<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-TW">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



















  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.4.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.4.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.4.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.4.0',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="ruopu&#39;s blog">
<meta property="og:url" content="http://yoursite.com/page/16/index.html">
<meta property="og:site_name" content="ruopu&#39;s blog">
<meta property="og:locale" content="zh-TW">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ruopu&#39;s blog">






  <link rel="canonical" href="http://yoursite.com/page/16/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>ruopu's blog</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-TW">

  
  
    
  

  <div class="container sidebar-position-right 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ruopu's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切換導航欄">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首頁</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />標籤</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分類</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />歸檔</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜尋</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜尋..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/02/tmux使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/02/tmux使用/" itemprop="url">
                  tmux使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-04-02 13:47:08" itemprop="dateCreated datePublished" datetime="2019-04-02T13:47:08+08:00">2019-04-02</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2020-04-17 17:32:07" itemprop="dateModified" datetime="2020-04-17T17:32:07+08:00">2020-04-17</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/基础/" itemprop="url" rel="index"><span itemprop="name">基础</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><blockquote>
<p>tmux采用C/S模型构建，输入tmux命令就相当于开启了一个服务器，此时默认将新建一个会话，然后会话中默认新建一个窗口，窗口中默认新建一个面板。会话、窗口、面板之间的联系如下： </p>
<p>一个tmux session（会话）可以包含多个window（窗口），窗口默认充满会话界面，因此这些窗口中可以运行相关性不大的任务。 </p>
<p>一个window又可以包含多个pane（面板），窗口下的面板，都处于同一界面下，这些面板适合运行相关性高的任务，以便同时观察到它们的运行情况。 </p>
</blockquote>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">⚡ ⚙ root@ruopu64  ~  apt install tmux</span><br></pre></td></tr></table></figure>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><h4 id="新建会话"><a href="#新建会话" class="headerlink" title="新建会话"></a>新建会话</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@ruopu64  ~  tmux</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 新建会话后，在屏幕的下方会有提示，如：<span class="string">"[0] 0:zsh*        "</span><span class="built_in">test</span><span class="string">" 13:51 02-4月-19"</span></span></span><br><span class="line">⚡ root@ruopu64  ~  exit</span><br><span class="line"><span class="meta">#</span><span class="bash"> 退出会话</span></span><br><span class="line">⚡ root@ruopu64  ~  tmux new -s abc</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建一个叫做abc的会话，提示信息：<span class="string">"[abc] 0:zsh*      "</span><span class="built_in">test</span><span class="string">" 13:53 02-4月-19"</span></span></span><br></pre></td></tr></table></figure>
<h4 id="断开当前会话"><a href="#断开当前会话" class="headerlink" title="断开当前会话"></a>断开当前会话</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@ruopu64  ~  tmux detach</span><br><span class="line"><span class="meta">#</span><span class="bash"> 断开会话，下次还可继续操作。会话会在后台运行</span></span><br><span class="line">也可以使用快捷键Ctrl + b松开，再按d</span><br></pre></td></tr></table></figure>
<h4 id="进入断开的会话"><a href="#进入断开的会话" class="headerlink" title="进入断开的会话"></a>进入断开的会话</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@ruopu64  ~  tmux a -t abc</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入名称为abc的会话</span></span><br><span class="line">⚡ root@ruopu64  ~  tmux attach-session</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入第一个会话，可以将attach-session简写为a或at</span></span><br></pre></td></tr></table></figure>
<h3 id="启用鼠标滚动"><a href="#启用鼠标滚动" class="headerlink" title="启用鼠标滚动"></a>启用鼠标滚动</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 先按ctrl+B</span><br><span class="line">2. set -g mouse on</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这时就启用对所有窗口的鼠标滚动了，但不能选中文本进行复制粘贴</span></span><br><span class="line">3. 按住shift再点击鼠标右键，这时就可以看到复制粘贴了，也可以选中文本了</span><br></pre></td></tr></table></figure>
<h4 id="查看会话"><a href="#查看会话" class="headerlink" title="查看会话"></a>查看会话</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@ruopu64  ~  tmux list-sessions </span><br><span class="line">1: 1 windows (created Tue Apr  2 13:55:52 2019) [70x21]</span><br><span class="line">2: 1 windows (created Tue Apr  2 13:56:05 2019) [70x21]</span><br><span class="line">abc: 1 windows (created Tue Apr  2 13:52:59 2019) [70x21]</span><br><span class="line"> ⚡ root@ruopu64  ~  tmux ls</span><br><span class="line">1: 1 windows (created Tue Apr  2 13:55:52 2019) [70x21]</span><br><span class="line">2: 1 windows (created Tue Apr  2 13:56:05 2019) [70x21]</span><br><span class="line">abc: 1 windows (created Tue Apr  2 13:52:59 2019) [70x21]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 两条命令是一样的，只是将list-sessions简写为了ls</span></span><br></pre></td></tr></table></figure>
<h4 id="关闭会话"><a href="#关闭会话" class="headerlink" title="关闭会话"></a>关闭会话</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@ruopu64  ~  tmux kill-session -t 2</span><br><span class="line"><span class="meta">#</span><span class="bash"> 关闭名称为2的会话</span></span><br><span class="line"> ⚡ root@ruopu64  ~  tmux kill-session </span><br><span class="line"><span class="meta"> #</span><span class="bash"> 关闭所有会话</span></span><br></pre></td></tr></table></figure>
<h4 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h4><blockquote>
<p>快捷键需要使用Ctrl+b激活控制台，再按下面的按键操作</p>
</blockquote>
<h5 id="系统操作"><a href="#系统操作" class="headerlink" title="系统操作"></a>系统操作</h5><table>
<thead>
<tr>
<th>?</th>
<th>列出所有快捷键；按q返回</th>
</tr>
</thead>
<tbody>
<tr>
<td>d</td>
<td>脱离当前会话；这样可以暂时返回Shell界面，输入tmux attach能够重新进入之前的会话</td>
</tr>
<tr>
<td>D</td>
<td>选择要脱离的会话；在同时开启了多个会话时使用</td>
</tr>
<tr>
<td>Ctrl+z</td>
<td>挂起当前会话</td>
</tr>
<tr>
<td>r</td>
<td>强制重绘未脱离的会话</td>
</tr>
<tr>
<td>s</td>
<td>列出所有会话，选择并切换会话；在同时开启了多个会话时使用</td>
</tr>
<tr>
<td>:</td>
<td>进入命令行模式；此时可以输入支持的命令，例如kill-server可以关闭服务器</td>
</tr>
<tr>
<td>[</td>
<td>进入复制模式；此时的操作与vi/emacs相同，按q/Esc退出</td>
</tr>
<tr>
<td>~</td>
<td>列出提示信息缓存；其中包含了之前tmux返回的各种提示信息</td>
</tr>
<tr>
<td>:new&lt;回车&gt;</td>
<td>启动新会话</td>
</tr>
<tr>
<td>$</td>
<td>重命名当前会话</td>
</tr>
</tbody>
</table>
<h5 id="窗口操作"><a href="#窗口操作" class="headerlink" title="窗口操作"></a>窗口操作</h5><table>
<thead>
<tr>
<th>c</th>
<th>创建新窗口</th>
</tr>
</thead>
<tbody>
<tr>
<td>&amp;</td>
<td>关闭当前窗口</td>
</tr>
<tr>
<td>数字键0~9</td>
<td>切换至指定窗口</td>
</tr>
<tr>
<td>p</td>
<td>切换至上一窗口</td>
</tr>
<tr>
<td>n</td>
<td>切换至下一窗口</td>
</tr>
<tr>
<td>l</td>
<td>在前后两个窗口间互相切换</td>
</tr>
<tr>
<td>w</td>
<td>通过窗口列表切换窗口</td>
</tr>
<tr>
<td>,</td>
<td>重命名当前窗口；这样便于识别</td>
</tr>
<tr>
<td>.</td>
<td>修改当前窗口编号；相当于窗口重新排序</td>
</tr>
<tr>
<td>f</td>
<td>在所有窗口中查找指定文本</td>
</tr>
</tbody>
</table>
<h5 id="面板操作"><a href="#面板操作" class="headerlink" title="面板操作"></a>面板操作</h5><table>
<thead>
<tr>
<th>”</th>
<th>将当前面板平分为上下两块</th>
</tr>
</thead>
<tbody>
<tr>
<td>%</td>
<td>将当前面板平分为左右两块</td>
</tr>
<tr>
<td>x</td>
<td>关闭当前面板</td>
</tr>
<tr>
<td>!</td>
<td>将当前面板置于新窗口；即新建一个窗口，其中仅包含当前面板</td>
</tr>
<tr>
<td>Ctrl+方向键</td>
<td>以1个单元格为单位移动边缘以调整当前面板大小</td>
</tr>
<tr>
<td>Alt+方向键</td>
<td>以5个单元格为单位移动边缘以调整当前面板大小</td>
</tr>
<tr>
<td>Space</td>
<td>在预置的面板布局中循环切换；依次包括even-horizontal、even-vertical、main-horizontal、main-vertical、tiled</td>
</tr>
<tr>
<td>q</td>
<td>显示面板编号</td>
</tr>
<tr>
<td>o</td>
<td>在当前窗口中选择下一面板</td>
</tr>
<tr>
<td>方向键</td>
<td>移动光标以选择面板</td>
</tr>
<tr>
<td>{</td>
<td>向前置换当前面板</td>
</tr>
<tr>
<td>}</td>
<td>向后置换当前面板</td>
</tr>
<tr>
<td>Alt+o</td>
<td>逆时针旋转当前窗口的面板</td>
</tr>
<tr>
<td>Ctrl+o</td>
<td>顺时针旋转当前窗口的面板</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/29/集群概念/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/29/集群概念/" itemprop="url">
                  集群概念
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-29 14:44:46" itemprop="dateCreated datePublished" datetime="2019-03-29T14:44:46+08:00">2019-03-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2020-04-17 17:32:07" itemprop="dateModified" datetime="2020-04-17T17:32:07+08:00">2020-04-17</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Cluster/" itemprop="url" rel="index"><span itemprop="name">Cluster</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="/images/cluster/架构.png" alt=""></p>
<h3 id="消息交换和基础结构层"><a href="#消息交换和基础结构层" class="headerlink" title="消息交换和基础结构层"></a>消息交换和基础结构层</h3><blockquote>
<p>Messaging and Infrastructure Layer：这一层也被称为心跳层，这一层主要包含了如发送心跳信息和集群中各种事务信息 </p>
<p>Membership Layer：也叫CCM层，用来计算整个集群中的节点状态信息的大图景，以及同步这个信息给集群中的所有节点，如集群中有几个节点，可以投几票等信息。还有组织集群拓朴的组件，所以它可以拥有整个集群的全局视图。 </p>
</blockquote>
<h3 id="资源分配层"><a href="#资源分配层" class="headerlink" title="资源分配层"></a>资源分配层</h3><blockquote>
<ul>
<li>CRM：资源分配层所采取的每个动作都是通过CRM来实现的，所以它是基础核心层，在每个节点上，CRM负责生成一个CIB，使每个节点都能了解整个集群的所有配置状态等。CRM会在集群中选举出一个节点当作DC，DC负责维持主CIB文档，所有对CIB的修改都应该通过DC来实现，而后由DC同步给其他节点，对CIB的读写都应该通过主CIB，也就是DC上的CIB，不能修改非DC的CIB，因为非DC的CIB是不会同步的。在一个集群中DC是唯一的，而且能做集群范围的修改操作及其他所有操作都是由DC来做出的。CIB是一个位于内存中的（也会同步到磁盘中），XML格式的，保存了集群每个条目的相关信息，包括集群状态，节点成员关系，定义的资源，及资源的关系等，如果要修改CIB的话可以使用各种客户端工具，如cibadmin这样的命令行工具或heartbeat GUI这样的图形化工具。DC还拥有PE和TE两个组件，一旦DC要做一个集群全局范围的修改，Policy Engine将用于实现计算集群的下一个状态，如当某一个节点离去了，此时位于这个节点上的所有资源应该被转移，之后运行在哪个节点就要由DC来决策，决策后还要修改CIB文档，PE还要将状态变化保存到CIB中，DC所做出的决策，如约束，是否爆头等都是由PE计算得出的，之后由TE负责执行。由TE将PE的决策发放给每个CRM，各CRM收到信息后，将指令发送给LRM，LRM将指令发给RA去执行。RA是脚本，可以执行基本的三个操作，start/stop/monitor </li>
</ul>
</blockquote>
<h4 id="群集资源管理器-CRM"><a href="#群集资源管理器-CRM" class="headerlink" title="群集资源管理器 (CRM)"></a>群集资源管理器 (CRM)</h4><blockquote>
<p>在资源分配层中执行的每个操作都要经过群集资源管理器。如果资源分配层的其他组件（或更高层中的组件）需要通讯，则它们通过本地 CRM 进行。在每个节点上，CRM 都会维护群集信息库 (CIB)</p>
</blockquote>
<h4 id="群集信息库-CIB"><a href="#群集信息库-CIB" class="headerlink" title="群集信息库 (CIB)"></a>群集信息库 (CIB)</h4><blockquote>
<p>群集信息库是整个群集配置和当前状态在内存中的 XML 表示。它包含所有群集选项、节点、资源、约束及其之间的关系的定义。CIB 还将更新同步到所有群集节点。群集中有一个主 CIB，由指定协调器 (DC)进行维护。所有其他节点都包含 CIB 复本。</p>
</blockquote>
<h4 id="指定协调器-DC"><a href="#指定协调器-DC" class="headerlink" title="指定协调器 (DC)"></a>指定协调器 (DC)</h4><blockquote>
<p>群集中的一个 CRM 会被选为 DC。DC 是群集中唯一可以决定需要在整个群集执行更改（例如节点屏蔽或资源移动）的实体。DC 同时也是用于保存 CIB 主副本的节点。所有其他节点都从当前 DC 获取他们的配置和资源分配信息。DC 是在成员资格更改后从群集的所有节点中选出的。</p>
</blockquote>
<h4 id="策略引擎-PE"><a href="#策略引擎-PE" class="headerlink" title="策略引擎 (PE)"></a>策略引擎 (PE)</h4><blockquote>
<p>只要指定协调程序需要进行群集范围的更改（对新 CIB 作出反应），策略引擎就会根据群集的当前状态和配置计算其下一个状态。PE 还生成一个转换图，包含用于达到下一个群集状态的（资源）操作和依赖性的列表。PE 始终在 DC 上运行。</p>
</blockquote>
<h4 id="本地资源管理器-LRM"><a href="#本地资源管理器-LRM" class="headerlink" title="本地资源管理器 (LRM)"></a>本地资源管理器 (LRM)</h4><blockquote>
<p>LRM一般由CRM提供，代表 CRM 调用本地资源代理。因此它可以执行启动/停止/监视操作并将结果报告给 CRM。LRM 是其本地节点上所有资源相关信息的权威来源。</p>
</blockquote>
<h3 id="资源层"><a href="#资源层" class="headerlink" title="资源层"></a>资源层</h3><blockquote>
<p>最高层是资源层。资源层包括一个或多个资源代理 (RA)。资源代理是已写入的用来启动、停止和监视某种服务（资源）的程序（通常是shell脚本）。资源代理仅由 LRM 调用。第三方可将他们自己的代理放在文件系统中定义的位置，这样就为各自的软件提供了现成群集集成。</p>
<p>Resource Layer：这里是一堆脚本ocf格式或lsb格式，建议使用ocf格式 </p>
</blockquote>
<h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><blockquote>
<p>群集最多可包含 32 个 Linux 服务器。如果群集内的一台服务器发生故障，则群集内的任何其他服务器均可重启动此服务器上的资源（应用程序、服务、IP 地址和文件系统）。</p>
<p>集群中应该有奇数个节点，如果是偶数，应该引入仲裁设备，集群中的节点通过心跳信息通告自己的健康状态，而不是探测其他主机，这意味着每个节点上都要运行一个应用程序，这些应用程序在固定的IP地址和端口上工作，通常因为是一对多的通信关系，因此是通过多播的方式向多播域内发送心跳信息和集群事务信息，其他主机看到这个信息就知道这个主机是在线的，这种功能的实现的层次称为message layer，message layer不但能传送心跳，还能传送集群事务信息，比如：如果集群发生分裂的话，失去联系并不具备法定票数的主机会被杀死。这就是集群事务内的决策信息。任何应用要想实现高可用，就要调用message layer提供的多播模式传递心跳信息和集群事务信息完成集群内部资源运行的决策，但不是所有应用都有这种能力，这就需要由CRM集群资源管理器实现，它向上可以为不具备高可用能力的服务提供高可用性，让其可以利用message layer完成高可用。向下，它利用message layer传递过来的各节点的心跳和集群事务信息，形成一个大的决策图景，从而决策都由CRM决定。因为各种资源的启动方式各有不同，为了避免这种麻烦，在CRM之上又加入了一个层次，叫LRM本地资源管理器。本地资源管理器一般都是由集群资源管理器提供的，本地资源不能做出一个资源应该如何启动与关闭，而要借助资源代理RA来实现，这是第四个层次。在每个节点上都有众多的RA，它是帮助启动关闭监控资源的脚本 。</p>
</blockquote>
<h4 id="资源类型"><a href="#资源类型" class="headerlink" title="资源类型"></a>资源类型</h4><blockquote>
<ul>
<li>Primitive：主资源，只能运行于集群内的某单个节点；只能启动一份，也称作native </li>
<li>Group：组资源，这是一个容器类资源，它可以包含一个或多个资源，这些资源可通过“组”这个资源统一进行调度 </li>
<li>Clone：克隆资源，可以在同一个集群内的多个节点运行多份克隆； </li>
<li>Master/slave：主从资源，在同一集群内部于两个节点运行两份资源，其中一个为主一个为从 </li>
</ul>
</blockquote>
<h4 id="资源的约束的关系"><a href="#资源的约束的关系" class="headerlink" title="资源的约束的关系"></a>资源的约束的关系</h4><blockquote>
<ul>
<li>location：位置约束，定义资源对节点的倾向性；用数值表示，从负无穷到正无穷 </li>
<li>colocation：排列约束，定义资源彼此间“在一起”的倾向性；从负无穷到正无穷</li>
<li>分组：也能实现将多个资源绑定在一起；但不能让资源不在一起 </li>
<li>Order：顺序约束，定义资源在同一个节点上启动时的先后顺序； </li>
</ul>
<p>运行在哪个节点，是在资源管理器的接口上进行配置，配置有三：1.这个资源更倾向运行在哪个节点上；2.这个资源更倾向与哪个资源运行在一起，注意：一个资源不能称之为服务，比如构建一个高可用的web集群，需要IP地址，进程，页面文件等，所以高可用服务与高可用资源是两回事。高可用服务可能包括多个高可用资源。一个高可用集群中的高可用资源可能有多个，而且要分类在一起才能构建成一个服务，比如，要启动三个资源，IP在第一个节点上，进程在第二个节点上，页面文件在第三个节点上，这是没用的，因为它们要同进退的。所以哪些资源要运行在一起，不能分开。这叫资源的排列约束。这主要是定义资源在一起的倾向性的。3. 如果多个资源必须运行在同一个节点上，并提供同一个服务工作，那是否有先后次序关系呢？是否要先启动一个再启动一个。比如：是先挂载页面文件还是先启动web进程。这就是次序约束。 </p>
</blockquote>
<blockquote>
<p>参考：</p>
<p><a href="https://www.suse.com/zh-cn/documentation/sle_ha/singlehtml/book_sleha/book_sleha.html#idm140043812445408" target="_blank" rel="noopener">SUSE Linux Enterprise High Availability Extension 11 SP4 高可用性指南</a></p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/29/corosync&pacemaker集群部署/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/29/corosync&pacemaker集群部署/" itemprop="url">
                  corosync&pacemaker集群部署
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-29 14:16:07" itemprop="dateCreated datePublished" datetime="2019-03-29T14:16:07+08:00">2019-03-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2020-04-17 17:32:07" itemprop="dateModified" datetime="2020-04-17T17:32:07+08:00">2020-04-17</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Cluster/" itemprop="url" rel="index"><span itemprop="name">Cluster</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><h4 id="OpenAIS"><a href="#OpenAIS" class="headerlink" title="OpenAIS"></a>OpenAIS</h4><blockquote>
<p>OpenAIS是基于SA Forum 标准的集群框架的应用程序接口规范。OpenAIS提供一种集群模式，这个模式包括集群框架，集群成员管理，通信方式，集群监测等，能够为集群软件或工具提供满足 AIS标准的集群接口，但是它没有集群资源管理功能，不能独立形成一个集群。OpenAIS组件包括AMF，CLM，CKPT，EVT，LCK，MSG，TMR，CPG，EVS等，因OpenAIS分支不同，组件略有不同。OpenAIS主要包含三个分支：Picacho，Whitetank，Wilson。Wilson是最新的，比较稳定的版本是从openais 1.0.0到openais1.1.4。Whitetank现在是主流分支版本，比较稳定的版本是openais0.80到openais0.86。Picacho第一代的OpenAIS的分支，比较稳定的版本是openais0.70和openais0.71。现在比较常用的是Whitetank和Wilson，两者之间有很多不同。OpenAIS从Whitetank升级到Wilson版本后，组件变化很大，Wilson把Openais核心架构组件独立出来放在Corosync（Corosync是一个集群管理引擎）里面。Whitetank包含的组件有AMF，CLM，CKPT，EVT，LCK ，MSG，CPG，CFG，EVS，aisparser，VSF_ykd，bojdb等。而Wilson只含有AMF，CLM，CKPT，LCK, MSG，EVT，TMR（TMR，Whitetank里面没有），这些都是AIS组件。其他核心组件被放到了Corosync内。Wilson被当做Corosync的一个插件。</p>
</blockquote>
<h4 id="corosync"><a href="#corosync" class="headerlink" title="corosync"></a>corosync</h4><blockquote>
<p>Corosync是OpenAIS发展到Wilson版本后衍生出来的开放性集群引擎工程。可以说Corosync是OpenAIS工程的一部分。OpenAIS从openais0.90开始独立成两部分，一个是Corosync；另一个是AIS标准接口Wilson。Corosync包含OpenAIS的核心框架用来对Wilson的标准接口的使用、管理。它为商用的或开源性的集群提供集群执行框架。Corosync执行高可用应用程序的通信组系统，它有以下特征： </p>
<ul>
<li>一个封闭的程序组（A closed process group communication model）通信模式，这个模式提供一种虚拟的同步方式来保证能够复制服务器的状态。 </li>
<li>一个简单可用性管理组件（A simple availability manager），这个管理组件可以重新启动应用程序的进程当它失败后。 </li>
<li>一个配置和内存数据的统计（A configuration and statistics <a href="http://en.wikipedia.org/wiki/in-memory_database" target="_blank" rel="noopener">in-memory database</a>），内存数据能够被设置，回复，接受通知的更改信息。 </li>
<li>一个定额的系统（A quorum  system），定额完成或者丢失时通知应用程序。 </li>
</ul>
</blockquote>
<h4 id="cman"><a href="#cman" class="headerlink" title="cman"></a>cman</h4><blockquote>
<p>CMAN是红帽RHCS套件的核心部分，CCS是CMAN集群配置系统，配置cluster.conf，而cluster.conf其实就是openais的配置文件，通过CCS映射到openais。 </p>
</blockquote>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><blockquote>
<p>AIS就是一个通用的应用程序编程接口，OpenAIS是AIS的子项目，标准的集群框架的应用程序接口规范，而corosync是OpenAIS是具体实现。</p>
</blockquote>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><h4 id="基本实现"><a href="#基本实现" class="headerlink" title="基本实现"></a>基本实现</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">===========================================================================================</span><br><span class="line">环境：</span><br><span class="line">准备三台主机，地址：192.168.2.132（primary, node1）、192.168.2.133（secondary, node2）。192.168.2.128（node3）提供NFS服务。</span><br><span class="line">===========================================================================================</span><br><span class="line">----------------</span><br><span class="line">   node1&amp;2</span><br><span class="line">----------------</span><br><span class="line">[root@primary ~]# ntpdate ntp.aliyun.com</span><br><span class="line"><span class="meta">#</span><span class="bash"> 同步时间</span></span><br><span class="line">[root@primary ~]# ssh-keygen -t rsa -P ''</span><br><span class="line">[root@primary ~]# ssh-copy-id -i ~/.ssh/id_rsa.pub 192.168.2.133</span><br><span class="line"><span class="meta">#</span><span class="bash"> 让两节点使用密钥通信</span></span><br><span class="line">[root@primary ~]# yum install -y corosync pacemaker</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装两个包</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# cd /etc/corosync/</span><br><span class="line">[root@primary corosync]# cp corosync.conf.example</span><br><span class="line">corosync.conf.example       corosync.conf.example.udpu  </span><br><span class="line">[root@primary corosync]# cp corosync.conf.example corosync.conf</span><br><span class="line">[root@primary corosync]# vim corosync.conf</span><br><span class="line">compatibility: whitetank</span><br><span class="line"><span class="meta">#</span><span class="bash"> 是否兼容whitetank </span></span><br><span class="line">totem &#123;</span><br><span class="line">	version: 2</span><br><span class="line">	secauth: on</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否打开安装认证，不让其他主机加入，打开此功能后需要使用corosync-keygen生成密钥 </span></span><br><span class="line">	threads: 0</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 工作时的线程数，0表示基于进程模式工作</span></span><br><span class="line">	interface &#123;</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 定义多个节点之间通过哪个接口，基于哪个多播地址，监听什么端口完成多播通信 </span></span><br><span class="line">		ringnumber: 0</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 环数目，一般为0，类似TTL值 </span></span><br><span class="line">		bindnetaddr: 192.168.2.0</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 这通常是要绑定到的接口的*网络*地址，也就是本机所在的网络。这样可以确保您可以跨所有集群节点使用此配置文件的相同实例，而无需修改此选项。 </span></span><br><span class="line">		mcastaddr: 239.165.134.13</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 多播地址</span></span><br><span class="line">		mcastport: 5405</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 多播监听端口 </span></span><br><span class="line">		ttl: 1</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">logging &#123;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定日志系统</span></span><br><span class="line">	fileline: off</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否记录fileline </span></span><br><span class="line">	to_stderr: no</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否发往标准错误输出，一般不发送</span></span><br><span class="line">	to_logfile: yes</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否记录到日志文件中</span></span><br><span class="line">	logfile: /var/log/cluster/corosync.log</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 日志位置 </span></span><br><span class="line">	to_syslog: no</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 也发往syslog一份，一般记录一份<span class="built_in">log</span>即可，所以这里关闭了此功能 </span></span><br><span class="line">	debug: off</span><br><span class="line">	timestamp: on</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否在日志中打开时间戳功能，如果是on，会影响系统性能 </span></span><br><span class="line">	logger_subsys &#123;</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否记录子系统，记录AMF，这是OpenAIS的子组件</span></span><br><span class="line">		subsys: AMF</span><br><span class="line">		debug: off</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">service &#123;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入此段，以插件形式运行pacemaker</span></span><br><span class="line">	ver: 0</span><br><span class="line">	name: pacemaker</span><br><span class="line">	use_mgmtd: yes</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 此项可有可无 </span></span><br><span class="line">&#125;</span><br><span class="line">aisexec &#123;</span><br><span class="line">	user: root</span><br><span class="line">	group:	root</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 以root用户身份运行，此项可有可无 </span></span><br><span class="line">&#125;</span><br><span class="line">[root@primary corosync]# ip link show</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN </span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</span><br><span class="line">    link/ether 00:0c:29:83:af:ca brd ff:ff:ff:ff:ff:ff</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看网卡是否支持MULTICAST</span></span><br><span class="line">[root@primary corosync]# corosync-keygen </span><br><span class="line">Corosync Cluster Engine Authentication key generator.</span><br><span class="line">Gathering 1024 bits for key from /dev/random.</span><br><span class="line">Press keys on your keyboard to generate entropy.</span><br><span class="line">Writing corosync key to /etc/corosync/authkey.</span><br><span class="line"><span class="meta">#</span><span class="bash"> 从随机数中生成密钥，需要1024个字符，可能不够，如果不够，可以下载大文件产生IO数，使熵池中生成随机数</span></span><br><span class="line">[root@primary corosync]# ll </span><br><span class="line">总用量 32</span><br><span class="line">-rw-r--r-- 1 root root 5384 7月  20 2011 amf.conf.example</span><br><span class="line">-r-------- 1 root root  128 4月   2 15:47 authkey</span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成了authkey文件，权限400</span></span><br><span class="line">[root@primary corosync]# scp authkey corosync.conf 192.168.2.133:/etc/corosync/</span><br><span class="line">[root@primary corosync]# service corosync start; ssh 192.168.2.133 'service corosync start'</span><br><span class="line">Starting Corosync Cluster Engine (corosync):               [  OK  ]</span><br><span class="line">Starting Corosync Cluster Engine (corosync): [  OK  ]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动两个节点的corosync服务</span></span><br><span class="line">[root@primary corosync]# ss -tlun</span><br><span class="line"><span class="meta">#</span><span class="bash"> 监听了5405多播端口</span></span><br><span class="line">[root@primary corosync]# tail -f /var/log/cluster/corosync.log</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看日志中是否有报错信息</span></span><br><span class="line">[root@primary corosync]# grep -e "Corosync Cluster Engine" -e "configuration file" /var/log/cluster/corosync.log</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看两个节点中是否有两条信息，如果有就证明启动成功了</span></span><br><span class="line">[root@primary corosync]# grep TOTEM /var/log/cluster/corosync.log</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看初始化成员节点通知是否正常发出，应该可以查到内容</span></span><br><span class="line">[root@primary corosync]# grep ERROR: /var/log/cluster/corosync.log | grep –v unpack_resources</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="comment"># 检查启动过程中是否有错误产生，错误信息表示packmaker不久之后将不再作为corosync的插件运行，因此，建议使用cman作为集群基础架构服务，此处可安全忽略。 </span></span></span><br><span class="line">[root@primary corosync]# grep pcmk_startup /var/log/cluster/corosync.log</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果有信息说明启动完成</span></span><br></pre></td></tr></table></figure>
<h4 id="使用crmsh配置pacemaker"><a href="#使用crmsh配置pacemaker" class="headerlink" title="使用crmsh配置pacemaker"></a>使用crmsh配置pacemaker</h4><blockquote>
<p>crmsh工具在集群中的任一节点上安装均可，不需要每个节点都安装</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@primary corosync]# cd /etc/yum.repos.d/</span><br><span class="line">[root@primary yum.repos.d]# wget http://download.opensuse.org/repositories/network:/ha-clustering:/Stable/CentOS_CentOS-6/network:ha-clustering:Stable.repo</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载opensuse的源，因为crmsh工具是opensuse提供的</span></span><br><span class="line">[root@primary yum.repos.d]# yum install -y crmsh pssh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装，连接速度很慢</span></span><br><span class="line">[root@primary yum.repos.d]# crm</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入crm模式</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 16:03:21 2019</span><br><span class="line">Last change: Tue Apr  2 15:51:08 2019 by hacluster via crmd on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">0 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">No resources</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看状态，也可以直接使用crm status命令。可以看到DC是主机名为primary的节点，Online: [ primary secondary ]表示有两台主机都在线。</span></span><br></pre></td></tr></table></figure>
<h5 id="configure配置集群"><a href="#configure配置集群" class="headerlink" title="configure配置集群"></a>configure配置集群</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[root@primary ~]# crm </span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> configure</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在子命令中使用此命令，表示配置集群模式 </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> <span class="built_in">help</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看configure的帮助</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> show</span></span><br><span class="line">node primary</span><br><span class="line">node secondary</span><br><span class="line">property cib-bootstrap-options: \</span><br><span class="line">	have-watchdog=false \</span><br><span class="line">	dc-version=1.1.18-3.el6-bfe4e80420 \</span><br><span class="line">	cluster-infrastructure="classic openais (with plugin)" \</span><br><span class="line">	expected-quorum-votes=2</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这是configure中的子命令，显示当前集群配置信息，实际配置文件是XML格式的。显示的property表示集群的全局属性，全局属性是配置集群的基本特性的 </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> show xml</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这样就可以看到xml格式的配置文件</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> property </span></span><br><span class="line">batch-limit=                   enable-startup-probes=         node-health-strategy=          stonith-enabled= </span><br><span class="line">cluster-delay=                 have-watchdog=                 node-health-yellow=            stonith-max-attempts= </span><br><span class="line">cluster-ipc-limit=             is-managed-default=            pe-error-series-max=           stonith-timeout= </span><br><span class="line"><span class="meta">#</span><span class="bash"> 执行此命令后，再按两次Tab键，可以看到可以配置的全局属性。stonity-enabled=表示是否必须配置stonith设备，默认为是。</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> property stonith-enabled=</span></span><br><span class="line">stonith-enabled (boolean, [true]): </span><br><span class="line">    Failed nodes are STONITH'd</span><br><span class="line"><span class="meta">#</span><span class="bash"> 按两次Tab键后可以看到默认的值是True </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> property stonith-enabled=<span class="literal">false</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 禁用stonith</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 校验配置是否有错，如果没错，不会显示任何信息</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> show</span></span><br><span class="line">node primary</span><br><span class="line">node secondary</span><br><span class="line">property cib-bootstrap-options: \</span><br><span class="line">	have-watchdog=false \</span><br><span class="line">	dc-version=1.1.18-3.el6-bfe4e80420 \</span><br><span class="line">	cluster-infrastructure="classic openais (with plugin)" \</span><br><span class="line">	expected-quorum-votes=2 \</span><br><span class="line">	stonith-enabled=false</span><br><span class="line"><span class="meta">#</span><span class="bash"> 再查看，多了stonith-enabled=<span class="literal">false</span>一项</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 提交，这样才能生效。因为上面的配置都是在内存中完成的。</span></span><br></pre></td></tr></table></figure>
<h5 id="node"><a href="#node" class="headerlink" title="node"></a>node</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> node</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> ls</span></span><br><span class="line">..               help             fence            </span><br><span class="line">show             attribute        back             </span><br><span class="line">cd               ready            status-attr      </span><br><span class="line">quit             end              utilization      </span><br><span class="line">exit             ls               maintenance      </span><br><span class="line">online           bye              ?                </span><br><span class="line">status           clearstate       standby          </span><br><span class="line">list             up               server           </span><br><span class="line">delete           </span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看可用的命令</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> show</span></span><br><span class="line">primary: normal</span><br><span class="line">secondary: normal</span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示当前在线节点，都是normal状态</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> standby</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 把当前节点设置为备用状态 </span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> show</span></span><br><span class="line">primary: normal</span><br><span class="line">	standby=on</span><br><span class="line">secondary: normal</span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> online</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 再让节点上线</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> status</span></span><br><span class="line">&lt;nodes&gt;</span><br><span class="line">  &lt;node id="primary" uname="primary"&gt;</span><br><span class="line">    &lt;instance_attributes id="nodes-primary"&gt;</span><br><span class="line">      &lt;nvpair id="nodes-primary-standby" name="standby" value="off"/&gt;</span><br><span class="line">    &lt;/instance_attributes&gt;</span><br><span class="line">  &lt;/node&gt;</span><br><span class="line">  &lt;node id="secondary" uname="secondary"/&gt;</span><br><span class="line">&lt;/nodes&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看当前节点信息</span></span><br></pre></td></tr></table></figure>
<h5 id="resource"><a href="#resource" class="headerlink" title="resource"></a>resource</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> resource</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> <span class="built_in">help</span></span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看资源状态</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> stop resource-name</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止资源</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> start resource-name</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动资源</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> restart resource-name</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启资源</span></span><br></pre></td></tr></table></figure>
<h5 id="ra资源代理"><a href="#ra资源代理" class="headerlink" title="ra资源代理"></a>ra资源代理</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> ra </span></span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> ls</span></span><br><span class="line">..               info             quit             </span><br><span class="line">end              help             providers        </span><br><span class="line">up               list             cd               </span><br><span class="line">classes          meta             ls               </span><br><span class="line">back             exit             validate         </span><br><span class="line">bye              ?                </span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> classes</span></span><br><span class="line">lsb</span><br><span class="line">ocf / .isolation heartbeat linbit pacemaker</span><br><span class="line">service</span><br><span class="line">stonith</span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示资源代理模式 </span></span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> list lsb</span></span><br><span class="line">abrt-ccpp                abrt-oops                abrtd                    acpid                    atd</span><br><span class="line">auditd                   autofs                   blk-availability         bmc-snmp-proxy           certmonger</span><br><span class="line">cgconfig                 cgred                    cman                     corosync                 corosync-notifyd</span><br><span class="line">cpuspeed                 crond                    cups                     drbd                     exchange-bmc-os-info</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看lsb中有哪些资源代理可用</span></span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> list ocf heartbeat</span></span><br><span class="line">CTDB              Delay             Dummy             Filesystem        IPaddr            IPaddr2           IPsrcaddr</span><br><span class="line">LVM               MailTo            Route             SendArp           Squid             VirtualDomain     Xinetd</span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> list ocf pacemaker</span></span><br><span class="line">ClusterMon    Dummy         HealthCPU     HealthSMART   Stateful      SysInfo       SystemHealth  attribute     ifspeed</span><br><span class="line">ping          pingd         remote  </span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> list service</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> service与lsb是一样的</span></span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> list stonith</span></span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> <span class="built_in">help</span> info</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  info可以查看帮助信息</span></span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> info ocf:heartbeat:IPaddr</span></span><br></pre></td></tr></table></figure>
<h5 id="配置资源primitive"><a href="#配置资源primitive" class="headerlink" title="配置资源primitive"></a>配置资源primitive</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> configure</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> primitive webip ocf:heartbeat:IPaddr params ip=192.168.2.100 nic=eth1 cidr_netmask=24</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> webip是资源名称，ocf:heartbeat:IPaddr是资源代理，params 用来指明参数，IP地址，网卡，掩码。</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 16:26:40 2019</span><br><span class="line">Last change: Tue Apr  2 16:26:27 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">1 resource configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以看到webip资源添加到了节点1上</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> <span class="built_in">exit</span></span></span><br><span class="line">bye</span><br><span class="line">[root@primary ~]# ip a</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN </span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</span><br><span class="line">    link/ether 00:0c:29:83:af:ca brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.2.132/24 brd 192.168.2.255 scope global eth1</span><br><span class="line">    inet 192.168.2.100/24 brd 192.168.2.255 scope global secondary eth1</span><br><span class="line">    inet6 fe80::20c:29ff:fe83:afca/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看看到添加了一个IP</span></span><br><span class="line">[root@primary ~]# crm node standby</span><br><span class="line"><span class="meta">#</span><span class="bash"> 要将哪个节点转为备节点，就在哪个节点上执行此命令</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 16:30:38 2019</span><br><span class="line">Last change: Tue Apr  2 16:30:34 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">1 resource configured</span><br><span class="line"></span><br><span class="line">Node primary: standby</span><br><span class="line">Online: [ secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started secondary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看状态，online的就只有node2了</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node2</span><br><span class="line">-------------</span><br><span class="line">[root@secondary ~]# ip a</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN </span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</span><br><span class="line">    link/ether 00:0c:29:af:e1:97 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.2.133/24 brd 192.168.2.255 scope global eth1</span><br><span class="line">    inet 192.168.2.100/24 brd 192.168.2.255 scope global secondary eth1</span><br><span class="line">    inet6 fe80::20c:29ff:feaf:e197/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以看到ip地址转到node2了</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# crm node online</span><br><span class="line"><span class="meta">#</span><span class="bash"> 让节点1上线</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 16:32:28 2019</span><br><span class="line">Last change: Tue Apr  2 16:32:25 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">1 resource configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started secondary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 资源没有转回</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node2</span><br><span class="line">-------------</span><br><span class="line">[root@secondary ~]# service corosync stop</span><br><span class="line">Signaling Corosync Cluster Engine (corosync) to terminate: [  OK  ]</span><br><span class="line">Waiting for corosync services to unload:.                  [  OK  ]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 停掉节点2的服务，看资源是转到节点1上</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition WITHOUT quorum</span><br><span class="line">Last updated: Tue Apr  2 16:34:22 2019</span><br><span class="line">Last change: Tue Apr  2 16:32:25 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">1 resource configured</span><br><span class="line"></span><br><span class="line">Online: [ primary ]</span><br><span class="line">OFFLINE: [ secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Stopped</span><br><span class="line"><span class="meta">#</span><span class="bash"> 看资源是否转移，显示资源没有启动，因为一个服务停止了，所以只有一个节点在线，未超过半数，并且资源默认是关闭的，所以资源未启动 </span></span><br><span class="line">[root@primary ~]# crm configure</span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> property no-quorum-policy=ignore</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置没有法定票数时怎么办，设置为ignore</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> <span class="built_in">exit</span></span></span><br><span class="line">bye</span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition WITHOUT quorum</span><br><span class="line">Last updated: Tue Apr  2 16:36:29 2019</span><br><span class="line">Last change: Tue Apr  2 16:35:58 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">1 resource configured</span><br><span class="line"></span><br><span class="line">Online: [ primary ]</span><br><span class="line">OFFLINE: [ secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这时可以看到资源启动了</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node2</span><br><span class="line">-------------</span><br><span class="line">[root@secondary ~]# service corosync start</span><br><span class="line">Starting Corosync Cluster Engine (corosync): </span><br><span class="line">                                                           [  OK  ]</span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# crm resource</span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status webip</span></span><br><span class="line">resource webip is running on: primary </span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看资源状态，显示资源在primary上</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> migrate webip secondary</span></span><br><span class="line">INFO: Move constraint created for webip to secondary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 转移资源 到secondary上，secondary是主机名</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status webip</span></span><br><span class="line">resource webip is running on: secondary </span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示资源在secondary上</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> stop webip</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止资源 </span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status webip</span></span><br><span class="line">resource webip is NOT running</span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> start webip</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动资源 </span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status webip</span></span><br><span class="line">resource webip is running on: secondary </span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status </span></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看所有资源</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> unmigrate webip</span></span><br><span class="line">INFO: Removed migration constraints for webip</span><br><span class="line"><span class="meta">#</span><span class="bash"> 转回到原来的节点</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status webip</span></span><br><span class="line">resource webip is running on: secondary </span><br><span class="line"><span class="meta">#</span><span class="bash"> 因为没有倾向性，所以没有转移</span></span><br></pre></td></tr></table></figure>
<h5 id="高可用web"><a href="#高可用web" class="headerlink" title="高可用web"></a>高可用web</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br></pre></td><td class="code"><pre><span class="line">----------------</span><br><span class="line">   node1&amp;2</span><br><span class="line">----------------</span><br><span class="line">[root@primary ~]# yum install -y httpd</span><br><span class="line">[root@primary ~]# vim /var/www/html/index.html</span><br><span class="line">node1:primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 提供网页文件，另一台内容为node2:secondary</span></span><br><span class="line">[root@primary ~]# service httpd start</span><br><span class="line">[root@primary ~]# curl 192.168.2.132</span><br><span class="line">node1:primary</span><br><span class="line">[root@primary ~]# curl 192.168.2.133</span><br><span class="line">node2:secondary</span><br><span class="line">[root@secondary ~]# service httpd stop</span><br><span class="line">[root@secondary ~]# chkconfig httpd off</span><br><span class="line"><span class="meta">#</span><span class="bash"> 因为要高可用此资源，所以不可以让服务自动启动</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# crm configure      </span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> primitive webserver lsb:httpd</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加资源</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node2</span><br><span class="line">-------------</span><br><span class="line">[root@secondary ~]# ss -tln</span><br><span class="line"><span class="meta">#</span><span class="bash"> web服务在节点2上启动了</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# crm resource</span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> show</span></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started</span><br><span class="line"> webserver	(lsb:httpd):	Started</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看资源是启动的</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> stop webserver</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止资源</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> show</span></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started</span><br><span class="line"> webserver	(lsb:httpd):	Stopped (disabled)</span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> start webserver</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 再启动</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> show</span></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started</span><br><span class="line"> webserver	(lsb:httpd):	Started</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这时资源还是在节点2上启动</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> node</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> standby secondary</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 让节点2成为备用节点</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:10:10 2019</span><br><span class="line">Last change: Tue Apr  2 17:08:47 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Node secondary: standby</span><br><span class="line">Online: [ primary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这时两个资源都在节点1上运行了</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> node online secondary</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 让节点2上线</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:11:16 2019</span><br><span class="line">Last change: Tue Apr  2 17:11:08 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started secondary</span><br><span class="line"><span class="meta"> #</span><span class="bash"> web资源又转移到了节点2上</span></span><br><span class="line"> </span><br><span class="line"> ==========================================================================================</span><br><span class="line"> 使用资源组的方式，让资源在同一个节点运行</span><br><span class="line"> ==========================================================================================</span><br><span class="line"><span class="meta"> crm(live)configure#</span><span class="bash"> group webservice webip webserver</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 定义一个组叫webservice，组内有两个资源</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> <span class="built_in">exit</span></span></span><br><span class="line">bye</span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:14:15 2019</span><br><span class="line">Last change: Tue Apr  2 17:13:22 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> Resource Group: webservice</span><br><span class="line">     webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line">     webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> web资源又转移到节点1上了</span></span><br><span class="line">[root@primary ~]# crm configure</span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> edit</span></span><br><span class="line">node primary \</span><br><span class="line">        attributes standby=off</span><br><span class="line">node secondary \</span><br><span class="line">        attributes standby=off</span><br><span class="line">primitive webip IPaddr \</span><br><span class="line">        params ip=192.168.2.100 nic=eth1 cidr_netmask=24 \</span><br><span class="line">        meta target-role=Started</span><br><span class="line">primitive webserver lsb:httpd \</span><br><span class="line">        meta target-role=Started</span><br><span class="line">group webservice webip webserver</span><br><span class="line">property cib-bootstrap-options: \</span><br><span class="line">        have-watchdog=false \</span><br><span class="line">        dc-version=1.1.18-3.el6-bfe4e80420 \</span><br><span class="line">        cluster-infrastructure="classic openais (with plugin)" \</span><br><span class="line">        expected-quorum-votes=2 \</span><br><span class="line">        stonith-enabled=false \</span><br><span class="line">        no-quorum-policy=ignore</span><br><span class="line"><span class="meta">#</span><span class="bash"> 编辑配置文件</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:18:54 2019</span><br><span class="line">Last change: Tue Apr  2 17:18:36 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> Resource Group: webservice</span><br><span class="line">     webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line">     webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以看到两个资源在一个资源组中</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> configure delete webservice</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除资源组，并不会报错，资源组马上被删除了</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:19:12 2019</span><br><span class="line">Last change: Tue Apr  2 17:19:10 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started secondary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 资源组没有了</span></span><br><span class="line">==========================================================================================</span><br><span class="line">定义排列约束，即将资源绑定在一起</span><br><span class="line">==========================================================================================</span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> configure</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> colocation webserver_with_webip inf: webserver webip</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> colocation定义排列约束，webserver_with_webip是自定义名称，inf表示定义分数，冒号后没有东西表示无穷大，这样两个资源就永远在一起了 </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:26:39 2019</span><br><span class="line">Last change: Tue Apr  2 17:26:35 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 提交后，两个资源就都在节点1上运行了</span></span><br><span class="line">==========================================================================================</span><br><span class="line">定义顺序约束，即资源的启动顺序。定义位置约束，即让资源倾向在哪个节点上运行。</span><br><span class="line">==========================================================================================</span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> order webip_before_webserver Mandatory: webip webserver</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 定义顺序约束，先启动webip再启动webserver </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> location webip_on_node2 webip 50: secondary</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 定义位置约束，让webip资源尽量在节点2上运行 </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:51:11 2019</span><br><span class="line">Last change: Tue Apr  2 17:50:50 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started secondary</span><br><span class="line"> webserver	(lsb:httpd):	Started secondary</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 提交后，资源都转到节点2运行了</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"> crm(live)configure#</span><span class="bash"> delete webip_on_node2 </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> show</span></span><br><span class="line">node primary \</span><br><span class="line">	attributes standby=off</span><br><span class="line">node secondary \</span><br><span class="line">	attributes standby=off</span><br><span class="line">primitive webip IPaddr \</span><br><span class="line">	params ip=192.168.2.100 nic=eth1 cidr_netmask=24 \</span><br><span class="line">	meta target-role=Started</span><br><span class="line">primitive webserver lsb:httpd \</span><br><span class="line">	meta target-role=Started</span><br><span class="line">order webip_before_webserver Mandatory: webip webserver</span><br><span class="line">colocation webserver_with_webip inf: webserver webip</span><br><span class="line">property cib-bootstrap-options: \</span><br><span class="line">	have-watchdog=false \</span><br><span class="line">	dc-version=1.1.18-3.el6-bfe4e80420 \</span><br><span class="line">	cluster-infrastructure="classic openais (with plugin)" \</span><br><span class="line">	expected-quorum-votes=2 \</span><br><span class="line">	stonith-enabled=false \</span><br><span class="line">	no-quorum-policy=ignore</span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> location webip_on_node2 webip rule 50: <span class="comment">#uname eq secondary</span></span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> standby secondary</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 让节点2成为备用节点</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:55:23 2019</span><br><span class="line">Last change: Tue Apr  2 17:55:07 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Node secondary: standby</span><br><span class="line">Online: [ primary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这时资源会转移到节点1</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> online secondary</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 节点2上线</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:55:38 2019</span><br><span class="line">Last change: Tue Apr  2 17:55:34 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started secondary</span><br><span class="line"> webserver	(lsb:httpd):	Started secondary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 资源又转回到节点2</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> rsc_defaults resource-stickiness=50</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置资源指黏性值，默认是0。之前的命令property default-resource-stickiness=50 已经不能使用了</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> node standby secondary</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 节点2下线</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 18:10:12 2019</span><br><span class="line">Last change: Tue Apr  2 18:07:48 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Node secondary: standby</span><br><span class="line">Online: [ primary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 资源到节点1</span></span><br><span class="line"><span class="meta"> crm(live)#</span><span class="bash"> node online secondary</span></span><br><span class="line"><span class="meta"> #</span><span class="bash"> 节点2上线</span></span><br><span class="line"> [root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 18:11:19 2019</span><br><span class="line">Last change: Tue Apr  2 18:10:41 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 资源不再转移，与设置资源黏性有关</span></span><br><span class="line"> [root@primary ~]# killall httpd</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 停止web服务</span></span><br><span class="line"><span class="meta"> crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 18:12:49 2019</span><br><span class="line">Last change: Tue Apr  2 18:10:41 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认只高可用节点，资源停掉也不会关心，还是显示资源在节点1上运行</span></span><br><span class="line"></span><br><span class="line">===========================================================================================</span><br><span class="line">配置高可用web资源，设置监控</span><br><span class="line">===========================================================================================</span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> resource</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> stop webserver</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> stop webip</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止资源</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> configure edit</span></span><br><span class="line">node primary \</span><br><span class="line">        attributes standby=off</span><br><span class="line">node secondary \</span><br><span class="line">        attributes standby=off</span><br><span class="line">property cib-bootstrap-options: \</span><br><span class="line">        have-watchdog=false \</span><br><span class="line">        dc-version=1.1.18-3.el6-bfe4e80420 \</span><br><span class="line">        cluster-infrastructure="classic openais (with plugin)" \</span><br><span class="line">        expected-quorum-votes=2 \</span><br><span class="line">        stonith-enabled=false \</span><br><span class="line">        no-quorum-policy=ignore</span><br><span class="line">rsc_defaults rsc-options: \</span><br><span class="line">        resource-stickiness=50</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除上面定义的资源，下面重新定义</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> primitive webip ocf:heartbeat:IPaddr params ip=192.168.2.100 nic=eth1 cidr_netmask=24 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 定义资源</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> monitor webip 10s:20s</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 单独定义monitor，后面是interval和timeout的时间</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> primitive webserver lsb:httpd op monitor interval=10s timeout=20s</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 也可以将定义资源与监控在一起定义。一定要用op才能使用monitor命令。monitor表示监控，interval=10s timeout=20s是监控的轮询时间和超时时间，有了监控，就可以在资源停止时进行转移了 </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> group webservice webip webserver</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line">[root@primary ~]# ss -tln</span><br><span class="line"><span class="meta">#</span><span class="bash"> 现在服务运行在节点1上</span></span><br><span class="line">[root@primary ~]# killall httpd</span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止web服务</span></span><br><span class="line">[root@primary ~]# ss -tln</span><br><span class="line"><span class="meta">#</span><span class="bash"> 10秒后，web服务会再次启动</span></span><br><span class="line">[root@primary ~]# yum install -y epel-release</span><br><span class="line">[root@primary ~]# yum install -y nginx</span><br><span class="line">[root@primary ~]# killall httpd</span><br><span class="line">[root@primary ~]# service nginx start</span><br><span class="line">Starting nginx:                                            [  OK  ]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止httpd服务，并启动nginx服务，为了不让httpd服务在节点1启动。看资源是否会转移到节点2上</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node2</span><br><span class="line">-------------</span><br><span class="line">[root@secondary ~]# ss -tln</span><br><span class="line">[root@secondary ~]# ip a</span><br><span class="line"><span class="meta">#</span><span class="bash"> 服务与地址都转到了节点2上</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node3</span><br><span class="line">-------------</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用此节点提供NFS服务</span></span><br><span class="line">[root@webdav ~]# yum install -y nfs-utils nginx</span><br><span class="line">[root@webdav ~]# systemctl start nfs</span><br><span class="line">[root@webdav ~]# mkdir /shared</span><br><span class="line">[root@webdav ~]# vim /shared/index.html</span><br><span class="line">test page</span><br><span class="line">[root@webdav ~]# vim /etc/exports</span><br><span class="line">/shared       192.168.2.0/24(rw,no_root_squash) 192.168.1.0/24(rw)</span><br><span class="line">[root@webdav ~]# exportfs -ra</span><br><span class="line">[root@webdav ~]# showmount -e 192.168.2.128</span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# crm configure</span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> primitive webstore ocf:heartbeat:Filesystem params device=<span class="string">"192.168.2.128:/shared"</span> directory=<span class="string">"/var/www/html"</span> fstype=<span class="string">"nfs"</span> op monitor interval=20s timeout=40s op start timeout=60s op stop timeout=60s</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 定义一个存储资源，提供NFS地址与挂载地址、文件系统类型。最后设置监控。</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> edit</span></span><br><span class="line">group webservice webip webserver webstore</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将资源加入组</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: secondary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Wed Apr  3 04:58:49 2019</span><br><span class="line">Last change: Wed Apr  3 04:57:53 2019 by hacluster via cibadmin on secondary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">3 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary ]</span><br><span class="line">OFFLINE: [ secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> Resource Group: webservice</span><br><span class="line">     webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line">     webserver	(lsb:httpd):	Stopped</span><br><span class="line">     webstore	(ocf::heartbeat:Filesystem):	Stopped</span><br><span class="line"><span class="meta">#</span><span class="bash"> 因为实验不是一起做的，提供NFS服务是第二次接着做，所以忘记上一次为什么资源会停止了，新加入的服务也停止了，使用节点上线与启动资源的命令也没有反应。所以下面准备重新启动服务</span></span><br><span class="line">[root@primary ~]# service corosync status</span><br><span class="line">corosync (pid  46159) is running...</span><br><span class="line">[root@primary ~]# kill -9 46159</span><br><span class="line"><span class="meta">#</span><span class="bash"> 因为停止服务非常 慢，所以使用<span class="built_in">kill</span>杀死服务，两个节点都重新启动服务</span></span><br><span class="line">[root@primary ~]# service corosync start</span><br><span class="line">[root@primary ~]# crm </span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: NONE</span><br><span class="line">Last updated: Wed Apr  3 05:02:40 2019</span><br><span class="line">Last change: Wed Apr  3 04:57:53 2019 by hacluster via cibadmin on secondary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">3 resources configured</span><br><span class="line"></span><br><span class="line">OFFLINE: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> Resource Group: webservice</span><br><span class="line">     webip	(ocf::heartbeat:IPaddr):	Stopped</span><br><span class="line">     webserver	(lsb:httpd):	Stopped</span><br><span class="line">     webstore	(ocf::heartbeat:Filesystem):	Stopped</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动服务后，资源还是停止状态</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> resource start webservice</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Wed Apr  3 05:03:07 2019</span><br><span class="line">Last change: Wed Apr  3 05:03:03 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">3 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> Resource Group: webservice</span><br><span class="line">     webip	(ocf::heartbeat:IPaddr):	Started secondary</span><br><span class="line">     webserver	(lsb:httpd):	Started secondary</span><br><span class="line">     webstore	(ocf::heartbeat:Filesystem):	Started secondary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动资源后正常了</span></span><br><span class="line">访问192.168.2.100，可以看到test page的字样证明成功了。</span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止节点2后，资源无法转移，后发现是在节点1上启动了nginx服务，停止nginx服务后仍然无法启动webserver资源。未找到原因，删除webserver资源重新添加后正常。</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/29/drbd基本配置使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/29/drbd基本配置使用/" itemprop="url">
                  drbd基本配置使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-29 10:57:21" itemprop="dateCreated datePublished" datetime="2019-03-29T10:57:21+08:00">2019-03-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2020-04-17 17:32:07" itemprop="dateModified" datetime="2020-04-17T17:32:07+08:00">2020-04-17</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Cluster/" itemprop="url" rel="index"><span itemprop="name">Cluster</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><blockquote>
<p>DRBD即Distributed Relicated Block Device：分布式磁盘块设备， 可以解决磁盘单点故障。一般情况下只支持两个节点。 </p>
<p>一般情况下文件写入磁盘的步骤是：写操作 –&gt; 文件系统 –&gt; 内存缓存中 –&gt; 磁盘调度器 –&gt; 磁盘驱动器 –&gt; 写入磁盘。而DRBD的工作机制如上图所示，数据经过buffer cache后有内核中的DRBD模块通过tcp/ip协议栈经过网卡和对方建立数据同步。 </p>
</blockquote>
<p><img src="/images/drbd/工作流程.png" alt=""></p>
<h4 id="工作模式"><a href="#工作模式" class="headerlink" title="工作模式"></a>工作模式</h4><blockquote>
<ol>
<li><p>主从模型</p>
<p>master/slave模型，在某一时刻只允许有一个主节点。主节点的作用是可以挂载使用，写入数据等；从节点只作为主节点的镜像，是主节点的备份。 </p>
</li>
<li><p>主主模型</p>
<p>dula primary模型，2个节点都可以当做主节点来挂载使用。需要配合集群文件系统使用，通过分布式文件锁管理器避免同时写一个文件造成文件系统损坏的问题。</p>
</li>
</ol>
</blockquote>
<h4 id="复制模型"><a href="#复制模型" class="headerlink" title="复制模型"></a>复制模型</h4><blockquote>
<ol>
<li>A协议：异步复制（asynchronous），写操作到本机网卡时即认为成功，性能好，数据可靠性差。 </li>
<li>B协议：半同步复制（semi sync），写操作到达备节点网卡即认为成功，数据可靠性介于A和C之间。 </li>
<li>C协议：同步复制（ sync），备用节点写入磁盘即认为成功，性能差，数据可靠性高。也是drbd默认使用的复制协议 </li>
</ol>
</blockquote>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">===========================================================================================</span><br><span class="line">环境：</span><br><span class="line">主机两台，操作系统CentOS6.6，内核2.6.32-504.el6.x86_64。地址：192.168.2.132、192.168.2.133</span><br><span class="line">安装与配置在两个节点上是一样的</span><br><span class="line">===========================================================================================</span><br><span class="line"><span class="meta">#</span><span class="bash"> 两台主机均按如下方法操作</span></span><br><span class="line">[root@primary drbd]# rpm -ivh drbd84-utils-8.9.2-1.el6.elrepo.x86_64.rpm kmod-drbd84-8.4.6-1.el6.elrepo.x86_64.rpm</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装包取自生产环境。drbd84-utils-8.9.1-1.el6.elrepo包提供配置文件与工具，komd-drbd84-8.4.6-504.el6.x86_64.rpm包提供内核模块。注意两个包要一起安装，不然可能不会添加设备</span></span><br><span class="line">[root@template ~]# ls /dev/d</span><br><span class="line">disk/   dm-1    drbd1   drbd11  drbd13  drbd15  drbd3   drbd5   drbd7   drbd9   dvdrw   </span><br><span class="line">dm-0    drbd0   drbd10  drbd12  drbd14  drbd2   drbd4   drbd6   drbd8   dvd</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装软件后可以看到添加了很多以drbd开头的设备</span></span><br><span class="line">[root@primary ~]# fdisk /dev/sdb</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在两个分区上提供大小一致的分区</span></span><br><span class="line">[root@primary ~]# ntpdate ntp1.aliyun.com</span><br><span class="line"><span class="meta">#</span><span class="bash"> 同步时间</span></span><br><span class="line">[root@primary ~]# partprobe /dev/sdb</span><br><span class="line">[root@primary drbd]# vim /etc/sysconfig/network</span><br><span class="line">NETWORKING=yes</span><br><span class="line">HOSTNAME=primary</span><br><span class="line">[root@primary drbd]# hostname primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改主机名</span></span><br><span class="line">[root@primary drbd]# ssh-keygen -t rsa -P ''</span><br><span class="line">[root@primary drbd]# ssh-copy-id -i ~/.ssh/id_rsa.pub 192.168.2.133</span><br><span class="line"><span class="meta">#</span><span class="bash"> 密钥通信</span></span><br><span class="line">[root@primary drbd]# vim /etc/hosts</span><br><span class="line">192.168.2.132 primary</span><br><span class="line">192.168.2.133 secondary</span><br><span class="line">[root@primary drbd]# scp drbd84-utils-8.9.2-1.el6.elrepo.x86_64.rpm kmod-drbd84-8.4.6-1.el6.elrepo.x86_64.rpm secondary:/root</span><br></pre></td></tr></table></figure>
<h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">[root@primary ~]# cd /etc/drbd.d</span><br><span class="line">[root@primary drbd.d]# vim global_common.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 此配置文件提供全局配置，及多个drbd设备相同的配置 </span></span><br><span class="line">global &#123;</span><br><span class="line">	usage-count no;</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否加入改进计划 </span></span><br><span class="line">&#125;</span><br><span class="line">common &#123;</span><br><span class="line">	handlers &#123;</span><br><span class="line">	&#125;</span><br><span class="line">	startup &#123;</span><br><span class="line">	&#125;</span><br><span class="line">	options &#123;</span><br><span class="line">	&#125;</span><br><span class="line">	disk &#123;</span><br><span class="line">		on-io-error detach;</span><br><span class="line"><span class="meta">		#</span><span class="bash"> IO出问题时，就将节点卸载 </span></span><br><span class="line">	&#125;</span><br><span class="line">	net &#123;</span><br><span class="line">		cram-hmac-alg "sha1";</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 使用的算法 </span></span><br><span class="line">		shared-secret "mydrbdshared123";</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 共享密钥，建议用随机数生成 </span></span><br><span class="line">	&#125;</span><br><span class="line">	syncer &#123;</span><br><span class="line">		rate 500M;</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 同步速率</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> glocal：全局属性，定义drbd自己的工作特性。common：通用属性，定义多组drbd设备通用特性 </span></span><br><span class="line"></span><br><span class="line">[root@primary drbd.d]# vim mystore.res</span><br><span class="line"><span class="meta">#</span><span class="bash"> 此文件为自建文件</span></span><br><span class="line">resource mystore &#123;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 首先定义公共配置，这一段可以被下面的多段使用 </span></span><br><span class="line">    device /dev/drdb0;</span><br><span class="line">    # 定义设备</span><br><span class="line">    disk /dev/sdb1;</span><br><span class="line">    # 定义磁盘，定义这两项就让磁盘与设备关联了？</span><br><span class="line">    meta-disk internal;</span><br><span class="line">     # 在自己的dev内部构建使用</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下面定义单个节点的属性 </span></span><br><span class="line">    on primary &#123;</span><br><span class="line">        address 192.168.2.132:7789;</span><br><span class="line">    &#125;</span><br><span class="line">    on secondary &#123;</span><br><span class="line">        address 192.168.2.132:7789;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">[root@primary drbd.d]# drbdadm create-md mystore</span><br><span class="line">initializing activity log</span><br><span class="line">NOT initializing bitmap</span><br><span class="line">Writing meta data...</span><br><span class="line">New drbd meta data block successfully created.</span><br><span class="line"><span class="meta">#</span><span class="bash"> 初始化资源，mystore是资源名，是在mystore.res文件中定义的。在两个节点上分别执行 </span></span><br><span class="line">[root@primary drbd.d]# drbdadm create-md mystore</span><br><span class="line">initializing activity log</span><br><span class="line">NOT initializing bitmap</span><br><span class="line">Writing meta data...</span><br><span class="line">New drbd meta data block successfully created.</span><br><span class="line">[root@primary drbd.d]# service drbd start</span><br><span class="line">Starting DRBD resources: [</span><br><span class="line">     create res: mystore</span><br><span class="line">   prepare disk: mystore</span><br><span class="line">    adjust disk: mystore</span><br><span class="line">     adjust net: mystore</span><br><span class="line">]</span><br><span class="line">....</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动一个节点后，它会等待另一个节点也启动此服务，这时两个节点才会一起启动服务</span></span><br><span class="line">[root@primary drbd.d]# cat /proc/drbd</span><br><span class="line">version: 8.4.6 (api:1/proto:86-101)</span><br><span class="line">GIT-hash: 833d830e0152d1e457fa7856e71e11248ccf3f70 build by phil@Build64R6, 2015-04-09 14:35:00</span><br><span class="line"> 0: cs:Connected ro:Secondary/Secondary ds:Inconsistent/Inconsistent C r-----</span><br><span class="line">    ns:0 nr:0 dw:0 dr:0 al:0 bm:0 lo:0 pe:0 ua:0 ap:0 ep:1 wo:f oos:3140544</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看运行状态，现在两个都是Secondary，没有同步 </span></span><br><span class="line">[root@primary drbd.d]# drbd-overview </span><br><span class="line"> 0:mystore/0  Connected Secondary/Secondary Inconsistent/Inconsistent </span><br><span class="line"><span class="meta"> #</span><span class="bash"> 使用此命令也可以</span></span><br><span class="line"> [root@primary drbd.d]# drbdadm primary --force mystore</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 设置节点1为主节点</span></span><br><span class="line"> [root@primary drbd.d]# cat /proc/drbd </span><br><span class="line">version: 8.4.6 (api:1/proto:86-101)</span><br><span class="line">GIT-hash: 833d830e0152d1e457fa7856e71e11248ccf3f70 build by phil@Build64R6, 2015-04-09 14:35:00</span><br><span class="line"> 0: cs:SyncSource ro:Primary/Secondary ds:UpToDate/Inconsistent C r-----</span><br><span class="line">    ns:1067676 nr:0 dw:0 dr:1069720 al:0 bm:0 lo:0 pe:2 ua:2 ap:0 ep:1 wo:f oos:2074560</span><br><span class="line">	[=====&gt;..............] sync'ed: 34.1% (2074560/3140544)K</span><br><span class="line">	finish: 0:00:52 speed: 39,708 (39,480) K/sec</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 显示同步过程，有两种状态，primary和secondary，主和从，左边为自己的状态右边是对方的状态 </span></span><br><span class="line">[root@primary drbd.d]# cat /proc/drbd </span><br><span class="line">version: 8.4.6 (api:1/proto:86-101)</span><br><span class="line">GIT-hash: 833d830e0152d1e457fa7856e71e11248ccf3f70 build by phil@Build64R6, 2015-04-09 14:35:00</span><br><span class="line"> 0: cs:Connected ro:Primary/Secondary ds:UpToDate/UpToDate C r-----</span><br><span class="line">    ns:3140544 nr:0 dw:0 dr:3141208 al:0 bm:0 lo:0 pe:0 ua:0 ap:0 ep:1 wo:f oos:0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 同步完成，这是状态为Primary/Secondary </span></span><br><span class="line">[root@primary drbd.d]# mke2fs -t ext4 /dev/drbd0</span><br><span class="line">mke2fs 1.41.12 (17-May-2010)</span><br><span class="line">文件系统标签=</span><br><span class="line">操作系统:Linux</span><br><span class="line">块大小=4096 (log=2)</span><br><span class="line">分块大小=4096 (log=2)</span><br><span class="line">Stride=0 blocks, Stripe width=0 blocks</span><br><span class="line">196608 inodes, 785136 blocks</span><br><span class="line">39256 blocks (5.00%) reserved for the super user</span><br><span class="line">第一个数据块=0</span><br><span class="line">Maximum filesystem blocks=805306368</span><br><span class="line">24 block groups</span><br><span class="line">32768 blocks per group, 32768 fragments per group</span><br><span class="line">8192 inodes per group</span><br><span class="line">Superblock backups stored on blocks: </span><br><span class="line">	32768, 98304, 163840, 229376, 294912</span><br><span class="line"></span><br><span class="line">正在写入inode表: 完成                            </span><br><span class="line">Creating journal (16384 blocks): 完成</span><br><span class="line">Writing superblocks and filesystem accounting information: 完成</span><br><span class="line"></span><br><span class="line">This filesystem will be automatically checked every 26 mounts or</span><br><span class="line">180 days, whichever comes first.  Use tune2fs -c or -i to override.</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在主节点格式化磁盘，从节点也会自动格式化，因为是按位同步的</span></span><br></pre></td></tr></table></figure>
<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">=========</span><br><span class="line">    node1   </span><br><span class="line">=========</span><br><span class="line">[root@primary drbd.d]# mount /dev/drbd0 /mnt</span><br><span class="line">[root@primary drbd.d]# ls /mnt</span><br><span class="line">lost+found</span><br><span class="line">[root@primary drbd.d]# cd /mnt</span><br><span class="line">[root@primary mnt]# cp /etc/issue ./</span><br><span class="line">[root@primary mnt]# ls</span><br><span class="line">issue  lost+found</span><br><span class="line">[root@primary mnt]# cd</span><br><span class="line">[root@primary ~]# umount /mnt</span><br><span class="line">[root@primary ~]# drbdadm secondary mystore</span><br><span class="line"><span class="meta">#</span><span class="bash"> 把自己切换为从节点</span></span><br><span class="line">[root@primary ~]# cat /proc/drbd</span><br><span class="line">version: 8.4.6 (api:1/proto:86-101)</span><br><span class="line">GIT-hash: 833d830e0152d1e457fa7856e71e11248ccf3f70 build by phil@Build64R6, 2015-04-09 14:35:00</span><br><span class="line"> 0: cs:Connected ro:Secondary/Secondary ds:UpToDate/UpToDate C r-----</span><br><span class="line">    ns:3256316 nr:0 dw:115772 dr:3141925 al:31 bm:0 lo:0 pe:0 ua:0 ap:0 ep:1 wo:f oos:0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 状态都是从节点</span></span><br><span class="line"></span><br><span class="line">=========</span><br><span class="line">    node2    </span><br><span class="line">=========</span><br><span class="line">[root@secondary drbd.d]# drbdadm primary mystore</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在哪个节点执行此命令就是切换哪个节点的状态，这里将备用节点切换为主节点</span></span><br><span class="line">[root@secondary drbd.d]# cat /proc/drbd</span><br><span class="line">version: 8.4.6 (api:1/proto:86-101)</span><br><span class="line">GIT-hash: 833d830e0152d1e457fa7856e71e11248ccf3f70 build by phil@Build64R6, 2015-04-09 14:35:00</span><br><span class="line"> 0: cs:Connected ro:Primary/Secondary ds:UpToDate/UpToDate C r-----</span><br><span class="line">    ns:0 nr:3256316 dw:3256316 dr:664 al:0 bm:0 lo:0 pe:0 ua:0 ap:0 ep:1 wo:f oos:0</span><br><span class="line">[root@secondary drbd.d]# mount /dev/drbd0 /mnt</span><br><span class="line">[root@secondary drbd.d]# ls /mnt</span><br><span class="line">issue  lost+found</span><br><span class="line">[root@secondary drbd.d]# vim /mnt/issue</span><br><span class="line">abcabc</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入一些内容</span></span><br><span class="line">[root@secondary drbd.d]# umount /mnt</span><br><span class="line">[root@secondary drbd.d]# drbdadm secondary mystore</span><br><span class="line"><span class="meta">#</span><span class="bash"> 一定要切换状态，备用状态是不能被挂载</span></span><br><span class="line"></span><br><span class="line">=========</span><br><span class="line">    node1   </span><br><span class="line">=========</span><br><span class="line">[root@primary ~]# mount /dev/drbd0 /mnt</span><br><span class="line">mount: you must specify the filesystem type</span><br><span class="line"><span class="meta">#</span><span class="bash"> 备用状态是不能被挂载的</span></span><br><span class="line">[root@primary ~]# drbdadm primary mystore</span><br><span class="line">[root@primary ~]# mount /dev/drbd0 /mnt</span><br><span class="line">[root@primary ~]# cat /mnt/issue </span><br><span class="line">CentOS release 6.6 (Final)</span><br><span class="line">Kernel \r on an \m</span><br><span class="line"></span><br><span class="line">abcabc</span><br><span class="line"><span class="meta">#</span><span class="bash"> 内容也被改变了</span></span><br><span class="line">[root@primary ~]# service drbd status</span><br><span class="line">drbd driver loaded OK; device status:</span><br><span class="line">version: 8.4.6 (api:1/proto:86-101)</span><br><span class="line">GIT-hash: 833d830e0152d1e457fa7856e71e11248ccf3f70 build by phil@Build64R6, 2015-04-09 14:35:00</span><br><span class="line">m:res      cs         ro                 ds                 p  mounted  fstype</span><br><span class="line">0:mystore  Connected  Primary/Secondary  UpToDate/UpToDate  C  /mnt     ext4</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看状态，UpToDate/UpToDate 表示已经同步</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/26/python基础学习-语句/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/26/python基础学习-语句/" itemprop="url">
                  python基础学习-语句
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-26 16:34:05" itemprop="dateCreated datePublished" datetime="2019-03-26T16:34:05+08:00">2019-03-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2020-05-18 09:43:20" itemprop="dateModified" datetime="2020-05-18T09:43:20+08:00">2020-05-18</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="print"><a href="#print" class="headerlink" title="print"></a>print</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'Age:'</span>, <span class="number">42</span>)</span><br><span class="line">Age: <span class="number">42</span></span><br><span class="line"><span class="comment"># 可同时打印多个表达式，条件是用逗号分隔它们</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">'Gumby'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>salutation = <span class="string">'Mr.'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>greeting = <span class="string">'Hello,'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(greeting, salutation, name)</span><br><span class="line">Hello, Mr. Gumby</span><br><span class="line"></span><br><span class="line">print(greeting + <span class="string">','</span>, salutation, name)</span><br><span class="line"><span class="comment"># 如果字符串变量greeting不包含逗号，可使用此方法添加，记得一定要有加号，不然会在greeting与逗号间加入一个空格</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"I"</span>, <span class="string">"wish"</span>, <span class="string">"to"</span>, <span class="string">"register"</span>, <span class="string">"a"</span>, <span class="string">"complaint"</span>, sep=<span class="string">"_"</span>)</span><br><span class="line">I_wish_to_register_a_complaint</span><br><span class="line"><span class="comment"># 自定义分隔符</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'Hello,'</span>, end=<span class="string">''</span>)</span><br><span class="line">print(<span class="string">'world!'</span>)</span><br><span class="line">Hello,world!</span><br><span class="line"><span class="comment"># 还可自定义结束字符串，以替换默认的换行符。上面将结束字符串指定为空字符串，所以Hello和world会打印在一行。</span></span><br></pre></td></tr></table></figure>
<h3 id="import"><a href="#import" class="headerlink" title="import"></a>import</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> somemodule</span><br><span class="line"><span class="keyword">from</span> somemodule <span class="keyword">import</span> somefunction</span><br><span class="line"><span class="keyword">from</span> somemodule <span class="keyword">import</span> somefunction, anotherfunction, yetanotherfunction</span><br><span class="line"><span class="keyword">from</span> somemodule <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># 从模块导入。仅当你确定要导入模块中的一切时，采用使用最后一种方式</span></span><br><span class="line"></span><br><span class="line">module1.open(...)</span><br><span class="line">module2.open(...)</span><br><span class="line"><span class="comment"># 有两个模块，它们都包含函数open，可使用import somemodule方式导入这两个模块，使用此种方式调用open函数</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math <span class="keyword">as</span> foobar</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foobar.sqrt(<span class="number">4</span>)</span><br><span class="line"><span class="number">2.0</span></span><br><span class="line"><span class="comment"># 导入整个模块并在语句末尾添加as子句指定别名。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> math <span class="keyword">import</span> sqrt <span class="keyword">as</span> foobar</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foobar(<span class="number">4</span>)</span><br><span class="line"><span class="number">2.0</span></span><br><span class="line"><span class="comment"># 导入特定函数并给它指定别名，这是给sqrt起的别名叫foobar</span></span><br></pre></td></tr></table></figure>
<h3 id="赋值"><a href="#赋值" class="headerlink" title="赋值"></a>赋值</h3><h4 id="序列解包"><a href="#序列解包" class="headerlink" title="序列解包"></a>序列解包</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x, y, z = <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(x, y, z)</span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="comment"># 同时(并行)给多个变量赋值</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x, y = y, x</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(x, y, z)</span><br><span class="line"><span class="number">2</span> <span class="number">1</span> <span class="number">3</span></span><br><span class="line"><span class="comment"># 这种方式还可交换多个变量的值</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>values = <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>values</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x, y, z = values</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="comment"># 这里执行的操作称为序列解包(或可迭代对象解包)：将一个序列(或任何可迭代对象)解包，并将得到的值存储到一系列变量中。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>scoundrel = &#123;<span class="string">'name'</span>: <span class="string">'Robin'</span>, <span class="string">'girlfriend'</span>: <span class="string">'Marion'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>key, value = scoundrel.popitem()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>key</span><br><span class="line"><span class="string">'girlfriend'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>value</span><br><span class="line"><span class="string">'Marion'</span></span><br><span class="line"><span class="comment"># 从字典中随便获取(或删除)一个键值对，可使用popitem方法，它随便获取一个键值对并以元组的方式返回。接下来，可直接将返回的元组解包到两个变量中。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x, y, z = <span class="number">1</span>, <span class="number">2</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ValueError: need more than <span class="number">2</span> values to unpack</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x, y, z = <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ValueError: too many values to unpack</span><br><span class="line"><span class="comment"># 要解包的序列包含的元素个数必须与你在等号左边列出的目标个数相同</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a, b, *rest = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rest</span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="comment"># 可使用星号运算符(*)来收集多余的值，这样无需确保值和变量的个数相同</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">"Albus Percival Wulfric Brian Dumbledore"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>first, *middle, last = name.split()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>middle</span><br><span class="line">[<span class="string">'Percival'</span>, <span class="string">'Wulfric'</span>, <span class="string">'Brian'</span>]</span><br><span class="line"><span class="comment"># 还可将带星号的变量放在其他位置。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a, *b, c = <span class="string">"abc"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a, b, c</span><br><span class="line">(<span class="string">'a'</span>, [<span class="string">'b'</span>], <span class="string">'c'</span>)</span><br><span class="line"><span class="comment"># 赋值语句的右边可以是任何类型的序列，但带星号的变量最终包含的总是一个列表。</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/26/python基础学习-字典/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/26/python基础学习-字典/" itemprop="url">
                  python基础学习-字典
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-26 09:36:23" itemprop="dateCreated datePublished" datetime="2019-03-26T09:36:23+08:00">2019-03-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2020-05-15 16:45:50" itemprop="dateModified" datetime="2020-05-15T16:45:50+08:00">2020-05-15</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>字典，也称映射(mapping)是一种可通过名称来访问其各个值的数据结构。字典是Python中唯一的内置映射类型，其中的值不按顺序排列，而是存储在键下。键可能是数、字符串或元组。字典是key-value键值对的数据的集合，它是可变的、无序的、key不重复。字典中的item指的就是kv对</p>
<p>字典(日常生活中的字典和Python字典)旨在让你能够轻松地找到特定的单词(键)，以获悉其定义(值) 。</p>
<p>Python字典的用途：</p>
<ul>
<li><p>表示棋盘的状态，其中每个键都是由坐标组成的元组；</p>
</li>
<li><p>存储文件修改时间，其中的键为文件名；</p>
</li>
<li><p>数字电话/地址簿。</p>
</li>
<li>不要用值来找，要用key来找。如果需要用值来找就不要用此种方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>names = [<span class="string">'Alice'</span>, <span class="string">'Beth'</span>, <span class="string">'Cecil'</span>, <span class="string">'Dee-Dee'</span>, <span class="string">'Earl'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers = [<span class="string">'2341'</span>, <span class="string">'9102'</span>, <span class="string">'3158'</span>, <span class="string">'0142'</span>, <span class="string">'5551'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[names.index(<span class="string">'Cecil'</span>)]</span><br><span class="line"><span class="string">'3158'</span></span><br><span class="line"><span class="comment"># 这可行，但不太实用。</span></span><br></pre></td></tr></table></figure>
<h3 id="基本的字典操作"><a href="#基本的字典操作" class="headerlink" title="基本的字典操作"></a>基本的字典操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">len(d)</span><br><span class="line"><span class="comment"># 返回字典d包含的项(键值对)数。</span></span><br><span class="line">d[k]</span><br><span class="line"><span class="comment"># 返回与键k相关联的值。</span></span><br><span class="line">d[k] = v</span><br><span class="line"><span class="comment"># 将值v关联到键k。</span></span><br><span class="line"><span class="keyword">del</span> d[k]</span><br><span class="line"><span class="comment"># 删除键为k的项。</span></span><br><span class="line">k <span class="keyword">in</span> d</span><br><span class="line"><span class="comment"># 检查字典d 是否包含键为k的项。</span></span><br></pre></td></tr></table></figure>
<h3 id="字典dict定义，初始化"><a href="#字典dict定义，初始化" class="headerlink" title="字典dict定义，初始化"></a>字典dict定义，初始化</h3><ul>
<li>d = dict()   或者   d = {}</li>
<li>dict(**kwargs)   使用name = value对初始化一个字典</li>
<li>dict(iterable,**kwarg) 使用可迭代对象和name = value对构造字典，不过可迭代对象的元素必须是一个二元结构<ul>
<li>d = dict(((1,’a’),(2,’b’))) 或者 d = dict(([1,’a’],[2,’b’]))</li>
</ul>
</li>
<li>dict(mapping,**kwarg) 使用一个字典构建另一个字典</li>
<li>d = {‘a’:10,’b’:20,’c’:None,’d’:[1,2,3]}</li>
<li><p>类方法 dict.fromkeys(iterable,value)</p>
<ul>
<li>d = dict.fromkeys(range(5))</li>
<li>d = dict.fromkeys(range(5),0)</li>
</ul>
</li>
<li><p>键的类型：字典中的键可以是整数，但并非必须是整数。字典中的键可以是任何不可变的类型，如浮点数(实数) 、字符串或元组。</p>
</li>
<li>自动添加：即便是字典中原本没有的键，也可以给它赋值，这将在字典中创建一个新项。然而，如果不使用append或其他类似的方法，就不能给列表中没有的元素赋值。</li>
<li>成员资格：表达式k in d(其中d 是一个字典)查找的是键而不是值，而表达式v in l(其中l是一个列表)查找的是值而不是索引。这看似不太一致，但你习惯后就会觉得相当自然。毕竟如果字典包含指定的键，检查相应的值就很容易。</li>
</ul>
<p>相比于检查列表是否包含指定的值，检查字典是否包含指定的键的效率更高。数据结构越大，效率差距就越大。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建与使用</span></span><br><span class="line">phonebook = &#123;<span class="string">'Alice'</span>: <span class="string">'2341'</span>, <span class="string">'Beth'</span>: <span class="string">'9102'</span>, <span class="string">'Cecil'</span>: <span class="string">'3258'</span>&#125;</span><br><span class="line"><span class="comment"># 字典由键及其相应的值组成，这种键值对称为项(item)。这里键为名字，而值为电话号码。每个键与其值之间都用</span></span><br><span class="line"><span class="comment"># 冒号(:)分隔，项之间用逗号分隔，而整个字典放在花括号内。空字典(没有任何项)用两个花括号表示。在字典(以</span></span><br><span class="line"><span class="comment"># 及其他映射类型)中，键必须是独一无二的，而字典中的值无需如此。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建字典</span></span><br><span class="line">l1 = list(range(<span class="number">5</span>))</span><br><span class="line">d = dict(l1)</span><br><span class="line"><span class="comment"># 这样是不行是，因为l1里都是单值，字典需要两个值。提示：TypeError: cannot convert dictionary update sequence element #0 to a sequence</span></span><br><span class="line"></span><br><span class="line">d = dict(enumerate(l1))</span><br><span class="line"><span class="comment"># enumerate是给值加上索引的，这样也就是两个值了。</span></span><br><span class="line"></span><br><span class="line">e = enumerate(l1)</span><br><span class="line">print(type(e))</span><br><span class="line"><span class="comment"># e的类型枚举，是一个可迭代对象，可以使用list、set、tuple来包括这个类型，用什么方法包括这个类型，这个</span></span><br><span class="line"><span class="comment"># 类型就生成什么数据类型。也就是封装成什么就返回什么类型</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> e:</span><br><span class="line">    print(x)</span><br><span class="line"><span class="comment"># 返回的是二元组，在python命令行中执行要使用Ctrl + 回车</span></span><br><span class="line"></span><br><span class="line">d = dict(e)</span><br><span class="line">print(d)</span><br><span class="line"><span class="comment"># enumerate类似生成器的东西，走到头就不会再走了，所以d返回的是&#123;&#125;。</span></span><br><span class="line"></span><br><span class="line">e = enumerate(l1)</span><br><span class="line">d = dict(e)</span><br><span class="line">print(d)</span><br><span class="line"><span class="comment"># 这样就生成了一个字典</span></span><br><span class="line"></span><br><span class="line">d = &#123;(<span class="string">'a'</span>,<span class="number">1</span>)&#125;</span><br><span class="line">print(d)</span><br><span class="line"><span class="comment"># 这样是不可以的，因为结果不是key:value</span></span><br><span class="line">c = dict(((<span class="number">1</span>,<span class="string">'a'</span>),))</span><br><span class="line">print(c)</span><br><span class="line"><span class="comment"># 需要使用这种方式，dict中是一个元组，一般不用这种方式。((1,'a'),)表示一个元组，因为字典需要两个值，所以定</span></span><br><span class="line"><span class="comment"># 义成(1,'a')</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用dict函数创建</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>items = [(<span class="string">'name'</span>, <span class="string">'Gumby'</span>), (<span class="string">'age'</span>, <span class="number">42</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = dict(items)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="number">42</span>, <span class="string">'name'</span>: <span class="string">'Gumby'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'name'</span>]</span><br><span class="line"><span class="string">'Gumby'</span></span><br><span class="line"><span class="comment"># 使用函数dict从其他映射(如其他字典)或键值对序列创建字典。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = dict(name=<span class="string">'Gumby'</span>, age=<span class="number">42</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="number">42</span>, <span class="string">'name'</span>: <span class="string">'Gumby'</span>&#125;</span><br><span class="line"><span class="comment"># 使用关键字实参来调用这个函数</span></span><br><span class="line"><span class="comment"># 也可使用一个映射实参来调用它，这将创建一个字典，其中包含指定映射中的所有项。像函数list、tuple和str一</span></span><br><span class="line"><span class="comment"># 样，如果调用这个函数时没有提供任何实参，将返回一个空字典。从映射创建字典时，如果该映射也是字典(毕竟字</span></span><br><span class="line"><span class="comment"># 典是Python中唯一的内置映射类型)，可不使用函数dict，而是使用字典方法copy。与list、tuple和str一样，</span></span><br><span class="line"><span class="comment"># dict其实根本就不是函数，而是一个类。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = []</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">42</span>] = <span class="string">'Foobar'</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File "&lt;stdin&gt;", line 1, in ?</span><br><span class="line">IndexError: list assignment index out of range</span><br><span class="line"><span class="comment"># 将字符串'Foobar'赋给一个空列表中索引为42的元素。这是不可以的，因为没有这样的元素。要让这种操作可行，</span></span><br><span class="line"><span class="comment"># 初始化x时，必须使用[None] * 43之类的代码，而不能使用[]。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">42</span>] = <span class="string">'Foobar'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">&#123;<span class="number">42</span>: <span class="string">'Foobar'</span>&#125;</span><br><span class="line"><span class="comment"># 将'Foobar'赋给一个空字典的键42，这样做一点问题都没有</span></span><br><span class="line"></span><br><span class="line">people = &#123;</span><br><span class="line">    <span class="string">'Alice'</span>: &#123;</span><br><span class="line">            <span class="string">'phone'</span>: <span class="string">'2341'</span>,</span><br><span class="line">            <span class="string">'addr'</span>: <span class="string">'Foo drive 23'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'Beth'</span>: &#123;</span><br><span class="line">            <span class="string">'phone'</span>: <span class="string">'9102'</span>,</span><br><span class="line">            <span class="string">'addr'</span>: <span class="string">'Bar street 42'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'Cecil'</span>: &#123;</span><br><span class="line">            <span class="string">'phone'</span>: <span class="string">'3158'</span>,</span><br><span class="line">            <span class="string">'addr'</span>: <span class="string">'Baz avenue 90'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 一个将人名用作键的字典。每个人都用一个字典表示，字典包含键'phone'和'addr'，它们分别与电</span></span><br><span class="line"><span class="comment"># 话号码和地址相关联</span></span><br><span class="line"></span><br><span class="line">labels = &#123;</span><br><span class="line"><span class="string">'phone'</span>: <span class="string">'phone number'</span>,</span><br><span class="line"><span class="string">'addr'</span>: <span class="string">'address'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 电话号码和地址的描述性标签，供打印输出时使用</span></span><br><span class="line"></span><br><span class="line">name = input(<span class="string">'Name: '</span>)</span><br><span class="line"></span><br><span class="line">request = input(<span class="string">'Phone number (p) or address (a)? '</span>)</span><br><span class="line"><span class="comment"># 要查找电话号码还是地址?</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> request == <span class="string">'p'</span>: key = <span class="string">'phone'</span></span><br><span class="line"><span class="keyword">if</span> request == <span class="string">'a'</span>: key = <span class="string">'addr'</span></span><br><span class="line"><span class="comment"># 判断输入的是电话还是地址，如果是电话，key='phone'；如果是地址，key = 'addr'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> name <span class="keyword">in</span> people: print(<span class="string">"&#123;&#125;'s &#123;&#125; is &#123;&#125;."</span>.format(name, labels[key], people[name][key]))</span><br><span class="line"><span class="comment"># 仅当名字是字典包含的键时才打印信息，打印的格式为某人的电话或地址是什么，format指定三个值</span></span><br><span class="line"><span class="comment"># 对应前面的三个中括号，第一个值是用户输入的name；第二个值是key，key可以是phone或addr，</span></span><br><span class="line"><span class="comment"># 在labels字典中查找对应的电话号码或地址；第三个值是使用name和key的值在people字典中查找</span></span><br><span class="line"><span class="comment"># 对应的值。</span></span><br><span class="line">这个程序的运行情况类似于下面这样:</span><br><span class="line">Name: Beth</span><br><span class="line">Phone number (p) or address (a)? p</span><br><span class="line">Beth<span class="string">'s phone number is 9102.</span></span><br></pre></td></tr></table></figure>
<h3 id="类与函数调用"><a href="#类与函数调用" class="headerlink" title="类与函数调用"></a>类与函数调用</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">l1 = list()</span><br><span class="line">print(l1)</span><br><span class="line"><span class="comment"># 上面定义了l1是一个空列表</span></span><br><span class="line"></span><br><span class="line">a = list</span><br><span class="line">l2 = a</span><br><span class="line">type(l2)</span><br><span class="line"><span class="comment"># 这样定义后，l2是一个类而不是列表。因为定义了a等于list类</span></span><br><span class="line"></span><br><span class="line">l3 = a()</span><br><span class="line">print(l3)</span><br><span class="line"><span class="comment"># l3被定义成了一个空列表，因为a等于list，所以这里l3 = a()就等于l3 = list()</span></span><br><span class="line"><span class="comment"># a = list就是a把list的名称拿走了，等于把名称对应的地址拿走了</span></span><br><span class="line"><span class="comment"># 函数也是一个对象，对象在内存中有一个地方放。这个地方就是函数的地址。列表放在内存中是一个对象，比如创建</span></span><br><span class="line"><span class="comment"># 一个空列表，这是一个对象，我们把空列表赋值给了l3，l3拿的就是这个空列表对象的地址。现在我们给出一个函数</span></span><br><span class="line"><span class="comment"># list，函数本身也是对象，一切皆对象。我们把这个对象给了a，就是把a覆盖掉了，这是把对象地址或叫对象引用</span></span><br><span class="line"><span class="comment"># 给了a，这时a与list也就是等价的了。如果写成list()就是调用了，只要加了括号就是调用了。也就是说，</span></span><br><span class="line"><span class="comment"># a = list是将对象地址给了a，a与list等价。a = list()是调用，将调用list函数的结果给了a，a被定义成了一个空列表</span></span><br><span class="line"></span><br><span class="line">l4 = <span class="number">5</span>()</span><br><span class="line"><span class="comment"># 这样定义会提示"TypeError: 'int' object is not callable"，这说明int类型是不可以调用的。这就说明</span></span><br><span class="line"><span class="comment"># 了加括号是可以调用前面的对象或名称的，但前面的对象或名称需要是可调用的对象。list是一个写好的函数，这个</span></span><br><span class="line"><span class="comment"># 函数已经被当前环境加载过了，所以这个名称可以直接拿来用，这个名称指代的是list名称加载到内存中的位置，这</span></span><br><span class="line"><span class="comment"># 就是引用类型。真正的引用并不是我们写一个列表，把列表赋值给变量，这才是对它的引用，实际这个函数也是对</span></span><br><span class="line"><span class="comment"># 象，它也在内存中，你要引用它，也要通过它的名称才能引用，一加括号意义就变了，这个对象如果是可调用对象的</span></span><br><span class="line"><span class="comment"># 话，我们就调用它了。如果函数是一个可调用对象，调用时就会执行函数里的函数体了。之后的类也可以变成一个可</span></span><br><span class="line"><span class="comment"># 调用对象，比如把一个类实例化了，它就变成一个对象，这个对象后面也可以加括号，这就是python的技巧</span></span><br></pre></td></tr></table></figure>
<h3 id="字典元素的访问"><a href="#字典元素的访问" class="headerlink" title="字典元素的访问"></a>字典元素的访问</h3><ul>
<li>d[key]<ul>
<li>返回key对应的值value</li>
<li>key不存在抛出KeyError异常</li>
</ul>
</li>
<li>get(key[,default])<ul>
<li>返回key对应的值value</li>
<li>get方法不会抛异常，如果key不存在，返回缺省值，如果没有设置缺省值就返回None。如果存在，就显示其值。</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法get为访问字典项提供了宽松的环境。通常，如果你试图访问字典中没有的项，将引发错误。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(d[<span class="string">'name'</span>])</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File "&lt;stdin&gt;", line 1, in ?</span><br><span class="line">KeyError: <span class="string">'name'</span></span><br><span class="line"><span class="comment"># 访问没有的项，报错。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(d.get(<span class="string">'name'</span>))</span><br><span class="line"><span class="keyword">None</span></span><br><span class="line"><span class="comment"># 使用get方法访问没有的项，不会报错。而是返回None。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.get(<span class="string">'name'</span>, <span class="string">'N/A'</span>)</span><br><span class="line"><span class="string">'N/A'</span></span><br><span class="line"><span class="comment"># 可指定“默认”值，这样将返回你指定的值而不是None。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'name'</span>] = <span class="string">'Eric'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.get(<span class="string">'name'</span>)</span><br><span class="line"><span class="string">'Eric'</span></span><br><span class="line"><span class="comment"># 如果字典包含指定的键，get的作用将与普通字典查找相同。</span></span><br><span class="line"></span><br><span class="line">people = &#123;</span><br><span class="line">    <span class="string">'Alice'</span>: &#123;</span><br><span class="line">            <span class="string">'phone'</span>: <span class="string">'2341'</span>,</span><br><span class="line">            <span class="string">'addr'</span>: <span class="string">'Foo drive 23'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'Beth'</span>: &#123;</span><br><span class="line">            <span class="string">'phone'</span>: <span class="string">'9102'</span>,</span><br><span class="line">            <span class="string">'addr'</span>: <span class="string">'Bar street 42'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'Cecil'</span>: &#123;</span><br><span class="line">            <span class="string">'phone'</span>: <span class="string">'3158'</span>,</span><br><span class="line">            <span class="string">'addr'</span>: <span class="string">'Baz avenue 90'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">labels = &#123;</span><br><span class="line"><span class="string">'phone'</span>: <span class="string">'phone number'</span>,</span><br><span class="line"><span class="string">'addr'</span>: <span class="string">'address'</span></span><br><span class="line">&#125;</span><br><span class="line">name = input(<span class="string">'Name: '</span>)</span><br><span class="line"></span><br><span class="line">request = input(<span class="string">'Phone number (p) or address (a)? '</span>)</span><br><span class="line"></span><br><span class="line">key = request </span><br><span class="line"><span class="keyword">if</span> request == <span class="string">'p'</span>: key = <span class="string">'phone'</span></span><br><span class="line"><span class="keyword">if</span> request == <span class="string">'a'</span>: key = <span class="string">'addr'</span></span><br><span class="line"></span><br><span class="line">person = people.get(name, &#123;&#125;)</span><br><span class="line">label = labels.get(key, key)</span><br><span class="line">result = person.get(key, <span class="string">'not available'</span>)</span><br><span class="line">print(<span class="string">"&#123;&#125;'s &#123;&#125; is &#123;&#125;."</span>.format(name, label, result))</span><br><span class="line"><span class="comment"># 使用了方法get来访问“数据库”条目</span></span><br><span class="line">下面是这个程序的运行情况。</span><br><span class="line">Name: Gumby</span><br><span class="line">Phone number (p) or address (a)? batting average</span><br><span class="line">Gumby<span class="string">'s batting average is not available.</span></span><br></pre></td></tr></table></figure>
<ul>
<li>setdefault(key[,default])<ul>
<li>返回key对应的值value</li>
<li>key不存在，添加kv对，value为default，并返回default，如果default没有设置，缺省为None</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法setdefault有点像get，因为它也获取与指定键相关联的值，但除此之外，setdefault还在字典不包含指定的键时，在字典中添加指定的键值对。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.setdefault(<span class="string">'name'</span>, <span class="string">'N/A'</span>)</span><br><span class="line"><span class="string">'N/A'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'name'</span>: <span class="string">'N/A'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'name'</span>] = <span class="string">'Gumby'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.setdefault(<span class="string">'name'</span>, <span class="string">'N/A'</span>)  </span><br><span class="line"><span class="comment"># 这里不加'N/A'也可以，N/A是默认值，如果name没有对应值就返回此值</span></span><br><span class="line"><span class="string">'Gumby'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'name'</span>: <span class="string">'Gumby'</span>&#125;</span><br><span class="line"><span class="comment"># 指定的键不存在时， setdefault返回指定的值并相应地更新字典。如果指定的键存在，就返回其值，并保持字典</span></span><br><span class="line"><span class="comment"># 不变。与get一样，值是可选的；如果没有指定，默认为None。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(d.setdefault(<span class="string">'name'</span>))</span><br><span class="line"><span class="keyword">None</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'name'</span>: <span class="keyword">None</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="字典增加和修改"><a href="#字典增加和修改" class="headerlink" title="字典增加和修改"></a>字典增加和修改</h3><ul>
<li>d[key] = value<ul>
<li>将key对应的值修改为value</li>
<li><strong>key不存在添加新的kv对</strong></li>
</ul>
</li>
<li>update([other]) -&gt; None<ul>
<li>使用另一个字典的kv对更新本字典</li>
<li>key不存在，就添加</li>
<li>key存在，覆盖已经存在的key对应的值</li>
<li>就地修改<ul>
<li>d.update(red=1)</li>
<li>d.update(((‘red’,2),))</li>
<li>d.update({‘red’:3})</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法update使用一个字典中的项来更新另一个字典。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;</span><br><span class="line"><span class="meta">... </span><span class="string">'title'</span>: <span class="string">'Python Web Site'</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">'url'</span>: <span class="string">'http://www.python.org'</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">'changed'</span>: <span class="string">'Mar 14 22:09:15 MET 2016'</span></span><br><span class="line"><span class="meta">... </span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;<span class="string">'title'</span>: <span class="string">'Python Language Website'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.update(x)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'url'</span>: <span class="string">'http://www.python.org'</span>, <span class="string">'changed'</span>:</span><br><span class="line"><span class="string">'Mar 14 22:09:15 MET 2016'</span>, <span class="string">'title'</span>: <span class="string">'Python Language Website'</span>&#125;</span><br><span class="line"><span class="comment"># 对于通过参数提供的字典，将其项添加到当前字典中。如果当前字典包含键相同的项，就替换它。</span></span><br></pre></td></tr></table></figure>
<ul>
<li>copy（返回一个新字典）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法copy返回一个新字典，其包含的键值对与原来的字典相同(这个方法执行的是浅复制，因为值本身是原件，而非副本)。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;<span class="string">'username'</span>: <span class="string">'admin'</span>, <span class="string">'machines'</span>: [<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>]&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = x.copy()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y[<span class="string">'username'</span>] = <span class="string">'mlh'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y[<span class="string">'machines'</span>].remove(<span class="string">'bar'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">&#123;<span class="string">'username'</span>: <span class="string">'mlh'</span>, <span class="string">'machines'</span>: [<span class="string">'foo'</span>, <span class="string">'baz'</span>]&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">&#123;<span class="string">'username'</span>: <span class="string">'admin'</span>, <span class="string">'machines'</span>: [<span class="string">'foo'</span>, <span class="string">'baz'</span>]&#125;</span><br><span class="line"><span class="comment"># 当替换副本中的值时，原件不受影响。然而，如果修改副本中的值(就地修改而不是替换)，原件也将发生变化，因为</span></span><br><span class="line"><span class="comment"># 原件指向的也是被修改的值</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'names'</span>] = [<span class="string">'Alfred'</span>, <span class="string">'Bertrand'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = d.copy()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dc = deepcopy(d)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'names'</span>].append(<span class="string">'Clive'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c</span><br><span class="line">&#123;<span class="string">'names'</span>: [<span class="string">'Alfred'</span>, <span class="string">'Bertrand'</span>, <span class="string">'Clive'</span>]&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dc</span><br><span class="line">&#123;<span class="string">'names'</span>: [<span class="string">'Alfred'</span>, <span class="string">'Bertrand'</span>]&#125;</span><br><span class="line"><span class="comment"># 深复制，即同时复制值及其包含的所有值，等等。为此，可使用模块copy中的函数deepcopy。c和dc的值都是从d</span></span><br><span class="line"><span class="comment"># 复制过来的，只是c是浅复制，dc是深复制，在d中追加值后，c的值也有变化，dc没有。</span></span><br></pre></td></tr></table></figure>
<ul>
<li>fromkeys（创建新字典）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># fromkeys创建一个新字典，其中包含指定的键，且每个键对应的值都是None。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;&#125;.fromkeys([<span class="string">'name'</span>, <span class="string">'age'</span>])</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="keyword">None</span>, <span class="string">'name'</span>: <span class="keyword">None</span>&#125;</span><br><span class="line"><span class="comment"># 首先创建了一个空字典，再对其调用方法fromkeys来创建另一个字典，这显得有点多余。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dict.fromkeys([<span class="string">'name'</span>, <span class="string">'age'</span>])</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="keyword">None</span>, <span class="string">'name'</span>: <span class="keyword">None</span>&#125;</span><br><span class="line"><span class="comment"># 直接对dict调用方法fromkeys。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dict.fromkeys([<span class="string">'name'</span>, <span class="string">'age'</span>], <span class="string">'(unknown)'</span>)</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="string">'(unknown)'</span>, <span class="string">'name'</span>: <span class="string">'(unknown)'</span>&#125;</span><br><span class="line"><span class="comment"># 不使用默认值None，可提供特定的值。</span></span><br></pre></td></tr></table></figure>
<h3 id="字典删除"><a href="#字典删除" class="headerlink" title="字典删除"></a>字典删除</h3><ul>
<li><p>pop(key[,default])</p>
<ul>
<li>key存在，移除它，并返回它的value</li>
<li>key不存在，返回给定的default</li>
<li>default未设置，key不存在则抛出KeyError异常</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法pop可用于获取与指定键相关联的值，并将该键值对从字典中删除。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">'x'</span>: <span class="number">1</span>, <span class="string">'y'</span>: <span class="number">2</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.pop(<span class="string">'x'</span>)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'y'</span>: <span class="number">2</span>&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>popitem()</p>
<ul>
<li>移除并返回一个任意的键值对</li>
<li>字典为empty，抛出KeyError异常</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法popitem类似于list.pop ，但 list.pop弹出列表中的最后一个元素，而popitem随机地弹出一个字典项，</span></span><br><span class="line"><span class="comment"># 因为字典项的顺序是不确定的，没有“最后一个元素”的概念。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">'url'</span>: <span class="string">'http://www.python.org'</span>, <span class="string">'spam'</span>: <span class="number">0</span>, <span class="string">'title'</span>: <span class="string">'Python Web Site'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.popitem()</span><br><span class="line">(<span class="string">'url'</span>, <span class="string">'http://www.python.org'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'spam'</span>: <span class="number">0</span>, <span class="string">'title'</span>: <span class="string">'Python Web Site'</span>&#125;</span><br><span class="line"><span class="comment"># 虽然popitem 类似于列表方法pop，但字典没有与append(它在列表末尾添加一个元素)对应的方法。这是因为字典</span></span><br><span class="line"><span class="comment"># 是无序的，类似的方法毫无意义。</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>clear()</p>
<ul>
<li>清空字典</li>
<li>就地修改</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clear（删除所有字典项）</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'name'</span>] = <span class="string">'Gumby'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'age'</span>] = <span class="number">42</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="number">42</span>, <span class="string">'name'</span>: <span class="string">'Gumby'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>returned_value = d.clear()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(returned_value)</span><br><span class="line"><span class="keyword">None</span></span><br><span class="line"><span class="comment"># 这种操作是就地执行的(就像list.sort一样)，因此什么都不返回(或者说返回None)。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = x</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="string">'key'</span>] = <span class="string">'value'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">&#123;<span class="string">'key'</span>: <span class="string">'value'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">&#123;<span class="string">'key'</span>: <span class="string">'value'</span>&#125;</span><br><span class="line"><span class="comment"># x和y最初都指向同一个字典。通过将一个空字典赋给x来“清空”它。这对y没有任何影响，它依然指向原来的字典。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = x</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="string">'key'</span>] = <span class="string">'value'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">&#123;<span class="string">'key'</span>: <span class="string">'value'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.clear()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">&#123;&#125;</span><br><span class="line"><span class="comment"># 要删除原来字典的所有元素，必须使用clear。如果这样做，y也将是空的</span></span><br></pre></td></tr></table></figure>
<ul>
<li>del语句</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="keyword">True</span></span><br><span class="line">b = [<span class="number">6</span>]</span><br><span class="line">d = &#123;<span class="string">'a'</span>:<span class="number">1</span>,<span class="string">'b'</span>:b,<span class="string">'c'</span>:[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>]&#125;</span><br><span class="line"><span class="keyword">del</span> a</span><br><span class="line"><span class="keyword">del</span> d[<span class="string">'c'</span>]   <span class="comment"># 删除了'c'键及其值</span></span><br><span class="line"><span class="keyword">del</span> b[<span class="number">0</span>]   <span class="comment"># 变成了空列表</span></span><br><span class="line">c = b</span><br><span class="line"><span class="keyword">del</span> c</span><br><span class="line"><span class="keyword">del</span> b</span><br><span class="line">b = d[<span class="string">'b'</span>]</span><br><span class="line"><span class="comment"># del d['c']看着像删除了一个对象，本质上减少了一个对象的引用，del实际上删除的是名称，而不是对象</span></span><br></pre></td></tr></table></figure>
<h3 id="字典遍历"><a href="#字典遍历" class="headerlink" title="字典遍历"></a>字典遍历</h3><ul>
<li>遍历key，方法keys返回一个字典视图，其中包含指定字典中的键。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Method：</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> d:</span><br><span class="line">	print(k)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> d.keys():</span><br><span class="line">	print(k)</span><br><span class="line"><span class="comment"># 下面这种方法较常用</span></span><br></pre></td></tr></table></figure>
<ul>
<li>遍历value</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Method：</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> d:</span><br><span class="line">	print(d[k])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> d.keys():</span><br><span class="line">	print(d.get(k))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> d.values():</span><br><span class="line">	print(v)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 方法values返回一个由字典中的值组成的字典视图。不同于方法keys，方法values返回的视图可能包含重复的值。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="number">2</span>] = <span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="number">3</span>] = <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="number">4</span>] = <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d           </span><br><span class="line">&#123;<span class="number">1</span>: <span class="number">1</span>, <span class="number">2</span>: <span class="number">2</span>, <span class="number">3</span>: <span class="number">3</span>, <span class="number">4</span>: <span class="number">4</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.values()</span><br><span class="line">dict_values([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<ul>
<li>遍历item，即kv对</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">Method:</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> d.items():</span><br><span class="line">	print(item)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> d.items():</span><br><span class="line">	print(item[<span class="number">0</span>],item[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> d.items():</span><br><span class="line">	print(k,v)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k,_ <span class="keyword">in</span> d.items():</span><br><span class="line">	print(k)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _,v <span class="keyword">in</span> d.items():</span><br><span class="line">	print(v)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法items返回一个包含所有字典项的列表，其中每个元素都为(key, value)的形式。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">'title'</span>: <span class="string">'Python Web Site'</span>, <span class="string">'url'</span>: <span class="string">'http://www.python.org'</span>, <span class="string">'spam'</span>: <span class="number">0</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.items()</span><br><span class="line">dict_items([(<span class="string">'url'</span>, <span class="string">'http://www.python.org'</span>), (<span class="string">'spam'</span>, <span class="number">0</span>), (<span class="string">'title'</span>, <span class="string">'Python Web Site'</span>)])</span><br><span class="line"><span class="comment"># 字典项在列表中的排列顺序不确定。返回值属于一种名为字典视图的特殊类型。字典视图可用于迭代</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>it = d.items()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(it)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="string">'spam'</span>, <span class="number">0</span>) <span class="keyword">in</span> it</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="comment"># 还可确定其长度以及对其执行成员资格检查。如下 ：</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'spam'</span>] = <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="string">'spam'</span>, <span class="number">0</span>) <span class="keyword">in</span> it</span><br><span class="line"><span class="keyword">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'spam'</span>] = <span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="string">'spam'</span>, <span class="number">0</span>) <span class="keyword">in</span> it</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="comment"># 视图的一个优点是不复制，它们始终是底层字典的反映，即便你修改了底层字典亦如此</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(d.items())</span><br><span class="line">[(<span class="string">'spam'</span>, <span class="number">0</span>), (<span class="string">'title'</span>, <span class="string">'Python Web Site'</span>), (<span class="string">'url'</span>, <span class="string">'http://www.python.org'</span>)]</span><br><span class="line"><span class="comment"># 将字典项复制到列表中</span></span><br></pre></td></tr></table></figure>
<ul>
<li>总结<ul>
<li>Python3中，keys、values、items方法返回一个类似一个生成器的可迭代对象，不会把函数的返回结果复制到内存中<ul>
<li>Dictionary view对象</li>
<li>字典的entry的动态的视图，字典变化，视图将反映出这些变化</li>
</ul>
</li>
<li>Python2中，上面的方法会返回一个新的列表，占据新的内存空间。所以Python2建议使用iterkeys、itervalues、iteritems版本，返回一个迭代器，而不是一个copy</li>
</ul>
</li>
</ul>
<h3 id="字典遍历和移除"><a href="#字典遍历和移除" class="headerlink" title="字典遍历和移除"></a>字典遍历和移除</h3><ul>
<li>如何在遍历的时候移除元素</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">错误的做法</span><br><span class="line">d = dict(a=<span class="number">1</span>,b=<span class="number">2</span>,c=<span class="string">'abc'</span>)</span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> d.items():</span><br><span class="line">	d.pop(k)   <span class="comment"># 异常，提示：RuntimeError: dictionary changed size during iteration</span></span><br><span class="line"><span class="comment"># 是不是在pop的同时改变了字典，所以会有这样的提示</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">while</span> len(d):   <span class="comment"># 相当于清空，不如直接clear()</span></span><br><span class="line">	print(d.popitem())</span><br><span class="line"></span><br><span class="line">正确的做法</span><br><span class="line">d = dict(a=<span class="number">1</span>,b=<span class="number">2</span>,c=<span class="string">'abc'</span>)</span><br><span class="line">keys = []</span><br><span class="line"><span class="keyword">for</span> k,v <span class="keyword">in</span> d.items():</span><br><span class="line">	<span class="keyword">if</span> isinstance(v,str):</span><br><span class="line">		keys.append(k)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> keys:</span><br><span class="line">	d.pop(k)</span><br><span class="line">print(d)</span><br></pre></td></tr></table></figure>
<h3 id="字典的key"><a href="#字典的key" class="headerlink" title="字典的key"></a>字典的key</h3><ul>
<li>key的要求和set的元素要求一致<ul>
<li>set的元素可以看做key，set可以看做dict的简化版</li>
<li>hashable可哈希才可以作为key，可以使用hash()测试。可hash的类型是不可变的，可变类型是不可hash的</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d = &#123;<span class="number">1</span>:<span class="number">0</span>,<span class="number">2.0</span>:<span class="number">3</span>,<span class="string">"abc"</span>:<span class="keyword">None</span>,(<span class="string">'hello'</span>,<span class="string">'world'</span>,<span class="string">'python'</span>):<span class="string">"string"</span>,<span class="string">b'abc'</span>:<span class="string">'135'</span>&#125;</span><br><span class="line"><span class="comment"># 同理，这里要用&#123;&#125;大括号，不能用dict()，不然会报错。个人还是认为dict()是转换类型的，&#123;&#125;是定义的</span></span><br></pre></td></tr></table></figure>
<h3 id="defaultdict"><a href="#defaultdict" class="headerlink" title="defaultdict"></a>defaultdict</h3><ul>
<li><p>collections.defaultdict([default_factory[,…]])</p>
<ul>
<li>第一个参数是default_factory，缺省是None，它提供一个初始化函数。当key不存在的时候，会调用这个工厂函数来生成key对应的value</li>
</ul>
</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">例：</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">d1 = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="string">'abcdef'</span>:</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(random.randint(<span class="number">1</span>,<span class="number">5</span>)):</span><br><span class="line">		<span class="keyword">if</span> k <span class="keyword">not</span> <span class="keyword">in</span> d1.keys():</span><br><span class="line">			d1[k] = []</span><br><span class="line">		d1[k].append(i)  <span class="comment"># d1[k]是列表，这里调用这个列表的append方法</span></span><br><span class="line">print(d1)</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">d1 = defaultdict(list)</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="string">'abcdef'</span>:</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(random.randint(<span class="number">1</span>,<span class="number">5</span>)):</span><br><span class="line">		d1[k].append(i)</span><br><span class="line">print(d1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># defaultdict</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line">d1 = &#123;&#125;</span><br><span class="line">d2 = defaultdict(list)</span><br><span class="line"><span class="comment"># list放在这里相当于传了一个工厂方法，要求是一个初始化函数，这就是以后的初始化函数default_factory，初</span></span><br><span class="line"><span class="comment"># 始化函数什么时候用，只有在key不存在的时候，会调用这个工厂函数来生成key对应的value，也就是生成一个缺</span></span><br><span class="line"><span class="comment"># 省值，用来给这个没有value的key赋值，这样就可以凑上一个kv对，也就可以加入字典当中了。</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="string">"abcde"</span>:    <span class="comment"># 迭代a到e，这里要创建的是key</span></span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> range(<span class="number">5</span>):     <span class="comment"># 迭代0到4，这里要生成value</span></span><br><span class="line">        <span class="keyword">if</span> k <span class="keyword">not</span> <span class="keyword">in</span> d1.keys():    </span><br><span class="line"><span class="comment"># d1.keys()开始是空的，第一次的时候找不到上面循环的k是a，只有在每次循环的第一次key不存在时会进入这里</span></span><br><span class="line">            d1[k] = []   <span class="comment"># 这里表示，如果上面判断k不存在，就给d1[k]初始化一个空列表</span></span><br><span class="line">        d1[k].append(v)   </span><br><span class="line">        <span class="comment"># 这里把0-4依次追加到d1[k]中，第一次d1[a].append[0]，第二次d1[a].append[1]</span></span><br><span class="line">print(d1)   <span class="comment"># 最后打印出来，这是第一种方式</span></span><br><span class="line">输出：</span><br><span class="line">&#123;<span class="string">'a'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">'b'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">'c'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">'d'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">'e'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]&#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="string">'mnopq'</span>:</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> range(<span class="number">3</span>):   <span class="comment"># 这里是3是为了说明v与上面的k的数量可以不一样 </span></span><br><span class="line">        d2[k].append(v)   </span><br><span class="line"><span class="comment"># 这里不做判断，直接赋值。是为了说明上面的k(key)如果不存在，就调用上面定义的d2 = defaultdict(list)</span></span><br><span class="line"><span class="comment"># 中的list，这时就是在做创建空列表的动作，也就是list()，因为上面已经说明了当key不存在时调用工厂函数生</span></span><br><span class="line"><span class="comment"># 成key对应的value，并且也定义了d2等于这个工厂函数d2[k]就相当于测试一下这个k是否存在，不存在就调用工</span></span><br><span class="line"><span class="comment"># 厂函数。之后也可以自定义函数，并调用。</span></span><br><span class="line"><span class="comment"># 这就相当于替换了d1[k] = []中后面的中括号</span></span><br><span class="line"><span class="comment"># 个人想，如果将list改成tuple是否可以，也许不行，因为tuple是不可变的，没有append这样的方法，那么改成</span></span><br><span class="line"><span class="comment"># set是不是就可以了？测试发现，当使用tuple或set时会提示没有append属性</span></span><br><span class="line">print(d2)</span><br><span class="line">输出：</span><br><span class="line">defaultdict(&lt;class 'list'&gt;, &#123;'m': [0, 1, 2], 'n': [0, 1, 2], 'o': [0, 1, 2], 'p': [0, 1, 2], 'q': [0, 1, 2]&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="OrderedDict"><a href="#OrderedDict" class="headerlink" title="OrderedDict"></a>OrderedDict</h3><ul>
<li><p>collections.OrderedDict([items])</p>
<ul>
<li>key并不是按照加入的顺序排列，可以使用OrderedDict记录顺序</li>
</ul>
</li>
<li><p>有序字典可以记录元素插入的顺序，打印的时候也是按照这个顺序输出打印</p>
</li>
<li>3.6版本的Python的字典就是记录key插入的顺序（IPython不一定有效果）</li>
<li>应用场景<ul>
<li>假如使用字典记录了N个产品，这些产品使用ID由小到大加入到字典中</li>
<li>除了使用字典检索的遍历，有时候需要取出ID，但是希望是按照输入的顺序，因为输入顺序是有序的</li>
<li>否则还需要重新把遍历到的值排序</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">d = &#123;<span class="string">'banana'</span>:<span class="number">3</span>,<span class="string">'apple'</span>:<span class="number">4</span>,<span class="string">'pear'</span>:<span class="number">1</span>,<span class="string">'orange'</span>:<span class="number">2</span>&#125;</span><br><span class="line">print(d)</span><br><span class="line">keys = list(d.keys())</span><br><span class="line">random.shuffle(keys)</span><br><span class="line">print(keys)</span><br><span class="line">od = OrderedDict()</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> keys:</span><br><span class="line">	od[key] = d[key]</span><br><span class="line">print(od)</span><br><span class="line">print(od.keys())</span><br><span class="line"></span><br><span class="line"><span class="comment"># OrderedDict顺序的字典，这里指key要按顺序而不是值输出。key的顺序应该和我们放入的顺序是一样的</span></span><br><span class="line">d = &#123;&#125;</span><br><span class="line">d[<span class="string">'a'</span>] = <span class="number">1</span></span><br><span class="line">d[<span class="string">'b'</span>] = <span class="number">2</span></span><br><span class="line">d[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">print(d)</span><br><span class="line"><span class="comment"># 这里显示的d的值应该是按hash值排列的</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> d:</span><br><span class="line">    print(k)</span><br><span class="line">输出：</span><br><span class="line">&#123;<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="number">2</span>, <span class="number">1</span>: <span class="number">3</span>&#125;</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">d = &#123;<span class="string">'banana'</span>:<span class="number">3</span>,<span class="string">'apple'</span>:<span class="number">4</span>,<span class="string">'pear'</span>:<span class="number">1</span>,<span class="string">'orange'</span>:<span class="number">2</span>&#125;</span><br><span class="line">print(d)</span><br><span class="line">keys = list(d.keys())</span><br><span class="line">random.shuffle(keys)   <span class="comment"># 用shuffle把keys列表打乱</span></span><br><span class="line">od = OrderedDict()</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> keys:</span><br><span class="line">    od[key] = d[key]   <span class="comment"># 创建od的kv对，这里就是od['pear'] = 1这样的形式</span></span><br><span class="line">    </span><br><span class="line">print(od)</span><br><span class="line">print(od.keys())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这种方法可能在ipython中不再起作用，因为显示的值与输入的顺序是一样的。3.5版本之前是解决不了这个问题</span></span><br><span class="line"><span class="comment"># 的。或者是在jupeter中就是可以按顺序显示的？需要在python命令行中再测试一下。视频中测试的3.6.1版本</span></span><br><span class="line"><span class="comment"># 时，发现和这里的显示是一样的，按顺序显示。所以最好在python环境中测试，也就是在命令行输入python，之后</span></span><br><span class="line"><span class="comment"># 执行上面的命令测试。之前视频中用ipython测试会打乱顺序</span></span><br><span class="line">输出：</span><br><span class="line">&#123;<span class="string">'banana'</span>: <span class="number">3</span>, <span class="string">'apple'</span>: <span class="number">4</span>, <span class="string">'pear'</span>: <span class="number">1</span>, <span class="string">'orange'</span>: <span class="number">2</span>&#125;</span><br><span class="line">OrderedDict([(<span class="string">'banana'</span>, <span class="number">3</span>), (<span class="string">'pear'</span>, <span class="number">1</span>), (<span class="string">'orange'</span>, <span class="number">2</span>), (<span class="string">'apple'</span>, <span class="number">4</span>)])</span><br><span class="line">odict_keys([<span class="string">'banana'</span>, <span class="string">'pear'</span>, <span class="string">'orange'</span>, <span class="string">'apple'</span>])</span><br></pre></td></tr></table></figure>
<h3 id="重点"><a href="#重点" class="headerlink" title="重点"></a>重点</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br></pre></td><td class="code"><pre><span class="line">- item指的就是kv对</span><br><span class="line">============================================================================================</span><br><span class="line">d[k]</span><br><span class="line"><span class="comment"># 返回与键k相关联的值。</span></span><br><span class="line">d[k] = v</span><br><span class="line"><span class="comment"># 将值v关联到键k。</span></span><br><span class="line"><span class="keyword">del</span> d[k]</span><br><span class="line"><span class="comment"># 删除键为k的项。</span></span><br><span class="line">k <span class="keyword">in</span> d</span><br><span class="line"><span class="comment"># 检查字典d是否包含键为k的项。</span></span><br><span class="line">===========================================================================================</span><br><span class="line">初始化方法</span><br><span class="line">d = dict() 或者 d = &#123;&#125;</span><br><span class="line">============================================================================================</span><br><span class="line">- 键的类型：字典中的键可以是整数，但并非必须是整数。字典中的键可以是任何不可变的类型，如浮点数(实数) 、字符串或元组。</span><br><span class="line">- 自动添加：即便是字典中原本没有的键，也可以给它赋值，这将在字典中创建一个新项。然而，如果不使用append或其他类似的方法，就不能给列表中没有的元素赋值。</span><br><span class="line">- 成员资格：表达式k <span class="keyword">in</span> d(其中d 是一个字典)查找的是键而不是值，而表达式v <span class="keyword">in</span> l(其中l是一个列表)查找的是值而不是索引。这看似不太一致，但你习惯后就会觉得相当自然。毕竟如果字典包含指定的键，检查相应的值就很容易。</span><br><span class="line">============================================================================================</span><br><span class="line"><span class="comment"># 创建字典</span></span><br><span class="line">l1 = list(range(<span class="number">5</span>))</span><br><span class="line">d = dict(l1)</span><br><span class="line"><span class="comment"># 这样是不行是，因为l1里都是单值，字典需要两个值。提示：TypeError: cannot convert dictionary update sequence element #0 to a sequence</span></span><br><span class="line">d = dict(enumerate(l1))</span><br><span class="line"><span class="comment"># enumerate是给值加上索引的，这样也就是两个值了。</span></span><br><span class="line"></span><br><span class="line">e = enumerate(l1)</span><br><span class="line">print(type(e))</span><br><span class="line"><span class="comment"># e的类型枚举，是一个可迭代对象，可以使用list、set、tuple来包括这个类型，用什么方法包括这个类型，这个</span></span><br><span class="line"><span class="comment"># 类型就生成什么数据类型。也就是封装成什么就返回什么类型</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> e:</span><br><span class="line">    print(x)</span><br><span class="line"><span class="comment"># 返回的是二元组</span></span><br><span class="line"></span><br><span class="line">f = dict(e)  <span class="comment"># 这和dict(enumerate(l1))是一样的，只是分开了，先做enumerate再做dict。</span></span><br><span class="line">print(f)</span><br><span class="line"><span class="comment"># enumerate类似生成器的东西，走到头就不会再走了，所以f返回的是&#123;&#125;。</span></span><br><span class="line"><span class="comment"># &#123;0: 0, 1: 1, 2: 2, 3: 3, 4: 4&#125;</span></span><br><span class="line">============================================================================================</span><br><span class="line">c = dict(((<span class="number">1</span>,<span class="string">'a'</span>),))</span><br><span class="line">print(c)</span><br><span class="line"><span class="comment"># 需要使用这种方式，dict中是一个元组，一般不用这种方式。((1,'a'),)表示一个元组，因为字典需要两个值，所以定</span></span><br><span class="line"><span class="comment"># 义成(1,'a')</span></span><br><span class="line">============================================================================================</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">42</span>] = <span class="string">'Foobar'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">&#123;<span class="number">42</span>: <span class="string">'Foobar'</span>&#125;</span><br><span class="line"><span class="comment"># 将'Foobar'赋给一个空字典的键42，这样做一点问题都没有</span></span><br><span class="line">============================================================================================</span><br><span class="line">a = list</span><br><span class="line">l2 = a</span><br><span class="line">type(l2)</span><br><span class="line"><span class="comment"># 这样定义后，l2是一个类而不是列表。因为定义了a等于list类</span></span><br><span class="line"></span><br><span class="line">l3 = a()</span><br><span class="line">print(l3)</span><br><span class="line"><span class="comment"># l3被定义成了一个空列表，因为a等于list，所以这里l3 = a()就等于l3 = list()</span></span><br><span class="line"><span class="comment"># a = list就是a把list的名称拿走了，等于把名称对应的地址拿走了</span></span><br><span class="line"><span class="comment"># 函数也是一个对象，对象在内存中有一个地方放。这个地方就是函数的地址。列表放在内存中是一个对象，比如创建</span></span><br><span class="line"><span class="comment"># 一个空列表，这是一个对象，我们把空列表赋值给了l3，l3拿的就是这个空列表对象的地址。现在我们给出一个函数</span></span><br><span class="line"><span class="comment"># list，函数本身也是对象，一切皆对象。我们把这个对象给了a，就是把a覆盖掉了，这是把对象地址或叫对象引用</span></span><br><span class="line"><span class="comment"># 给了a，这时a与list也就是等价的了。如果写成list()就是调用了，只要加了括号就是调用了。也就是说，</span></span><br><span class="line"><span class="comment"># a = list是将对象地址给了a，a与list等价。a = list()是调用，将调用list函数的结果给了a，a被定义成了一个空列表</span></span><br><span class="line"></span><br><span class="line">l4 = <span class="number">5</span>()</span><br><span class="line"><span class="comment"># 这样定义会提示"TypeError: 'int' object is not callable"，这说明int类型是不可以调用的。这就说明</span></span><br><span class="line"><span class="comment"># 了加括号是可以调用前面的对象或名称的，但前面的对象或名称需要是可调用的对象。list是一个写好的函数，这个</span></span><br><span class="line"><span class="comment"># 函数已经被当前环境加载过了，所以这个名称可以直接拿来用，这个名称指代的是list名称加载到内存中的位置，这</span></span><br><span class="line"><span class="comment"># 就是引用类型。真正的引用并不是我们写一个列表，把列表赋值给变量，这才是对它的引用，实际这个函数也是对</span></span><br><span class="line"><span class="comment"># 象，它也在内存中，你要引用它，也要通过它的名称才能引用，一加括号意义就变了，这个对象如果是可调用对象的</span></span><br><span class="line"><span class="comment"># 话，我们就调用它了。如果函数是一个可调用对象，调用时就会执行函数里的函数体了。之后的类也可以变成一个可</span></span><br><span class="line"><span class="comment"># 调用对象，比如把一个类实例化了，它就变成一个对象，这个对象后面也可以加括号，这就是python的技巧</span></span><br><span class="line">============================================================================================</span><br><span class="line">- d[key]</span><br><span class="line">    - 返回key对应的值value</span><br><span class="line">    - key不存在抛出KeyError异常</span><br><span class="line">    </span><br><span class="line">- get(key[,default])</span><br><span class="line">    - 返回key对应的值value</span><br><span class="line">    - get方法不会抛异常，如果key不存在，返回缺省值，如果没有设置缺省值就返回<span class="keyword">None</span>。如果存在，就显示其值。</span><br><span class="line">    </span><br><span class="line">- setdefault(key[,default])</span><br><span class="line">	- 返回key对应的值value</span><br><span class="line">	- key不存在，添加kv对，value为default，并返回default，如果default没有设置，缺省为<span class="keyword">None</span></span><br><span class="line">    </span><br><span class="line">- d[key] = value</span><br><span class="line">    - 将key对应的值修改为value</span><br><span class="line">    - **key不存在添加新的kv对**</span><br><span class="line">    </span><br><span class="line">- update([other]) -&gt; None</span><br><span class="line">    - 使用另一个字典的kv对更新本字典</span><br><span class="line">    - key不存在，就添加</span><br><span class="line">    - key存在，覆盖已经存在的key对应的值</span><br><span class="line">    - 就地修改</span><br><span class="line">        - d.update(red=<span class="number">1</span>)</span><br><span class="line">        - d.update(((<span class="string">'red'</span>,<span class="number">2</span>),))</span><br><span class="line">        - d.update(&#123;<span class="string">'red'</span>:<span class="number">3</span>&#125;)</span><br><span class="line">        </span><br><span class="line">- copy（返回一个新字典）</span><br><span class="line">	- copy方法返回一个新字典，其包含的键值对与原来的字典相同(这个方法执行的是浅复制，因为值本身是原件，而非副本)。</span><br><span class="line">	- x = &#123;<span class="string">'username'</span>: <span class="string">'admin'</span>, <span class="string">'machines'</span>: [<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>]&#125;</span><br><span class="line">	- y = x.copy()</span><br><span class="line"></span><br><span class="line">- fromkeys</span><br><span class="line">    - fromkeys创建一个新字典，其中包含指定的键，且每个键对应的值都是<span class="keyword">None</span>。</span><br><span class="line">	- &#123;&#125;.fromkeys([<span class="string">'name'</span>, <span class="string">'age'</span>])</span><br><span class="line">	<span class="comment"># &#123;'age': None, 'name': None&#125;</span></span><br><span class="line">    - dict.fromkeys([<span class="string">'name'</span>, <span class="string">'age'</span>])</span><br><span class="line">	<span class="comment"># 直接对dict调用方法fromkeys。</span></span><br><span class="line">	- dict.fromkeys([<span class="string">'name'</span>, <span class="string">'age'</span>], <span class="string">'(unknown)'</span>)</span><br><span class="line">    </span><br><span class="line">- pop(key[,default])</span><br><span class="line">	- key存在，移除它，并返回它的value</span><br><span class="line">	- key不存在，返回给定的default</span><br><span class="line">	- default未设置，key不存在则抛出KeyError异常</span><br><span class="line">    </span><br><span class="line">- popitem()</span><br><span class="line">	- 移除并返回一个任意的键值对</span><br><span class="line">	- 字典为empty，抛出KeyError异常</span><br><span class="line">    </span><br><span class="line">- clear()</span><br><span class="line">	- 清空字典</span><br><span class="line">	- 就地修改</span><br><span class="line">    </span><br><span class="line">- <span class="keyword">del</span>语句</span><br><span class="line"></span><br><span class="line">- 遍历key，方法keys返回一个字典视图，其中包含指定字典中的键。</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> d:</span><br><span class="line">        print(k)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> d.keys():</span><br><span class="line">        print(k)</span><br><span class="line">    <span class="comment"># 下面这种方法较常用</span></span><br><span class="line">    </span><br><span class="line">- 遍历value</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> d:</span><br><span class="line">        print(d[k])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> d.keys():</span><br><span class="line">        print(d.get(k))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> d.values():</span><br><span class="line">        print(v)</span><br><span class="line">        </span><br><span class="line">- 遍历item，即kv对</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> d.items():</span><br><span class="line">        print(item)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> d.items():</span><br><span class="line">        print(item[<span class="number">0</span>],item[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k,v <span class="keyword">in</span> d.items():</span><br><span class="line">        print(k,v)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k,_ <span class="keyword">in</span> d.items():</span><br><span class="line">        print(k)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _,v <span class="keyword">in</span> d.items():</span><br><span class="line">        print(v)</span><br><span class="line">        </span><br><span class="line">- 总结</span><br><span class="line">	Python3中，keys、values、items方法返回一个类似一个生成器的可迭代对象，不会把函数的返回结果复制到内存中</span><br><span class="line">		- Dictionary view对象</span><br><span class="line">		- 字典的entry的动态的视图，字典变化，视图将反映出这些变化</span><br><span class="line">        </span><br><span class="line">- 如何在遍历的时候移除元素</span><br><span class="line">    d = dict(a=<span class="number">1</span>,b=<span class="number">2</span>,c=<span class="string">'abc'</span>)</span><br><span class="line">    keys = []</span><br><span class="line">    <span class="keyword">for</span> k,v <span class="keyword">in</span> d.items():</span><br><span class="line">        <span class="keyword">if</span> isinstance(v,str):</span><br><span class="line">            keys.append(k)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> keys:</span><br><span class="line">        d.pop(k)</span><br><span class="line">    print(d)</span><br><span class="line"></span><br><span class="line">- key的要求和set的元素要求一致</span><br><span class="line">	- set的元素可以看做key，set可以看做dict的简化版</span><br><span class="line">	- hashable可哈希才可以作为key，可以使用hash()测试。</span><br><span class="line">    </span><br><span class="line">- collections.defaultdict([default_factory[,...]])</span><br><span class="line">	- 第一个参数是default_factory，缺省是<span class="keyword">None</span>，它提供一个初始化函数。当key不存在的时候，会调用这个工厂函数来生成key对应的value</span><br><span class="line">例：</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">d1 = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="string">'abcdef'</span>:</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(random.randint(<span class="number">1</span>,<span class="number">5</span>)):</span><br><span class="line">		<span class="keyword">if</span> k <span class="keyword">not</span> <span class="keyword">in</span> d1.keys():</span><br><span class="line">			d1[k] = []</span><br><span class="line">		d1[k].append(i)  <span class="comment"># d1[k]是列表，这里调用这个列表的append方法</span></span><br><span class="line">print(d1)</span><br><span class="line">输出：</span><br><span class="line">&#123;<span class="string">'a'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">'b'</span>: [<span class="number">0</span>, <span class="number">1</span>], <span class="string">'c'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">'d'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">'e'</span>: [<span class="number">0</span>], <span class="string">'f'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]&#125;</span><br><span class="line"><span class="comment"># 字典中的元素如果是列表类型，那么使用列表的append方法会得到&#123;元素: [列表]&#125;，如上面d1[k]就是列表类型，如果</span></span><br><span class="line"><span class="comment"># 向列表中添加值，就会等到如&#123;'a': [0, 1, 2, 3]&#125;，这是通过d1[a].append(0)，d1[a].append(1)这样添加的。</span></span><br><span class="line"></span><br><span class="line">- collections.OrderedDict([items])</span><br><span class="line">    - key并不是按照加入的顺序排列，可以使用OrderedDict记录顺序</span><br><span class="line">    - 有序字典可以记录元素插入的顺序，打印的时候也是按照这个顺序输出打印</span><br><span class="line">    - <span class="number">3.6</span>版本的Python的字典就是记录key插入的顺序（IPython不一定有效果）</span><br><span class="line">    - 应用场景</span><br><span class="line">        - 假如使用字典记录了N个产品，这些产品使用ID由小到大加入到字典中</span><br><span class="line">        - 除了使用字典检索的遍历，有时候需要取出ID，但是希望是按照输入的顺序，因为输入顺序是有序的</span><br><span class="line">        - 否则还需要重新把遍历到的值排序</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/25/python基础学习-使用字符串/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/25/python基础学习-使用字符串/" itemprop="url">
                  python基础学习-使用字符串
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-25 14:28:54" itemprop="dateCreated datePublished" datetime="2019-03-25T14:28:54+08:00">2019-03-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2020-04-17 17:32:07" itemprop="dateModified" datetime="2020-04-17T17:32:07+08:00">2020-04-17</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>​    字符串是一个个字符组成的有序的序列，是字符的集合。可以使用单引号、双引号、三引号引住的字符序列。字符串是不可变对象。从Python3起，字符串就是Unicode类型。</p>
<h4 id="字符串定义-初始化"><a href="#字符串定义-初始化" class="headerlink" title="字符串定义-初始化"></a>字符串定义-初始化</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">s1 = <span class="string">'string'</span></span><br><span class="line">s2 = <span class="string">"string2"</span></span><br><span class="line">s3 = <span class="string">'''this's a "string"'''</span></span><br><span class="line">s4 = <span class="string">'hello \n magedu.com'</span></span><br><span class="line">s5 = <span class="string">r"hello \n magedu.com"</span></span><br><span class="line">s6 = <span class="string">'c:\windows\nt'</span></span><br><span class="line">s7 = R<span class="string">"c:\windows\\nt"</span></span><br><span class="line">s8 = <span class="string">'c:\windows\\nt'</span></span><br><span class="line"><span class="comment"># 使用\\可以转义为一个\</span></span><br><span class="line">sql = <span class="string">"""select * from user where name='tom'"""</span></span><br><span class="line">print(s1,s2,s3,s4,s5,s6,s7,s8,sql)</span><br></pre></td></tr></table></figure>
<h4 id="字符串元素访问-下标"><a href="#字符串元素访问-下标" class="headerlink" title="字符串元素访问-下标"></a>字符串元素访问-下标</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字符串支持使用索引访问</span></span><br><span class="line">sql = <span class="string">"select * from user where name='tom'"</span></span><br><span class="line">sql[<span class="number">4</span>]   </span><br><span class="line">输出：<span class="string">'c'</span></span><br><span class="line"></span><br><span class="line">sql[<span class="number">4</span>] = <span class="string">'o'</span></span><br><span class="line">输出：---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-6</span><span class="number">-9056</span>ec11fda5&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">1</span> sql = <span class="string">"select * from user where name='tom'"</span></span><br><span class="line">----&gt; 2 sql[4] = 'o'</span><br><span class="line"></span><br><span class="line">TypeError: <span class="string">'str'</span> object does <span class="keyword">not</span> support item assignment</span><br><span class="line"><span class="comment"># 字符串是不可变对象，所以报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 有序的字符集合，字符序列</span></span><br><span class="line">sql = <span class="string">"select * from user where name='tom'"</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> sql:</span><br><span class="line">    print(c)</span><br><span class="line">    print(type(c))</span><br><span class="line">输出：</span><br><span class="line">s</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">str</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">e</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">str</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">l</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">str</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">e</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">str</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">c</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">str</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">t</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">str</span>'&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># 可迭代</span></span><br><span class="line">sql = "select * from user where name='tom'"</span><br><span class="line">lst = list(sql)</span><br><span class="line">print(lst)</span><br><span class="line">输出：</span><br><span class="line">[<span class="string">'s'</span>, <span class="string">'e'</span>, <span class="string">'l'</span>, <span class="string">'e'</span>, <span class="string">'c'</span>, <span class="string">'t'</span>, <span class="string">' '</span>, <span class="string">'*'</span>, <span class="string">' '</span>, <span class="string">'f'</span>, <span class="string">'r'</span>, <span class="string">'o'</span>, <span class="string">'m'</span>, <span class="string">' '</span>, <span class="string">'u'</span>, <span class="string">'s'</span>, <span class="string">'e'</span>, <span class="string">'r'</span>, <span class="string">' '</span>, <span class="string">'w'</span>, <span class="string">'h'</span>, <span class="string">'e'</span>, <span class="string">'r'</span>, <span class="string">'e'</span>, <span class="string">' '</span>, <span class="string">'n'</span>, <span class="string">'a'</span>, <span class="string">'m'</span>, <span class="string">'e'</span>, <span class="string">'='</span>, <span class="string">"'"</span>, <span class="string">'t'</span>, <span class="string">'o'</span>, <span class="string">'m'</span>, <span class="string">"'"</span>]</span><br><span class="line"></span><br><span class="line">练习：</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>website = <span class="string">'http://www.python.org'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>website[<span class="number">-3</span>:] = <span class="string">'com'</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File "&lt;pyshell#19&gt;", line 1, in ?</span><br><span class="line">website[<span class="number">-3</span>:] = <span class="string">'com'</span></span><br><span class="line">TypeError: object doesn<span class="string">'t support slice assignment</span></span><br><span class="line"><span class="string"># 所有标准序列操作(索引、切片、乘法、成员资格检查、长度、最小值和最大值)都适用于字符串，但字符串是不可变的，因此所有的元素赋值和切片赋值都是非法的。</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串join连接"><a href="#字符串join连接" class="headerlink" title="字符串join连接"></a>字符串join连接</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># "string".join(iterable) -&gt; str</span></span><br><span class="line"><span class="comment"># 将可迭代对象连接起来，使用string作为分隔符</span></span><br><span class="line"><span class="comment"># 可迭代对象本身元素都是字符串</span></span><br><span class="line"><span class="comment"># 返回一个新字符串</span></span><br><span class="line"></span><br><span class="line">lst = [<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>]</span><br><span class="line">print(<span class="string">"\""</span>.join(lst))</span><br><span class="line">输出：<span class="number">1</span><span class="string">"2"</span><span class="number">3</span></span><br><span class="line"><span class="comment"># 分隔符是双引号。\是转义符</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">" "</span>.join(lst))</span><br><span class="line">输出：<span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"\n"</span>.join(lst))</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"></span><br><span class="line">lst = [<span class="string">'1'</span>,[<span class="string">'a'</span>,<span class="string">'b'</span>],<span class="string">'3'</span>]</span><br><span class="line">print(<span class="string">" "</span>.join(lst))</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-11</span>-d6bdd3c2fbc5&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">1</span> lst = [<span class="string">'1'</span>,[<span class="string">'a'</span>,<span class="string">'b'</span>],<span class="string">'3'</span>]</span><br><span class="line">----&gt; 2 print(" ".join(lst))</span><br><span class="line"></span><br><span class="line">TypeError: sequence item <span class="number">1</span>: expected str instance, list found</span><br><span class="line"><span class="comment"># 不能对复杂列表用join()函数</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>seq = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sep = <span class="string">'+'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sep.join(seq) </span><br><span class="line"><span class="comment"># 尝试合并一个数字列表，结果不可以对列表使用join方法</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File "&lt;stdin&gt;", line 1, in ?</span><br><span class="line">TypeError: sequence item <span class="number">0</span>: expected string, int found</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>seq = [<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sep.join(seq) </span><br><span class="line"><span class="string">'1+2+3+4+5'</span></span><br><span class="line"><span class="comment"># 合并一个字符串列表</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dirs = <span class="string">''</span>, <span class="string">'usr'</span>, <span class="string">'bin'</span>, <span class="string">'env'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'/'</span>.join(dirs)</span><br><span class="line"><span class="string">'/usr/bin/env'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'C:'</span> + <span class="string">'\\'</span>.join(dirs))</span><br><span class="line">C:\usr\bin\env</span><br><span class="line"><span class="comment"># 这里需要对\转义</span></span><br><span class="line"><span class="comment"># 注：所合并序列的元素必须都是字符串。</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串-连接"><a href="#字符串-连接" class="headerlink" title="字符串+连接"></a>字符串+连接</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># + -&gt; str</span></span><br><span class="line"><span class="comment"># 将2个字符串连接在一起</span></span><br><span class="line"><span class="comment"># 返回一个新字符串</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串分割"><a href="#字符串分割" class="headerlink" title="* 字符串分割"></a>* 字符串分割</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分割字符串的方法分为2类</span></span><br><span class="line">	<span class="comment"># split系</span></span><br><span class="line">		<span class="comment"># 将字符串按照分隔符分割成若干字符串，并返回列表</span></span><br><span class="line">	<span class="comment"># partition系</span></span><br><span class="line">    	<span class="comment"># 将字符串按照分隔符分割成2段，返回这2段和分隔符的元组</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># split(sep=None,maxsplit=-1) -&gt; list of strings</span></span><br><span class="line">	<span class="comment"># 从左至右</span></span><br><span class="line">    <span class="comment"># sep指定分割字符串，缺省的情况下空白字符串作为分隔符</span></span><br><span class="line">    <span class="comment"># maxsplit指定分割的次数，-1表示遍历整个字符串</span></span><br><span class="line">    </span><br><span class="line">s1 = <span class="string">"I'm \ta super student."</span></span><br><span class="line">s1.split()</span><br><span class="line">输出：[<span class="string">"I'm"</span>, <span class="string">'a'</span>, <span class="string">'super'</span>, <span class="string">'student.'</span>]</span><br><span class="line"><span class="comment"># 默认以空白为分割符</span></span><br><span class="line"></span><br><span class="line">s1.split(<span class="string">'s'</span>)</span><br><span class="line">输出：[<span class="string">"I'm \ta "</span>, <span class="string">'uper '</span>, <span class="string">'tudent.'</span>]</span><br><span class="line"><span class="comment"># 以s为分割符</span></span><br><span class="line"></span><br><span class="line">s1.split(<span class="string">'super'</span>)</span><br><span class="line">输出：[<span class="string">"I'm \ta "</span>, <span class="string">' student.'</span>]</span><br><span class="line"></span><br><span class="line">s1.split(<span class="string">'super '</span>)    <span class="comment"># 这比上面的super多了一个空格</span></span><br><span class="line">输出：[<span class="string">"I'm \ta "</span>, <span class="string">'student.'</span>]</span><br><span class="line"></span><br><span class="line">s1.split(<span class="string">' '</span>)</span><br><span class="line">输出：[<span class="string">"I'm"</span>, <span class="string">'\ta'</span>, <span class="string">'super'</span>, <span class="string">'student.'</span>]</span><br><span class="line"></span><br><span class="line">s1.split(<span class="string">' '</span>,maxsplit=<span class="number">2</span>)</span><br><span class="line">输出：[<span class="string">"I'm"</span>, <span class="string">'\ta'</span>, <span class="string">'super student.'</span>]</span><br><span class="line"></span><br><span class="line">s1.split(<span class="string">'\t'</span>,maxsplit=<span class="number">2</span>)</span><br><span class="line">输出：[<span class="string">"I'm "</span>, <span class="string">'a super student.'</span>]</span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'1+2+3+4+5'</span>.split(<span class="string">'+'</span>)</span><br><span class="line">[<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'/usr/bin/env'</span>.split(<span class="string">'/'</span>)</span><br><span class="line">[<span class="string">''</span>, <span class="string">'usr'</span>, <span class="string">'bin'</span>, <span class="string">'env'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'Using the default'</span>.split()</span><br><span class="line">[<span class="string">'Using'</span>, <span class="string">'the'</span>, <span class="string">'default'</span>]</span><br><span class="line"><span class="comment"># split是一个非常重要的字符串方法，其作用与join相反，用于将字符串拆分为序列。如果没有指定分隔符，将默认在单个或多个连续的空白字符(空格、制表符、换行符等)处进行拆分。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># splitlines([keepends]) -&gt; list of strings</span></span><br><span class="line">	<span class="comment"># 按照行来切分字符串</span></span><br><span class="line">    <span class="comment"># keepends指的是是否保留行分隔符</span></span><br><span class="line">    <span class="comment"># 行分隔符包括\n、\r\n、\r、等</span></span><br><span class="line"><span class="string">'ab c\n\nde fg\rkl\r\n'</span>.splitlines()</span><br><span class="line">输出：[<span class="string">'ab c'</span>, <span class="string">''</span>, <span class="string">'de fg'</span>, <span class="string">'kl'</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">'ab c\n\nde fg\rkl\r\n'</span>.splitlines(<span class="keyword">True</span>)</span><br><span class="line">输出：[<span class="string">'ab c\n'</span>, <span class="string">'\n'</span>, <span class="string">'de fg\r'</span>, <span class="string">'kl\r\n'</span>]</span><br><span class="line"></span><br><span class="line">s1 = <span class="string">'''I'm a super student.</span></span><br><span class="line"><span class="string">You're a super teacher.'''</span></span><br><span class="line">print(s1)</span><br><span class="line">输出：</span><br><span class="line">I<span class="string">'m a super student.</span></span><br><span class="line"><span class="string">You'</span>re a super teacher.</span><br><span class="line"></span><br><span class="line">print(s1.splitlines())</span><br><span class="line">输出：[<span class="string">"I'm a super student."</span>, <span class="string">"You're a super teacher."</span>]</span><br><span class="line"></span><br><span class="line">print(s1.splitlines(<span class="keyword">True</span>))</span><br><span class="line">输出：[<span class="string">"I'm a super student.\n"</span>, <span class="string">"You're a super teacher."</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># * partition(sep) -&gt; (head, sep, tail)</span></span><br><span class="line">	<span class="comment"># 从左至右，遇到分隔符就把字符串分割成两部分，返回头、分隔符、尾三部分的三元组；如果没有找</span></span><br><span class="line">    <span class="comment"># 到分隔符，就返回头、2个空元素的三元组</span></span><br><span class="line">    <span class="comment"># sep分割字符串，心须指定</span></span><br><span class="line">s1 = <span class="string">"I'm a super student."</span></span><br><span class="line">s1.partition(<span class="string">'s'</span>)</span><br><span class="line">输出：(<span class="string">"I'm a "</span>, <span class="string">'s'</span>, <span class="string">'uper student.'</span>)</span><br><span class="line"></span><br><span class="line">s1.partition(<span class="string">'stu'</span>)</span><br><span class="line">输出：(<span class="string">"I'm a super "</span>, <span class="string">'stu'</span>, <span class="string">'dent.'</span>)</span><br><span class="line"></span><br><span class="line">s1.partition(<span class="string">''</span>)</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">ValueError                                Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-29</span><span class="number">-4</span>a93ae92b66c&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">2</span> s1.partition(<span class="string">'s'</span>)</span><br><span class="line">      <span class="number">3</span> s1.partition(<span class="string">'stu'</span>)</span><br><span class="line">----&gt; 4 s1.partition('')</span><br><span class="line"></span><br><span class="line">ValueError: empty separator</span><br><span class="line">    </span><br><span class="line">s1.partition(<span class="string">'abc'</span>)</span><br><span class="line">输出：</span><br><span class="line"></span><br><span class="line"><span class="comment"># rpartition(sep) -&gt; (head, sep, tail)</span></span><br><span class="line">	<span class="comment"># 从右至左，遇到分隔符就把字符串分割成两部分，返回头、分隔符、尾三部分的三元组；如果没有找到分隔符，</span></span><br><span class="line">    <span class="comment"># 就返回2个空元素和尾的三元组</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串大小写"><a href="#字符串大小写" class="headerlink" title="字符串大小写"></a>字符串大小写</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># upper()   全大写</span></span><br><span class="line"><span class="comment"># lower()    全小写</span></span><br><span class="line"><span class="comment"># 大小写，做判断的时候用</span></span><br><span class="line"><span class="comment"># swapcase()    交互大小写</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'Trondheim Hammer Dance'</span>.lower()</span><br><span class="line"><span class="string">'trondheim hammer dance'</span></span><br><span class="line"><span class="comment"># lower返回字符串的小写版本</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> <span class="string">'Gumby'</span> <span class="keyword">in</span> [<span class="string">'gumby'</span>, <span class="string">'smith'</span>, <span class="string">'jones'</span>]: print(<span class="string">'Found it!'</span>)</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 这样是找不到的。这里的匹配是区分大小写的</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">'Gumby'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>names = [<span class="string">'gumby'</span>, <span class="string">'smith'</span>, <span class="string">'jones'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> name.lower() <span class="keyword">in</span> names: print(<span class="string">'Found it!'</span>)</span><br><span class="line">...</span><br><span class="line">Found it!</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 使用lower转换后才可以找到</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串排版"><a href="#字符串排版" class="headerlink" title="字符串排版"></a>字符串排版</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># title() -&gt; str</span></span><br><span class="line">	<span class="comment"># 标题的每个单词都大写</span></span><br><span class="line"><span class="comment"># capitalize() -&gt; str</span></span><br><span class="line">    <span class="comment"># 首个单词大写</span></span><br><span class="line"><span class="comment"># center(width[,fillchar]) -&gt; str</span></span><br><span class="line">    <span class="comment"># width    打印宽度</span></span><br><span class="line">    <span class="comment"># fillchar    填充的字符</span></span><br><span class="line"><span class="comment"># zfill(width) -&gt; str</span></span><br><span class="line">    <span class="comment"># width  打印宽度，居右，左边用0填充</span></span><br><span class="line"><span class="comment"># ljust(width[,fillchar]) -&gt; str    左对齐</span></span><br><span class="line"><span class="comment"># rjust(width[,fillchar]) -&gt; str    右对齐</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"The Middle by Jimmy Eat World"</span>.center(<span class="number">39</span>)</span><br><span class="line"><span class="string">'      The Middle by Jimmy Eat World      '</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"The Middle by Jimmy Eat World"</span>.center(<span class="number">39</span>, <span class="string">"*"</span>)</span><br><span class="line"><span class="string">'*****The Middle by Jimmy Eat World*****'</span></span><br><span class="line"><span class="comment"># center通过在两边添加填充字符(默认为空格)让字符串居中。上面表示总长度是39，不足的地方用星号填充</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"that's all folks"</span>.title()</span><br><span class="line"><span class="string">"That'S All, Folks"</span></span><br><span class="line"><span class="comment"># title将字符串转换为词首大写，即所有单词的首字母都大写，其他字母都小写。然而，它确定单词边界的方式可能导致结果不合理。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.capwords(<span class="string">"that's all, folks"</span>)</span><br><span class="line">That<span class="string">'s All, Folks"</span></span><br><span class="line"><span class="string"># 还可以使用模块string中的函数capwords</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串修改"><a href="#字符串修改" class="headerlink" title="* 字符串修改"></a>* 字符串修改</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># replace(old,new[,count]) -&gt; str</span></span><br><span class="line">	<span class="comment"># 字符串中找到匹配替换为新子串，返回新字符串</span></span><br><span class="line">    <span class="comment"># count表示替换几次，不指定就是全部替换</span></span><br><span class="line">    </span><br><span class="line"><span class="string">'www.magedu.com'</span>.replace(<span class="string">'w'</span>,<span class="string">'p'</span>)</span><br><span class="line">输出：<span class="string">'ppp.magedu.com'</span></span><br><span class="line"></span><br><span class="line"><span class="string">'www.magedu.com'</span>.replace(<span class="string">'w'</span>,<span class="string">'p'</span>,<span class="number">2</span>)</span><br><span class="line">输出：<span class="string">'ppw.magedu.com'</span></span><br><span class="line"></span><br><span class="line"><span class="string">'www.magedu.com'</span>.replace(<span class="string">'w'</span>,<span class="string">'p'</span>,<span class="number">3</span>)</span><br><span class="line">输出：<span class="string">'ppp.magedu.com'</span></span><br><span class="line"></span><br><span class="line"><span class="string">'www.magedu.com'</span>.replace(<span class="string">'ww'</span>,<span class="string">'p'</span>,<span class="number">2</span>)</span><br><span class="line">输出：<span class="string">'pw.magedu.com'</span></span><br><span class="line"></span><br><span class="line"><span class="string">'www.magedu.com'</span>.replace(<span class="string">'www'</span>,<span class="string">'python'</span>,<span class="number">2</span>)</span><br><span class="line">输出：<span class="string">'python.magedu.com'</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'This is a test'</span>.replace(<span class="string">'is'</span>, <span class="string">'eez'</span>)</span><br><span class="line"><span class="string">'Theez eez a test'</span></span><br><span class="line"><span class="comment"># replace将指定子串都替换为另一个字符串，并返回替换后的结果。上面是将is替换为eez</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># strip([chars]) -&gt; str</span></span><br><span class="line">	<span class="comment"># 从字符串两端去除指定的字符集chars中的所有字符</span></span><br><span class="line">    <span class="comment"># 如果chars没有指定，去除两端的空白字符</span></span><br><span class="line">    </span><br><span class="line">s = <span class="string">"\r \n \t Hello Python \n \t"</span></span><br><span class="line">s.strip()</span><br><span class="line">输出：<span class="string">'Hello Python'</span></span><br><span class="line"><span class="comment"># 没有指定去除的字符串，所以去除的是空白</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">" I am very very very sorry "</span></span><br><span class="line">s.strip(<span class="string">'Iy'</span>)</span><br><span class="line">输出：<span class="string">' I am very very very sorry '</span></span><br><span class="line"><span class="comment"># 因为前后都有空格，所以输出与原字符串没有区别</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">" I am very very very sorry "</span></span><br><span class="line">s.strip(<span class="string">'Iy '</span>)</span><br><span class="line">输出：<span class="string">'am very very very sorr'</span></span><br><span class="line"><span class="comment"># 在strip中加了空格，所以可以去除字符串中前后的空格和与空格挨着的I和y。</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'      internal whitespace is kept      '</span>.strip()</span><br><span class="line"><span class="string">'internal whitespace is kept'</span></span><br><span class="line"><span class="comment"># strip将字符串开头和末尾的空白(但不包括中间的空白)删除，并返回删除后的结果。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>names = [<span class="string">'gumby'</span>, <span class="string">'smith'</span>, <span class="string">'jones'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">'gumby '</span></span><br><span class="line"><span class="comment"># 这里的gumby后有一个空格</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> name <span class="keyword">in</span> names: print(<span class="string">'Found it!'</span>)</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> name.strip() <span class="keyword">in</span> names: print(<span class="string">'Found it!'</span>)</span><br><span class="line">...</span><br><span class="line">Found it!</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 需要将输入与存储的值进行比较时，strip很有用。如上面，在用户名后多了一个空格也可以找到</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'*** SPAM * for * everyone!!! ***'</span>.strip(<span class="string">' *!'</span>)</span><br><span class="line"><span class="string">'SPAM * for * everyone'</span></span><br><span class="line"><span class="comment"># 这个方法可以删除开头或末尾的指定字符，中间的星号不会被删除。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># lstrip([chars]) -&gt; str</span></span><br><span class="line">	<span class="comment"># 从左开始</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># rstrip([chars]) -&gt; str</span></span><br><span class="line">	<span class="comment"># 从右开始</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串查找"><a href="#字符串查找" class="headerlink" title="* 字符串查找"></a>* 字符串查找</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find(sub[,start[,end]]) -&gt; int</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start,end]，从左至右，查找子串sub。查询到结果返回索引，没查询到结果返回-1</span></span><br><span class="line"><span class="comment"># rfind(sub[,start[,end]]) -&gt; int</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start,end]，从右至左，查找子串sub。查询到结果返回索引，没查询到结果返回-1</span></span><br><span class="line">    </span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.find(<span class="string">'very'</span>)</span><br><span class="line">输出：<span class="number">5</span></span><br><span class="line"><span class="comment"># 结果表示从索引5开始，找到了very</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.find(<span class="string">'very'</span>, <span class="number">5</span>)</span><br><span class="line">输出：<span class="number">5</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.find(<span class="string">'very'</span>, <span class="number">6</span>, <span class="number">13</span>)</span><br><span class="line">输出：<span class="number">-1</span></span><br><span class="line"><span class="comment"># 这表示没有找到，区间是从索引6到12，这也是前包后不包。如果将13改成14，就能找到了</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.rfind(<span class="string">'very'</span>, <span class="number">10</span>)</span><br><span class="line">输出：<span class="number">15</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.rfind(<span class="string">'very'</span>, <span class="number">10</span>, <span class="number">15</span>)</span><br><span class="line">输出：<span class="number">10</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.rfind(<span class="string">'very'</span>,<span class="number">-10</span>,<span class="number">-1</span>)</span><br><span class="line">输出：<span class="number">15</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'With a moo-moo here, and a moo-moo there'</span>.find(<span class="string">'moo'</span>)</span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>title = <span class="string">"Monty Python's Flying Circus"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>title.find(<span class="string">'Monty'</span>)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>title.find(<span class="string">'Python'</span>)</span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>title.find(<span class="string">'Flying'</span>)</span><br><span class="line"><span class="number">15</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>title.find(<span class="string">'Zirquss'</span>)</span><br><span class="line"><span class="number">-1</span></span><br><span class="line"><span class="comment"># find在字符串中查找子串。如果找到，就返回子串的第一个字符的索引，否则返回-1。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject = <span class="string">'$$$ Get rich now!!! $$$'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject.find(<span class="string">'$$$'</span>)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="comment"># 使用find查找在subject字符串中的$$$，字符串方法find返回的并非布尔值。如果find像这样返回0，就意味着它在索引0处找到了指定的子串。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject = <span class="string">'$$$ Get rich now!!! $$$'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject.find(<span class="string">'$$$'</span>)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject.find(<span class="string">'$$$'</span>, <span class="number">1</span>) </span><br><span class="line"><span class="number">20</span></span><br><span class="line"><span class="comment"># 只指定了起点</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject.find(<span class="string">'!!!'</span>)</span><br><span class="line"><span class="number">16</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject.find(<span class="string">'!!!'</span>, <span class="number">0</span>, <span class="number">16</span>) </span><br><span class="line"><span class="number">-1</span></span><br><span class="line"><span class="comment"># 同时指定了起点和终点</span></span><br><span class="line"><span class="comment"># 起点和终点值(第二个和第三个参数)指定的搜索范围包含起点，但不包含终点。前包后不包</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># index(sub[, start[, end]]) -&gt; int</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start, end)，从左至右，查找子串sub。找到返回索引，没找到抛出异常ValueError</span></span><br><span class="line"><span class="comment"># rindex(sub[, start[, end]]) -&gt; int</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start, end)，从左至右，查找子串sub。找到返回索引，没找到抛出异常ValueError</span></span><br><span class="line"><span class="comment"># 这两个函数与上面两个不同之处就是会抛出异常。</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.index(<span class="string">'very'</span>)</span><br><span class="line">输出：<span class="number">5</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.index(<span class="string">'very'</span>, <span class="number">5</span>)</span><br><span class="line">输出：<span class="number">5</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.index(<span class="string">'very'</span>, <span class="number">6</span>, <span class="number">13</span>)</span><br><span class="line">输出：---------------------------------------------------------------------------</span><br><span class="line">ValueError                                Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-19</span><span class="number">-2</span>b0e56ce0749&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">1</span> s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">----&gt; 2 s.index('very', 6, 13)</span><br><span class="line"></span><br><span class="line">ValueError: substring <span class="keyword">not</span> found</span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.rindex(<span class="string">'very'</span>, <span class="number">10</span>)</span><br><span class="line">输出：<span class="number">15</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.rindex(<span class="string">'very'</span>, <span class="number">10</span>, <span class="number">15</span>)</span><br><span class="line">输出：<span class="number">10</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.rindex(<span class="string">'very'</span>,<span class="number">-10</span>,<span class="number">-1</span>)</span><br><span class="line">输出：<span class="number">15</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 时间复杂度</span></span><br><span class="line">	<span class="comment"># index和count方法都是O(n)</span></span><br><span class="line">	<span class="comment"># 随着列表数据规模的增大,而效率下降</span></span><br><span class="line"><span class="comment"># len(string)</span></span><br><span class="line">	<span class="comment"># 返回字符串的长度,即字符的个数</span></span><br><span class="line"><span class="comment"># count(sub[, start[, end]]) -&gt; int</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start, end),从左至右,统计子串sub出现的次数</span></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.count(<span class="string">'very'</span>)</span><br><span class="line">输出：<span class="number">3</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.count(<span class="string">'very'</span>, <span class="number">5</span>)</span><br><span class="line">输出：<span class="number">3</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.count(<span class="string">'very'</span>, <span class="number">10</span>, <span class="number">14</span>)</span><br><span class="line">输出：<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串判断"><a href="#字符串判断" class="headerlink" title="* 字符串判断"></a>* 字符串判断</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># endswith(suffix[, start[, end]]) -&gt; bool</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start, end)，字符串是否是suffix结尾</span></span><br><span class="line"><span class="comment"># startswith(prefix[, start[, end]]) -&gt; bool</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start, end)，字符串是否是prefix开头</span></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.startswith(<span class="string">'very'</span>)</span><br><span class="line">输出：<span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.startswith(<span class="string">'very'</span>, <span class="number">5</span>)</span><br><span class="line">输出：<span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.startswith(<span class="string">'very'</span>, <span class="number">5</span>, <span class="number">9</span>)</span><br><span class="line">输出：<span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.endswith(<span class="string">'very'</span>, <span class="number">5</span>, <span class="number">9</span>)</span><br><span class="line">输出：<span class="keyword">True</span></span><br><span class="line"><span class="comment"># 因为第一个very是从索引5到索引8，所以上面的命令涵盖了这个区间，所以无论是startswith还是</span></span><br><span class="line"><span class="comment"># endswith都返回True</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.endswith(<span class="string">'sorry'</span>, <span class="number">5</span>)</span><br><span class="line">输出：<span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.endswith(<span class="string">'sorry'</span>, <span class="number">5</span>, <span class="number">-1</span>)</span><br><span class="line">输出：<span class="keyword">False</span></span><br><span class="line"><span class="comment"># 因为是前包后不包，所以索引是-1是不行的，就不能从尾部找到sorry了。</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.endswith(<span class="string">'sorry'</span>, <span class="number">5</span>, <span class="number">100</span>)</span><br><span class="line">输出：<span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串判断-is系列"><a href="#字符串判断-is系列" class="headerlink" title="字符串判断 is系列"></a>字符串判断 is系列</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># isalnum() -&gt; bool 是否是字母和数字组成</span></span><br><span class="line"><span class="comment"># isalpha() 是否是字母</span></span><br><span class="line"><span class="comment"># isdecimal() 是否只包含十进制数字</span></span><br><span class="line"><span class="comment"># isdigit() 是否全部数字(0~9)</span></span><br><span class="line"><span class="comment"># isidentifier() 是不是字母和下划线开头,其他都是字母、数字、下划线</span></span><br><span class="line"><span class="comment"># islower() 是否都是小写</span></span><br><span class="line"><span class="comment"># isupper() 是否全部大写</span></span><br><span class="line"><span class="comment"># isspace() 是否只包含空白字符</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串格式化"><a href="#字符串格式化" class="headerlink" title="*** 字符串格式化"></a>*** 字符串格式化</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字符串的格式化是一种拼接字符串输出样式的手段，更灵活方便</span></span><br><span class="line">	<span class="comment"># join拼接只能使用分隔符，且要求被拼接的是可迭代对象</span></span><br><span class="line">	<span class="comment"># + 拼接字符串还算方便，但是非字符串需要先转换为字符串才能拼接</span></span><br><span class="line"><span class="comment"># 在2.5版本之前，只能使用printf style风格的print输出</span></span><br><span class="line">	<span class="comment"># printf-style formatting，来自于C语言的printf函数</span></span><br><span class="line">	<span class="comment"># 格式要求</span></span><br><span class="line">		<span class="comment"># 占位符:使用%和格式字符组成，例如%s、%d等</span></span><br><span class="line">			<span class="comment"># s调用str()，r会调用repr()。所有对象都可以被这两个转换。</span></span><br><span class="line">		<span class="comment"># 占位符中还可以插入修饰字符，例如%03d表示打印3个位置，不够前面补零</span></span><br><span class="line">		<span class="comment"># format % values，格式字符串和被格式的值之间使用%分隔</span></span><br><span class="line">		<span class="comment"># values只能是一个对象，或是一个和格式字符串占位符数目相等的元组，或一个字典</span></span><br><span class="line"><span class="comment"># printf-style formatting 举例</span></span><br><span class="line"><span class="string">"I am %03d"</span> % (<span class="number">20</span>,)</span><br><span class="line">输出：<span class="string">'I am 020'</span></span><br><span class="line"></span><br><span class="line"><span class="string">'I like %s.'</span> % <span class="string">'Python'</span></span><br><span class="line">输出：<span class="string">'I like Python.'</span></span><br><span class="line"></span><br><span class="line"><span class="string">'%3.2f%% , 0x%x, 0X%02X'</span> % (<span class="number">89.7654</span>, <span class="number">10</span>, <span class="number">15</span>)</span><br><span class="line">输出：<span class="string">'89.77% , 0xa, 0X0F'</span></span><br><span class="line"></span><br><span class="line"><span class="string">"I am %-5d"</span> % (<span class="number">20</span>,)</span><br><span class="line">输出：<span class="string">'I am 20   '</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># format函数格式字符串语法——Python鼓励使用</span></span><br><span class="line">	<span class="comment"># "&#123;&#125; &#123;xxx&#125;".format(*args, **kwargs) -&gt; str</span></span><br><span class="line">	<span class="comment"># args是位置参数,是一个元组</span></span><br><span class="line">	<span class="comment"># kwargs是关键字参数,是一个字典</span></span><br><span class="line">	<span class="comment"># 花括号表示占位符</span></span><br><span class="line">	<span class="comment"># &#123;&#125;表示按照顺序匹配位置参数,&#123;n&#125;表示取位置参数索引为n的值</span></span><br><span class="line">	<span class="comment"># &#123;xxx&#125;表示在关键字参数中搜索名称一致的</span></span><br><span class="line">	<span class="comment"># &#123;&#123;&#125;&#125; 表示打印花括号</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 位置参数</span></span><br><span class="line"><span class="string">"&#123;&#125;:&#123;&#125;"</span>.format(<span class="string">'192.168.1.100'</span>,<span class="number">8888</span>)</span><br><span class="line">输出：<span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span>:<span class="number">8888</span></span><br><span class="line"><span class="comment"># 这就是按照位置顺序用位置参数替换前面的格式字符串的占位符中</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关键字参数或命名参数</span></span><br><span class="line"><span class="string">"&#123;server&#125; &#123;1&#125;:&#123;0&#125;"</span>.format(<span class="number">8888</span>, <span class="string">'192.168.1.100'</span>, server=<span class="string">'Web Server Info : '</span>) </span><br><span class="line">输出：Web Server Info :  <span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span>:<span class="number">8888</span></span><br><span class="line"><span class="comment"># 位置参数按照序号匹配，关键字参数按照名词匹配</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问元素</span></span><br><span class="line"><span class="string">"&#123;0[0]&#125;.&#123;0[1]&#125;"</span>.format((<span class="string">'magedu'</span>,<span class="string">'com'</span>))</span><br><span class="line">输出：magedu.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对象属性访问</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line">Point = namedtuple(<span class="string">'_Point'</span>,<span class="string">'x y'</span>)</span><br><span class="line">p = Point(<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line"><span class="string">"&#123;&#123;&#123;0.x&#125;,&#123;0.y&#125;&#125;&#125;"</span>.format(p)</span><br><span class="line">输出：<span class="string">'&#123;4,5&#125;'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对齐</span></span><br><span class="line"><span class="string">'&#123;0&#125;*&#123;1&#125;=&#123;2:&lt;2&#125;'</span>.format(<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>*<span class="number">3</span>)</span><br><span class="line">输出：<span class="number">3</span>*<span class="number">2</span>=<span class="number">6</span> </span><br><span class="line"><span class="string">'&#123;0&#125;*&#123;1&#125;=&#123;2:&lt;02&#125;'</span>.format(<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>*<span class="number">3</span>)</span><br><span class="line">输出：<span class="number">3</span>*<span class="number">2</span>=<span class="number">60</span></span><br><span class="line"><span class="string">'&#123;0&#125;*&#123;1&#125;=&#123;2:&gt;02&#125;'</span>.format(<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>*<span class="number">3</span>)</span><br><span class="line">输出：<span class="number">3</span>*<span class="number">2</span>=<span class="number">06</span></span><br><span class="line"><span class="string">'&#123;:^30&#125;'</span>.format(<span class="string">'centered'</span>)</span><br><span class="line">输出：           centered           </span><br><span class="line"><span class="string">'&#123;:*^30&#125;'</span>.format(<span class="string">'centered'</span>)</span><br><span class="line">输出：***********centered***********</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进制</span></span><br><span class="line"><span class="string">"int: &#123;0:d&#125;; hex: &#123;0:x&#125;; oct: &#123;0:o&#125;; bin: &#123;0:b&#125;"</span>.format(<span class="number">42</span>)</span><br><span class="line">输出：int: <span class="number">42</span>; hex: <span class="number">2</span>a; oct: <span class="number">52</span>; bin: <span class="number">101010</span></span><br><span class="line">                </span><br><span class="line"><span class="string">"int: &#123;0:d&#125;; hex: &#123;0:#x&#125;; oct: &#123;0:#o&#125;; bin: &#123;0:#b&#125;"</span>.format(<span class="number">42</span>)</span><br><span class="line">输出：int: <span class="number">42</span>; hex: <span class="number">0x2a</span>; oct: <span class="number">0o52</span>; bin: <span class="number">0b101010</span></span><br><span class="line">                </span><br><span class="line">octets = [<span class="number">192</span>, <span class="number">168</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"><span class="string">'&#123;:02X&#125;&#123;:02X&#125;&#123;:02X&#125;&#123;:02X&#125;'</span>.format(*octets)</span><br><span class="line">输出：C0A80001</span><br><span class="line"><span class="comment"># *号表示参数解构，依次将每个元素分解开。X表示转为16进制</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>format = <span class="string">"Hello, %s. %s enough for ya?"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>values = (<span class="string">'world'</span>, <span class="string">'Hot'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>format % values</span><br><span class="line"><span class="string">'Hello, world. Hot enough for ya?'</span></span><br><span class="line"><span class="comment"># 在%左边指定一个字符串(格式字符串)，并在右边指定要设置其格式的值。指定要设置其格式的值时，可使用单个值(如字符串或数字)，可使用元组(如果要设置多个值的格式)，还可使用字典，其中最常见的是元组。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>format = <span class="string">"Hello, %s. %s enough for ya?"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>values = (<span class="string">'world'</span>, <span class="string">'Hot'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>format % values</span><br><span class="line"><span class="string">'Hello, world. Hot enough for ya?'</span></span><br><span class="line"><span class="comment"># 上述格式字符串中的%s称为转换说明符，指出了要将值插入什么地方。s意味着将值视为字符串进行格式设置。如果指定的值不是字符串，将使用str将其转换为字符串。其他说明符将导致其他形式的转换。例如，%.3f将值的格式设置为包含3位小数的浮点数。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> string <span class="keyword">import</span> Template</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tmpl = Template(<span class="string">"Hello, $who! $what enough for ya?"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tmpl.substitute(who=<span class="string">"Mars"</span>, what=<span class="string">"Dusty"</span>)</span><br><span class="line"><span class="string">'Hello, Mars! Dusty enough for ya?'</span></span><br><span class="line"><span class="comment"># 包含等号的参数称为关键字参数。在字符串格式设置中，可将关键字参数视为一种向命名替换字段提供值的方式。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;&#125;, &#123;&#125; and &#123;&#125;"</span>.format(<span class="string">"first"</span>, <span class="string">"second"</span>, <span class="string">"third"</span>)</span><br><span class="line"><span class="string">'first, second and third'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;0&#125;, &#123;1&#125; and &#123;2&#125;"</span>.format(<span class="string">"first"</span>, <span class="string">"second"</span>, <span class="string">"third"</span>)</span><br><span class="line"><span class="string">'first, second and third'</span></span><br><span class="line"><span class="comment"># 在最简单的情况下，替换字段没有名称或将索引用作名称。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;3&#125; &#123;0&#125; &#123;2&#125; &#123;1&#125; &#123;3&#125; &#123;0&#125;"</span>.format(<span class="string">"be"</span>, <span class="string">"not"</span>, <span class="string">"or"</span>, <span class="string">"to"</span>)</span><br><span class="line"><span class="string">'to be or not to be'</span></span><br><span class="line"><span class="comment"># 索引无需按顺序排列</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> math <span class="keyword">import</span> pi</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;name&#125; is approximately &#123;value:.2f&#125;."</span>.format(value=pi, name=<span class="string">"π"</span>)</span><br><span class="line"><span class="string">'π is approximately 3.14.'</span></span><br><span class="line"><span class="comment"># 关键字参数的排列顺序无关紧要。在这里，我还指定了格式说明符.2f，并使用冒号将其与字段名隔开。它意味着要使用包含2位小数的浮点数格式。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;name&#125; is approximately &#123;value&#125;."</span>.format(value=pi, name=<span class="string">"π"</span>)</span><br><span class="line"><span class="string">'π is approximately 3.141592653589793.'</span></span><br><span class="line"><span class="comment"># 没有指定.2f的结果</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> math <span class="keyword">import</span> e</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">f"Euler's constant is roughly <span class="subst">&#123;e&#125;</span>."</span></span><br><span class="line"><span class="string">"Euler's constant is roughly 2.718281828459045."</span></span><br><span class="line"><span class="comment"># 如果变量与替换字段同名，可使用f字符串——在字符串前面加上f。创建最终的字符串时，将把替换字段e替换为变量e的值。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"Euler's constant is roughly &#123;e&#125;."</span>.format(e=e)</span><br><span class="line"><span class="string">"Euler's constant is roughly 2.718281828459045."</span></span><br><span class="line"><span class="comment"># 此命令与上面的命令效果是一样的。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;&#123;ceci n'est pas une replacement field&#125;&#125;"</span>.format()</span><br><span class="line"><span class="string">"&#123;ceci n'est pas une replacement field&#125;"</span></span><br><span class="line"><span class="comment"># 要在最终结果中包含花括号，可在格式字符串中使用两个花括号(即&#123;&#123;或 &#125;&#125;)来指定。</span></span><br><span class="line">============================================================================================</span><br><span class="line">在格式字符串中，最激动人心的部分为替换字段。替换字段由如下部分组成，其中每个部分都是可选的。</span><br><span class="line">* 字段名：索引或标识符，指出要设置哪个值的格式并使用结果来替换该字段。除指定值外，还可指定值的特定部分，如列表的元素。</span><br><span class="line">* 转换标志：跟在叹号后面的单个字符。当前支持的字符包括r(表示repr) 、s(表示str)和a(表示ascii)。如果你指定了转换标志，将不使用对象本身的格式设置机制，而是使用指定的函数将对象转换为字符串，再做进一步的格式设置。</span><br><span class="line">* 格式说明符：跟在冒号后面的表达式(这种表达式是使用微型格式指定语言表示的) 。格式说明符让我们能够详细地指定最终的格式，包括格式类型(如字符串、浮点数或十六进制数)，字段宽度和数的精度，如何显示符号和千位分隔符，以及各种对齐和填充方式。</span><br><span class="line">============================================================================================</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;foo&#125; &#123;&#125; &#123;bar&#125; &#123;&#125;"</span>.format(<span class="number">1</span>, <span class="number">2</span>, bar=<span class="number">4</span>, foo=<span class="number">3</span>)</span><br><span class="line"><span class="string">'3 1 4 2'</span></span><br><span class="line"><span class="comment"># 还可通过索引来指定要在哪个字段中使用相应的未命名参数，这样可不按顺序使用未命名参数。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;foo&#125; &#123;1&#125; &#123;bar&#125; &#123;0&#125;"</span>.format(<span class="number">1</span>, <span class="number">2</span>, bar=<span class="number">4</span>, foo=<span class="number">3</span>)</span><br><span class="line"><span class="string">'3 2 4 1'</span></span><br><span class="line"><span class="comment"># 不能同时使用手工编号和自动编号，因为这样很快会变得混乱不堪。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fullname = [<span class="string">"Alfred"</span>, <span class="string">"Smoketoomuch"</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"Mr &#123;name[1]&#125;"</span>.format(name=fullname)</span><br><span class="line"><span class="string">'Mr Smoketoomuch'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tmpl = <span class="string">"The &#123;mod.__name__&#125; module defines the value &#123;mod.pi&#125; for π"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tmpl.format(mod=math)</span><br><span class="line"><span class="string">'The math module defines the value 3.141592653589793 for π'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"&#123;pi!s&#125; &#123;pi!r&#125; &#123;pi!a&#125;"</span>.format(pi=<span class="string">"π"</span>))</span><br><span class="line">π <span class="string">'π'</span> <span class="string">'\u03c0'</span></span><br><span class="line"><span class="comment"># 上述三个标志(s、r和a)指定分别使用str、repr和ascii进行转换。函数str通常创建外观普通的字符串版本(这里没有对输入字符串做任何处理)。函数 repr 尝试创建给定值的Python表示(这里是一个字符串字面量)。函数 ascii创建只包含ASCII字符的表示</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"The number is &#123;num&#125;"</span>.format(num=<span class="number">42</span>)</span><br><span class="line"><span class="string">'The number is 42'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"The number is &#123;num:f&#125;"</span>.format(num=<span class="number">42</span>)</span><br><span class="line"><span class="string">'The number is 42.000000'</span></span><br><span class="line"><span class="comment"># 可指定要转换的值是哪种类型，更准确地说，是要将其视为哪种类型。例如，上面命令提供一个整数，但将其作为小数进行处理。为此可在格式说明(即冒号后面)使用字符f(表示定点数) 。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"The number is &#123;num:b&#125;"</span>.format(num=<span class="number">42</span>)</span><br><span class="line"><span class="string">'The number is 101010'</span></span><br><span class="line"><span class="comment"># 作为二进制数进行处理</span></span><br><span class="line"></span><br><span class="line">============================================================================================</span><br><span class="line">类型			含义</span><br><span class="line">b			将整数表示为二进制数</span><br><span class="line">c			将整数解读为Unicode码点</span><br><span class="line">d			将整数视为十进制数进行处理，这是整数默认使用的说明符</span><br><span class="line">e			使用科学表示法来表示小数(用e来表示指数)</span><br><span class="line">E			与e相同，但使用E来表示指数</span><br><span class="line">f			将小数表示为定点数</span><br><span class="line">F			与 f相同，但对于特殊值(nan和 inf)，使用大写表示</span><br><span class="line">g			自动在定点表示法和科学表示法之间做出选择。这是默认用于小数的说明符，但在默认情况下至少有<span class="number">1</span>位小数</span><br><span class="line">G			与 g相同，但使用大写来表示指数和特殊值</span><br><span class="line">n			与 g相同，但插入随区域而异的数字分隔符</span><br><span class="line">o			将整数表示为八进制数</span><br><span class="line">s			保持字符串的格式不变，这是默认用于字符串的说明符</span><br><span class="line">x			将整数表示为十六进制数并使用小写字母</span><br><span class="line">X			与 x相同，但使用大写字母</span><br><span class="line">%			将数表示为百分比值(乘以<span class="number">100</span>，按说明符 f设置格式，再在后面加上%)</span><br><span class="line">============================================================================================</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;num:10&#125;"</span>.format(num=<span class="number">3</span>)</span><br><span class="line"><span class="string">'          3'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;name:10&#125;"</span>.format(name=<span class="string">"Bob"</span>)</span><br><span class="line"><span class="string">'Bob          '</span></span><br><span class="line"><span class="comment"># 宽度是使用整数指定的。数和字符串的对齐方式不同。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"Pi day is &#123;pi:.2f&#125;"</span>.format(pi=pi)</span><br><span class="line"><span class="string">'Pi day is 3.14'</span></span><br><span class="line"><span class="comment"># 精度也是使用整数指定的，但需要在它前面加上一个表示小数点的句点。这里显式地指定了类型f，因为默认的精度处理方式稍有不同</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;pi:10.2f&#125;"</span>.format(pi=pi)</span><br><span class="line"><span class="string">'          3.14'</span></span><br><span class="line"><span class="comment"># 同时指定宽度和精度</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;:.5&#125;"</span>.format(<span class="string">"Guido van Rossum"</span>)</span><br><span class="line"><span class="string">'Guido'</span></span><br><span class="line"><span class="comment"># 对于其他类型也可指定精度，但是这样做的情形不太常见。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'One googol is &#123;:,&#125;'</span>.format(<span class="number">10</span>**<span class="number">100</span>)</span><br><span class="line"><span class="string">'One googol is 10,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,00</span></span><br><span class="line"><span class="string">0,000,000,000,000,000,000,000,000,000,000,000,000,000,000'</span></span><br><span class="line"><span class="comment"># 使用逗号来指出你要添加千位分隔符</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;:010.2f&#125;'</span>.format(pi)</span><br><span class="line"><span class="string">'0000003.14'</span></span><br><span class="line"><span class="comment"># 在指定宽度和精度的数前面，可添加一个标志。这个标志可以是零、加号、减号或空格，其中零表示使用0来填充数字。</span></span><br><span class="line"><span class="comment"># &#123;:010.2f&#125;指定一共有10位，小数点有两位，前面不足的地方用0填充。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;0:&lt;10.2f&#125;\n&#123;0:^10.2f&#125;\n&#123;0:&gt;10.2f&#125;'</span>.format(pi))</span><br><span class="line"><span class="number">3.14</span></span><br><span class="line">	   <span class="number">3.14</span></span><br><span class="line">	 		<span class="number">3.14</span></span><br><span class="line"><span class="comment"># 指定左对齐、右对齐和居中，可分别使用&lt;、&gt;和^</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;:$^15&#125;"</span>.format(<span class="string">" WIN BIG "</span>)</span><br><span class="line"><span class="string">'$$$ WIN BIG $$$'</span></span><br><span class="line"><span class="comment"># &#123;:$^15&#125;表示一共15位，空格也算，不足的地方用$填充。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;0:10.2f&#125;\n&#123;1:10.2f&#125;'</span>.format(pi, -pi))</span><br><span class="line">            <span class="number">3.14</span></span><br><span class="line">          <span class="number">-3.14</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;0:10.2f&#125;\n&#123;1:=10.2f&#125;'</span>.format(pi, -pi))</span><br><span class="line">            <span class="number">3.14</span></span><br><span class="line">-          <span class="number">3.14</span></span><br><span class="line"><span class="comment"># 指定将填充字符放在符号和数字之间。&#123;1:=10.2f&#125;表示索引为1的元素</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;0:-.2&#125;\n&#123;1:-.2&#125;'</span>.format(pi, -pi)) <span class="comment">#默认设置</span></span><br><span class="line"><span class="number">3.1</span></span><br><span class="line"><span class="number">-3.1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;0:+.2&#125;\n&#123;1:+.2&#125;'</span>.format(pi, -pi))</span><br><span class="line">+<span class="number">3.1</span></span><br><span class="line"><span class="number">-3.1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;0: .2&#125;\n&#123;1: .2&#125;'</span>.format(pi, -pi))</span><br><span class="line"><span class="number">3.1</span></span><br><span class="line"><span class="number">-3.1</span></span><br><span class="line"><span class="comment"># 要给正数加上符号，可使用说明符+(将其放在对齐说明符后面)，而不是默认的-。如果将符号说明符指定为空格，会在正数前面加上空格而不是+。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;:b&#125;"</span>.format(<span class="number">42</span>)</span><br><span class="line"><span class="string">'101010'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;:#b&#125;"</span>.format(<span class="number">42</span>)</span><br><span class="line"><span class="string">'0b101010'</span></span><br><span class="line"><span class="comment"># 井号( #)选项，可将其放在符号说明符和宽度之间(如果指定了这两种设置)。这个选项将触发另一种转换方式，转换细节随类型而异。例如，对于二进制、八进制和十六进制转换，将加上一个前缀。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;:g&#125;"</span>.format(<span class="number">42</span>)</span><br><span class="line"><span class="string">'42'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;:#g&#125;"</span>.format(<span class="number">42</span>)</span><br><span class="line"><span class="string">'42.0000'</span></span><br><span class="line"><span class="comment"># 对于各种十进制数,它要求必须包含小数点(对于类型g,它保留小数点后面的零)。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据指定的宽度打印格式良好的价格列表</span></span><br><span class="line">width = int(input(<span class="string">'Please enter width: '</span>))</span><br><span class="line"></span><br><span class="line">price_width = <span class="number">10</span></span><br><span class="line">item_width = width - price_width</span><br><span class="line"></span><br><span class="line">header_fmt = <span class="string">'&#123;&#123;:&#123;&#125;&#125;&#125;&#123;&#123;:&gt;&#123;&#125;&#125;&#125;'</span>.format(item_width, price_width)</span><br><span class="line">fmt = <span class="string">'&#123;&#123;:&#123;&#125;&#125;&#125;&#123;&#123;:&gt;&#123;&#125;.2f&#125;&#125;'</span>.format(item_width, price_width)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'='</span> * width)</span><br><span class="line"></span><br><span class="line">print(header_fmt.format(<span class="string">'Item'</span>, <span class="string">'Price'</span>))</span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span> * width)</span><br><span class="line"></span><br><span class="line">print(fmt.format(<span class="string">'Apples'</span>, <span class="number">0.4</span>))</span><br><span class="line">print(fmt.format(<span class="string">'Pears'</span>, <span class="number">0.5</span>))</span><br><span class="line">print(fmt.format(<span class="string">'Cantaloupes'</span>, <span class="number">1.92</span>))</span><br><span class="line">print(fmt.format(<span class="string">'Dried Apricots (16 oz.)'</span>, <span class="number">8</span>))</span><br><span class="line">print(fmt.format(<span class="string">'Prunes (4 lbs.)'</span>, <span class="number">12</span>))</span><br><span class="line"></span><br><span class="line">print(<span class="string">'='</span> * width)</span><br><span class="line">这个程序的运行情况类似于下面这样:</span><br><span class="line">Please enter width: <span class="number">35</span></span><br><span class="line">===================================</span><br><span class="line">Item						Price</span><br><span class="line">-----------------------------------</span><br><span class="line">Apples						<span class="number">0.40</span></span><br><span class="line">Pears						<span class="number">0.50</span></span><br><span class="line">Cantaloupes					<span class="number">1.92</span></span><br><span class="line">Dried Apricots (<span class="number">16</span> oz.)		<span class="number">8.00</span></span><br><span class="line">Prunes (<span class="number">4</span> lbs.)			   <span class="number">12.00</span></span><br><span class="line">===================================</span><br></pre></td></tr></table></figure>
<h4 id="string模块"><a href="#string模块" class="headerlink" title="string模块"></a>string模块</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">string.digits</span><br><span class="line"><span class="comment"># 包含数字0~9的字符串。</span></span><br><span class="line">string.ascii_letters</span><br><span class="line"><span class="comment"># 包含所有ASCII字母(大写和小写)的字符串。</span></span><br><span class="line">string.ascii_lowercase</span><br><span class="line"><span class="comment"># 包含所有小写ASCII字母的字符串。</span></span><br><span class="line">string.printable</span><br><span class="line"><span class="comment"># 包含所有可打印的ASCII字符的字符串。</span></span><br><span class="line">string.punctuation</span><br><span class="line"><span class="comment"># 包含所有ASCII标点字符的字符串。</span></span><br><span class="line">string.ascii_uppercase</span><br><span class="line"><span class="comment"># 包含所有大写ASCII字母的字符串。</span></span><br><span class="line"><span class="comment"># 虽然说的是ASCII字符，但值实际上是未解码的Unicode字符串。</span></span><br></pre></td></tr></table></figure>
<h4 id="translate（替换字符串）"><a href="#translate（替换字符串）" class="headerlink" title="translate（替换字符串）"></a>translate（替换字符串）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法translate与replace一样替换字符串的特定部分，但不同的是它只能进行单字符替换。这个方法的优势在于能够同时替换多个字符，因此效率比replace高。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>table = str.maketrans(<span class="string">'cs'</span>, <span class="string">'kz'</span>)</span><br><span class="line"><span class="comment"># 使用translate前必须创建一个转换表。将cs两个字母转换为kz两个字母，字母是单个匹配的。这个转换表指出了不同Unicode码点之间的转换关系。要创建转换表，可对字符串类型str调用方法maketrans，这个方法接受两个参数：两个长度相同的字符串，它们指定要将第一个字符串中的每个字符都替换为第二个字符串中的相应字符。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>table</span><br><span class="line">&#123;<span class="number">115</span>: <span class="number">122</span>, <span class="number">99</span>: <span class="number">107</span>&#125;</span><br><span class="line"><span class="comment"># 查看转换表的内容，但你看到的只是Unicode码点之间的映射。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'this is an incredible test'</span>.translate(table)</span><br><span class="line"><span class="string">'thiz iz an inkredible tezt'</span></span><br><span class="line"><span class="comment"># 创建转换表后，就可将其用作方法translate的参数。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>table = str.maketrans(<span class="string">'cs'</span>, <span class="string">'kz'</span>, <span class="string">' '</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'this is an incredible test'</span>.translate(table)</span><br><span class="line"><span class="string">'thizizaninkredibletezt'</span></span><br><span class="line"><span class="comment"># 调用方法 maketrans时,还可提供可选的第三个参数，指定要将哪些字母删除。上面是将所有的空格删除。</span></span><br></pre></td></tr></table></figure>
<h4 id="判断字符串是否满足特定的条件"><a href="#判断字符串是否满足特定的条件" class="headerlink" title="判断字符串是否满足特定的条件"></a>判断字符串是否满足特定的条件</h4><blockquote>
<p>很多字符串方法都以is打头，如isspace、 isdigit 和isupper，它们判断字符串是否具有特定的性质(如包含的字符全为空白、数字或大写) 。如果字符串具备特定的性质，这些方法就返回True，否则返回False。</p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/21/python基础学习-列表和元组/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/21/python基础学习-列表和元组/" itemprop="url">
                  python基础学习-列表和元组
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-21 13:29:38" itemprop="dateCreated datePublished" datetime="2019-03-21T13:29:38+08:00">2019-03-21</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2020-04-17 17:32:07" itemprop="dateModified" datetime="2020-04-17T17:32:07+08:00">2020-04-17</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><h4 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h4><blockquote>
<p>数据结构是以某种方式(如通过编号)组合起来的数据元素(如数、字符乃至其他数据结构)集合。</p>
</blockquote>
<h4 id="序列"><a href="#序列" class="headerlink" title="序列"></a>序列</h4><blockquote>
<p>在Python中，最基本的数据结构为序列(sequence) 。序列中的每个元素都有编号，即其位置或索引，其中第一个元素的索引为0，第二个元素的索引为1，依此类推。Python内置了多种序列，如列表、元组、字符串。列表和元组的主要不同在于，列表是可以修改的，而元组不可以。</p>
</blockquote>
<h5 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一个队列，一个排列整齐的队伍</span></span><br><span class="line"><span class="comment"># 列表内的个体称作元素，由若干元素组成列表</span></span><br><span class="line"><span class="comment"># 元素可以是任意对象（数字、字符串、对象、列表等）</span></span><br><span class="line"><span class="comment"># 列表内元素有顺序，可以使用索引</span></span><br><span class="line"><span class="comment"># 线性的数据结构</span></span><br><span class="line"><span class="comment"># 使用[]表示</span></span><br><span class="line"><span class="comment"># 列表是可变的</span></span><br><span class="line"><span class="comment"># 列表list、链表、queue、stack的差异</span></span><br><span class="line"><span class="comment"># 列表不能一开始就定义大小</span></span><br><span class="line">list()</span><br><span class="line"><span class="comment"># 定义一个空列表</span></span><br><span class="line">list(iterable)</span><br><span class="line"><span class="comment"># 从可交互项初始化的新列表</span></span><br><span class="line">例</span><br><span class="line">lst = list()</span><br><span class="line"><span class="comment"># list()中需要是一个可迭代序列，如range()。或一个列表，如list([1,2])，不能使用list(2)这样的方法来定义，会提示int是不可迭代的</span></span><br><span class="line">lst = []</span><br><span class="line">lst = [<span class="number">2</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="string">'ab'</span>]</span><br><span class="line">lst = list(range(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>edward = [<span class="string">'Edward Gumby'</span>, <span class="number">42</span>]</span><br><span class="line"><span class="comment"># 使用列表来表示</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>edward = [<span class="string">'Edward Gumby'</span>, <span class="number">42</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>john = [<span class="string">'John Smith'</span>, <span class="number">50</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>database = [edward, john]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>database</span><br><span class="line">[[<span class="string">'Edward Gumby'</span>, <span class="number">42</span>], [<span class="string">'John Smith'</span>, <span class="number">50</span>]]</span><br><span class="line"><span class="comment"># 序列还可包含其他序列，上面是创建一个由数据库中所有人员组成的列表。Python支持一种数据结构的基本概念，名为容器(container)。容器基本上就是可包含其他对象的对象。两种主要的容器是序列(如列表和元组)和映射(如字典) 。在序列中，每个元素都有编号，而在映射中，每个元素都有名称(也叫键)。</span></span><br></pre></td></tr></table></figure>
<h4 id="数字的处理函数"><a href="#数字的处理函数" class="headerlink" title="数字的处理函数"></a>数字的处理函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">round()</span><br><span class="line"><span class="comment"># 这个函数是四舍六入五取偶的</span></span><br><span class="line">floor()</span><br><span class="line"><span class="comment"># 这个函数是向下取整的</span></span><br><span class="line">ceil()</span><br><span class="line"><span class="comment"># 这个函数是向上取整的</span></span><br><span class="line">int()</span><br><span class="line"><span class="comment"># 这个函数是取整数部分的</span></span><br><span class="line">//</span><br><span class="line"><span class="comment"># 整除且向下取整</span></span><br><span class="line"><span class="comment"># python只有长整型，数值没有上限。int也是取整的，如int(1.5)，得1。floor是向下取整的。ceil是向上取整的。round是4舍6入5取偶。 bin是二进制，返回的是字符串。oct是八进制。pi是派。 </span></span><br><span class="line">bin()</span><br><span class="line">oct()</span><br><span class="line">hex()</span><br><span class="line"><span class="comment"># 上面三个是进制函数，返回值是字符串</span></span><br><span class="line">math.pi</span><br><span class="line"><span class="comment"># 派</span></span><br><span class="line">math.e</span><br><span class="line"><span class="comment"># 自然常数</span></span><br></pre></td></tr></table></figure>
<h4 id="类型判断"><a href="#类型判断" class="headerlink" title="类型判断"></a>类型判断</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">type(a) == str </span><br><span class="line"><span class="comment"># 这是类型比较的方式</span></span><br><span class="line">type(obj)</span><br><span class="line"><span class="comment"># 返回类型，而不是字符串</span></span><br><span class="line">isinstance(obj,class_or_tuple)</span><br><span class="line"><span class="comment"># 返回布尔值</span></span><br><span class="line">例：</span><br><span class="line">type(a)</span><br><span class="line">type(<span class="string">'abc'</span>)</span><br><span class="line">type(<span class="number">123</span>)</span><br><span class="line">isinstance(<span class="number">6</span>,str)</span><br><span class="line">isinstance(<span class="number">6</span>,(str,bool,int))</span><br><span class="line">type(<span class="number">1</span>+<span class="keyword">True</span>)</span><br><span class="line">type(<span class="number">1</span>+<span class="keyword">True</span>+<span class="number">2.0</span>)</span><br></pre></td></tr></table></figure>
<h3 id="通用的序列操作"><a href="#通用的序列操作" class="headerlink" title="通用的序列操作"></a>通用的序列操作</h3><h4 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 索引，也叫下标</span></span><br><span class="line"><span class="comment"># 正索引：从左至右，从0开始，为列表中每一个元素编号</span></span><br><span class="line"><span class="comment"># 负索引：从右至左，从-1开始</span></span><br><span class="line"><span class="comment"># 正负索引不可以超界，否则引发异常IndexError</span></span><br><span class="line"><span class="comment"># 为了理解方便，可以认为列表是从左至右排列的，左边是头部，右边是尾部，左边是下界，右边是上界</span></span><br><span class="line"><span class="comment"># 列表通过索引访问</span></span><br><span class="line"><span class="comment"># list[index]，index就是索引，使用中括号访问</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>greeting = <span class="string">'Hello'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>greeting[<span class="number">0</span>]</span><br><span class="line"><span class="string">'H'</span></span><br><span class="line"><span class="comment"># 字符串就是由字符组成的序列。索引0指向第一个元素,这里为字母H。Python没有专门用于表示字符的类型，因此一个字符就是只包含一个元素的字符串。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>greeting[<span class="number">-1</span>]</span><br><span class="line"><span class="string">'o'</span></span><br><span class="line"><span class="comment"># 当你使用负数索引时，Python将从右(即从最后一个元素)开始往左数，因此-1是最后一个元素的位置。对于字符串字面量(以及其他的序列字面量)，可直接对其执行索引操作,无需先将其赋给变量。这与先赋给变量再对变量执行索引操作的效果是一样的。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'Hello'</span>[<span class="number">1</span>]</span><br><span class="line"><span class="string">'e'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fourth = input(<span class="string">'Year: '</span>)[<span class="number">3</span>]</span><br><span class="line">Year: <span class="number">2005</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fourth</span><br><span class="line"><span class="string">'5'</span></span><br><span class="line"><span class="comment"># 如果函数调用返回一个序列，可直接对其执行索引操作。例如：如果你只想获取用户输入的年份的第4位</span></span><br><span class="line"></span><br><span class="line">months = [</span><br><span class="line"><span class="string">'January'</span>,</span><br><span class="line"><span class="string">'February'</span>,</span><br><span class="line"><span class="string">'March'</span>,</span><br><span class="line"><span class="string">'April'</span>,</span><br><span class="line"><span class="string">'May'</span>,</span><br><span class="line"><span class="string">'June'</span>,</span><br><span class="line"><span class="string">'July'</span>,</span><br><span class="line"><span class="string">'August'</span>,</span><br><span class="line"><span class="string">'September'</span>,</span><br><span class="line"><span class="string">'October'</span>,</span><br><span class="line"><span class="string">'November'</span>,</span><br><span class="line"><span class="string">'December'</span></span><br><span class="line">]</span><br><span class="line">endings = [<span class="string">'st'</span>, <span class="string">'nd'</span>, <span class="string">'rd'</span>] + <span class="number">17</span> * [<span class="string">'th'</span>] \</span><br><span class="line">+ [<span class="string">'st'</span>, <span class="string">'nd'</span>, <span class="string">'rd'</span>] + <span class="number">7</span> * [<span class="string">'th'</span>] \</span><br><span class="line">+ [<span class="string">'st'</span>]</span><br><span class="line"><span class="comment"># 这是一个列表的拼接，st,nd,rd表示1,2,3号，4-20使用th，之后只要有1,2,3就要用st,nd,rd表示，其他用th表示</span></span><br><span class="line">year= input(<span class="string">'Year: '</span>)</span><br><span class="line">month= input(<span class="string">'Month (1-12): '</span>)</span><br><span class="line">day= input(<span class="string">'Day (1-31): '</span>)</span><br><span class="line">month_number = int(month)</span><br><span class="line">day_number = int(day)</span><br><span class="line">month_name = months[month_number<span class="number">-1</span>]</span><br><span class="line">ordinal = day + endings[day_number<span class="number">-1</span>]</span><br><span class="line"><span class="comment"># 将表示月和日的数要减1，这样才能得到正确的索引。因为months是一个列表，其索引是从0开始的，所以要减1。</span></span><br><span class="line">print(month_name + <span class="string">' '</span> + ordinal + <span class="string">', '</span> + year)</span><br><span class="line">上面的程序执行结果如下：</span><br><span class="line">Year: <span class="number">1974</span></span><br><span class="line">Month (<span class="number">1</span><span class="number">-12</span>): <span class="number">8</span></span><br><span class="line">Day (<span class="number">1</span><span class="number">-31</span>): <span class="number">16</span></span><br><span class="line">August <span class="number">16</span>th, <span class="number">1974</span></span><br></pre></td></tr></table></figure>
<h4 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 需要注意：使用切片方法时，切片中指定的第一个索引值是一定会取的，第二个元素不一定取得到。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tag = <span class="string">'&lt;a href="http://www.python.org"&gt;Python web site&lt;/a&gt;'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tag[<span class="number">9</span>:<span class="number">30</span>]</span><br><span class="line"><span class="string">'http://www.python.org'</span></span><br><span class="line"><span class="comment"># 这是提取tag变量索引9到29的值</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tag[<span class="number">32</span>:<span class="number">-4</span>]</span><br><span class="line"><span class="string">'Python web site'</span></span><br><span class="line"><span class="comment"># 提取tag变量索引32到倒数第5个的值。中括号中的数字是前包后不包的。也就是第一个索引指定的元素包含在切片内，但第二个索引指定的元素不包含在切片内。如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">3</span>:<span class="number">6</span>] </span><br><span class="line">[<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">0</span>:<span class="number">1</span>] </span><br><span class="line">[<span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">7</span>:<span class="number">10</span>]</span><br><span class="line">[<span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="comment"># 首先明确指定从第8个元素开始取值，在这里，索引10指的是第11个元素，它并不存在，但确实是到达最后一个元素后再前进一步所处的位置。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">-3</span>:<span class="number">-1</span>]</span><br><span class="line">[<span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"><span class="comment"># 从倒数第3个元素取到倒数第二个元素</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">-3</span>:<span class="number">0</span>]</span><br><span class="line">[]</span><br><span class="line"><span class="comment"># 如果第二个元素使用0，那么结果是一个空。因为执行切片操作时，如果第一个索引指定的元素位于第二个索引指定的元素后面(在这里，倒数第3个元素位于第1个元素后面) ，结果就为空序列。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">-3</span>:]</span><br><span class="line">[<span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="comment"># 如果要取到最后一个元素，可以不写第二个索引的值</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[:<span class="number">3</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment"># 同样，如果索引从第一个元素开始取值，也可以不写第一个元素的值</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[:]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="comment"># 要复制整个序列,可将两个索引都省略。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>url = input(<span class="string">'Please enter the URL:'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>domain = url[<span class="number">11</span>:<span class="number">-4</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"Domain name: "</span> + domain)</span><br><span class="line">Please enter the URL: http://www.python.org</span><br><span class="line">Domain name: python</span><br><span class="line"><span class="comment"># 从类似于http://www.something.com的URL中提取域名</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">0</span>:<span class="number">10</span>:<span class="number">1</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="comment"># 执行切片操作时，你显式或隐式地指定起点和终点，但通常省略另一个参数，即步长。在普通切片中，步长为1。这意味着从一个元素移到下一个元素，因此切片包含起点和终点之间的所有元素。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">0</span>:<span class="number">10</span>:<span class="number">2</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">3</span>:<span class="number">6</span>:<span class="number">3</span>]</span><br><span class="line">[<span class="number">4</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[::<span class="number">4</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line"><span class="comment"># 要从序列中每隔3个元素提取1个，只需提供步长4即可。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">8</span>:<span class="number">3</span>:<span class="number">-1</span>]</span><br><span class="line">[<span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">10</span>:<span class="number">0</span>:<span class="number">-2</span>]</span><br><span class="line">[<span class="number">10</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">0</span>:<span class="number">10</span>:<span class="number">-2</span>]</span><br><span class="line">[]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[::<span class="number">-2</span>]</span><br><span class="line">[<span class="number">10</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">5</span>::<span class="number">-2</span>]</span><br><span class="line">[<span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[:<span class="number">5</span>:<span class="number">-2</span>]</span><br><span class="line">[<span class="number">10</span>, <span class="number">8</span>]</span><br><span class="line"><span class="comment"># 步长不能为0，否则无法向前移动，但可以为负数，即从右向左提取元素。步长为负数时，第一个索引必须比第二个索引大。</span></span><br></pre></td></tr></table></figure>
<h4 id="序列相加"><a href="#序列相加" class="headerlink" title="序列相加"></a>序列相加</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># + -&gt; list</span></span><br><span class="line"><span class="comment"># 连接操作，将两个列表连接起来</span></span><br><span class="line"><span class="comment"># 产生新的列表，原列表不变</span></span><br><span class="line"><span class="comment"># 本质上调用的是__add__()方法</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] + [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'Hello,'</span> + <span class="string">'world!'</span></span><br><span class="line"><span class="string">'Hello, world!'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] + <span class="string">'world!'</span></span><br><span class="line">Traceback (innermost last):</span><br><span class="line">File "&lt;pyshell&gt;", line 1, in ?</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] + <span class="string">'world!'</span></span><br><span class="line">TypeError: can only concatenate list (<span class="keyword">not</span> <span class="string">"string"</span>) to list</span><br><span class="line"><span class="comment"># 不能拼接列表和字符串，虽然它们都是序列。一般而言，不能拼接不同类型的序列。</span></span><br></pre></td></tr></table></figure>
<h4 id="乘法"><a href="#乘法" class="headerlink" title="乘法"></a>乘法</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># * -&gt; list</span></span><br><span class="line"><span class="comment"># 重复操作，将本列表元素重复n次，返回新的列表。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'python'</span> * <span class="number">5</span></span><br><span class="line"><span class="string">'pythonpythonpythonpythonpython'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">42</span>] * <span class="number">10</span></span><br><span class="line">[<span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>]</span><br><span class="line"><span class="comment"># 将序列与数x相乘时，将重复这个序列x次来创建一个新序列</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sequence = [<span class="keyword">None</span>] * <span class="number">10</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sequence</span><br><span class="line">[<span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>]</span><br><span class="line"><span class="comment"># 空列表是使用不包含任何内容的两个方括号([])表示的。如果要创建一个可包含10个元素的列表，但没有任何有用的内容，可像前面那样使用[42]*10。但更准确的做法是使用[0]*10，这将创建一个包含10个零的列表。然而，在有些情况下，你可能想使用表示“什么都没有”的值，如表示还没有在列表中添加任何内容。在这种情况下，可使用None。在Python中，None表示什么都没有。</span></span><br><span class="line"></span><br><span class="line">sentence = input(<span class="string">"Sentence: "</span>)</span><br><span class="line"><span class="comment"># 这里是要求输入要在框中显示的内容的</span></span><br><span class="line">screen_width = <span class="number">80</span></span><br><span class="line"><span class="comment"># screen_width：屏幕宽度</span></span><br><span class="line">text_width = len(sentence)</span><br><span class="line"><span class="comment"># 文本宽度，len用于取字符串宽度</span></span><br><span class="line">box_width = text_width + <span class="number">4</span></span><br><span class="line"><span class="comment"># 框的宽度，这里加的数需要自行调整，示例中加了6，但测试打印出的内容没有达到效果</span></span><br><span class="line">left_margin = (screen_width - box_width) // <span class="number">2</span></span><br><span class="line"><span class="comment"># 左边缘的宽度，等于屏幕宽度减去框的宽度最后除以2,这是为了使最后的内容居中</span></span><br><span class="line">print()</span><br><span class="line"><span class="comment"># 打印一个空行</span></span><br><span class="line">print(<span class="string">' '</span> * left_margin + <span class="string">'+'</span> + <span class="string">'-'</span> * (box_width<span class="number">-2</span>) + <span class="string">'+'</span>)</span><br><span class="line"><span class="comment"># ' ' * left_margin是整个内容左边空出来的距离，然后输出一个加号，之后输出"-"，输出的数量是外框的长度减2,因为两侧都有一个加号所以要减2.最后输出一个加号。</span></span><br><span class="line">print(<span class="string">' '</span> * left_margin + <span class="string">'| '</span> + <span class="string">' '</span> * text_width  + <span class="string">' |'</span>)</span><br><span class="line"><span class="comment"># 实际打印每一行时只要注意左侧的空格数量就可以了。</span></span><br><span class="line">print(<span class="string">' '</span> * left_margin + <span class="string">'| '</span> +       sentence + <span class="string">' |'</span>)</span><br><span class="line"><span class="comment"># 通过'| '和' |'使内容与边缘间多出一个空格</span></span><br><span class="line">print(<span class="string">' '</span> * left_margin + <span class="string">'| '</span> + <span class="string">' '</span> * text_width + <span class="string">' |'</span>)</span><br><span class="line">print(<span class="string">' '</span> * left_margin + <span class="string">'+'</span> + <span class="string">'-'</span> * (box_width<span class="number">-2</span>) + <span class="string">'+'</span>)</span><br><span class="line">print()</span><br><span class="line">输出结果如下：</span><br><span class="line">Sentence: He<span class="string">'s a very naughty boy!</span></span><br><span class="line"><span class="string">                          +---------------------------------+</span></span><br><span class="line"><span class="string">                          |                                 |</span></span><br><span class="line"><span class="string">                          |    He'</span>s a very naughty boy!     |</span><br><span class="line">                          |                                 |</span><br><span class="line">                          +---------------------------------+</span><br></pre></td></tr></table></figure>
<h4 id="成员资格"><a href="#成员资格" class="headerlink" title="成员资格"></a>成员资格</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 要检查特定的值是否包含在序列中，可使用运算符in。这个运算符与前面讨论的运算符(如乘法或加法运算符)稍有不同。它检查是否满足指定的条件，并返回相应的值:满足时返回True，不满足时返回False。这样的运算符称为布尔运算符，而前述真值称为布尔值。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>permissions = <span class="string">'rw'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'w'</span> <span class="keyword">in</span> permissions</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'x'</span> <span class="keyword">in</span> permissions</span><br><span class="line"><span class="keyword">False</span></span><br><span class="line"><span class="comment"># 使用成员资格测试分别检查'w'和'x'是否包含在字符串变量permissions中</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>users = [<span class="string">'mlh'</span>, <span class="string">'foo'</span>, <span class="string">'bar'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>input(<span class="string">'Enter your user name: '</span>) <span class="keyword">in</span> users</span><br><span class="line">Enter your user name: mlh</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="comment"># 检查提供的用户名mlh是否包含在用户列表中，这在程序需要执行特定的安全策略时很有用(在这种情况下，可能还需检查密码)。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject = <span class="string">'$$$ Get rich now!!! $$$'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'$$$'</span> <span class="keyword">in</span> subject</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="comment"># 检查字符串变量subject是否包含字符串'$$$'，这可用于垃圾邮件过滤器中。</span></span><br><span class="line"><span class="comment"># 相比于其他示例，检查字符串是否包含'$$$'的示例稍有不同。一般而言，运算符in检查指定的对象是否是序列(或其他集合)的成员(即其中的一个元素)，但对字符串来说，只有它包含的字符才是其成员或元素，因此下面的代码完全合理：&gt;&gt;&gt; 'P' in 'Python'		True</span></span><br><span class="line"></span><br><span class="line">database = [</span><br><span class="line">[<span class="string">'albert'</span>, <span class="string">'1234'</span>],</span><br><span class="line">[<span class="string">'dilbert'</span>,  <span class="string">'4242'</span>],</span><br><span class="line">[<span class="string">'smith'</span>,  <span class="string">'7524'</span>],</span><br><span class="line">[<span class="string">'jones'</span>,  <span class="string">'9843'</span>]</span><br><span class="line">]</span><br><span class="line">username = input(<span class="string">'User name: '</span>)</span><br><span class="line">pin = input(<span class="string">'PIN code: '</span>)</span><br><span class="line"><span class="keyword">if</span> [username, pin] <span class="keyword">in</span> database: print(<span class="string">'Access granted'</span>)</span><br><span class="line">输出结果如下：</span><br><span class="line">User name: jones</span><br><span class="line">PIN code: <span class="number">9843</span></span><br><span class="line">Access granted</span><br><span class="line"><span class="comment"># 检查用户名和PIN码，程序从用户那里获取一个用户名和一个PIN码，并检查它们组成的列表是否包含在数据库(实际上也是一个列表)中。如果用户名-PIN码对包含在数据库中，就打印字符串'Access granted'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers = [<span class="number">100</span>, <span class="number">34</span>, <span class="number">678</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(numbers)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>max(numbers)</span><br><span class="line"><span class="number">678</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>min(numbers)</span><br><span class="line"><span class="number">34</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>max(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>min(<span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>)</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="comment"># 函数len返回序列包含的元素个数，而min和max分别返回序列中最小和最大的元素。</span></span><br><span class="line"><span class="comment"># 最后两个表达式调用max和min时指定的实参并不是序列，而直接将数作为实参。</span></span><br></pre></td></tr></table></figure>
<h4 id="随机数"><a href="#随机数" class="headerlink" title="随机数"></a>随机数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># random模块</span></span><br><span class="line"><span class="comment"># randint(a,b)返回[a,b]之间的整数</span></span><br><span class="line"><span class="comment"># choice(seq)从非空序列的元素中随机挑选一个元素，比如random.choice(range(10))，从0到9中随机挑选一个整数。random.choice([1,3,5,7])</span></span><br><span class="line"><span class="comment"># randrange([start,]stop[,step])从指定范围内，按指定基数递增的集合中获取一个随机数，基数缺省值为1.random.randrange(1,7,2)</span></span><br><span class="line"><span class="comment"># random.shuffle(list) -&gt; None，就地打乱列表元素</span></span><br><span class="line"><span class="comment"># sample(population,k)从样本空间或总体（序列或者集合类型）中随机取出k个不同的元素，返回一个新的列表</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.sample([<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>],<span class="number">2</span>)</span><br><span class="line">random.sample([<span class="string">'a'</span>,<span class="string">'a'</span>],<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<h3 id="列表-1"><a href="#列表-1" class="headerlink" title="列表"></a>列表</h3><h4 id="函数list"><a href="#函数list" class="headerlink" title="函数list"></a>函数list</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(<span class="string">'Hello'</span>)</span><br><span class="line">[<span class="string">'H'</span>, <span class="string">'e'</span>, <span class="string">'l'</span>, <span class="string">'l'</span>, <span class="string">'o'</span>]</span><br><span class="line"><span class="comment"># 鉴于不能像修改列表那样修改字符串，因此在有些情况下使用字符串来创建列表很有帮助。可将任何序列(而不仅仅是字符串)作为list的参数。</span></span><br><span class="line"><span class="comment"># 要将字符列表(如前述代码中的字符列表)转换为字符串。可使用下面的表达式：''.join(somelist)，其中somelist是要转换的列表。</span></span><br></pre></td></tr></table></figure>
<h4 id="基本的列表操作"><a href="#基本的列表操作" class="headerlink" title="基本的列表操作"></a>基本的列表操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">* 修改列表：给元素赋值</span><br><span class="line">list[index] = value</span><br><span class="line"><span class="comment"># 索引不要超界</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line"><span class="comment"># 将索引为1的值改为2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"><span class="comment"># 不能给不存在的元素赋值，因此如果列表的长度为2，就不能给索引为100的元素赋值。要这样做，列表的长度至少为101。</span></span><br><span class="line"></span><br><span class="line">* 删除元素</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>names = [<span class="string">'Alice'</span>, <span class="string">'Beth'</span>, <span class="string">'Cecil'</span>, <span class="string">'Dee-Dee'</span>, <span class="string">'Earl'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> names[<span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>names</span><br><span class="line">[<span class="string">'Alice'</span>, <span class="string">'Beth'</span>, <span class="string">'Dee-Dee'</span>, <span class="string">'Earl'</span>]</span><br><span class="line"></span><br><span class="line">* 给切片赋值</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = list(<span class="string">'Perl'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name</span><br><span class="line">[<span class="string">'P'</span>, <span class="string">'e'</span>, <span class="string">'r'</span>, <span class="string">'l'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name[<span class="number">2</span>:] = list(<span class="string">'ar'</span>)</span><br><span class="line"><span class="comment"># 将索引为2到最后的一个元素改为ar，perl就变成了pear</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name</span><br><span class="line">[<span class="string">'P'</span>, <span class="string">'e'</span>, <span class="string">'a'</span>, <span class="string">'r'</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = list(<span class="string">'Perl'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name[<span class="number">1</span>:] = list(<span class="string">'ython'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name</span><br><span class="line">[<span class="string">'P'</span>, <span class="string">'y'</span>, <span class="string">'t'</span>, <span class="string">'h'</span>, <span class="string">'o'</span>, <span class="string">'n'</span>]</span><br><span class="line"><span class="comment"># 通过使用切片赋值，可将切片替换为长度与其不同的序列。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers = [<span class="number">1</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">1</span>:<span class="number">1</span>] = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="comment"># [1:1] 指在索引为1的地方</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="comment"># 使用切片赋值还可在不替换原有元素的情况下插入新元素。在这里，“替换”了一个空切片，相当于插入了一个序列。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">1</span>:<span class="number">4</span>] = []</span><br><span class="line"><span class="comment"># 将索引1至4的元素值替换为空</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers</span><br><span class="line">[<span class="number">1</span>, <span class="number">5</span>]</span><br><span class="line"><span class="comment"># 上述代码与del numbers[1:4]等效</span></span><br></pre></td></tr></table></figure>
<h4 id="列表方法"><a href="#列表方法" class="headerlink" title="列表方法"></a>列表方法</h4><blockquote>
<p>方法是与对象(列表、数、字符串等)联系紧密的函数。<br>调用方法：<br>object.method(arguments)<br>方法调用与函数调用很像，只是在方法名前加上了对象和句点。列表包含多个可用来查看或修改其内容的方法。</p>
<p>下面的方法中，pop index count copy 这四个方法不会就地修改并返回None；append clear extend insert remove reverse sort 这些方法会就地修改并返回None</p>
</blockquote>
<h5 id="append"><a href="#append" class="headerlink" title="append"></a>append</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># append(object) -&gt; None</span></span><br><span class="line"><span class="comment"># 列表尾部追加元素，返回None</span></span><br><span class="line"><span class="comment"># 返回None就意味着没有新的列表产生，就地修改</span></span><br><span class="line"><span class="comment"># 时间复杂度是O(1)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst.append(<span class="number">4</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="comment"># 方法append用于将一个对象附加到列表末尾。 append也就地修改列表。它不会返回修改后的新列表，而是直接修改旧列表。</span></span><br></pre></td></tr></table></figure>
<h5 id="clear"><a href="#clear" class="headerlink" title="clear"></a>clear</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clear() -&gt; None</span></span><br><span class="line"><span class="comment"># 清除列表所有元素，剩下一个空列表</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst.clear()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst</span><br><span class="line">[]</span><br><span class="line"><span class="comment"># 方法clear就地清空列表的内容。这类似于切片赋值语句lst[:] = []。</span></span><br></pre></td></tr></table></figure>
<h5 id="copy"><a href="#copy" class="headerlink" title="copy"></a>copy</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># copy() -&gt; list</span></span><br><span class="line"><span class="comment"># shadow copy返回一个新的列表</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = a</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment"># 方法 copy 复制列表。常规复制只是将另一个名称关联到列表。要让a 和b 指向不同的列表，就必须将b关联到a的副本。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = a.copy()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment"># 这类似于使用a[:]或list(a)，它们也都复制a。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># shadow copy表示影子拷贝，也叫浅拷贝，遇到引用类型，只是复制了一个引用而已</span></span><br><span class="line"><span class="comment"># 深浅拷贝测试</span></span><br><span class="line">lst0 = list(range(<span class="number">4</span>))</span><br><span class="line">id(lst0)</span><br><span class="line"><span class="comment"># 查看内存地址</span></span><br><span class="line">hash(lst0)</span><br><span class="line"><span class="comment"># 列表是不可hash的，所以会报错</span></span><br><span class="line">hash(id(lst0))</span><br><span class="line"><span class="comment"># 这样才行</span></span><br><span class="line">lst1 = list(range(<span class="number">4</span>))</span><br><span class="line">id(lst1)</span><br><span class="line"><span class="comment"># lst0和lst1在内存中的位置是不一样的。</span></span><br><span class="line">lst0 == lst1</span><br><span class="line"><span class="comment"># 这里比较的是两个列表的值</span></span><br><span class="line">lst0 <span class="keyword">is</span> lst1</span><br><span class="line"><span class="comment"># 这里比较的是两个列表的内存地址。id就是查看内存地址的</span></span><br><span class="line">lst1 = lst0</span><br><span class="line"><span class="comment"># 这里是将lst0的内存地址给了lst1，这时两个列表都指向了同一个内存地址，所以下面修改lst1的内容时，lst0也会改变</span></span><br><span class="line">lst1[<span class="number">2</span>] = <span class="number">10</span></span><br><span class="line">lst0</span><br><span class="line">lst0 = list(range(<span class="number">4</span>))</span><br><span class="line">lst5 = lst0.copy()</span><br><span class="line"><span class="comment"># 这里只是复制内容，内存地址是不一样的</span></span><br><span class="line">lst5</span><br><span class="line">lst5 == lst0</span><br><span class="line"><span class="comment"># 返回True</span></span><br><span class="line">lst5 <span class="keyword">is</span> lst0</span><br><span class="line"><span class="comment"># 返回False</span></span><br><span class="line">id(lst0)</span><br><span class="line">id(lst5)</span><br><span class="line"><span class="comment"># 内存地址不一样</span></span><br><span class="line">lst0 = [<span class="number">1</span>,[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],<span class="number">5</span>]</span><br><span class="line">lst5 = lst0.copy()</span><br><span class="line"><span class="comment"># 这是一个影子拷贝或叫浅拷贝。当复制的内容比较复杂时，会复制内存地址，如下面的lst0和lst5的复制。</span></span><br><span class="line">lst5 == lst0</span><br><span class="line"><span class="comment"># 返回True</span></span><br><span class="line">lst5[<span class="number">2</span>] = <span class="number">10</span></span><br><span class="line">lst5 == lst0</span><br><span class="line"><span class="comment"># 返回False</span></span><br><span class="line">lst0</span><br><span class="line">lst5[<span class="number">2</span>] = <span class="number">5</span></span><br><span class="line">lst5 == lst0</span><br><span class="line"><span class="comment"># 返回True</span></span><br><span class="line">lst5[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">20</span></span><br><span class="line"><span class="comment"># 这里修改的是第一个元素中的第一个元素</span></span><br><span class="line">lst5 == lst0</span><br><span class="line"><span class="comment"># 因为是浅拷贝，所以列表中的列表复制的是内存地址，所以会都改变。返回True</span></span><br><span class="line">lst0</span><br><span class="line">lst5</span><br><span class="line"><span class="comment"># 两个列表中的值是一样的</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 深拷贝</span></span><br><span class="line"><span class="comment"># copy模块提供了deepcopy</span></span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line">lst0 = [<span class="number">1</span>,[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],<span class="number">5</span>]</span><br><span class="line">lst5 = copy.deepcopy(lst0)</span><br><span class="line">lst5[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">20</span></span><br><span class="line">lst5 == lst0</span><br></pre></td></tr></table></figure>
<h5 id="count"><a href="#count" class="headerlink" title="count"></a>count</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># count(value)</span></span><br><span class="line"><span class="comment"># 返回列表中匹配value的次数</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">'to'</span>, <span class="string">'be'</span>, <span class="string">'or'</span>, <span class="string">'not'</span>, <span class="string">'to'</span>, <span class="string">'be'</span>].count(<span class="string">'to'</span>)</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [[<span class="number">1</span>, <span class="number">2</span>], <span class="number">1</span>, <span class="number">1</span>, [<span class="number">2</span>, <span class="number">1</span>, [<span class="number">1</span>, <span class="number">2</span>]]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.count(<span class="number">1</span>)</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.count([<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="comment"># 方法count计算指定的元素在列表中出现了多少次。</span></span><br></pre></td></tr></table></figure>
<h5 id="extend"><a href="#extend" class="headerlink" title="extend"></a>extend</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># extend(iteratable) -&gt; None</span></span><br><span class="line"><span class="comment"># 将可迭代对象的元素追加进来，返回None</span></span><br><span class="line"><span class="comment"># 就地修改</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.extend(b)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="comment"># 方法extend让你能够同时将多个值附加到列表末尾，为此可将这些值组成的序列作为参数提供给方法extend。换而言之，你可使用一个列表来扩展另一个列表。</span></span><br><span class="line"><span class="comment"># 这可能看起来类似于拼接，但存在一个重要差别，那就是将修改被扩展的序列(这里是a)。在常规拼接中，情况是返回一个全新的序列。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a + b</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment"># 拼接出来的列表与前一个示例扩展得到的列表完全相同，但在这里a并没有被修改。鉴于常规拼接必须使用a和b的副本创建一个新列表，因此如果你要获得类似于下面的效果，拼接的效率将比extend低:</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = a + b</span><br><span class="line"><span class="comment"># 拼接操作并非就地执行的，即它不会修改原来的列表。</span></span><br></pre></td></tr></table></figure>
<h5 id="index"><a href="#index" class="headerlink" title="index"></a>index</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># index(value,[start,[stop]])</span></span><br><span class="line"><span class="comment"># 通过值value，从指定区间查找列表内的元素是否匹配</span></span><br><span class="line"><span class="comment"># 匹配第一个就立即返回索引</span></span><br><span class="line"><span class="comment"># 匹配不到，抛出异常ValueError</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>knights = [<span class="string">'We'</span>, <span class="string">'are'</span>, <span class="string">'the'</span>, <span class="string">'knights'</span>, <span class="string">'who'</span>, <span class="string">'say'</span>, <span class="string">'ni'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>knights.index(<span class="string">'who'</span>)</span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>knights.index(<span class="string">'herring'</span>)</span><br><span class="line">Traceback (innermost last):</span><br><span class="line">File "&lt;pyshell&gt;", line 1, in ?</span><br><span class="line">knights.index(<span class="string">'herring'</span>)</span><br><span class="line">ValueError: list.index(x): x <span class="keyword">not</span> <span class="keyword">in</span> list</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>knights[<span class="number">4</span>]</span><br><span class="line"><span class="string">'who'</span></span><br><span class="line"><span class="comment"># index在列表中查找指定值第一次出现的索引。搜索单词'who'时，发现它位于索引4处。然而，搜索'herring'时引发了异常，因为根本就没有找到这个单词。</span></span><br></pre></td></tr></table></figure>
<h5 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># insert(index,object) -&gt; None</span></span><br><span class="line"><span class="comment"># 在指定的索引index处插入元素object</span></span><br><span class="line"><span class="comment"># 返回None就意味着没有新的列表产生，就地修改</span></span><br><span class="line"><span class="comment"># 时间复杂度是O(n)</span></span><br><span class="line"><span class="comment"># 索引超越上界，尾部追加</span></span><br><span class="line"><span class="comment"># 索引超越下界，头部追加</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers.insert(<span class="number">3</span>, <span class="string">'four'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">'four'</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"><span class="comment"># insert用于将一个对象插入列表。与extend一样，也可使用切片赋值来获得与insert一样的效果。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">3</span>:<span class="number">3</span>] = [<span class="string">'four'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">'four'</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"><span class="comment"># 这虽巧妙，但可读性根本无法与使用insert媲美。</span></span><br></pre></td></tr></table></figure>
<h5 id="pop"><a href="#pop" class="headerlink" title="pop"></a>pop</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pop([index]) -&gt; item</span></span><br><span class="line"><span class="comment"># 不指定索引index，就从列表尾部弹出一个元素</span></span><br><span class="line"><span class="comment"># 指定索引index，就从索引处弹出一个元素，索引超界抛出IndexError错误</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.pop()</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="comment"># 如果用pop()，会删除最后一个元素</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.pop(<span class="number">0</span>)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">2</span>]</span><br><span class="line"><span class="comment"># pop从列表中删除一个元素(末尾为最后一个元素)，并返回这一元素。</span></span><br><span class="line"><span class="comment"># pop是唯一既修改列表又返回一个非None值的列表方法。</span></span><br><span class="line"><span class="comment"># 使用pop可实现一种常见的数据结构——栈 (stack)。栈就像一叠盘子，你可在上面添加盘子，还可从上面取走盘子。最后加入的盘子最先取走，这被称为后进先出(LIFO)。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.append(x.pop())</span><br><span class="line"><span class="comment"># 每次弹出的都是3，再将3追加到列表的尾部，就还是[1,2,3]</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment"># 使用append代替push方法，因为python中没有提供push。此将刚弹出的值压入(或附加)后，得到的栈将与原来相同。要创建先进先出(FIFO)的队列，可使用insert(0, ...)代替append。另外，也可继续使用append，但用 pop(0)替代 pop() 。</span></span><br></pre></td></tr></table></figure>
<h5 id="remove"><a href="#remove" class="headerlink" title="remove"></a>remove</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># remove(value) -&gt; None</span></span><br><span class="line"><span class="comment"># 从左至右查找第一个匹配value的值，移除该元素，返回None</span></span><br><span class="line"><span class="comment"># 就地修改</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="string">'to'</span>, <span class="string">'be'</span>, <span class="string">'or'</span>, <span class="string">'not'</span>, <span class="string">'to'</span>, <span class="string">'be'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.remove(<span class="string">'be'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="string">'to'</span>, <span class="string">'or'</span>, <span class="string">'not'</span>, <span class="string">'to'</span>, <span class="string">'be'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.remove(<span class="string">'bee'</span>)</span><br><span class="line">Traceback (innermost last):</span><br><span class="line">File "&lt;pyshell&gt;", line 1, in ?</span><br><span class="line">x.remove(<span class="string">'bee'</span>)</span><br><span class="line">ValueError: list.remove(x): x <span class="keyword">not</span> <span class="keyword">in</span> list</span><br><span class="line"><span class="comment"># remove用于删除第一个为指定值的元素。这只删除了为指定值的第一个元素，无法删除列表中其他为指定值的元素</span></span><br><span class="line"><span class="comment"># remove是就地修改且不返回值的方法之一。不同于 pop的是，它修改列表，但不返回任何值。</span></span><br></pre></td></tr></table></figure>
<h5 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># reverse() -&gt; None</span></span><br><span class="line"><span class="comment"># 将列表元素反转，返回None</span></span><br><span class="line"><span class="comment"># 就地修改</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.reverse()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"><span class="comment"># reverse按相反的顺序排列列表中的元素。但不返回任何值(与remove和sort等方法一样) 。</span></span><br><span class="line"><span class="comment"># 如果要按相反的顺序迭代序列，可使用函数reversed 。这个函数不返回列表，而是返回一个迭代器 。你可使用list将返回的对象转换为列表。如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(reversed(x))</span><br><span class="line">[<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<h5 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sort(key=None,reverse=False) -&gt; None</span></span><br><span class="line"><span class="comment"># 对列表元素进行排序，就地修改，默认升序</span></span><br><span class="line"><span class="comment"># reverse为True，反转，降序</span></span><br><span class="line"><span class="comment"># key一个函数，指定key如何排序</span></span><br><span class="line"><span class="comment"># lst.sort(key=functionname)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.sort()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="comment"># sort是修改列表而不返回任何值的方法，sort用于对列表就地排序。就地排序意味着对原来的列表进行修改，使其元素按顺序排列，而不是返回排序后的列表的副本。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = x.sort() <span class="comment"># Don't do this!</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(y)</span><br><span class="line"><span class="keyword">None</span></span><br><span class="line"><span class="comment"># 这种方法是错误的，sort修改x后是不返回任何值的，最终的结果是，x是经过排序的，而y包含 None。正确做法如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = x.copy()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y.sort()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="comment"># 只是将x赋给y是不可行的，因为这样x和y将指向同一个列表。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = sorted(x)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="comment"># sorted函数可用于任何可迭代的对象，但总是返回一个列表。如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sorted(<span class="string">'Python'</span>)</span><br><span class="line">[<span class="string">'P'</span>, <span class="string">'h'</span>, <span class="string">'n'</span>, <span class="string">'o'</span>, <span class="string">'t'</span>, <span class="string">'y'</span>]</span><br></pre></td></tr></table></figure>
<h5 id="高级排序"><a href="#高级排序" class="headerlink" title="高级排序"></a>高级排序</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="string">'aardvark'</span>, <span class="string">'abalone'</span>, <span class="string">'acme'</span>, <span class="string">'add'</span>, <span class="string">'aerate'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.sort(key=len)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="string">'add'</span>, <span class="string">'acme'</span>, <span class="string">'aerate'</span>, <span class="string">'abalone'</span>, <span class="string">'aardvark'</span>]</span><br><span class="line"><span class="comment"># 方法sort接受两个可选参数：key 和reverse。这两个参数通常是按名称指定的，称为关键字参数，参数 key类似于参数cmp：你将其设置为一个用于排序的函数。然而，不会直接使用这个函数来判断一个元素是否比另一个元素小，而是使用它来为每个元素创建一个键，再根据这些键对元素进行排序。因此，要根据长度对元素进行排序，可将参数 key 设置为函数len。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.sort(reverse=<span class="keyword">True</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">9</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"><span class="comment"># 对于另一个关键字参数reverse，只需将其指定为一个真值（True或False），以指出是否要按相反的顺序对列表进行排序。</span></span><br><span class="line"><span class="comment"># 函数sorted也接受参数key和reverse。在很多情况下，将参数key设置为一个自定义函数很有用。</span></span><br></pre></td></tr></table></figure>
<h5 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index和count方法都是O(n)。随着列表数据规模的增大，而效率下降</span><br></pre></td></tr></table></figure>
<h5 id="如何查帮助"><a href="#如何查帮助" class="headerlink" title="如何查帮助"></a>如何查帮助</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 官方帮助文档，搜索关键字</span></span><br><span class="line"><span class="comment"># IPython中</span></span><br><span class="line">help(keyword)</span><br><span class="line"><span class="comment"># keyword可以是变量、对象、类名、函数名、方法名</span></span><br></pre></td></tr></table></figure>
<h3 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h3><blockquote>
<p>与列表一样，元组也是序列，唯一的差别在于元组是不能修改的。元组语法很简单，只要将一些值用逗号分隔，就能自动创建一个元组。元组就是一个有序的元素组成的集合，使用小括号()表示。元组是不可变对象。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># index(value,[start,[stop]])</span></span><br><span class="line">	<span class="comment"># 通过值value,从指定区间查找列表内的元素是否匹配</span></span><br><span class="line">	<span class="comment"># 匹配第一个就立即返回索引</span></span><br><span class="line">	<span class="comment"># 匹配不到,抛出异常ValueError</span></span><br><span class="line"><span class="comment"># count(value)</span></span><br><span class="line">	<span class="comment"># 返回列表中匹配value的次数</span></span><br><span class="line"><span class="comment"># 时间复杂度</span></span><br><span class="line">	<span class="comment"># index和count方法都是O(n)</span></span><br><span class="line">	<span class="comment"># 随着列表数据规模的增大,而效率下降</span></span><br><span class="line"><span class="comment"># len(tuple)</span></span><br><span class="line">	<span class="comment"># 返回元素的个数</span></span><br><span class="line"><span class="comment"># 元组是只读的,所以增、改、删方法都没有</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># 元组还可用圆括号括起(这也是通常采用的做法) 。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>()</span><br><span class="line">()</span><br><span class="line"><span class="comment"># 空元组用两个不包含任何内容的圆括号表示。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">42</span></span><br><span class="line"><span class="number">42</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">42</span>,</span><br><span class="line">(<span class="number">42</span>,)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="number">42</span>,)</span><br><span class="line">(<span class="number">42</span>,)</span><br><span class="line"><span class="comment"># 表示一个值的元组也必须在它后面加上逗号。最后两个示例创建的元组长度为1，而第一个示例根本没有创建元组。逗号至关重要，仅将值用圆括号括起不管用：(42)与 42完全等效。但仅仅加上一个逗号，就能完全改变表达式的值。如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">3</span> * (<span class="number">40</span> + <span class="number">2</span>)</span><br><span class="line"><span class="number">126</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">3</span> * (<span class="number">40</span> + <span class="number">2</span>,)</span><br><span class="line">(<span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tuple([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tuple(<span class="string">'abc'</span>)</span><br><span class="line">(<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tuple((<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># 函数tuple的工作原理与list很像：它将一个序列作为参数，并将其转换为元组。如果参数已经是元组，就原封不动地返回它。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">1</span>]</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># 元组的切片也是元组,就像列表的切片也是列表一样。为何要熟悉元组呢?原因有以下两个。</span></span><br><span class="line"><span class="comment"># 1. 它们用作映射中的键(以及集合的成员)，而列表不行。</span></span><br><span class="line"><span class="comment"># 2. 有些内置函数和方法返回元组，这意味着必须跟它们打交道。只要不尝试修改元组，与元组“打交道”通常意味着像处理列表一样处理它们(需要使用元组没有的index和count等方法时例外)。</span></span><br><span class="line"><span class="comment"># 一般而言，使用列表足以满足对序列的需求。</span></span><br></pre></td></tr></table></figure>
<h4 id="命名元组namedtuple"><a href="#命名元组namedtuple" class="headerlink" title="命名元组namedtuple"></a>命名元组namedtuple</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 帮助文档中，查阅namedtuple，有使用教程</span></span><br><span class="line"><span class="comment"># 语法：</span></span><br><span class="line">	<span class="comment"># namedtuple(typename,field_names,verbose=False,rename=False)</span></span><br><span class="line">    <span class="comment"># 命名元组，返回一个元组的子类，并定义了字段</span></span><br><span class="line">    <span class="comment"># typename表示此元组的名称</span></span><br><span class="line">    <span class="comment"># field_names表示元组中元素的名称，此字段有多种表达方式，可以是空白符或逗号分隔的字段的字符串，可以是字段的列表</span></span><br><span class="line">    <span class="comment"># rename表示如果元素名称中含有python的关键字，则必须设置为rename=True</span></span><br><span class="line">    <span class="comment"># verbose使用默认就可以。</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line">Point = namedtuple(<span class="string">'_Point'</span>,[<span class="string">'x'</span>,<span class="string">'y'</span>])</span><br><span class="line"><span class="comment"># Point为返回的类</span></span><br><span class="line">p = Point(<span class="number">11</span>,<span class="number">22</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Student = namedtuple(<span class="string">'Student'</span>, [<span class="string">'name'</span>, <span class="string">'age'</span>, <span class="string">'sex'</span>, <span class="string">'email'</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = Student(<span class="string">'Jim'</span>, <span class="number">21</span>, <span class="string">'male'</span>, <span class="string">'123@qq.com'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.name</span><br><span class="line"><span class="string">'Jim'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.age</span><br><span class="line"><span class="number">21</span></span><br><span class="line"><span class="comment"># namedtuple 函数这里接收两个参数，第一个参数为要创建类型的名称，第二个参数是一个列表，代表了每一个</span></span><br><span class="line"><span class="comment"># 索引的名字。当建立完这个 Student 类之后，就可以使用正常的构造方法来构造新的对象如 s，并且可以直接</span></span><br><span class="line"><span class="comment"># 通过访问属性的方式来访问所需要的值。</span></span><br><span class="line"><span class="comment"># 此时使用isinstance函数对比内置的tuple：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(s, tuple)</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="comment"># 可见用namedtuple构造出来的类其本质就是一个tuple元组，所以仍然可以使用下标的方式来访问属性。并且在</span></span><br><span class="line"><span class="comment"># 任何要求类型为元组的地方都可以使用这个namedtuple。</span></span><br></pre></td></tr></table></figure>
<h4 id="冒泡法"><a href="#冒泡法" class="headerlink" title="冒泡法"></a>冒泡法</h4><ul>
<li><p>属于交换排序</p>
</li>
<li><p>两两比较大小，交换位置。如同水泡咕嘟咕嘟往上冒</p>
</li>
<li>结果分为升序和降序排列</li>
<li>升序<ul>
<li>n个数从左至右，编号从0开始到n-1，索引0和1的值比较，如果索引0大，则交换两者位置，如果索引1大，则不交换。继续比较索引1和2的值，将大值放在右侧。直至n-2和n-1比较完，第一轮比较完成。第二轮从索引0比较到n-2，因为最右侧n-1位置上已经是最大值了。依次类推，每一轮都会减少最右侧的不参与比较的数，直至剩下最后2个数比较。</li>
</ul>
</li>
<li><p>降序</p>
<ul>
<li>和升序相反</li>
</ul>
</li>
<li><p>图示</p>
</li>
</ul>
<p><img src="/images/python冒泡法/冒泡法1.png" alt=""></p>
<p><img src="/images/python冒泡法/冒泡法2.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 冒泡法代码实现一，简单冒泡实现</span></span><br><span class="line">num_list = [[<span class="number">1</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]]</span><br><span class="line"><span class="comment"># 定义一个列表，这个列表中还有两个子列表</span></span><br><span class="line">nums = num_list[<span class="number">1</span>]</span><br><span class="line"><span class="comment"># 定义nums等于第2个子列表</span></span><br><span class="line">print(nums)</span><br><span class="line"><span class="comment"># 先打印一次nums列表</span></span><br><span class="line">length = len(nums)</span><br><span class="line"><span class="comment"># 计算nums列表的长度</span></span><br><span class="line">count_swap = <span class="number">0</span></span><br><span class="line"><span class="comment"># 交换</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="comment"># 统计次数</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line"><span class="comment"># 用length也就是列表长度来循环，length是一共要比较的次数，也就是要用每个数字与所有的数字比较一次，所有数字比较一遍的次数。i表示第几个数字</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(length-i<span class="number">-1</span>):</span><br><span class="line"><span class="comment"># 这里j是长度减去之前比较的次数后，还要比较的次数。也就是每次每个数字要与列表中数字比较的次数，如第一次从第一个数字比较到最后一个数字，</span></span><br><span class="line"><span class="comment"># 那么，第二次比较时就从第一个数字比较到倒数第二个数字了，因为第一次已经将最大的数字放到最后了。最后减1是因为i是从0开始的，所以要多减1.</span></span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line"><span class="comment"># 计算比较的次数</span></span><br><span class="line">        <span class="keyword">if</span> nums[j] &gt; nums[j+<span class="number">1</span>]:</span><br><span class="line"><span class="comment"># 按循环每次比较，nums列表中的第j个元素是否与j+1个元素大，也就是前面的数字与后面的数字比较，如第一次是第1个和第2个数字比较，下一次就是第2个和第3个比较</span></span><br><span class="line">            tmp = nums[j]</span><br><span class="line"><span class="comment"># 如果前面的数字大，就将数字给tmp</span></span><br><span class="line">            nums[j] = nums[j+<span class="number">1</span>]</span><br><span class="line"><span class="comment"># 之后将前面的数字向后移</span></span><br><span class="line">            nums[j+<span class="number">1</span>] = tmp</span><br><span class="line"><span class="comment"># 再把后面的数字放在临时空间中</span></span><br><span class="line">            count_swap += <span class="number">1</span></span><br><span class="line"><span class="comment"># 记录一次交换</span></span><br><span class="line">print(nums, count_swap, count)</span><br><span class="line"><span class="comment"># 打印列表，交换次数，比较次数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 冒泡法代码实现二，优化实现</span></span><br><span class="line">num_list = [[<span class="number">1</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">8</span>]]</span><br><span class="line">nums = num_list[<span class="number">2</span>]</span><br><span class="line">print(nums)</span><br><span class="line">length = len(nums)</span><br><span class="line">count_swap = <span class="number">0</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line">    flag = <span class="keyword">False</span></span><br><span class="line"><span class="comment"># 每次每个数比较之前都加一个标记</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(length-i<span class="number">-1</span>):</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> nums[j] &gt; nums[j+<span class="number">1</span>]:</span><br><span class="line">            tmp = nums[j]</span><br><span class="line">            nums[j] = nums[j+<span class="number">1</span>]</span><br><span class="line">            nums[j+<span class="number">1</span>] = tmp</span><br><span class="line">            flag = <span class="keyword">True</span></span><br><span class="line">            <span class="comment"># 如果前面的数字比后面的大，进行了交换，就将flag改为True</span></span><br><span class="line">            count_swap += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> flag:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># 当flag为False时，证明没有交换，也就证明没必要再进行之后的动作，顺序已经排好了。</span></span><br><span class="line">print(nums, count_swap, count)</span><br></pre></td></tr></table></figure>
<ul>
<li>冒泡法总结<ul>
<li>冒泡法需要数据一轮轮比较</li>
<li>可以设定一个标记判断此轮是否有数据交换发生，如果没有发生交换，可以结束排序，如果发生交换，继续下一轮排序</li>
<li>最差的排序情况是，初始顺序与目标顺序完全相反，遍历次数1,…,n-1之和n(n/1)/2</li>
<li>最好的排序情况是，初始顺序与目标顺序完全相同，遍历次数n-1</li>
<li>时间复杂度O(n**2)</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/20/python基础学习-基础知识/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/20/python基础学习-基础知识/" itemprop="url">
                  python基础学习-基础知识
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-20 09:04:26" itemprop="dateCreated datePublished" datetime="2019-03-20T09:04:26+08:00">2019-03-20</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2020-04-17 17:32:07" itemprop="dateModified" datetime="2020-04-17T17:32:07+08:00">2020-04-17</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><h4 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h4><blockquote>
<p>算法是流程或菜谱的时髦说法，详尽地描述了如何完成某项任务。算法由对象（原料）和语句（操作说明）组成。从本质上说，编写计算机程序就是使用计算机能够理解的语言(如Python)描述一种算法。这种对机器友好的描述被称为程序，主要由表达式和语句组成。</p>
</blockquote>
<h4 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h4><blockquote>
<p>表达式为程序的一部分，结果为一个值。例如：2 + 2就是一个表达式，结果为4 。简单表达式是使用运算符(如+或% )和函数(如pow)将字面值(如2或”Hello” )组合起来得到的。通过组合简单的表达式，可创建复杂的表达式，如(2 + 2) *(3 - 1)。表达式还可能包含变量。</p>
<p>圆整，是科技术语，通常理解为因满足某种要求而进行的数据修正。按照修正后的数据在数值上是否比原数据大，又可分为向上圆整和向下圆整。</p>
<p>整除符号：//，当结果为整数时向下圆整，如：10 // 3。如果余数为0，就不会向下圆整了，如：9 // 3。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">10</span> % <span class="number">3</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">10</span> % <span class="number">-3</span></span><br><span class="line"><span class="number">-2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">-10</span> % <span class="number">3</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">-10</span> % <span class="number">-3</span></span><br><span class="line"><span class="number">-1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">10</span> // <span class="number">3</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">10</span> // <span class="number">-3</span></span><br><span class="line"><span class="number">-4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">-10</span> // <span class="number">3</span></span><br><span class="line"><span class="number">-4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">-10</span> // <span class="number">-3</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="comment"># 对于整数运算，结果是向下圆整的。在结果是负数时，圆整后将离0更远。</span></span><br></pre></td></tr></table></figure>
<h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><blockquote>
<p>变量是表示值的名称。通过赋值,可将新值赋给变量,如x = 2。赋值是一种语句。</p>
<p>使用python变量前必须给它赋值，因此python变量没有默认值。在python中，名称（标识符）只能由字母、数字和下划线(_)构成，且不能以数字开头。最好也不要以下划线开头。</p>
</blockquote>
<h4 id="语句"><a href="#语句" class="headerlink" title="语句"></a>语句</h4><blockquote>
<p>语句是让计算机执行特定操作的指示。这种操作可能是修改变量(通过赋值) 、将信息打印到屏幕上(如print(“Hello, world!”))、导入模块或执行众多其他任务。</p>
<p>表达式是一些东西，而语句是一些事情。上面介绍的都是表达式。如表达式：2 <em> 2，语句：print(2 </em> 2)</p>
<p>语句的特征是执行修改操作。赋值语句可以改变变量，print语句改变屏幕的外观。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = input(<span class="string">"x: "</span>)</span><br><span class="line">x: <span class="number">34</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = input(<span class="string">"y: "</span>)</span><br><span class="line">y: <span class="number">42</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(int(x) * int(y))</span><br><span class="line"><span class="number">1428</span></span><br><span class="line"><span class="comment"># int可以将字符串转换为整数。</span></span><br></pre></td></tr></table></figure>
<h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><blockquote>
<p>Python函数类似于数学函数，它们可以接受参数，并返回结果。函数犹如小型程序，可用来执行特定的操作。通常将标准函数称为内置函数。使用函数称为调用函数，可以向函数提供实参，之后函数返回一个值。因为函数调用返回一个值，因此它们也是表达式。可以结合使用函数调用和运算符来编写更复杂的表达式。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">2</span> ** <span class="number">3</span></span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pow(<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="comment"># pow函数是计算幂运算的。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">10</span> + pow(<span class="number">2</span>,<span class="number">3</span>*<span class="number">5</span>) / <span class="number">3.0</span></span><br><span class="line"><span class="number">10932.6666666</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>abs(<span class="number">-10</span>)</span><br><span class="line"><span class="comment"># abs函数计算绝对值</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>round(<span class="number">2</span> / <span class="number">3</span>)</span><br><span class="line"><span class="comment"># round将浮点数圆整为与之最接近的整数。</span></span><br><span class="line"><span class="comment"># 整数总是向下圆整，而round圆整到最接近的整数，并在两个整数一样近时圆整到偶数。</span></span><br></pre></td></tr></table></figure>
<h4 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h4><blockquote>
<p>模块是扩展，可通过导入它们来扩展Python的功能。例如：模块math包含多个很有用的函数。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>math.floor(<span class="number">32.9</span>)</span><br><span class="line"><span class="number">32</span></span><br><span class="line"><span class="comment"># 使用import导入模块，再以module.function的方式使用模块中的函数。floor函数与上面的round函数相反，可以将浮点数向下圆整</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>math.ceil(<span class="number">32.3</span>)</span><br><span class="line"><span class="number">33</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>math.ceil(<span class="number">32</span>)</span><br><span class="line"><span class="number">32</span></span><br><span class="line"><span class="comment"># ceil与floor相反，返回大于或等于给定数的最小整数。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sqrt(<span class="number">9</span>)</span><br><span class="line"><span class="number">3.0</span></span><br><span class="line"><span class="comment"># sqrt函数用于计算平方根。如果确定不会从不同模块导入多个同名函数，可使用from math import function的方法调用函数，之后就不用再指定模块前缀了。一般还是不使用此种方法，容易出现无法使用常规函数的问题</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo = math.sqrt</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo(<span class="number">4</span>)</span><br><span class="line"><span class="comment"># 可以将函数赋值给变量，之后变量就有了函数的功能</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sqrt(<span class="number">-1</span>)</span><br><span class="line">nan</span><br><span class="line"><span class="comment"># nan具有特殊含义，指的是"非数值"(not a number)。</span></span><br><span class="line"><span class="comment"># 如果将值域限定为实数，并使用其近似的浮点数实现，就无法计算负数的平方根。负数的平方根是虚数，而由实部和虚部组成的数为复数</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> cmath</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>cmath.sqrt(<span class="number">-1</span>)</span><br><span class="line"><span class="number">1j</span></span><br><span class="line"><span class="comment"># 1j是个虚数，虚数都以j（或J）结尾。复数算术运算都基于如下定义：-1的平方根为1j。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="number">1</span> + <span class="number">3j</span>) * (<span class="number">9</span> + <span class="number">4j</span>)</span><br><span class="line">(<span class="number">-3</span> + <span class="number">31j</span>)</span><br><span class="line"><span class="comment"># python提供了对复数的支持。</span></span><br><span class="line"><span class="comment"># python没有专门表示虚数的类型，而将虚数视为实部为零的复数。</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h4><blockquote>
<p>字符串的主要用途是表示一段文本。在Python 3中，所有的字符串都是Unicode字符串。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"Let's go!"</span></span><br><span class="line"><span class="string">"Let's go!"</span></span><br><span class="line"><span class="comment"># 这里用了一个单引号，因此不能用单引号再将整个字符串括起，否则解释器将报错。如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'Let'</span>s go!<span class="string">'</span></span><br><span class="line"><span class="string">SyntaxError: invalid syntax</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt;&gt;&gt; '</span><span class="string">"Hello, world!"</span> she said<span class="string">'</span></span><br><span class="line"><span class="string">'</span><span class="string">"Hello, world!"</span> she said<span class="string">'</span></span><br><span class="line"><span class="string"># 因为字符串包含双引号，因此必须使用单引号将整个字符串括起</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt;&gt;&gt; '</span>Let\<span class="string">'s go!'</span></span><br><span class="line"><span class="string">"Let's go!"</span></span><br><span class="line"><span class="comment"># 可使用反斜杠( \ )对引号进行转义</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"\"Hello, world!\" she said"</span></span><br><span class="line"><span class="string">'"Hello, world!" she said'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"Let's say "</span> <span class="string">'"Hello, world!"'</span></span><br><span class="line"><span class="string">'Let\'s say "Hello, world!"'</span></span><br><span class="line"><span class="comment"># Python可以自动将字符串拼接起来</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"Hello, "</span> + <span class="string">"world!"</span></span><br><span class="line"><span class="string">'Hello, world!'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">"Hello, "</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = <span class="string">"world!"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x + y</span><br><span class="line"><span class="string">'Hello, world!'</span></span><br><span class="line"><span class="comment"># 拼接字符串的方法</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'''This is a very long string. It continues here.</span></span><br><span class="line"><span class="string">And it's not over yet. "Hello, world!"</span></span><br><span class="line"><span class="string">Still here.'''</span>)</span><br><span class="line"><span class="comment"># 表示长字符串时可以使用三个单引号或三个双引号，这让解释器能够识别表示字符串开始和结束位置的引号，因此字符串本身可包含单引号和双引号，无需使用反斜杠进行转义。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span> + <span class="number">2</span> + \</span><br><span class="line"><span class="number">4</span> + <span class="number">5</span></span><br><span class="line"><span class="number">12</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> \</span><br><span class="line">(<span class="string">'Hello, world'</span>)</span><br><span class="line">Hello, world</span><br><span class="line"><span class="comment"># 常规字符串也可横跨多行。只要在行尾加上反斜杠,反斜杠和换行符将被转义,即被忽略。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">r'C:\nowhere'</span>)</span><br><span class="line">C:\nowhere</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">r'C:\Program Files\fnord\foo\bar\baz\frozz\bozz'</span>)</span><br><span class="line">C:\Program Files\fnord\foo\bar\baz\frozz\bozz</span><br><span class="line"><span class="comment"># 原始字符串用前缀r表示。看起来可在原始字符串中包含任何字符，这大致是正确的。一个例外是，引号需要像通常那样进行转义，但这意味着用于执行转义的反斜杠也将包含在最终的字符串中。如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">r'Let\'s go!'</span>)</span><br><span class="line">Let\<span class="string">'s go!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt;&gt;&gt; print(r"This is illegal\")</span></span><br><span class="line"><span class="string">SyntaxError: EOL while scanning string literal</span></span><br><span class="line"><span class="string"># 原始字符串不能以单个反斜杠结尾。除非你对其进行转义(但进行转义时,用于转义的反斜杠也将是字符串的一部分) 。</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; print(r'</span>C:\Program Files\foo\ba<span class="string">r' '</span>\\<span class="string">')</span></span><br><span class="line"><span class="string">C:\Program Files\foo\bar\</span></span><br><span class="line"><span class="string"># 可以将反斜杠单独作为一个字符串</span></span><br></pre></td></tr></table></figure>
<h4 id="函数表"><a href="#函数表" class="headerlink" title="函数表"></a>函数表</h4><table>
<thead>
<tr>
<th style="text-align:left">函数</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">abs(number)</td>
<td style="text-align:left">返回指定数的绝对值</td>
</tr>
<tr>
<td style="text-align:left">bytes(string, encoding[, errors])</td>
<td style="text-align:left">对指定的字符串进行编码，并以指定的方式处理错误</td>
</tr>
<tr>
<td style="text-align:left">cmath.sqrt(number)</td>
<td style="text-align:left">返回平方根；可用于负数</td>
</tr>
<tr>
<td style="text-align:left">float(object)</td>
<td style="text-align:left">将数字转换为浮点数</td>
</tr>
<tr>
<td style="text-align:left">help([object])</td>
<td style="text-align:left">提供交互式帮助</td>
</tr>
<tr>
<td style="text-align:left">input(prompt)</td>
<td style="text-align:left">以字符串的方式获取用户输入</td>
</tr>
<tr>
<td style="text-align:left">int(object)</td>
<td style="text-align:left">将字符串或数转换为整数</td>
</tr>
<tr>
<td style="text-align:left">math.ceil(number)</td>
<td style="text-align:left">以浮点数的方式返回向上圆整的结果</td>
</tr>
<tr>
<td style="text-align:left">math.floor(number)</td>
<td style="text-align:left">以浮点数的方式返回向下圆整的结果</td>
</tr>
<tr>
<td style="text-align:left">math.sqrt(number)</td>
<td style="text-align:left">返回平方根；不能用于负数</td>
</tr>
<tr>
<td style="text-align:left">pow(x, y[, z])</td>
<td style="text-align:left">返回x的y次方对z求模的结果</td>
</tr>
<tr>
<td style="text-align:left">print(object, …)</td>
<td style="text-align:left">将提供的实参打印出来,并用空格分隔</td>
</tr>
<tr>
<td style="text-align:left">repr(object)</td>
<td style="text-align:left">返回指定值的字符串表示</td>
</tr>
<tr>
<td style="text-align:left">round(number[, ndigits])</td>
<td style="text-align:left">四舍五入为指定的精度，正好为5时舍入到偶数</td>
</tr>
<tr>
<td style="text-align:left">str(object)</td>
<td style="text-align:left">将指定的值转换为字符串。用于转换 bytes 时，可指定编码和错误处理方式</td>
</tr>
<tr>
<td style="text-align:left">len(seq)</td>
<td style="text-align:left">返回序列的长度</td>
</tr>
<tr>
<td style="text-align:left">list(seq)</td>
<td style="text-align:left">将序列转换为列表</td>
</tr>
<tr>
<td style="text-align:left">max(args)</td>
<td style="text-align:left">返回序列或一组参数中的最大值</td>
</tr>
<tr>
<td style="text-align:left">min(args)</td>
<td style="text-align:left">返回序列和一组参数中的最小值</td>
</tr>
<tr>
<td style="text-align:left">reversed(seq)</td>
<td style="text-align:left">让你能够反向迭代序列</td>
</tr>
<tr>
<td style="text-align:left">sorted(seq)</td>
<td style="text-align:left">返回一个有序列表，其中包含指定序列中的所有元素</td>
</tr>
<tr>
<td style="text-align:left">tuple(seq)</td>
<td style="text-align:left">将序列转换为元组</td>
</tr>
<tr>
<td style="text-align:left">string.capwords(s[, sep])</td>
<td style="text-align:left">使用split 根据sep拆分s，将每项的首字母大写，再以空格为分隔符将它们合并起来</td>
</tr>
<tr>
<td style="text-align:left">ascii(obj)</td>
<td style="text-align:left">创建指定对象的ASCII表示</td>
</tr>
<tr>
<td style="text-align:left">dict(seq)</td>
<td style="text-align:left">从键值对、映射或关键字参数创建字典</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/17/搭建个人博客github-pages/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/17/搭建个人博客github-pages/" itemprop="url">
                  搭建个人博客github-pages
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-17 22:03:29" itemprop="dateCreated datePublished" datetime="2019-03-17T22:03:29+08:00">2019-03-17</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2020-09-12 00:30:54" itemprop="dateModified" datetime="2020-09-12T00:30:54+08:00">2020-09-12</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/hexo/" itemprop="url" rel="index"><span itemprop="name">hexo</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="下载软件"><a href="#下载软件" class="headerlink" title="下载软件"></a>下载软件</h1><ol>
<li>下载安装Node.js，官网地址：<a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">https://nodejs.org/en/download/</a></li>
<li>下载安装git，官网地址：<a href="https://git-scm.com/download/win" target="_blank" rel="noopener">https://git-scm.com/download/win</a></li>
<li>下载安装githubDesktop，官网地址：<a href="https://desktop.github.com/" target="_blank" rel="noopener">https://desktop.github.com/</a></li>
</ol>
<p>注：实际git与githubDesktop安装一个就可以，只是不习惯使用命令行的人使用githubDesktop更方便。</p>
<h1 id="注册github"><a href="#注册github" class="headerlink" title="注册github"></a>注册github</h1><p>官方地址：<a href="https://github.com/" target="_blank" rel="noopener">https://github.com/</a></p>
<p>注册后登录，创建一个自己的github pages项目，项目名称一般与自己的登录名一致。</p>
<h1 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">在本地创建一个Hexo目录，并进入目录，右键选择Git Bash Here</span><br><span class="line">npm install hexo-cli -g</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">hexo init</span><br><span class="line">hexo generate</span><br><span class="line">hexo server</span><br><span class="line">访问localhost:4000</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在执行hexo命令时提示：</span></span><br><span class="line">internal/modules/cjs/loader.js:596</span><br><span class="line">    throw err;</span><br><span class="line">    ^</span><br><span class="line"></span><br><span class="line">Error: Cannot find module 'D:\Git\node_modules\hexo-cli\bin\hexo'</span><br><span class="line">之后在C:\Users\r\AppData\Roaming\npm中找到node_modules，将其复制到D:\Git下后，可以正常使用hexo命令</span><br></pre></td></tr></table></figure>
<h2 id="配置SSH密钥"><a href="#配置SSH密钥" class="headerlink" title="配置SSH密钥"></a>配置SSH密钥</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C "your_email@example.com"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这将按照你提供的邮箱地址，创建一对密钥。一直回车就可以完成</span></span><br><span class="line">cat ~/.ssh/id_rsa.pub</span><br><span class="line">复制公钥，将公钥放到github页面中的Settings中的SSH and GPG keys中</span><br><span class="line">ssh -T git@github.com</span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试密钥是否生效，如果生效会有向用户打招呼的提示</span></span><br></pre></td></tr></table></figure>
<h2 id="设置用户信息"><a href="#设置用户信息" class="headerlink" title="设置用户信息"></a>设置用户信息</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name "ryanlijianchang"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 用户名</span></span><br><span class="line">git config --global user.email  "liji.anchang@163.com"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 填写自己的邮箱</span></span><br></pre></td></tr></table></figure>
<h2 id="将本地的Hexo文件更新到Github的库中"><a href="#将本地的Hexo文件更新到Github的库中" class="headerlink" title="将本地的Hexo文件更新到Github的库中"></a>将本地的Hexo文件更新到Github的库中</h2><ol>
<li>登录github</li>
<li>打开自己的项目</li>
<li>点击Clone or download，选择SSH，并复制地址</li>
<li>打开本地创建的Hexo目录，打开_config.yml文件</li>
<li><p>在配置文件中修改</p>
</li>
<li><p>执行命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo g -d</span><br><span class="line"><span class="meta">#</span><span class="bash"> 完成远程部署，如果有报错 ERROR Deployer not found: git，可以删除node_modules目录，再重新执行下面的命令</span></span><br><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
</li>
<li><p>访问name.github.io</p>
</li>
</ol>
<h2 id="使用自定义域名"><a href="#使用自定义域名" class="headerlink" title="使用自定义域名"></a>使用自定义域名</h2><p>将freenom的nameserver地址改为cloudflare给出的地址，登录cloudflare.com，创建一条DNS的CNAME记录，解析到github的个人主页默认域名上，默认域名一般就是仓库名，如xxx.github.io。之后登录到github上，选择仓库，进入settings，下拉到github pages，在Custom domain中输入上面创建的CNAME的域名，之后github会在创建项目的根目录下创建一个CNAME文件，其中写的就是CNAME的域名。这时就可以使用CNAME的域名访问了。另外，cloudflare中一定要加入一级域名的解析，不然其他解析无法生效。</p>
<h1 id="美化自己博客"><a href="#美化自己博客" class="headerlink" title="美化自己博客"></a>美化自己博客</h1><h2 id="安装主题"><a href="#安装主题" class="headerlink" title="安装主题"></a>安装主题</h2><ol>
<li>进入<a href="https://hexo.io/themes/" target="_blank" rel="noopener">https://hexo.io/themes/</a></li>
<li>选择自己喜欢的主题，并打开，打开后是一个github的页面，复制git地址</li>
<li>到本地Hexo目录中的themes右键选择Git Hash Here</li>
<li><p>克隆主题到本地<figure class="highlight plain"><figcaption><span>clone</span><a href="https://github.com/iissnan/hexo-theme-next```" target="_blank" rel="noopener">link</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">5. 修改Hexo配置文件，将_config.yml文件中的theme后的参数改为自己下载的主题的名字</span><br><span class="line">6. 部署主题，本地查看。</span><br><span class="line"></span><br><span class="line">```shell</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br><span class="line">访问localhost:4000</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>部署到Github上</p>
</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g -d</span><br></pre></td></tr></table></figure>
<h2 id="主题设定"><a href="#主题设定" class="headerlink" title="主题设定"></a>主题设定</h2><ol>
<li>打开主题配置文件</li>
</ol>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:<span class="symbol">\G</span>itHub<span class="symbol">\r</span>uopu89.github.io<span class="symbol">\t</span>hemes<span class="symbol">\h</span>exo-theme-next<span class="symbol">\_</span>config.yml</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>设置</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Schemes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">scheme: Muse</span></span><br><span class="line"><span class="meta">#</span><span class="bash">scheme: Mist</span></span><br><span class="line"><span class="meta">#</span><span class="bash">scheme: Pisces</span></span><br><span class="line">scheme: Gemini</span><br><span class="line"><span class="meta">#</span><span class="bash"> 现在有四种风格，使用哪个就去掉其前面的注释</span></span><br></pre></td></tr></table></figure>
<h2 id="设置语言"><a href="#设置语言" class="headerlink" title="设置语言"></a>设置语言</h2><ol>
<li>打开站点配置文件</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">E:\GitHub\ruopu89.github.io\_config.yml</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意这里一定是在站点配置文件中设置</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>设置</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">language: zh-TW</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在主题配置目录中有一个languages目录，在这里是可以使用的语言的文件。上面设置的语言应该和languages目录中的文件名是一样的。</span></span><br></pre></td></tr></table></figure>
<h2 id="设置菜单"><a href="#设置菜单" class="headerlink" title="设置菜单"></a>设置菜单</h2><ol>
<li>打开主题配置文件</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:\GitHub\ruopu89.github.io\themes\hexo-theme-next\_config.yml</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>设置</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: / || home	//主页</span><br><span class="line"><span class="meta">  #</span><span class="bash">about: /about/ || user	//关于页面</span></span><br><span class="line"><span class="meta">  #</span><span class="bash">tags: /tags/ || tags</span></span><br><span class="line">  tags: /tags || tags	//标签页 </span><br><span class="line">  categories: /categories/ || th	//分类页 </span><br><span class="line">  archives: /archives/ || archive	//归档页</span><br><span class="line"><span class="meta">  #</span><span class="bash">schedule: /schedule/ || calendar</span></span><br><span class="line"><span class="meta">  #</span><span class="bash">sitemap: /sitemap.xml || sitemap</span></span><br><span class="line"><span class="meta">  #</span><span class="bash">commonweal: /404/ || heartbeat	//公益 404</span></span><br><span class="line">//这里最前面的name:表示在页面中显示的内容；后面是路径；最后的|| name表示显示的图标样式。除了主页与归档页外，其他需要手动创建这个页面</span><br></pre></td></tr></table></figure>
<h2 id="设置侧栏"><a href="#设置侧栏" class="headerlink" title="设置侧栏"></a>设置侧栏</h2><blockquote>
<p>默认情况下，侧栏仅在文章页面（拥有目录列表）时才显示，并放置于右侧位置。</p>
</blockquote>
<ol>
<li>打开主题配置文件</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:\GitHub\ruopu89.github.io\themes\hexo-theme-next\_config.yml</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>设置位置</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sidebar:</span><br><span class="line">  position: left</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以使用的值有left和right</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>设置侧栏显示的时机</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sidebar:</span><br><span class="line">  display: post</span><br><span class="line">//可选项：</span><br><span class="line">//post - 默认行为，在文章页面（拥有目录列表）时显示</span><br><span class="line">//always - 在所有页面中都显示</span><br><span class="line">//hide - 在所有页面中都隐藏（可以手动展开）</span><br><span class="line">//remove - 完全移除</span><br><span class="line">//已知侧栏在 use motion: false 的情况下不会展示。 影响版本5.0.0及更低版本。</span><br></pre></td></tr></table></figure>
<h2 id="添加标签"><a href="#添加标签" class="headerlink" title="添加标签"></a>添加标签</h2><ol>
<li>新建页面</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在项目目录中右键打开git</span><br><span class="line">hexo new page tags</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在项目目录中的<span class="built_in">source</span>创建一个tags目录，如果没有这个目录，在页面上就没法打开这个标签</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>设置页面类型</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">在新建的tags目录中会自动生成一个叫index的文件，打开它</span><br><span class="line">---</span><br><span class="line">title: 标签</span><br><span class="line">date: 2014-12-22 12:39:04</span><br><span class="line">type: "tags"</span><br><span class="line">---</span><br><span class="line"><span class="meta">#</span><span class="bash"> index文件中的内容如上，添加<span class="built_in">type</span>: <span class="string">"tags"</span></span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>修改菜单</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">修改主题配置文件</span><br><span class="line">menu:</span><br><span class="line">  home: /</span><br><span class="line">  archives: /archives</span><br><span class="line">  tags: /tags</span><br><span class="line"><span class="meta">#</span><span class="bash"> tags一行要取消注释，这样在页面中才能显示tags标签</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>写作</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">在新建文章后，在文章头部会有如下内容</span><br><span class="line">---</span><br><span class="line">hetitle: 搭建个人博客github_pages</span><br><span class="line">date: 2018-08-30 08:32:00</span><br><span class="line">tags: hexo</span><br><span class="line">---</span><br><span class="line"><span class="meta">#</span><span class="bash"> 要指定此文章的tags，这样就可以将文章加入上面创建的tags中了，打开页面时在tags标签中会有一个hexo，在hexo中有我们的文章</span></span><br></pre></td></tr></table></figure>
<h2 id="添加分类页面"><a href="#添加分类页面" class="headerlink" title="添加分类页面"></a>添加分类页面</h2><ol>
<li>新建页面</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在项目目录中右键打开git</span><br><span class="line">hexo new page categories</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在项目目录中的<span class="built_in">source</span>创建一个categories目录，如果没有这个目录，在页面上就没法打开这个标签</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>设置页面类型</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">在新建的tags目录中会自动生成一个叫index的文件，打开它</span><br><span class="line">---</span><br><span class="line">title: 标签</span><br><span class="line">date: 2014-12-22 12:39:04</span><br><span class="line">type: "categories"</span><br><span class="line">---</span><br><span class="line"><span class="meta">#</span><span class="bash"> index文件中的内容如上，添加<span class="built_in">type</span>: <span class="string">"categories"</span></span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>修改菜单</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">修改主题配置文件</span><br><span class="line">menu:</span><br><span class="line">  home: /</span><br><span class="line">  archives: /archives</span><br><span class="line">  categories: /categories</span><br><span class="line"><span class="meta">#</span><span class="bash"> categories一行要取消注释，这样在页面中才能显示categories标签</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>写作</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">在新建文章后，在文章头部会有如下内容</span><br><span class="line">---</span><br><span class="line">hetitle: 搭建个人博客github_pages</span><br><span class="line">date: 2018-08-30 08:32:00</span><br><span class="line">categories: hexo</span><br><span class="line">---</span><br><span class="line"><span class="meta">#</span><span class="bash"> 要指定此文章的tags，这样就可以将文章加入上面创建的tags中了，打开页面时在tags标签中会有一个hexo，在hexo中有我们的文章</span></span><br></pre></td></tr></table></figure>
<h2 id="添加搜索功能"><a href="#添加搜索功能" class="headerlink" title="添加搜索功能"></a>添加搜索功能</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cd /home/ruopu/文档/Github/ruopu.github.io</span><br><span class="line"><span class="meta">#</span><span class="bash"> 先到博客的根目录</span></span><br><span class="line">npm install hexo-generator-searchdb --save</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装搜索插件</span></span><br><span class="line">vim /home/ruopu/文档/Github/ruopu.github.io/_config.yml</span><br><span class="line">search:</span><br><span class="line">  path: search.xml</span><br><span class="line">  field: post</span><br><span class="line">  format: html</span><br><span class="line">  limit: 10000</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在博客的配置文件中添加上述内容</span></span><br><span class="line">vim /home/ruopu/文档/Github/ruopu.github.io/theme/hexo-next/_config.yml</span><br><span class="line">local_search:</span><br><span class="line">    enable: true</span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置主题的功能，上面内容默认是flase，改为<span class="literal">true</span></span></span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br><span class="line"><span class="meta">#</span><span class="bash"> 上传后就可以看到搜索功能了。</span></span><br></pre></td></tr></table></figure>
<h2 id="添加访客人数统计"><a href="#添加访客人数统计" class="headerlink" title="添加访客人数统计"></a>添加访客人数统计</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/layout/_partials/footer.swig</span><br><span class="line"><span class="meta">#</span><span class="bash"> 打开使用的主题下的这个文件</span></span><br><span class="line">&lt;div class="copyright"&gt;</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    &lt;script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"&gt;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">    &lt;span class="post-meta-divider"&gt;|&lt;/span&gt;</span><br><span class="line">    &lt;span id="busuanzi_container_site_pv"&gt;</span><br><span class="line">        本站总访问量: &lt;span id="busuanzi_value_site_pv"&gt;&lt;/span&gt;次</span><br><span class="line">    &lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在上方的两个div之间配置上面的代码，script是安装不蒜子的统计脚本，下面的本部总访问量是统计的PV量</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> pv：单个用户连续点击n篇文章，记录n次访问量</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> uv：单个用户连续点击n篇文章，只记录1次访客数</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用uv的方法</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> &lt;span id=<span class="string">"busuanzi_container_site_uv"</span>&gt;</span></span><br><span class="line"><span class="meta">#</span><span class="bash">     本站访客数&lt;span id=<span class="string">"busuanzi_value_site_uv"</span>&gt;&lt;/span&gt;人次</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> &lt;/span&gt;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://hexo-guide.readthedocs.io/zh_CN/latest/third-service/[%E4%B8%8D%E8%92%9C%E5%AD%90]%E8%AE%BF%E5%AE%A2%E4%BA%BA%E6%95%B0.html</span></span><br></pre></td></tr></table></figure>
<h2 id="添加文章阅读量统计"><a href="#添加文章阅读量统计" class="headerlink" title="添加文章阅读量统计"></a>添加文章阅读量统计</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">方法一</span><br><span class="line">vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/_config.yml            </span><br><span class="line">busuanzi_count:</span><br><span class="line">	enable: true    # 这里默认是false，改为true即可。next主题自带了不蒜子的统计功能</span><br><span class="line">	total_visitors: true</span><br><span class="line">	total_visitors_icon: user</span><br><span class="line">	total_views: true</span><br><span class="line">	total_views_icon: eye</span><br><span class="line">	post_views: true</span><br><span class="line">	post_views_icon: eye</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个方法在进入文章后，可以看到阅读次数</span></span><br><span class="line"></span><br><span class="line">方法二</span><br><span class="line">vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/layout/_macro/post.swig</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在&#123;<span class="comment"># LeanCould PageView #&#125;下添加下面内容</span></span></span><br><span class="line">&#123;# LeanCould PageView #&#125;</span><br><span class="line">&lt;span id="busuanzi_container_page_pv"&gt;                                                     &lt;span class="post-meta-divider"&gt;|&lt;/span&gt;</span><br><span class="line">    &lt;span class="post-meta-item-icon"&gt;</span><br><span class="line">    &lt;i class="fa fa-eye"&gt;&lt;/i&gt;</span><br><span class="line">	&lt;/span&gt; </span><br><span class="line">	阅读量: &lt;span id="busuanzi_value_page_pv"&gt;&lt;/span&gt;次</span><br><span class="line">&lt;/span&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个方法在首页就能看到每篇文章的阅读次数</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://hexo-guide.readthedocs.io/zh_CN/latest/third-service/[%E4%B8%8D%E8%92%9C%E5%AD%90]%E6%96%87%E7%AB%A0%E9%98%85%E8%AF%BB%E6%AC%A1%E6%95%B0.html</span></span><br></pre></td></tr></table></figure>
<h2 id="添加文章评论功能"><a href="#添加文章评论功能" class="headerlink" title="添加文章评论功能"></a>添加文章评论功能</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">1. 注册github应用，首先登录github，之后在settings-&gt;Developer settings-&gt;OAuth Apps中注册。注意需要输入四项内容，应用名称是自定义的，主页地址是自己的github页面的地址，但要注意，地址前要加https://，</span><br><span class="line">不然会报错，应用说明是自定义的，授权回调地址与主页地址一样。注册成功后会得到Client ID和Client Secret</span><br><span class="line"></span><br><span class="line">2. vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89</span><br><span class="line">.github.io/themes/hexo-theme-next/layout/_third-party/comments/gitalk.swig</span><br><span class="line">&#123;% if page.comments &amp;&amp; theme.gitalk.enable %&#125;</span><br><span class="line">  &lt;link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"&gt;</span><br><span class="line">  &lt;script src="https://unpkg.com/gitalk/dist/gitalk.min.js"&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script type="text/javascript"&gt;</span><br><span class="line">        var gitalk = new Gitalk(&#123;</span><br><span class="line">          clientID: '&#123;&#123; theme.gitalk.ClientID &#125;&#125;',</span><br><span class="line">          clientSecret: '&#123;&#123; theme.gitalk.ClientSecret &#125;&#125;',</span><br><span class="line">          repo: '&#123;&#123; theme.gitalk.repo &#125;&#125;',</span><br><span class="line">          owner: '&#123;&#123; theme.gitalk.githubID &#125;&#125;',</span><br><span class="line">          admin: ['&#123;&#123; theme.gitalk.adminUser &#125;&#125;'],</span><br><span class="line">          id: location.pathname,</span><br><span class="line">          distractionFreeMode: '&#123;&#123; theme.gitalk.distractionFreeMode &#125;&#125;'</span><br><span class="line">        &#125;)</span><br><span class="line">        gitalk.render('gitalk-container')           </span><br><span class="line">       &lt;/script&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line">3. vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/layout/_partials/comments.swig</span><br><span class="line">&#123;% elseif theme.gitalk.enable %&#125;</span><br><span class="line"> &lt;div id="gitalk-container"&gt;&lt;/div&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意，添加的内容与前面的elseif同一级别上即可，但不要加在最后，测试时加在了18行左右的位置</span></span><br><span class="line"></span><br><span class="line">4. vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89</span><br><span class="line">.github.io/themes/hexo-theme-next/layout/_third-party/comments/index.swig</span><br><span class="line">&#123;% include 'gitalk.swig' %&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在最后一行添加内容</span></span><br><span class="line"></span><br><span class="line">5. vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/source/css/_common/components/third-party/third-party.styl</span><br><span class="line">@import "gitalk";</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在最后一行上添加内容</span></span><br><span class="line"></span><br><span class="line">6. vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/source/css/_common/components/third-party/gitalk.styl</span><br><span class="line">.gt-header a, .gt-comments a, .gt-popup a</span><br><span class="line">  border-bottom: none;</span><br><span class="line">.gt-container .gt-popup .gt-action.is--active:before</span><br><span class="line">  top: 0.7em;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 新建文件，加入内容</span></span><br><span class="line"></span><br><span class="line">7. vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/_config.yml                                               </span><br><span class="line"><span class="meta">#</span><span class="bash"> Gitalk                                                                               <span class="comment"># Demo: https://gitalk.github.io</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Reference: https://asdfv1929.github.io/2018/01/20/gitalk/, https://liujunzhou.top/2018/8/10/gitalk-error/</span></span><br><span class="line">gitalk:</span><br><span class="line">	enable: true</span><br><span class="line">	github_id: abc89  # github帐号，不用写邮箱地址</span><br><span class="line">	repo: abc   # 仓库名称</span><br><span class="line">	client_id: # 注册得到的</span><br><span class="line">	client_secret: # 注册得到的</span><br><span class="line">	admin_user: abc89  # github帐号</span><br><span class="line">	distraction_free_mode: true # Facebook-like distraction free mode</span><br><span class="line">	</span><br><span class="line">8. 问题</span><br><span class="line">描述：在文章底部评论框中出现错误信息“Error: Not Found”</span><br><span class="line">解决办法：和repo属性有关，换一个新的仓库，比如新建仓库guestbook。</span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://extremegtr.github.io/2017/09/07/Add-Gitment-comment-system-to-hexo-theme-NexT/<span class="comment">#%E4%BF%AE%E6%94%B9NexT%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6</span></span></span><br></pre></td></tr></table></figure>
<h2 id="高亮显示代码"><a href="#高亮显示代码" class="headerlink" title="高亮显示代码"></a>高亮显示代码</h2><ol>
<li>编辑主题配置文件E:\GitHub\ruopu89.github.io\themes\hexo-theme-next_config.yml</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">highlight_theme: night blue</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可选的选择有：normal，night， night blue， night bright， night eighties</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>编辑站点配置文件E:\GitHub\ruopu89.github.io</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">highlight:</span><br><span class="line">  enable: true</span><br><span class="line">  line_number: true</span><br><span class="line">  auto_detect: true</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这里默认是<span class="literal">false</span></span></span><br><span class="line">  tab_replace:</span><br><span class="line"><span class="meta">  #</span><span class="bash"> 设置后，博客中的代码会有高亮显示，但显示的还是有问题。无论是否在代码中加入语言标记。</span></span><br></pre></td></tr></table></figure>
<h2 id="添加图片"><a href="#添加图片" class="headerlink" title="添加图片"></a>添加图片</h2><blockquote>
<p>图片默认被保存在主题目录中的source中的images中，如：E:\GitHub\ruopu89.github.io\themes\hexo-theme-next\source\images，我们可以在这个目录下新建目录，与博客名称相同，所有图片都保存在这里<br>使用图片的网络地址也可上传图片。这种方式的问题应该是，当图片的网络地址失效时，这个图片也就看不到了。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![](https://raw.githubusercontent.com/higoge/image/master/basic01/01.png)</span><br></pre></td></tr></table></figure></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">使用markdown语法添加图片时可以使用下面的语法</span><br><span class="line">&lt;img src="/images/image.jpg"/&gt;</span><br><span class="line">![](/images/images.jpg)</span><br><span class="line"><span class="meta">#</span><span class="bash"> 上面两种方法都可以添加图片，系统会自动到主题目录中的<span class="built_in">source</span>中的images中找图片。问题是，在markdown中是看不到图片的。因为提交后，系统会到images中找图片，所以要用这种格式，斜线也要用/。如果输入在windows中的路径，上传后是找不到图片的，所以也无法显示。</span></span><br></pre></td></tr></table></figure>
<h1 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h1><h3 id="github-Desktop提交时提示“Commit-failed-exit-code-1-received”"><a href="#github-Desktop提交时提示“Commit-failed-exit-code-1-received”" class="headerlink" title="github Desktop提交时提示“Commit failed - exit code 1 received”"></a>github Desktop提交时提示“Commit failed - exit code 1 received”</h3><p>解决：原因是不能提示的目录中也有.git目录，删除.git目录再上传就正常了。</p>
<h3 id="在另一台ubuntu18-04系统上重新部署hexo"><a href="#在另一台ubuntu18-04系统上重新部署hexo" class="headerlink" title="在另一台ubuntu18.04系统上重新部署hexo"></a>在另一台ubuntu18.04系统上重新部署hexo</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">* 安装所需软件包</span><br><span class="line">apt install -y nodejs</span><br><span class="line">apt install -y npm</span><br><span class="line">apt install -y git</span><br><span class="line">npm install hexo-cli -g</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line"><span class="meta">#</span><span class="bash"> 上面安装的nodejs是一个8.10的版本，也可以升级nodejs</span></span><br><span class="line">ssh-keygen -t rsa -C "ruopu1989@hotmail.com"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成密钥</span></span><br><span class="line">cat .ssh/id_rsa.pub</span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取密钥</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这两步在root和普通用户上都做了一遍。之后将得到的密钥复制到github上</span></span><br><span class="line">ssh -T git@github.com</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在两个帐户上都测试一下连接是否成功。如果成功会有下面的提示，测试发现只在root用户下执行成功，在普通用户上执行也可以通过，但提示github不提供shell访问</span></span><br><span class="line">    Hi ruopu89! You've successfully authenticated, but GitHub does not provide shell access.</span><br><span class="line">git config --global user.name "ruopu1989"</span><br><span class="line">git config --global user.email "ruopu1989@hotmail.com"</span><br><span class="line">cd /media/rp/00E219519546E/MyFile/GitHub/rp.github.io</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果这一步报错，可以尝试使用hexo clean撤消hexo g生成的静态文件，再执行hexo g重新生成再部署。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试</span></span><br></pre></td></tr></table></figure>
<h3 id="github个人博客多电脑使用"><a href="#github个人博客多电脑使用" class="headerlink" title="github个人博客多电脑使用"></a>github个人博客多电脑使用</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">apt install nodejs</span><br><span class="line">apt install npm</span><br><span class="line">npm install hexo-cli -g</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">cd /home/GitHub/ruopu.github.io</span><br><span class="line">ssh-keygen -t rsa -C "ruopu19@hotmail.com"</span><br><span class="line"><span class="meta">#</span><span class="bash"> -C后的是一些描述信息</span></span><br><span class="line">cat .ssh/id_rsa.pub</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将密钥复制到github上</span></span><br><span class="line">ssh -T git@github.com</span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试与github连接是否成功</span></span><br><span class="line">git config --global user.name "ruopu1989"</span><br><span class="line">git config --global user.email "ruopu1989@hotmail.com"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 自报家门</span></span><br><span class="line">git init</span><br><span class="line"><span class="meta">#</span><span class="bash"> 给源文件目录初始化git，虽然目录中已有内容，但这也不会报错的</span></span><br><span class="line">git remote add origin https://github.com/abc/abc.github.io.git</span><br><span class="line"><span class="meta">#</span><span class="bash"> 与远程的origin分支关联，最后的地址是github上项目的地址。使用git push时如果提示需要输入用户名和密码，可以删除远程地址，再试。命令：git remote remove origin。另外，这里也可以使用git@github.com:abc/abc.github.io.git地址。</span></span><br><span class="line">git checkout -b source</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建并切换分支，使用-b选择就是为了创建并切换。这与git branch <span class="built_in">source</span> &amp;&amp; git checkout <span class="built_in">source</span>两条命令的执行结果是一样的。</span></span><br><span class="line">git branch</span><br><span class="line"><span class="meta">#</span><span class="bash"> 现在本地只有一个<span class="built_in">source</span>分支，这也就是主分支</span></span><br><span class="line">git add .</span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加所有内容到暂存区</span></span><br><span class="line">git commit -m 'add source'</span><br><span class="line"><span class="meta">#</span><span class="bash"> 提交</span></span><br><span class="line">git push origin source</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将本地的<span class="built_in">source</span>分支推送到远程的origin分支上</span></span><br><span class="line">在github上将source设置为主分支，这样之后clone的就都是这个source分支上的内容了。</span><br><span class="line">** 上传中会有一个问题，就是theme目录中的主题文件上传后可能是灰色的，这是因为获得主题文件时就是从另一个库clone来的，所以主题文件目录中也有.git文件。如果上传了目录，解决方法如下：</span><br><span class="line">1. 将主题文件目录剪切到另一个不相干的目录中</span><br><span class="line">2. git add .</span><br><span class="line">3. git commit -m 'delete theme'</span><br><span class="line">4. git push</span><br><span class="line"><span class="meta">#</span><span class="bash"> 以上几步是为了将没有主题文件目录的信息再次提交，之后推送到远程库，也就删除了远程库上的主题文件目录</span></span><br><span class="line">5. 将主题文件目录中的.git、.gitignore、.gitattributes三个文件删除，之后将主题文件目录再剪切回github的theme目录中</span><br><span class="line">6. git add .</span><br><span class="line">7. git commit -m 'new theme'</span><br><span class="line">8. git push</span><br><span class="line"><span class="meta">#</span><span class="bash"> 再次将没有.git文件的主题推送到远程库就没有问题了。</span></span><br><span class="line">==============================================================================================</span><br><span class="line">推送时出现问题，原因是想将本地的文件推送到远程，但与远程有很多不同。可以使用下面命令强行推送。但本地的文件可能丢失。推送前将文件备份，推送后将丢失的文再复制到相应目录，再推送就可以了。</span><br><span class="line">git push -f origin source</span><br><span class="line"></span><br><span class="line">==============================================================================================</span><br><span class="line">另外还涉及一些常用命令</span><br><span class="line">git branch</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看当前分支</span></span><br><span class="line">git checkout master</span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换分支。加-b选项是创建并切换分支</span></span><br><span class="line">git merge source</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将<span class="built_in">source</span>分支内容合并到当前分支</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m "abc"</span><br><span class="line">git push origin source</span><br><span class="line">git diff</span><br><span class="line">git status</span><br><span class="line">git log</span><br><span class="line">git remote add origin https://github.com/abc/rab.github.io.git</span><br><span class="line">git reset --hard HEAD^</span><br><span class="line"><span class="meta">#</span><span class="bash"> 回退到上一个版本</span></span><br><span class="line">git reflog</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看提交与回退历史</span></span><br><span class="line">==============================================================================================</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/15/"><i class="fa fa-angle-left" aria-label="上一頁"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><span class="page-number current">16</span><a class="page-number" href="/page/17/">17</a><span class="space">&hellip;</span><a class="page-number" href="/page/26/">26</a><a class="extend next" rel="next" href="/page/17/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">ruopu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">260</span>
                    <span class="site-state-item-name">文章</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">32</span>
                    <span class="site-state-item-name">分類</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">183</span>
                    <span class="site-state-item-name">標籤</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ruopu</span>

  

  

  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>
  <span class="post-meta-divider">|</span>
  <span id="busuanzi_container_site_pv">
    本站总访问量: <span id="busuanzi_value_site_pv"></span>次
  </span>
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 強力驅動 v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主題 – <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Gemini</a> v6.4.0</div>





        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="訪客總數">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="總瀏覽次數">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.4.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.4.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.0"></script>



  



  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
