<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-TW">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



















  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.4.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.4.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.4.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.4.0',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="ruopu&#39;s blog">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="ruopu&#39;s blog">
<meta property="og:locale" content="zh-TW">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ruopu&#39;s blog">






  <link rel="canonical" href="http://yoursite.com/page/6/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>ruopu's blog</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-TW">

  
  
    
  

  <div class="container sidebar-position-right 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ruopu's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切換導航欄">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首頁</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />標籤</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分類</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />歸檔</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜尋</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜尋..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/29/corosync&pacemaker集群部署/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/29/corosync&pacemaker集群部署/" itemprop="url">
                  corosync&pacemaker集群部署
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-29 14:16:07" itemprop="dateCreated datePublished" datetime="2019-03-29T14:16:07+08:00">2019-03-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-04-04 10:33:08" itemprop="dateModified" datetime="2019-04-04T10:33:08+08:00">2019-04-04</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Cluster/" itemprop="url" rel="index"><span itemprop="name">Cluster</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><h4 id="OpenAIS"><a href="#OpenAIS" class="headerlink" title="OpenAIS"></a>OpenAIS</h4><blockquote>
<p>OpenAIS是基于SA Forum 标准的集群框架的应用程序接口规范。OpenAIS提供一种集群模式，这个模式包括集群框架，集群成员管理，通信方式，集群监测等，能够为集群软件或工具提供满足 AIS标准的集群接口，但是它没有集群资源管理功能，不能独立形成一个集群。OpenAIS组件包括AMF，CLM，CKPT，EVT，LCK，MSG，TMR，CPG，EVS等，因OpenAIS分支不同，组件略有不同。OpenAIS主要包含三个分支：Picacho，Whitetank，Wilson。Wilson是最新的，比较稳定的版本是从openais 1.0.0到openais1.1.4。Whitetank现在是主流分支版本，比较稳定的版本是openais0.80到openais0.86。Picacho第一代的OpenAIS的分支，比较稳定的版本是openais0.70和openais0.71。现在比较常用的是Whitetank和Wilson，两者之间有很多不同。OpenAIS从Whitetank升级到Wilson版本后，组件变化很大，Wilson把Openais核心架构组件独立出来放在Corosync（Corosync是一个集群管理引擎）里面。Whitetank包含的组件有AMF，CLM，CKPT，EVT，LCK ，MSG，CPG，CFG，EVS，aisparser，VSF_ykd，bojdb等。而Wilson只含有AMF，CLM，CKPT，LCK, MSG，EVT，TMR（TMR，Whitetank里面没有），这些都是AIS组件。其他核心组件被放到了Corosync内。Wilson被当做Corosync的一个插件。</p>
</blockquote>
<h4 id="corosync"><a href="#corosync" class="headerlink" title="corosync"></a>corosync</h4><blockquote>
<p>Corosync是OpenAIS发展到Wilson版本后衍生出来的开放性集群引擎工程。可以说Corosync是OpenAIS工程的一部分。OpenAIS从openais0.90开始独立成两部分，一个是Corosync；另一个是AIS标准接口Wilson。Corosync包含OpenAIS的核心框架用来对Wilson的标准接口的使用、管理。它为商用的或开源性的集群提供集群执行框架。Corosync执行高可用应用程序的通信组系统，它有以下特征： </p>
<ul>
<li>一个封闭的程序组（A closed process group communication model）通信模式，这个模式提供一种虚拟的同步方式来保证能够复制服务器的状态。 </li>
<li>一个简单可用性管理组件（A simple availability manager），这个管理组件可以重新启动应用程序的进程当它失败后。 </li>
<li>一个配置和内存数据的统计（A configuration and statistics <a href="http://en.wikipedia.org/wiki/in-memory_database" target="_blank" rel="noopener">in-memory database</a>），内存数据能够被设置，回复，接受通知的更改信息。 </li>
<li>一个定额的系统（A quorum  system），定额完成或者丢失时通知应用程序。 </li>
</ul>
</blockquote>
<h4 id="cman"><a href="#cman" class="headerlink" title="cman"></a>cman</h4><blockquote>
<p>CMAN是红帽RHCS套件的核心部分，CCS是CMAN集群配置系统，配置cluster.conf，而cluster.conf其实就是openais的配置文件，通过CCS映射到openais。 </p>
</blockquote>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><blockquote>
<p>AIS就是一个通用的应用程序编程接口，OpenAIS是AIS的子项目，标准的集群框架的应用程序接口规范，而corosync是OpenAIS是具体实现。</p>
</blockquote>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><h4 id="基本实现"><a href="#基本实现" class="headerlink" title="基本实现"></a>基本实现</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">===========================================================================================</span><br><span class="line">环境：</span><br><span class="line">准备三台主机，地址：192.168.2.132（primary, node1）、192.168.2.133（secondary, node2）。192.168.2.128（node3）提供NFS服务。</span><br><span class="line">===========================================================================================</span><br><span class="line">----------------</span><br><span class="line">   node1&amp;2</span><br><span class="line">----------------</span><br><span class="line">[root@primary ~]# ntpdate ntp.aliyun.com</span><br><span class="line"><span class="meta">#</span><span class="bash"> 同步时间</span></span><br><span class="line">[root@primary ~]# ssh-keygen -t rsa -P ''</span><br><span class="line">[root@primary ~]# ssh-copy-id -i ~/.ssh/id_rsa.pub 192.168.2.133</span><br><span class="line"><span class="meta">#</span><span class="bash"> 让两节点使用密钥通信</span></span><br><span class="line">[root@primary ~]# yum install -y corosync pacemaker</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装两个包</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# cd /etc/corosync/</span><br><span class="line">[root@primary corosync]# cp corosync.conf.example</span><br><span class="line">corosync.conf.example       corosync.conf.example.udpu  </span><br><span class="line">[root@primary corosync]# cp corosync.conf.example corosync.conf</span><br><span class="line">[root@primary corosync]# vim corosync.conf</span><br><span class="line">compatibility: whitetank</span><br><span class="line"><span class="meta">#</span><span class="bash"> 是否兼容whitetank </span></span><br><span class="line">totem &#123;</span><br><span class="line">	version: 2</span><br><span class="line">	secauth: on</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否打开安装认证，不让其他主机加入，打开此功能后需要使用corosync-keygen生成密钥 </span></span><br><span class="line">	threads: 0</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 工作时的线程数，0表示基于进程模式工作</span></span><br><span class="line">	interface &#123;</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 定义多个节点之间通过哪个接口，基于哪个多播地址，监听什么端口完成多播通信 </span></span><br><span class="line">		ringnumber: 0</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 环数目，一般为0，类似TTL值 </span></span><br><span class="line">		bindnetaddr: 192.168.2.0</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 这通常是要绑定到的接口的*网络*地址，也就是本机所在的网络。这样可以确保您可以跨所有集群节点使用此配置文件的相同实例，而无需修改此选项。 </span></span><br><span class="line">		mcastaddr: 239.165.134.13</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 多播地址</span></span><br><span class="line">		mcastport: 5405</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 多播监听端口 </span></span><br><span class="line">		ttl: 1</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">logging &#123;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定日志系统</span></span><br><span class="line">	fileline: off</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否记录fileline </span></span><br><span class="line">	to_stderr: no</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否发往标准错误输出，一般不发送</span></span><br><span class="line">	to_logfile: yes</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否记录到日志文件中</span></span><br><span class="line">	logfile: /var/log/cluster/corosync.log</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 日志位置 </span></span><br><span class="line">	to_syslog: no</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 也发往syslog一份，一般记录一份<span class="built_in">log</span>即可，所以这里关闭了此功能 </span></span><br><span class="line">	debug: off</span><br><span class="line">	timestamp: on</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否在日志中打开时间戳功能，如果是on，会影响系统性能 </span></span><br><span class="line">	logger_subsys &#123;</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否记录子系统，记录AMF，这是OpenAIS的子组件</span></span><br><span class="line">		subsys: AMF</span><br><span class="line">		debug: off</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">service &#123;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入此段，以插件形式运行pacemaker</span></span><br><span class="line">	ver: 0</span><br><span class="line">	name: pacemaker</span><br><span class="line">	use_mgmtd: yes</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 此项可有可无 </span></span><br><span class="line">&#125;</span><br><span class="line">aisexec &#123;</span><br><span class="line">	user: root</span><br><span class="line">	group:	root</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 以root用户身份运行，此项可有可无 </span></span><br><span class="line">&#125;</span><br><span class="line">[root@primary corosync]# ip link show</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN </span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</span><br><span class="line">    link/ether 00:0c:29:83:af:ca brd ff:ff:ff:ff:ff:ff</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看网卡是否支持MULTICAST</span></span><br><span class="line">[root@primary corosync]# corosync-keygen </span><br><span class="line">Corosync Cluster Engine Authentication key generator.</span><br><span class="line">Gathering 1024 bits for key from /dev/random.</span><br><span class="line">Press keys on your keyboard to generate entropy.</span><br><span class="line">Writing corosync key to /etc/corosync/authkey.</span><br><span class="line"><span class="meta">#</span><span class="bash"> 从随机数中生成密钥，需要1024个字符，可能不够，如果不够，可以下载大文件产生IO数，使熵池中生成随机数</span></span><br><span class="line">[root@primary corosync]# ll </span><br><span class="line">总用量 32</span><br><span class="line">-rw-r--r-- 1 root root 5384 7月  20 2011 amf.conf.example</span><br><span class="line">-r-------- 1 root root  128 4月   2 15:47 authkey</span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成了authkey文件，权限400</span></span><br><span class="line">[root@primary corosync]# scp authkey corosync.conf 192.168.2.133:/etc/corosync/</span><br><span class="line">[root@primary corosync]# service corosync start; ssh 192.168.2.133 'service corosync start'</span><br><span class="line">Starting Corosync Cluster Engine (corosync):               [  OK  ]</span><br><span class="line">Starting Corosync Cluster Engine (corosync): [  OK  ]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动两个节点的corosync服务</span></span><br><span class="line">[root@primary corosync]# ss -tlun</span><br><span class="line"><span class="meta">#</span><span class="bash"> 监听了5405多播端口</span></span><br><span class="line">[root@primary corosync]# tail -f /var/log/cluster/corosync.log</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看日志中是否有报错信息</span></span><br><span class="line">[root@primary corosync]# grep -e "Corosync Cluster Engine" -e "configuration file" /var/log/cluster/corosync.log</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看两个节点中是否有两条信息，如果有就证明启动成功了</span></span><br><span class="line">[root@primary corosync]# grep TOTEM /var/log/cluster/corosync.log</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看初始化成员节点通知是否正常发出，应该可以查到内容</span></span><br><span class="line">[root@primary corosync]# grep ERROR: /var/log/cluster/corosync.log | grep –v unpack_resources</span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="comment"># 检查启动过程中是否有错误产生，错误信息表示packmaker不久之后将不再作为corosync的插件运行，因此，建议使用cman作为集群基础架构服务，此处可安全忽略。 </span></span></span><br><span class="line">[root@primary corosync]# grep pcmk_startup /var/log/cluster/corosync.log</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果有信息说明启动完成</span></span><br></pre></td></tr></table></figure>
<h4 id="使用crmsh配置pacemaker"><a href="#使用crmsh配置pacemaker" class="headerlink" title="使用crmsh配置pacemaker"></a>使用crmsh配置pacemaker</h4><blockquote>
<p>crmsh工具在集群中的任一节点上安装均可，不需要每个节点都安装</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@primary corosync]# cd /etc/yum.repos.d/</span><br><span class="line">[root@primary yum.repos.d]# wget http://download.opensuse.org/repositories/network:/ha-clustering:/Stable/CentOS_CentOS-6/network:ha-clustering:Stable.repo</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载opensuse的源，因为crmsh工具是opensuse提供的</span></span><br><span class="line">[root@primary yum.repos.d]# yum install -y crmsh pssh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装，连接速度很慢</span></span><br><span class="line">[root@primary yum.repos.d]# crm</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入crm模式</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 16:03:21 2019</span><br><span class="line">Last change: Tue Apr  2 15:51:08 2019 by hacluster via crmd on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">0 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">No resources</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看状态，也可以直接使用crm status命令。可以看到DC是主机名为primary的节点，Online: [ primary secondary ]表示有两台主机都在线。</span></span><br></pre></td></tr></table></figure>
<h5 id="configure配置集群"><a href="#configure配置集群" class="headerlink" title="configure配置集群"></a>configure配置集群</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[root@primary ~]# crm </span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> configure</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在子命令中使用此命令，表示配置集群模式 </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> <span class="built_in">help</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看configure的帮助</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> show</span></span><br><span class="line">node primary</span><br><span class="line">node secondary</span><br><span class="line">property cib-bootstrap-options: \</span><br><span class="line">	have-watchdog=false \</span><br><span class="line">	dc-version=1.1.18-3.el6-bfe4e80420 \</span><br><span class="line">	cluster-infrastructure="classic openais (with plugin)" \</span><br><span class="line">	expected-quorum-votes=2</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这是configure中的子命令，显示当前集群配置信息，实际配置文件是XML格式的。显示的property表示集群的全局属性，全局属性是配置集群的基本特性的 </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> show xml</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这样就可以看到xml格式的配置文件</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> property </span></span><br><span class="line">batch-limit=                   enable-startup-probes=         node-health-strategy=          stonith-enabled= </span><br><span class="line">cluster-delay=                 have-watchdog=                 node-health-yellow=            stonith-max-attempts= </span><br><span class="line">cluster-ipc-limit=             is-managed-default=            pe-error-series-max=           stonith-timeout= </span><br><span class="line"><span class="meta">#</span><span class="bash"> 执行此命令后，再按两次Tab键，可以看到可以配置的全局属性。stonity-enabled=表示是否必须配置stonith设备，默认为是。</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> property stonith-enabled=</span></span><br><span class="line">stonith-enabled (boolean, [true]): </span><br><span class="line">    Failed nodes are STONITH'd</span><br><span class="line"><span class="meta">#</span><span class="bash"> 按两次Tab键后可以看到默认的值是True </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> property stonith-enabled=<span class="literal">false</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 禁用stonith</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 校验配置是否有错，如果没错，不会显示任何信息</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> show</span></span><br><span class="line">node primary</span><br><span class="line">node secondary</span><br><span class="line">property cib-bootstrap-options: \</span><br><span class="line">	have-watchdog=false \</span><br><span class="line">	dc-version=1.1.18-3.el6-bfe4e80420 \</span><br><span class="line">	cluster-infrastructure="classic openais (with plugin)" \</span><br><span class="line">	expected-quorum-votes=2 \</span><br><span class="line">	stonith-enabled=false</span><br><span class="line"><span class="meta">#</span><span class="bash"> 再查看，多了stonith-enabled=<span class="literal">false</span>一项</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 提交，这样才能生效。因为上面的配置都是在内存中完成的。</span></span><br></pre></td></tr></table></figure>
<h5 id="node"><a href="#node" class="headerlink" title="node"></a>node</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> node</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> ls</span></span><br><span class="line">..               help             fence            </span><br><span class="line">show             attribute        back             </span><br><span class="line">cd               ready            status-attr      </span><br><span class="line">quit             end              utilization      </span><br><span class="line">exit             ls               maintenance      </span><br><span class="line">online           bye              ?                </span><br><span class="line">status           clearstate       standby          </span><br><span class="line">list             up               server           </span><br><span class="line">delete           </span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看可用的命令</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> show</span></span><br><span class="line">primary: normal</span><br><span class="line">secondary: normal</span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示当前在线节点，都是normal状态</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> standby</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 把当前节点设置为备用状态 </span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> show</span></span><br><span class="line">primary: normal</span><br><span class="line">	standby=on</span><br><span class="line">secondary: normal</span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> online</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 再让节点上线</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> status</span></span><br><span class="line">&lt;nodes&gt;</span><br><span class="line">  &lt;node id="primary" uname="primary"&gt;</span><br><span class="line">    &lt;instance_attributes id="nodes-primary"&gt;</span><br><span class="line">      &lt;nvpair id="nodes-primary-standby" name="standby" value="off"/&gt;</span><br><span class="line">    &lt;/instance_attributes&gt;</span><br><span class="line">  &lt;/node&gt;</span><br><span class="line">  &lt;node id="secondary" uname="secondary"/&gt;</span><br><span class="line">&lt;/nodes&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看当前节点信息</span></span><br></pre></td></tr></table></figure>
<h5 id="resource"><a href="#resource" class="headerlink" title="resource"></a>resource</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> resource</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> <span class="built_in">help</span></span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看资源状态</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> stop resource-name</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止资源</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> start resource-name</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动资源</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> restart resource-name</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启资源</span></span><br></pre></td></tr></table></figure>
<h5 id="ra资源代理"><a href="#ra资源代理" class="headerlink" title="ra资源代理"></a>ra资源代理</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> ra </span></span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> ls</span></span><br><span class="line">..               info             quit             </span><br><span class="line">end              help             providers        </span><br><span class="line">up               list             cd               </span><br><span class="line">classes          meta             ls               </span><br><span class="line">back             exit             validate         </span><br><span class="line">bye              ?                </span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> classes</span></span><br><span class="line">lsb</span><br><span class="line">ocf / .isolation heartbeat linbit pacemaker</span><br><span class="line">service</span><br><span class="line">stonith</span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示资源代理模式 </span></span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> list lsb</span></span><br><span class="line">abrt-ccpp                abrt-oops                abrtd                    acpid                    atd</span><br><span class="line">auditd                   autofs                   blk-availability         bmc-snmp-proxy           certmonger</span><br><span class="line">cgconfig                 cgred                    cman                     corosync                 corosync-notifyd</span><br><span class="line">cpuspeed                 crond                    cups                     drbd                     exchange-bmc-os-info</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看lsb中有哪些资源代理可用</span></span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> list ocf heartbeat</span></span><br><span class="line">CTDB              Delay             Dummy             Filesystem        IPaddr            IPaddr2           IPsrcaddr</span><br><span class="line">LVM               MailTo            Route             SendArp           Squid             VirtualDomain     Xinetd</span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> list ocf pacemaker</span></span><br><span class="line">ClusterMon    Dummy         HealthCPU     HealthSMART   Stateful      SysInfo       SystemHealth  attribute     ifspeed</span><br><span class="line">ping          pingd         remote  </span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> list service</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> service与lsb是一样的</span></span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> list stonith</span></span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> <span class="built_in">help</span> info</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  info可以查看帮助信息</span></span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> info ocf:heartbeat:IPaddr</span></span><br></pre></td></tr></table></figure>
<h5 id="配置资源primitive"><a href="#配置资源primitive" class="headerlink" title="配置资源primitive"></a>配置资源primitive</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line"><span class="meta">crm(live)ra#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> configure</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> primitive webip ocf:heartbeat:IPaddr params ip=192.168.2.100 nic=eth1 cidr_netmask=24</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> webip是资源名称，ocf:heartbeat:IPaddr是资源代理，params 用来指明参数，IP地址，网卡，掩码。</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 16:26:40 2019</span><br><span class="line">Last change: Tue Apr  2 16:26:27 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">1 resource configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以看到webip资源添加到了节点1上</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> <span class="built_in">exit</span></span></span><br><span class="line">bye</span><br><span class="line">[root@primary ~]# ip a</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN </span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</span><br><span class="line">    link/ether 00:0c:29:83:af:ca brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.2.132/24 brd 192.168.2.255 scope global eth1</span><br><span class="line">    inet 192.168.2.100/24 brd 192.168.2.255 scope global secondary eth1</span><br><span class="line">    inet6 fe80::20c:29ff:fe83:afca/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看看到添加了一个IP</span></span><br><span class="line">[root@primary ~]# crm node standby</span><br><span class="line"><span class="meta">#</span><span class="bash"> 要将哪个节点转为备节点，就在哪个节点上执行此命令</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 16:30:38 2019</span><br><span class="line">Last change: Tue Apr  2 16:30:34 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">1 resource configured</span><br><span class="line"></span><br><span class="line">Node primary: standby</span><br><span class="line">Online: [ secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started secondary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看状态，online的就只有node2了</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node2</span><br><span class="line">-------------</span><br><span class="line">[root@secondary ~]# ip a</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN </span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: eth1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</span><br><span class="line">    link/ether 00:0c:29:af:e1:97 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.2.133/24 brd 192.168.2.255 scope global eth1</span><br><span class="line">    inet 192.168.2.100/24 brd 192.168.2.255 scope global secondary eth1</span><br><span class="line">    inet6 fe80::20c:29ff:feaf:e197/64 scope link </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以看到ip地址转到node2了</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# crm node online</span><br><span class="line"><span class="meta">#</span><span class="bash"> 让节点1上线</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 16:32:28 2019</span><br><span class="line">Last change: Tue Apr  2 16:32:25 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">1 resource configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started secondary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 资源没有转回</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node2</span><br><span class="line">-------------</span><br><span class="line">[root@secondary ~]# service corosync stop</span><br><span class="line">Signaling Corosync Cluster Engine (corosync) to terminate: [  OK  ]</span><br><span class="line">Waiting for corosync services to unload:.                  [  OK  ]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 停掉节点2的服务，看资源是转到节点1上</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition WITHOUT quorum</span><br><span class="line">Last updated: Tue Apr  2 16:34:22 2019</span><br><span class="line">Last change: Tue Apr  2 16:32:25 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">1 resource configured</span><br><span class="line"></span><br><span class="line">Online: [ primary ]</span><br><span class="line">OFFLINE: [ secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Stopped</span><br><span class="line"><span class="meta">#</span><span class="bash"> 看资源是否转移，显示资源没有启动，因为一个服务停止了，所以只有一个节点在线，未超过半数，并且资源默认是关闭的，所以资源未启动 </span></span><br><span class="line">[root@primary ~]# crm configure</span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> property no-quorum-policy=ignore</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置没有法定票数时怎么办，设置为ignore</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> <span class="built_in">exit</span></span></span><br><span class="line">bye</span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition WITHOUT quorum</span><br><span class="line">Last updated: Tue Apr  2 16:36:29 2019</span><br><span class="line">Last change: Tue Apr  2 16:35:58 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">1 resource configured</span><br><span class="line"></span><br><span class="line">Online: [ primary ]</span><br><span class="line">OFFLINE: [ secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这时可以看到资源启动了</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node2</span><br><span class="line">-------------</span><br><span class="line">[root@secondary ~]# service corosync start</span><br><span class="line">Starting Corosync Cluster Engine (corosync): </span><br><span class="line">                                                           [  OK  ]</span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# crm resource</span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status webip</span></span><br><span class="line">resource webip is running on: primary </span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看资源状态，显示资源在primary上</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> migrate webip secondary</span></span><br><span class="line">INFO: Move constraint created for webip to secondary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 转移资源 到secondary上，secondary是主机名</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status webip</span></span><br><span class="line">resource webip is running on: secondary </span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示资源在secondary上</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> stop webip</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止资源 </span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status webip</span></span><br><span class="line">resource webip is NOT running</span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> start webip</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动资源 </span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status webip</span></span><br><span class="line">resource webip is running on: secondary </span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status </span></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看所有资源</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> unmigrate webip</span></span><br><span class="line">INFO: Removed migration constraints for webip</span><br><span class="line"><span class="meta">#</span><span class="bash"> 转回到原来的节点</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> status webip</span></span><br><span class="line">resource webip is running on: secondary </span><br><span class="line"><span class="meta">#</span><span class="bash"> 因为没有倾向性，所以没有转移</span></span><br></pre></td></tr></table></figure>
<h5 id="高可用web"><a href="#高可用web" class="headerlink" title="高可用web"></a>高可用web</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br></pre></td><td class="code"><pre><span class="line">----------------</span><br><span class="line">   node1&amp;2</span><br><span class="line">----------------</span><br><span class="line">[root@primary ~]# yum install -y httpd</span><br><span class="line">[root@primary ~]# vim /var/www/html/index.html</span><br><span class="line">node1:primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 提供网页文件，另一台内容为node2:secondary</span></span><br><span class="line">[root@primary ~]# service httpd start</span><br><span class="line">[root@primary ~]# curl 192.168.2.132</span><br><span class="line">node1:primary</span><br><span class="line">[root@primary ~]# curl 192.168.2.133</span><br><span class="line">node2:secondary</span><br><span class="line">[root@secondary ~]# service httpd stop</span><br><span class="line">[root@secondary ~]# chkconfig httpd off</span><br><span class="line"><span class="meta">#</span><span class="bash"> 因为要高可用此资源，所以不可以让服务自动启动</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# crm configure      </span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> primitive webserver lsb:httpd</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加资源</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node2</span><br><span class="line">-------------</span><br><span class="line">[root@secondary ~]# ss -tln</span><br><span class="line"><span class="meta">#</span><span class="bash"> web服务在节点2上启动了</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# crm resource</span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> show</span></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started</span><br><span class="line"> webserver	(lsb:httpd):	Started</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看资源是启动的</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> stop webserver</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止资源</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> show</span></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started</span><br><span class="line"> webserver	(lsb:httpd):	Stopped (disabled)</span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> start webserver</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 再启动</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> show</span></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started</span><br><span class="line"> webserver	(lsb:httpd):	Started</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这时资源还是在节点2上启动</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> node</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> standby secondary</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 让节点2成为备用节点</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:10:10 2019</span><br><span class="line">Last change: Tue Apr  2 17:08:47 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Node secondary: standby</span><br><span class="line">Online: [ primary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这时两个资源都在节点1上运行了</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> node online secondary</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 让节点2上线</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:11:16 2019</span><br><span class="line">Last change: Tue Apr  2 17:11:08 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started secondary</span><br><span class="line"><span class="meta"> #</span><span class="bash"> web资源又转移到了节点2上</span></span><br><span class="line"> </span><br><span class="line"> ==========================================================================================</span><br><span class="line"> 使用资源组的方式，让资源在同一个节点运行</span><br><span class="line"> ==========================================================================================</span><br><span class="line"><span class="meta"> crm(live)configure#</span><span class="bash"> group webservice webip webserver</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 定义一个组叫webservice，组内有两个资源</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> <span class="built_in">exit</span></span></span><br><span class="line">bye</span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:14:15 2019</span><br><span class="line">Last change: Tue Apr  2 17:13:22 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> Resource Group: webservice</span><br><span class="line">     webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line">     webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> web资源又转移到节点1上了</span></span><br><span class="line">[root@primary ~]# crm configure</span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> edit</span></span><br><span class="line">node primary \</span><br><span class="line">        attributes standby=off</span><br><span class="line">node secondary \</span><br><span class="line">        attributes standby=off</span><br><span class="line">primitive webip IPaddr \</span><br><span class="line">        params ip=192.168.2.100 nic=eth1 cidr_netmask=24 \</span><br><span class="line">        meta target-role=Started</span><br><span class="line">primitive webserver lsb:httpd \</span><br><span class="line">        meta target-role=Started</span><br><span class="line">group webservice webip webserver</span><br><span class="line">property cib-bootstrap-options: \</span><br><span class="line">        have-watchdog=false \</span><br><span class="line">        dc-version=1.1.18-3.el6-bfe4e80420 \</span><br><span class="line">        cluster-infrastructure="classic openais (with plugin)" \</span><br><span class="line">        expected-quorum-votes=2 \</span><br><span class="line">        stonith-enabled=false \</span><br><span class="line">        no-quorum-policy=ignore</span><br><span class="line"><span class="meta">#</span><span class="bash"> 编辑配置文件</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:18:54 2019</span><br><span class="line">Last change: Tue Apr  2 17:18:36 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> Resource Group: webservice</span><br><span class="line">     webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line">     webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以看到两个资源在一个资源组中</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> configure delete webservice</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除资源组，并不会报错，资源组马上被删除了</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:19:12 2019</span><br><span class="line">Last change: Tue Apr  2 17:19:10 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started secondary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 资源组没有了</span></span><br><span class="line">==========================================================================================</span><br><span class="line">定义排列约束，即将资源绑定在一起</span><br><span class="line">==========================================================================================</span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> configure</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> colocation webserver_with_webip inf: webserver webip</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> colocation定义排列约束，webserver_with_webip是自定义名称，inf表示定义分数，冒号后没有东西表示无穷大，这样两个资源就永远在一起了 </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:26:39 2019</span><br><span class="line">Last change: Tue Apr  2 17:26:35 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 提交后，两个资源就都在节点1上运行了</span></span><br><span class="line">==========================================================================================</span><br><span class="line">定义顺序约束，即资源的启动顺序。定义位置约束，即让资源倾向在哪个节点上运行。</span><br><span class="line">==========================================================================================</span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> order webip_before_webserver Mandatory: webip webserver</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 定义顺序约束，先启动webip再启动webserver </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> location webip_on_node2 webip 50: secondary</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 定义位置约束，让webip资源尽量在节点2上运行 </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:51:11 2019</span><br><span class="line">Last change: Tue Apr  2 17:50:50 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started secondary</span><br><span class="line"> webserver	(lsb:httpd):	Started secondary</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 提交后，资源都转到节点2运行了</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"> crm(live)configure#</span><span class="bash"> delete webip_on_node2 </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> show</span></span><br><span class="line">node primary \</span><br><span class="line">	attributes standby=off</span><br><span class="line">node secondary \</span><br><span class="line">	attributes standby=off</span><br><span class="line">primitive webip IPaddr \</span><br><span class="line">	params ip=192.168.2.100 nic=eth1 cidr_netmask=24 \</span><br><span class="line">	meta target-role=Started</span><br><span class="line">primitive webserver lsb:httpd \</span><br><span class="line">	meta target-role=Started</span><br><span class="line">order webip_before_webserver Mandatory: webip webserver</span><br><span class="line">colocation webserver_with_webip inf: webserver webip</span><br><span class="line">property cib-bootstrap-options: \</span><br><span class="line">	have-watchdog=false \</span><br><span class="line">	dc-version=1.1.18-3.el6-bfe4e80420 \</span><br><span class="line">	cluster-infrastructure="classic openais (with plugin)" \</span><br><span class="line">	expected-quorum-votes=2 \</span><br><span class="line">	stonith-enabled=false \</span><br><span class="line">	no-quorum-policy=ignore</span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> location webip_on_node2 webip rule 50: <span class="comment">#uname eq secondary</span></span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> standby secondary</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 让节点2成为备用节点</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:55:23 2019</span><br><span class="line">Last change: Tue Apr  2 17:55:07 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Node secondary: standby</span><br><span class="line">Online: [ primary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这时资源会转移到节点1</span></span><br><span class="line"><span class="meta">crm(live)node#</span><span class="bash"> online secondary</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 节点2上线</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 17:55:38 2019</span><br><span class="line">Last change: Tue Apr  2 17:55:34 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started secondary</span><br><span class="line"> webserver	(lsb:httpd):	Started secondary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 资源又转回到节点2</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> rsc_defaults resource-stickiness=50</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置资源指黏性值，默认是0。之前的命令property default-resource-stickiness=50 已经不能使用了</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> node standby secondary</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 节点2下线</span></span><br><span class="line">[root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 18:10:12 2019</span><br><span class="line">Last change: Tue Apr  2 18:07:48 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Node secondary: standby</span><br><span class="line">Online: [ primary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 资源到节点1</span></span><br><span class="line"><span class="meta"> crm(live)#</span><span class="bash"> node online secondary</span></span><br><span class="line"><span class="meta"> #</span><span class="bash"> 节点2上线</span></span><br><span class="line"> [root@primary ~]# crm status</span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 18:11:19 2019</span><br><span class="line">Last change: Tue Apr  2 18:10:41 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 资源不再转移，与设置资源黏性有关</span></span><br><span class="line"> [root@primary ~]# killall httpd</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 停止web服务</span></span><br><span class="line"><span class="meta"> crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Tue Apr  2 18:12:49 2019</span><br><span class="line">Last change: Tue Apr  2 18:10:41 2019 by root via crm_attribute on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">2 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line"> webserver	(lsb:httpd):	Started primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认只高可用节点，资源停掉也不会关心，还是显示资源在节点1上运行</span></span><br><span class="line"></span><br><span class="line">===========================================================================================</span><br><span class="line">配置高可用web资源，设置监控</span><br><span class="line">===========================================================================================</span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> resource</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> stop webserver</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> stop webip</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止资源</span></span><br><span class="line"><span class="meta">crm(live)resource#</span><span class="bash"> <span class="built_in">cd</span> ..</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> configure edit</span></span><br><span class="line">node primary \</span><br><span class="line">        attributes standby=off</span><br><span class="line">node secondary \</span><br><span class="line">        attributes standby=off</span><br><span class="line">property cib-bootstrap-options: \</span><br><span class="line">        have-watchdog=false \</span><br><span class="line">        dc-version=1.1.18-3.el6-bfe4e80420 \</span><br><span class="line">        cluster-infrastructure="classic openais (with plugin)" \</span><br><span class="line">        expected-quorum-votes=2 \</span><br><span class="line">        stonith-enabled=false \</span><br><span class="line">        no-quorum-policy=ignore</span><br><span class="line">rsc_defaults rsc-options: \</span><br><span class="line">        resource-stickiness=50</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除上面定义的资源，下面重新定义</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> primitive webip ocf:heartbeat:IPaddr params ip=192.168.2.100 nic=eth1 cidr_netmask=24 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 定义资源</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> monitor webip 10s:20s</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 单独定义monitor，后面是interval和timeout的时间</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> primitive webserver lsb:httpd op monitor interval=10s timeout=20s</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 也可以将定义资源与监控在一起定义。一定要用op才能使用monitor命令。monitor表示监控，interval=10s timeout=20s是监控的轮询时间和超时时间，有了监控，就可以在资源停止时进行转移了 </span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> group webservice webip webserver</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line">[root@primary ~]# ss -tln</span><br><span class="line"><span class="meta">#</span><span class="bash"> 现在服务运行在节点1上</span></span><br><span class="line">[root@primary ~]# killall httpd</span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止web服务</span></span><br><span class="line">[root@primary ~]# ss -tln</span><br><span class="line"><span class="meta">#</span><span class="bash"> 10秒后，web服务会再次启动</span></span><br><span class="line">[root@primary ~]# yum install -y epel-release</span><br><span class="line">[root@primary ~]# yum install -y nginx</span><br><span class="line">[root@primary ~]# killall httpd</span><br><span class="line">[root@primary ~]# service nginx start</span><br><span class="line">Starting nginx:                                            [  OK  ]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止httpd服务，并启动nginx服务，为了不让httpd服务在节点1启动。看资源是否会转移到节点2上</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node2</span><br><span class="line">-------------</span><br><span class="line">[root@secondary ~]# ss -tln</span><br><span class="line">[root@secondary ~]# ip a</span><br><span class="line"><span class="meta">#</span><span class="bash"> 服务与地址都转到了节点2上</span></span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node3</span><br><span class="line">-------------</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用此节点提供NFS服务</span></span><br><span class="line">[root@webdav ~]# yum install -y nfs-utils nginx</span><br><span class="line">[root@webdav ~]# systemctl start nfs</span><br><span class="line">[root@webdav ~]# mkdir /shared</span><br><span class="line">[root@webdav ~]# vim /shared/index.html</span><br><span class="line">test page</span><br><span class="line">[root@webdav ~]# vim /etc/exports</span><br><span class="line">/shared       192.168.2.0/24(rw,no_root_squash) 192.168.1.0/24(rw)</span><br><span class="line">[root@webdav ~]# exportfs -ra</span><br><span class="line">[root@webdav ~]# showmount -e 192.168.2.128</span><br><span class="line"></span><br><span class="line">-------------</span><br><span class="line">   node1</span><br><span class="line">-------------</span><br><span class="line">[root@primary ~]# crm configure</span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> primitive webstore ocf:heartbeat:Filesystem params device=<span class="string">"192.168.2.128:/shared"</span> directory=<span class="string">"/var/www/html"</span> fstype=<span class="string">"nfs"</span> op monitor interval=20s timeout=40s op start timeout=60s op stop timeout=60s</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 定义一个存储资源，提供NFS地址与挂载地址、文件系统类型。最后设置监控。</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> edit</span></span><br><span class="line">group webservice webip webserver webstore</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将资源加入组</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> verify</span></span><br><span class="line"><span class="meta">crm(live)configure#</span><span class="bash"> commit</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: secondary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Wed Apr  3 04:58:49 2019</span><br><span class="line">Last change: Wed Apr  3 04:57:53 2019 by hacluster via cibadmin on secondary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">3 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary ]</span><br><span class="line">OFFLINE: [ secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> Resource Group: webservice</span><br><span class="line">     webip	(ocf::heartbeat:IPaddr):	Started primary</span><br><span class="line">     webserver	(lsb:httpd):	Stopped</span><br><span class="line">     webstore	(ocf::heartbeat:Filesystem):	Stopped</span><br><span class="line"><span class="meta">#</span><span class="bash"> 因为实验不是一起做的，提供NFS服务是第二次接着做，所以忘记上一次为什么资源会停止了，新加入的服务也停止了，使用节点上线与启动资源的命令也没有反应。所以下面准备重新启动服务</span></span><br><span class="line">[root@primary ~]# service corosync status</span><br><span class="line">corosync (pid  46159) is running...</span><br><span class="line">[root@primary ~]# kill -9 46159</span><br><span class="line"><span class="meta">#</span><span class="bash"> 因为停止服务非常 慢，所以使用<span class="built_in">kill</span>杀死服务，两个节点都重新启动服务</span></span><br><span class="line">[root@primary ~]# service corosync start</span><br><span class="line">[root@primary ~]# crm </span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: NONE</span><br><span class="line">Last updated: Wed Apr  3 05:02:40 2019</span><br><span class="line">Last change: Wed Apr  3 04:57:53 2019 by hacluster via cibadmin on secondary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">3 resources configured</span><br><span class="line"></span><br><span class="line">OFFLINE: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> Resource Group: webservice</span><br><span class="line">     webip	(ocf::heartbeat:IPaddr):	Stopped</span><br><span class="line">     webserver	(lsb:httpd):	Stopped</span><br><span class="line">     webstore	(ocf::heartbeat:Filesystem):	Stopped</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动服务后，资源还是停止状态</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> resource start webservice</span></span><br><span class="line"><span class="meta">crm(live)#</span><span class="bash"> status</span></span><br><span class="line">Stack: classic openais (with plugin)</span><br><span class="line">Current DC: primary (version 1.1.18-3.el6-bfe4e80420) - partition with quorum</span><br><span class="line">Last updated: Wed Apr  3 05:03:07 2019</span><br><span class="line">Last change: Wed Apr  3 05:03:03 2019 by root via cibadmin on primary</span><br><span class="line"></span><br><span class="line">2 nodes configured (2 expected votes)</span><br><span class="line">3 resources configured</span><br><span class="line"></span><br><span class="line">Online: [ primary secondary ]</span><br><span class="line"></span><br><span class="line">Full list of resources:</span><br><span class="line"></span><br><span class="line"> Resource Group: webservice</span><br><span class="line">     webip	(ocf::heartbeat:IPaddr):	Started secondary</span><br><span class="line">     webserver	(lsb:httpd):	Started secondary</span><br><span class="line">     webstore	(ocf::heartbeat:Filesystem):	Started secondary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动资源后正常了</span></span><br><span class="line">访问192.168.2.100，可以看到test page的字样证明成功了。</span><br><span class="line"><span class="meta">#</span><span class="bash"> 停止节点2后，资源无法转移，后发现是在节点1上启动了nginx服务，停止nginx服务后仍然无法启动webserver资源。未找到原因，删除webserver资源重新添加后正常。</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/29/drbd基本配置使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/29/drbd基本配置使用/" itemprop="url">
                  drbd基本配置使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-29 10:57:21 / 修改時間：14:10:56" itemprop="dateCreated datePublished" datetime="2019-03-29T10:57:21+08:00">2019-03-29</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Cluster/" itemprop="url" rel="index"><span itemprop="name">Cluster</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><blockquote>
<p>DRBD即Distributed Relicated Block Device：分布式磁盘块设备， 可以解决磁盘单点故障。一般情况下只支持两个节点。 </p>
<p>一般情况下文件写入磁盘的步骤是：写操作 –&gt; 文件系统 –&gt; 内存缓存中 –&gt; 磁盘调度器 –&gt; 磁盘驱动器 –&gt; 写入磁盘。而DRBD的工作机制如上图所示，数据经过buffer cache后有内核中的DRBD模块通过tcp/ip协议栈经过网卡和对方建立数据同步。 </p>
</blockquote>
<p><img src="/images/drbd/工作流程.png" alt=""></p>
<h4 id="工作模式"><a href="#工作模式" class="headerlink" title="工作模式"></a>工作模式</h4><blockquote>
<ol>
<li><p>主从模型</p>
<p>master/slave模型，在某一时刻只允许有一个主节点。主节点的作用是可以挂载使用，写入数据等；从节点只作为主节点的镜像，是主节点的备份。 </p>
</li>
<li><p>主主模型</p>
<p>dula primary模型，2个节点都可以当做主节点来挂载使用。需要配合集群文件系统使用，通过分布式文件锁管理器避免同时写一个文件造成文件系统损坏的问题。</p>
</li>
</ol>
</blockquote>
<h4 id="复制模型"><a href="#复制模型" class="headerlink" title="复制模型"></a>复制模型</h4><blockquote>
<ol>
<li>A协议：异步复制（asynchronous），写操作到本机网卡时即认为成功，性能好，数据可靠性差。 </li>
<li>B协议：半同步复制（semi sync），写操作到达备节点网卡即认为成功，数据可靠性介于A和C之间。 </li>
<li>C协议：同步复制（ sync），备用节点写入磁盘即认为成功，性能差，数据可靠性高。也是drbd默认使用的复制协议 </li>
</ol>
</blockquote>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">===========================================================================================</span><br><span class="line">环境：</span><br><span class="line">主机两台，操作系统CentOS6.6，内核2.6.32-504.el6.x86_64。地址：192.168.2.132、192.168.2.133</span><br><span class="line">安装与配置在两个节点上是一样的</span><br><span class="line">===========================================================================================</span><br><span class="line"><span class="meta">#</span><span class="bash"> 两台主机均按如下方法操作</span></span><br><span class="line">[root@primary drbd]# rpm -ivh drbd84-utils-8.9.2-1.el6.elrepo.x86_64.rpm kmod-drbd84-8.4.6-1.el6.elrepo.x86_64.rpm</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装包取自生产环境。drbd84-utils-8.9.1-1.el6.elrepo包提供配置文件与工具，komd-drbd84-8.4.6-504.el6.x86_64.rpm包提供内核模块。注意两个包要一起安装，不然可能不会添加设备</span></span><br><span class="line">[root@template ~]# ls /dev/d</span><br><span class="line">disk/   dm-1    drbd1   drbd11  drbd13  drbd15  drbd3   drbd5   drbd7   drbd9   dvdrw   </span><br><span class="line">dm-0    drbd0   drbd10  drbd12  drbd14  drbd2   drbd4   drbd6   drbd8   dvd</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装软件后可以看到添加了很多以drbd开头的设备</span></span><br><span class="line">[root@primary ~]# fdisk /dev/sdb</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在两个分区上提供大小一致的分区</span></span><br><span class="line">[root@primary ~]# ntpdate ntp1.aliyun.com</span><br><span class="line"><span class="meta">#</span><span class="bash"> 同步时间</span></span><br><span class="line">[root@primary ~]# partprobe /dev/sdb</span><br><span class="line">[root@primary drbd]# vim /etc/sysconfig/network</span><br><span class="line">NETWORKING=yes</span><br><span class="line">HOSTNAME=primary</span><br><span class="line">[root@primary drbd]# hostname primary</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改主机名</span></span><br><span class="line">[root@primary drbd]# ssh-keygen -t rsa -P ''</span><br><span class="line">[root@primary drbd]# ssh-copy-id -i ~/.ssh/id_rsa.pub 192.168.2.133</span><br><span class="line"><span class="meta">#</span><span class="bash"> 密钥通信</span></span><br><span class="line">[root@primary drbd]# vim /etc/hosts</span><br><span class="line">192.168.2.132 primary</span><br><span class="line">192.168.2.133 secondary</span><br><span class="line">[root@primary drbd]# scp drbd84-utils-8.9.2-1.el6.elrepo.x86_64.rpm kmod-drbd84-8.4.6-1.el6.elrepo.x86_64.rpm secondary:/root</span><br></pre></td></tr></table></figure>
<h4 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">[root@primary ~]# cd /etc/drbd.d</span><br><span class="line">[root@primary drbd.d]# vim global_common.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 此配置文件提供全局配置，及多个drbd设备相同的配置 </span></span><br><span class="line">global &#123;</span><br><span class="line">	usage-count no;</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 是否加入改进计划 </span></span><br><span class="line">&#125;</span><br><span class="line">common &#123;</span><br><span class="line">	handlers &#123;</span><br><span class="line">	&#125;</span><br><span class="line">	startup &#123;</span><br><span class="line">	&#125;</span><br><span class="line">	options &#123;</span><br><span class="line">	&#125;</span><br><span class="line">	disk &#123;</span><br><span class="line">		on-io-error detach;</span><br><span class="line"><span class="meta">		#</span><span class="bash"> IO出问题时，就将节点卸载 </span></span><br><span class="line">	&#125;</span><br><span class="line">	net &#123;</span><br><span class="line">		cram-hmac-alg "sha1";</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 使用的算法 </span></span><br><span class="line">		shared-secret "mydrbdshared123";</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 共享密钥，建议用随机数生成 </span></span><br><span class="line">	&#125;</span><br><span class="line">	syncer &#123;</span><br><span class="line">		rate 500M;</span><br><span class="line"><span class="meta">		#</span><span class="bash"> 同步速率</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> glocal：全局属性，定义drbd自己的工作特性。common：通用属性，定义多组drbd设备通用特性 </span></span><br><span class="line"></span><br><span class="line">[root@primary drbd.d]# vim mystore.res</span><br><span class="line"><span class="meta">#</span><span class="bash"> 此文件为自建文件</span></span><br><span class="line">resource mystore &#123;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 首先定义公共配置，这一段可以被下面的多段使用 </span></span><br><span class="line">    device /dev/drdb0;</span><br><span class="line">    # 定义设备</span><br><span class="line">    disk /dev/sdb1;</span><br><span class="line">    # 定义磁盘，定义这两项就让磁盘与设备关联了？</span><br><span class="line">    meta-disk internal;</span><br><span class="line">     # 在自己的dev内部构建使用</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下面定义单个节点的属性 </span></span><br><span class="line">    on primary &#123;</span><br><span class="line">        address 192.168.2.132:7789;</span><br><span class="line">    &#125;</span><br><span class="line">    on secondary &#123;</span><br><span class="line">        address 192.168.2.132:7789;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">[root@primary drbd.d]# drbdadm create-md mystore</span><br><span class="line">initializing activity log</span><br><span class="line">NOT initializing bitmap</span><br><span class="line">Writing meta data...</span><br><span class="line">New drbd meta data block successfully created.</span><br><span class="line"><span class="meta">#</span><span class="bash"> 初始化资源，mystore是资源名，是在mystore.res文件中定义的。在两个节点上分别执行 </span></span><br><span class="line">[root@primary drbd.d]# drbdadm create-md mystore</span><br><span class="line">initializing activity log</span><br><span class="line">NOT initializing bitmap</span><br><span class="line">Writing meta data...</span><br><span class="line">New drbd meta data block successfully created.</span><br><span class="line">[root@primary drbd.d]# service drbd start</span><br><span class="line">Starting DRBD resources: [</span><br><span class="line">     create res: mystore</span><br><span class="line">   prepare disk: mystore</span><br><span class="line">    adjust disk: mystore</span><br><span class="line">     adjust net: mystore</span><br><span class="line">]</span><br><span class="line">....</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动一个节点后，它会等待另一个节点也启动此服务，这时两个节点才会一起启动服务</span></span><br><span class="line">[root@primary drbd.d]# cat /proc/drbd</span><br><span class="line">version: 8.4.6 (api:1/proto:86-101)</span><br><span class="line">GIT-hash: 833d830e0152d1e457fa7856e71e11248ccf3f70 build by phil@Build64R6, 2015-04-09 14:35:00</span><br><span class="line"> 0: cs:Connected ro:Secondary/Secondary ds:Inconsistent/Inconsistent C r-----</span><br><span class="line">    ns:0 nr:0 dw:0 dr:0 al:0 bm:0 lo:0 pe:0 ua:0 ap:0 ep:1 wo:f oos:3140544</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看运行状态，现在两个都是Secondary，没有同步 </span></span><br><span class="line">[root@primary drbd.d]# drbd-overview </span><br><span class="line"> 0:mystore/0  Connected Secondary/Secondary Inconsistent/Inconsistent </span><br><span class="line"><span class="meta"> #</span><span class="bash"> 使用此命令也可以</span></span><br><span class="line"> [root@primary drbd.d]# drbdadm primary --force mystore</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 设置节点1为主节点</span></span><br><span class="line"> [root@primary drbd.d]# cat /proc/drbd </span><br><span class="line">version: 8.4.6 (api:1/proto:86-101)</span><br><span class="line">GIT-hash: 833d830e0152d1e457fa7856e71e11248ccf3f70 build by phil@Build64R6, 2015-04-09 14:35:00</span><br><span class="line"> 0: cs:SyncSource ro:Primary/Secondary ds:UpToDate/Inconsistent C r-----</span><br><span class="line">    ns:1067676 nr:0 dw:0 dr:1069720 al:0 bm:0 lo:0 pe:2 ua:2 ap:0 ep:1 wo:f oos:2074560</span><br><span class="line">	[=====&gt;..............] sync'ed: 34.1% (2074560/3140544)K</span><br><span class="line">	finish: 0:00:52 speed: 39,708 (39,480) K/sec</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 显示同步过程，有两种状态，primary和secondary，主和从，左边为自己的状态右边是对方的状态 </span></span><br><span class="line">[root@primary drbd.d]# cat /proc/drbd </span><br><span class="line">version: 8.4.6 (api:1/proto:86-101)</span><br><span class="line">GIT-hash: 833d830e0152d1e457fa7856e71e11248ccf3f70 build by phil@Build64R6, 2015-04-09 14:35:00</span><br><span class="line"> 0: cs:Connected ro:Primary/Secondary ds:UpToDate/UpToDate C r-----</span><br><span class="line">    ns:3140544 nr:0 dw:0 dr:3141208 al:0 bm:0 lo:0 pe:0 ua:0 ap:0 ep:1 wo:f oos:0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 同步完成，这是状态为Primary/Secondary </span></span><br><span class="line">[root@primary drbd.d]# mke2fs -t ext4 /dev/drbd0</span><br><span class="line">mke2fs 1.41.12 (17-May-2010)</span><br><span class="line">文件系统标签=</span><br><span class="line">操作系统:Linux</span><br><span class="line">块大小=4096 (log=2)</span><br><span class="line">分块大小=4096 (log=2)</span><br><span class="line">Stride=0 blocks, Stripe width=0 blocks</span><br><span class="line">196608 inodes, 785136 blocks</span><br><span class="line">39256 blocks (5.00%) reserved for the super user</span><br><span class="line">第一个数据块=0</span><br><span class="line">Maximum filesystem blocks=805306368</span><br><span class="line">24 block groups</span><br><span class="line">32768 blocks per group, 32768 fragments per group</span><br><span class="line">8192 inodes per group</span><br><span class="line">Superblock backups stored on blocks: </span><br><span class="line">	32768, 98304, 163840, 229376, 294912</span><br><span class="line"></span><br><span class="line">正在写入inode表: 完成                            </span><br><span class="line">Creating journal (16384 blocks): 完成</span><br><span class="line">Writing superblocks and filesystem accounting information: 完成</span><br><span class="line"></span><br><span class="line">This filesystem will be automatically checked every 26 mounts or</span><br><span class="line">180 days, whichever comes first.  Use tune2fs -c or -i to override.</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在主节点格式化磁盘，从节点也会自动格式化，因为是按位同步的</span></span><br></pre></td></tr></table></figure>
<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">=========</span><br><span class="line">    node1   </span><br><span class="line">=========</span><br><span class="line">[root@primary drbd.d]# mount /dev/drbd0 /mnt</span><br><span class="line">[root@primary drbd.d]# ls /mnt</span><br><span class="line">lost+found</span><br><span class="line">[root@primary drbd.d]# cd /mnt</span><br><span class="line">[root@primary mnt]# cp /etc/issue ./</span><br><span class="line">[root@primary mnt]# ls</span><br><span class="line">issue  lost+found</span><br><span class="line">[root@primary mnt]# cd</span><br><span class="line">[root@primary ~]# umount /mnt</span><br><span class="line">[root@primary ~]# drbdadm secondary mystore</span><br><span class="line"><span class="meta">#</span><span class="bash"> 把自己切换为从节点</span></span><br><span class="line">[root@primary ~]# cat /proc/drbd</span><br><span class="line">version: 8.4.6 (api:1/proto:86-101)</span><br><span class="line">GIT-hash: 833d830e0152d1e457fa7856e71e11248ccf3f70 build by phil@Build64R6, 2015-04-09 14:35:00</span><br><span class="line"> 0: cs:Connected ro:Secondary/Secondary ds:UpToDate/UpToDate C r-----</span><br><span class="line">    ns:3256316 nr:0 dw:115772 dr:3141925 al:31 bm:0 lo:0 pe:0 ua:0 ap:0 ep:1 wo:f oos:0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 状态都是从节点</span></span><br><span class="line"></span><br><span class="line">=========</span><br><span class="line">    node2    </span><br><span class="line">=========</span><br><span class="line">[root@secondary drbd.d]# drbdadm primary mystore</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在哪个节点执行此命令就是切换哪个节点的状态，这里将备用节点切换为主节点</span></span><br><span class="line">[root@secondary drbd.d]# cat /proc/drbd</span><br><span class="line">version: 8.4.6 (api:1/proto:86-101)</span><br><span class="line">GIT-hash: 833d830e0152d1e457fa7856e71e11248ccf3f70 build by phil@Build64R6, 2015-04-09 14:35:00</span><br><span class="line"> 0: cs:Connected ro:Primary/Secondary ds:UpToDate/UpToDate C r-----</span><br><span class="line">    ns:0 nr:3256316 dw:3256316 dr:664 al:0 bm:0 lo:0 pe:0 ua:0 ap:0 ep:1 wo:f oos:0</span><br><span class="line">[root@secondary drbd.d]# mount /dev/drbd0 /mnt</span><br><span class="line">[root@secondary drbd.d]# ls /mnt</span><br><span class="line">issue  lost+found</span><br><span class="line">[root@secondary drbd.d]# vim /mnt/issue</span><br><span class="line">abcabc</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入一些内容</span></span><br><span class="line">[root@secondary drbd.d]# umount /mnt</span><br><span class="line">[root@secondary drbd.d]# drbdadm secondary mystore</span><br><span class="line"><span class="meta">#</span><span class="bash"> 一定要切换状态，备用状态是不能被挂载</span></span><br><span class="line"></span><br><span class="line">=========</span><br><span class="line">    node1   </span><br><span class="line">=========</span><br><span class="line">[root@primary ~]# mount /dev/drbd0 /mnt</span><br><span class="line">mount: you must specify the filesystem type</span><br><span class="line"><span class="meta">#</span><span class="bash"> 备用状态是不能被挂载的</span></span><br><span class="line">[root@primary ~]# drbdadm primary mystore</span><br><span class="line">[root@primary ~]# mount /dev/drbd0 /mnt</span><br><span class="line">[root@primary ~]# cat /mnt/issue </span><br><span class="line">CentOS release 6.6 (Final)</span><br><span class="line">Kernel \r on an \m</span><br><span class="line"></span><br><span class="line">abcabc</span><br><span class="line"><span class="meta">#</span><span class="bash"> 内容也被改变了</span></span><br><span class="line">[root@primary ~]# service drbd status</span><br><span class="line">drbd driver loaded OK; device status:</span><br><span class="line">version: 8.4.6 (api:1/proto:86-101)</span><br><span class="line">GIT-hash: 833d830e0152d1e457fa7856e71e11248ccf3f70 build by phil@Build64R6, 2015-04-09 14:35:00</span><br><span class="line">m:res      cs         ro                 ds                 p  mounted  fstype</span><br><span class="line">0:mystore  Connected  Primary/Secondary  UpToDate/UpToDate  C  /mnt     ext4</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看状态，UpToDate/UpToDate 表示已经同步</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/26/python基础学习-语句/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/26/python基础学习-语句/" itemprop="url">
                  python基础学习-语句
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-26 16:34:05" itemprop="dateCreated datePublished" datetime="2019-03-26T16:34:05+08:00">2019-03-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-09-23 11:34:30" itemprop="dateModified" datetime="2019-09-23T11:34:30+08:00">2019-09-23</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="print"><a href="#print" class="headerlink" title="print"></a>print</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'Age:'</span>, <span class="number">42</span>)</span><br><span class="line">Age: <span class="number">42</span></span><br><span class="line"><span class="comment"># 可同时打印多个表达式，条件是用逗号分隔它们</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">'Gumby'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>salutation = <span class="string">'Mr.'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>greeting = <span class="string">'Hello,'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(greeting, salutation, name)</span><br><span class="line">Hello, Mr. Gumby</span><br><span class="line"></span><br><span class="line">print(greeting + <span class="string">','</span>, salutation, name)</span><br><span class="line"><span class="comment"># 如果字符串变量greeting不包含逗号，可使用此方法添加，记得一定要有加号，不然会在greeting与逗号间加入一个空格</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"I"</span>, <span class="string">"wish"</span>, <span class="string">"to"</span>, <span class="string">"register"</span>, <span class="string">"a"</span>, <span class="string">"complaint"</span>, sep=<span class="string">"_"</span>)</span><br><span class="line">I_wish_to_register_a_complaint</span><br><span class="line"><span class="comment"># 自定义分隔符</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'Hello,'</span>, end=<span class="string">''</span>)</span><br><span class="line">print(<span class="string">'world!'</span>)</span><br><span class="line">Hello,world!</span><br><span class="line"><span class="comment"># 还可自定义结束字符串，以替换默认的换行符。上面将结束字符串指定为空字符串，所以Hello和world会打印在一行。</span></span><br></pre></td></tr></table></figure>
<h3 id="import"><a href="#import" class="headerlink" title="import"></a>import</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> somemodule</span><br><span class="line"><span class="keyword">from</span> somemodule <span class="keyword">import</span> somefunction</span><br><span class="line"><span class="keyword">from</span> somemodule <span class="keyword">import</span> somefunction, anotherfunction, yetanotherfunction</span><br><span class="line"><span class="keyword">from</span> somemodule <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># 从模块导入。仅当你确定要导入模块中的一切时，采用使用最后一种方式</span></span><br><span class="line"></span><br><span class="line">module1.open(...)</span><br><span class="line">module2.open(...)</span><br><span class="line"><span class="comment"># 有两个模块，它们都包含函数open，可使用第一种方式导入这两个模块，使用此种方式调用open函数</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math <span class="keyword">as</span> foobar</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foobar.sqrt(<span class="number">4</span>)</span><br><span class="line"><span class="number">2.0</span></span><br><span class="line"><span class="comment"># 导入整个模块并在语句末尾添加as子句指定别名。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> math <span class="keyword">import</span> sqrt <span class="keyword">as</span> foobar</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foobar(<span class="number">4</span>)</span><br><span class="line"><span class="number">2.0</span></span><br><span class="line"><span class="comment"># 导入特定函数并给它指定别名，这是给sqrt起的别名叫foobar</span></span><br></pre></td></tr></table></figure>
<h3 id="赋值"><a href="#赋值" class="headerlink" title="赋值"></a>赋值</h3><h4 id="序列解包"><a href="#序列解包" class="headerlink" title="序列解包"></a>序列解包</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x, y, z = <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(x, y, z)</span><br><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"><span class="comment"># 同时(并行)给多个变量赋值</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x, y = y, x</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(x, y, z)</span><br><span class="line"><span class="number">2</span> <span class="number">1</span> <span class="number">3</span></span><br><span class="line"><span class="comment"># 这种方式还可交换多个变量的值</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>values = <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>values</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x, y, z = values</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="comment"># 这里执行的操作称为序列解包(或可迭代对象解包)：将一个序列(或任何可迭代对象)解包，并将得到的值存储到一系列变量中。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>scoundrel = &#123;<span class="string">'name'</span>: <span class="string">'Robin'</span>, <span class="string">'girlfriend'</span>: <span class="string">'Marion'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>key, value = scoundrel.popitem()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>key</span><br><span class="line"><span class="string">'girlfriend'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>value</span><br><span class="line"><span class="string">'Marion'</span></span><br><span class="line"><span class="comment"># 从字典中随便获取(或删除)一个键值对，可使用方法popitem，它随便获取一个键值对并以元组的方式返回。接下来，可直接将返回的元组解包到两个变量中。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x, y, z = <span class="number">1</span>, <span class="number">2</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ValueError: need more than <span class="number">2</span> values to unpack</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x, y, z = <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File <span class="string">"&lt;stdin&gt;"</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ValueError: too many values to unpack</span><br><span class="line"><span class="comment"># 要解包的序列包含的元素个数必须与你在等号左边列出的目标个数相同</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a, b, *rest = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>rest</span><br><span class="line">[<span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="comment"># 可使用星号运算符(*)来收集多余的值，这样无需确保值和变量的个数相同</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">"Albus Percival Wulfric Brian Dumbledore"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>first, *middle, last = name.split()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>middle</span><br><span class="line">[<span class="string">'Percival'</span>, <span class="string">'Wulfric'</span>, <span class="string">'Brian'</span>]</span><br><span class="line"><span class="comment"># 还可将带星号的变量放在其他位置。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a, *b, c = <span class="string">"abc"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a, b, c</span><br><span class="line">(<span class="string">'a'</span>, [<span class="string">'b'</span>], <span class="string">'c'</span>)</span><br><span class="line"><span class="comment"># 赋值语句的右边可以是任何类型的序列，但带星号的变量最终包含的总是一个列表。</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/26/python基础学习-字典/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/26/python基础学习-字典/" itemprop="url">
                  python基础学习-字典
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-26 09:36:23" itemprop="dateCreated datePublished" datetime="2019-03-26T09:36:23+08:00">2019-03-26</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-10-12 18:14:11" itemprop="dateModified" datetime="2019-10-12T18:14:11+08:00">2019-10-12</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>字典，也称映射(mapping)是一种可通过名称来访问其各个值的数据结构。字典是Python中唯一的内置映射类型，其中的值不按顺序排列，而是存储在键下。键可能是数、字符串或元组。字典是key-value键值对的数据的集合，它是可变的、无序的、key不重复。字典中的item指的就是kv对</p>
<p>字典(日常生活中的字典和Python字典)旨在让你能够轻松地找到特定的单词(键)，以获悉其定义(值) 。</p>
<p>Python字典的用途：</p>
<ul>
<li><p>表示棋盘的状态，其中每个键都是由坐标组成的元组；</p>
</li>
<li><p>存储文件修改时间，其中的键为文件名；</p>
</li>
<li><p>数字电话/地址簿。</p>
</li>
<li>不要用值来找，要用key来找。如果需要用值来找就不要用此种方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>names = [<span class="string">'Alice'</span>, <span class="string">'Beth'</span>, <span class="string">'Cecil'</span>, <span class="string">'Dee-Dee'</span>, <span class="string">'Earl'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers = [<span class="string">'2341'</span>, <span class="string">'9102'</span>, <span class="string">'3158'</span>, <span class="string">'0142'</span>, <span class="string">'5551'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[names.index(<span class="string">'Cecil'</span>)]</span><br><span class="line"><span class="string">'3158'</span></span><br><span class="line"><span class="comment"># 这可行，但不太实用。</span></span><br></pre></td></tr></table></figure>
<h3 id="基本的字典操作"><a href="#基本的字典操作" class="headerlink" title="基本的字典操作"></a>基本的字典操作</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">len(d)</span><br><span class="line"><span class="comment"># 返回字典d 包含的项(键值对)数。</span></span><br><span class="line">d[k]</span><br><span class="line"><span class="comment"># 返回与键k相关联的值。</span></span><br><span class="line">d[k] = v</span><br><span class="line"><span class="comment"># 将值v关联到键k。</span></span><br><span class="line"><span class="keyword">del</span> d[k]</span><br><span class="line"><span class="comment"># 删除键为k的项。</span></span><br><span class="line">k <span class="keyword">in</span> d</span><br><span class="line"><span class="comment"># 检查字典d 是否包含键为k的项。</span></span><br></pre></td></tr></table></figure>
<h3 id="字典dict定义，初始化"><a href="#字典dict定义，初始化" class="headerlink" title="字典dict定义，初始化"></a>字典dict定义，初始化</h3><ul>
<li>d = dict()   或者   d = {}</li>
<li>dict(**kwargs)   使用name = value对初始化一个字典</li>
<li>dict(iterable,**kwarg) 使用可迭代对象和name = value对构造字典，不过可迭代对象的元素必须是一个二元结构<ul>
<li>d = dict(((1,’a’),(2,’b’))) 或者 d = dict(([1,’a’],[2,’b’]))</li>
</ul>
</li>
<li>dict(mapping,**kwarg) 使用一个字典构建另一个字典</li>
<li>d = {‘a’:10,’b’:20,’c’:None,’d’:[1,2,3]}</li>
<li><p>类方法 dict.fromkeys(iterable,value)</p>
<ul>
<li>d = dict.fromkeys(range(5))</li>
<li>d = dict.fromkeys(range(5),0)</li>
</ul>
</li>
<li><p>键的类型：字典中的键可以是整数，但并非必须是整数。字典中的键可以是任何不可变的类型，如浮点数(实数) 、字符串或元组。</p>
</li>
<li>自动添加：即便是字典中原本没有的键，也可以给它赋值，这将在字典中创建一个新项。然而，如果不使用append或其他类似的方法，就不能给列表中没有的元素赋值。</li>
<li>成员资格：表达式k in d(其中d 是一个字典)查找的是键而不是值，而表达式v in l(其中l是一个列表)查找的是值而不是索引。这看似不太一致，但你习惯后就会觉得相当自然。毕竟如果字典包含指定的键，检查相应的值就很容易。</li>
</ul>
<p>相比于检查列表是否包含指定的值，检查字典是否包含指定的键的效率更高。数据结构越大，效率差距就越大。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建与使用</span></span><br><span class="line">phonebook = &#123;<span class="string">'Alice'</span>: <span class="string">'2341'</span>, <span class="string">'Beth'</span>: <span class="string">'9102'</span>, <span class="string">'Cecil'</span>: <span class="string">'3258'</span>&#125;</span><br><span class="line"><span class="comment"># 字典由键及其相应的值组成，这种键值对称为项(item)。这里键为名字，而值为电话号码。每个键与</span></span><br><span class="line"><span class="comment"># 其值之间都用冒号(:)分隔，项之间用逗号分隔，而整个字典放在花括号内。空字典(没有任何项)用两</span></span><br><span class="line"><span class="comment"># 个花括号表示。</span></span><br><span class="line"><span class="comment"># 在字典(以及其他映射类型)中，键必须是独一无二的，而字典中的值无需如此。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建字典</span></span><br><span class="line">l1 = list(range(<span class="number">5</span>))</span><br><span class="line">d = dict(l1)</span><br><span class="line"><span class="comment"># 这样是不行是，因为l1里都是单值，字典需要两个值。</span></span><br><span class="line"></span><br><span class="line">d = dict(enumerate(l1))</span><br><span class="line"><span class="comment"># enumerate是给值加上索引的，这样也就是两个值了。</span></span><br><span class="line"></span><br><span class="line">e = enumerate(l1)</span><br><span class="line">print(type(e))</span><br><span class="line"><span class="comment"># e的类型枚举，是一个可迭代对象，可以使用list、set、tuple来包括这个类型，用什么方法包括这</span></span><br><span class="line"><span class="comment"># 个类型，这个类型就生成什么数据类型。也就是封装成什么就返回什么类型</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> e:</span><br><span class="line">    print(x)</span><br><span class="line"><span class="comment"># 返回的是二元组，在python命令行中执行要使用Ctrl + 回车</span></span><br><span class="line"></span><br><span class="line">d = dict(e)</span><br><span class="line">print(d)</span><br><span class="line"><span class="comment"># 这是一个类似生成器的东西，走到头就不会再走了，所以d返回的是&#123;&#125;。</span></span><br><span class="line"></span><br><span class="line">e = enumerate(l1)</span><br><span class="line">d = dict(e)</span><br><span class="line">print(d)</span><br><span class="line"><span class="comment"># 这样就生成了一个字典</span></span><br><span class="line"></span><br><span class="line">d = &#123;(<span class="string">'a'</span>,<span class="number">1</span>)&#125;</span><br><span class="line">print(d)</span><br><span class="line"><span class="comment"># 这样是不可以的，因为结果不是key:value</span></span><br><span class="line">c = dict(((<span class="number">1</span>,<span class="string">'a'</span>),))</span><br><span class="line">print(c)</span><br><span class="line"><span class="comment"># 需要使用这种方式，dict中是一个元组，一般不用这种方式。((1,'a'),)表示一个元组，因为字典</span></span><br><span class="line"><span class="comment"># 需要两个值，所以定义成(1,'a')</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用dict函数创建</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>items = [(<span class="string">'name'</span>, <span class="string">'Gumby'</span>), (<span class="string">'age'</span>, <span class="number">42</span>)]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = dict(items)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="number">42</span>, <span class="string">'name'</span>: <span class="string">'Gumby'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'name'</span>]</span><br><span class="line"><span class="string">'Gumby'</span></span><br><span class="line"><span class="comment"># 使用函数dict从其他映射(如其他字典)或键值对序列创建字典。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = dict(name=<span class="string">'Gumby'</span>, age=<span class="number">42</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="number">42</span>, <span class="string">'name'</span>: <span class="string">'Gumby'</span>&#125;</span><br><span class="line"><span class="comment"># 使用关键字实参来调用这个函数</span></span><br><span class="line"><span class="comment"># 也可使用一个映射实参来调用它，这将创建一个字典，其中包含指定映射中的所有项。像函数list、</span></span><br><span class="line"><span class="comment"># tuple和str一样，如果调用这个函数时没有提供任何实参，将返回一个空字典。从映射创建字典时，</span></span><br><span class="line"><span class="comment"># 如果该映射也是字典(毕竟字典是Python中唯一的内置映射类型)，可不使用函数dict，而是使用字</span></span><br><span class="line"><span class="comment"># 典方法copy</span></span><br><span class="line"><span class="comment"># 与list、tuple和str一样，dict其实根本就不是函数，而是一个类。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = []</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">42</span>] = <span class="string">'Foobar'</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File "&lt;stdin&gt;", line 1, in ?</span><br><span class="line">IndexError: list assignment index out of range</span><br><span class="line"><span class="comment"># 将字符串'Foobar'赋给一个空列表中索引为42的元素。这是不可以的，因为没有这样的元素。要让这</span></span><br><span class="line"><span class="comment"># 种操作可行，初始化x时，必须使用[None] * 43之类的代码，而不能使用[]。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">42</span>] = <span class="string">'Foobar'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">&#123;<span class="number">42</span>: <span class="string">'Foobar'</span>&#125;</span><br><span class="line"><span class="comment"># 将'Foobar'赋给一个空字典的键42，这样做一点问题都没有</span></span><br><span class="line"></span><br><span class="line">people = &#123;</span><br><span class="line">    <span class="string">'Alice'</span>: &#123;</span><br><span class="line">            <span class="string">'phone'</span>: <span class="string">'2341'</span>,</span><br><span class="line">            <span class="string">'addr'</span>: <span class="string">'Foo drive 23'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'Beth'</span>: &#123;</span><br><span class="line">            <span class="string">'phone'</span>: <span class="string">'9102'</span>,</span><br><span class="line">            <span class="string">'addr'</span>: <span class="string">'Bar street 42'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'Cecil'</span>: &#123;</span><br><span class="line">            <span class="string">'phone'</span>: <span class="string">'3158'</span>,</span><br><span class="line">            <span class="string">'addr'</span>: <span class="string">'Baz avenue 90'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 一个将人名用作键的字典。每个人都用一个字典表示，字典包含键'phone'和'addr'，它们分别与电</span></span><br><span class="line"><span class="comment"># 话号码和地址相关联</span></span><br><span class="line"></span><br><span class="line">labels = &#123;</span><br><span class="line"><span class="string">'phone'</span>: <span class="string">'phone number'</span>,</span><br><span class="line"><span class="string">'addr'</span>: <span class="string">'address'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 电话号码和地址的描述性标签，供打印输出时使用</span></span><br><span class="line"></span><br><span class="line">name = input(<span class="string">'Name: '</span>)</span><br><span class="line"></span><br><span class="line">request = input(<span class="string">'Phone number (p) or address (a)? '</span>)</span><br><span class="line"><span class="comment"># 要查找电话号码还是地址?</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> request == <span class="string">'p'</span>: key = <span class="string">'phone'</span></span><br><span class="line"><span class="keyword">if</span> request == <span class="string">'a'</span>: key = <span class="string">'addr'</span></span><br><span class="line"><span class="comment"># 判断输入的是电话还是地址，如果是电话，key='phone'；如果是地址，key = 'addr'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> name <span class="keyword">in</span> people: print(<span class="string">"&#123;&#125;'s &#123;&#125; is &#123;&#125;."</span>.format(name, labels[key], people[name][key]))</span><br><span class="line"><span class="comment"># 仅当名字是字典包含的键时才打印信息，打印的格式为某人的电话或地址是什么，format指定三个值</span></span><br><span class="line"><span class="comment"># 对应前面的三个中括号，第一个值是用户输入的name；第二个值是key，key可以是phone或addr，</span></span><br><span class="line"><span class="comment"># 在labels字典中查找对应的电话号码或地址；第三个值是使用name和key的值在people字典中查找</span></span><br><span class="line"><span class="comment"># 对应的值。</span></span><br><span class="line">这个程序的运行情况类似于下面这样:</span><br><span class="line">Name: Beth</span><br><span class="line">Phone number (p) or address (a)? p</span><br><span class="line">Beth<span class="string">'s phone number is 9102.</span></span><br></pre></td></tr></table></figure>
<h3 id="类与函数调用"><a href="#类与函数调用" class="headerlink" title="类与函数调用"></a>类与函数调用</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">l1 = list()</span><br><span class="line">print(l1)</span><br><span class="line"><span class="comment"># 上面定义了l1是一个空列表</span></span><br><span class="line"></span><br><span class="line">a = list</span><br><span class="line">l2 = a</span><br><span class="line">type(l2)</span><br><span class="line"><span class="comment"># 这样定义后，l2是一个类而不是列表。因为定义了a等于list类</span></span><br><span class="line"></span><br><span class="line">l3 = a()</span><br><span class="line">print(l3)</span><br><span class="line"><span class="comment"># l3被定义成了一个空列表，因为a等于list，所以这里l3 = a()就等于l3 = list()</span></span><br><span class="line"><span class="comment"># a = list就是a把list的名称拿走了，等于把名称对应的地址拿走了</span></span><br><span class="line"><span class="comment"># 函数也是一个对象，对象在内存中有一个地方放。这个地方就是函数的地址。列表放在内存中是一个对</span></span><br><span class="line"><span class="comment"># 象，比如创建一个空列表，这是一个对象，我们把空列表赋值给了l3，l3拿的就是这个空列表对象的</span></span><br><span class="line"><span class="comment"># 地址。现在我们给出一个函数list，函数本身也是对象，一切皆对象。我们把这个对象给了a，就是把</span></span><br><span class="line"><span class="comment"># a覆盖掉了，这是把对象地址或叫对象引用给了a，这时a与list也就是等价的了。如果写成list()就</span></span><br><span class="line"><span class="comment"># 是调用了，只要加了括号就是调用了。</span></span><br><span class="line"><span class="comment"># 也就是说，a = list是将对象地址给了a，a与list等价。a = list()是调用，将调用list函数的结果给了a，a被定义成了一个空列表</span></span><br><span class="line"></span><br><span class="line">l4 = <span class="number">5</span>()</span><br><span class="line"><span class="comment"># 这样定义会提示"TypeError: 'int' object is not callable"，这说明int类型是不可以调</span></span><br><span class="line"><span class="comment"># 用的。这就说明了加括号是可以调用前面的对象或名称的，但前面的对象或名称需要是可调用的对象。</span></span><br><span class="line"><span class="comment"># list是一个写好的函数，这个函数已经被当前环境加载过了，所以这个名称可以直接拿来用，这个名</span></span><br><span class="line"><span class="comment"># 称指代的是list名称加载到内存中的位置，这就是引用类型。真正的引用并不是我们写一个列表，把</span></span><br><span class="line"><span class="comment"># 列表赋值给变量，这才是对它的引用，实际这个函数也是对象，它也在内存中，你要引用它，也要通过</span></span><br><span class="line"><span class="comment"># 它的名称才能引用，一加括号意义就变了，这个对象如果是可调用对象的话，我们就调用它了。如果函</span></span><br><span class="line"><span class="comment"># 数是一个可调用对象，调用时就会执行函数里的函数体了。之后的类也可以变成一个可调用对象，比如</span></span><br><span class="line"><span class="comment"># 把一个类实例化了，它就变成一个对象，这个对象后面也可以加括号，这就是python的技巧</span></span><br></pre></td></tr></table></figure>
<h3 id="字典元素的访问"><a href="#字典元素的访问" class="headerlink" title="字典元素的访问"></a>字典元素的访问</h3><ul>
<li>d[key]<ul>
<li>返回key对应的值value</li>
<li>key不存在抛出KeyError异常</li>
</ul>
</li>
<li>get(key[,default])<ul>
<li>返回key对应的值value</li>
<li>get方法不会抛异常，如果key不存在，返回缺省值，如果没有设置缺省值就返回None。如果存在，就显示其值。</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法get为访问字典项提供了宽松的环境。通常，如果你试图访问字典中没有的项，将引发错误。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(d[<span class="string">'name'</span>])</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File "&lt;stdin&gt;", line 1, in ?</span><br><span class="line">KeyError: <span class="string">'name'</span></span><br><span class="line"><span class="comment"># 访问没有的项，报错。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(d.get(<span class="string">'name'</span>))</span><br><span class="line"><span class="keyword">None</span></span><br><span class="line"><span class="comment"># 使用get方法访问没有的项，不会报错。而是返回None。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.get(<span class="string">'name'</span>, <span class="string">'N/A'</span>)</span><br><span class="line"><span class="string">'N/A'</span></span><br><span class="line"><span class="comment"># 可指定“默认”值，这样将返回你指定的值而不是None。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'name'</span>] = <span class="string">'Eric'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.get(<span class="string">'name'</span>)</span><br><span class="line"><span class="string">'Eric'</span></span><br><span class="line"><span class="comment"># 如果字典包含指定的键，get的作用将与普通字典查找相同。</span></span><br><span class="line"></span><br><span class="line">people = &#123;</span><br><span class="line">    <span class="string">'Alice'</span>: &#123;</span><br><span class="line">            <span class="string">'phone'</span>: <span class="string">'2341'</span>,</span><br><span class="line">            <span class="string">'addr'</span>: <span class="string">'Foo drive 23'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'Beth'</span>: &#123;</span><br><span class="line">            <span class="string">'phone'</span>: <span class="string">'9102'</span>,</span><br><span class="line">            <span class="string">'addr'</span>: <span class="string">'Bar street 42'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'Cecil'</span>: &#123;</span><br><span class="line">            <span class="string">'phone'</span>: <span class="string">'3158'</span>,</span><br><span class="line">            <span class="string">'addr'</span>: <span class="string">'Baz avenue 90'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">labels = &#123;</span><br><span class="line"><span class="string">'phone'</span>: <span class="string">'phone number'</span>,</span><br><span class="line"><span class="string">'addr'</span>: <span class="string">'address'</span></span><br><span class="line">&#125;</span><br><span class="line">name = input(<span class="string">'Name: '</span>)</span><br><span class="line"></span><br><span class="line">request = input(<span class="string">'Phone number (p) or address (a)? '</span>)</span><br><span class="line"></span><br><span class="line">key = request </span><br><span class="line"><span class="keyword">if</span> request == <span class="string">'p'</span>: key = <span class="string">'phone'</span></span><br><span class="line"><span class="keyword">if</span> request == <span class="string">'a'</span>: key = <span class="string">'addr'</span></span><br><span class="line"></span><br><span class="line">person = people.get(name, &#123;&#125;)</span><br><span class="line">label = labels.get(key, key)</span><br><span class="line">result = person.get(key, <span class="string">'not available'</span>)</span><br><span class="line">print(<span class="string">"&#123;&#125;'s &#123;&#125; is &#123;&#125;."</span>.format(name, label, result))</span><br><span class="line"><span class="comment"># 使用了方法get来访问“数据库”条目</span></span><br><span class="line">下面是这个程序的运行情况。</span><br><span class="line">Name: Gumby</span><br><span class="line">Phone number (p) or address (a)? batting average</span><br><span class="line">Gumby<span class="string">'s batting average is not available.</span></span><br></pre></td></tr></table></figure>
<ul>
<li>setdefault(key[,default])<ul>
<li>返回key对应的值value</li>
<li>key不存在，添加kv对，value为default，并返回default，如果default没有设置，缺省为None</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法setdefault 有点像 get，因为它也获取与指定键相关联的值，但除此之外，setdefault还在字典不包含指定的键时，在字典中添加指定的键值对。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.setdefault(<span class="string">'name'</span>, <span class="string">'N/A'</span>)</span><br><span class="line"><span class="string">'N/A'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'name'</span>: <span class="string">'N/A'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'name'</span>] = <span class="string">'Gumby'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.setdefault(<span class="string">'name'</span>, <span class="string">'N/A'</span>)  </span><br><span class="line"><span class="comment"># 这里不加'N/A'也可以，N/A是默认值，如果name没有对应值就返回此值</span></span><br><span class="line"><span class="string">'Gumby'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'name'</span>: <span class="string">'Gumby'</span>&#125;</span><br><span class="line"><span class="comment"># 指定的键不存在时， setdefault返回指定的值并相应地更新字典。如果指定的键存在，就返回其</span></span><br><span class="line"><span class="comment"># 值，并保持字典不变。与get一样，值是可选的；如果没有指定，默认为None。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(d.setdefault(<span class="string">'name'</span>))</span><br><span class="line"><span class="keyword">None</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'name'</span>: <span class="keyword">None</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="字典增加和修改"><a href="#字典增加和修改" class="headerlink" title="字典增加和修改"></a>字典增加和修改</h3><ul>
<li>d[key] = value<ul>
<li>将key对应的值修改为value</li>
<li><strong>key不存在添加新的kv对</strong></li>
</ul>
</li>
<li>update([other]) -&gt; None<ul>
<li>使用另一个字典的kv对更新本字典</li>
<li>key不存在，就添加</li>
<li>key存在，覆盖已经存在的key对应的值</li>
<li>就地修改<ul>
<li>d.update(red=1)</li>
<li>d.update(((‘red’,2),))</li>
<li>d.update({‘red’:3})</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法update使用一个字典中的项来更新另一个字典。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;</span><br><span class="line"><span class="meta">... </span><span class="string">'title'</span>: <span class="string">'Python Web Site'</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">'url'</span>: <span class="string">'http://www.python.org'</span>,</span><br><span class="line"><span class="meta">... </span><span class="string">'changed'</span>: <span class="string">'Mar 14 22:09:15 MET 2016'</span></span><br><span class="line"><span class="meta">... </span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;<span class="string">'title'</span>: <span class="string">'Python Language Website'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.update(x)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'url'</span>: <span class="string">'http://www.python.org'</span>, <span class="string">'changed'</span>:</span><br><span class="line"><span class="string">'Mar 14 22:09:15 MET 2016'</span>, <span class="string">'title'</span>: <span class="string">'Python Language Website'</span>&#125;</span><br><span class="line"><span class="comment"># 对于通过参数提供的字典，将其项添加到当前字典中。如果当前字典包含键相同的项，就替换它。</span></span><br></pre></td></tr></table></figure>
<ul>
<li>copy（返回一个新字典）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法copy返回一个新字典，其包含的键值对与原来的字典相同(这个方法执行的是浅复制，因为值本身</span></span><br><span class="line"><span class="comment"># 是原件，而非副本)。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;<span class="string">'username'</span>: <span class="string">'admin'</span>, <span class="string">'machines'</span>: [<span class="string">'foo'</span>, <span class="string">'bar'</span>, <span class="string">'baz'</span>]&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = x.copy()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y[<span class="string">'username'</span>] = <span class="string">'mlh'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y[<span class="string">'machines'</span>].remove(<span class="string">'bar'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">&#123;<span class="string">'username'</span>: <span class="string">'mlh'</span>, <span class="string">'machines'</span>: [<span class="string">'foo'</span>, <span class="string">'baz'</span>]&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">&#123;<span class="string">'username'</span>: <span class="string">'admin'</span>, <span class="string">'machines'</span>: [<span class="string">'foo'</span>, <span class="string">'baz'</span>]&#125;</span><br><span class="line"><span class="comment"># 当替换副本中的值时，原件不受影响。然而，如果修改副本中的值(就地修改而不是替换)，原件也将</span></span><br><span class="line"><span class="comment"># 发生变化，因为原件指向的也是被修改的值</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> copy <span class="keyword">import</span> deepcopy</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'names'</span>] = [<span class="string">'Alfred'</span>, <span class="string">'Bertrand'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = d.copy()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dc = deepcopy(d)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'names'</span>].append(<span class="string">'Clive'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c</span><br><span class="line">&#123;<span class="string">'names'</span>: [<span class="string">'Alfred'</span>, <span class="string">'Bertrand'</span>, <span class="string">'Clive'</span>]&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dc</span><br><span class="line">&#123;<span class="string">'names'</span>: [<span class="string">'Alfred'</span>, <span class="string">'Bertrand'</span>]&#125;</span><br><span class="line"><span class="comment"># 深复制，即同时复制值及其包含的所有值，等等。为此，可使用模块copy中的函数deepcopy。c和dc</span></span><br><span class="line"><span class="comment"># 的值都是从d复制过来的，只是c是浅复制，dc是深复制，在d中追加值后，c的值也有变化，dc没有。</span></span><br></pre></td></tr></table></figure>
<ul>
<li>fromkeys（创建新字典）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># fromkeys创建一个新字典，其中包含指定的键，且每个键对应的值都是None。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;&#125;.fromkeys([<span class="string">'name'</span>, <span class="string">'age'</span>])</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="keyword">None</span>, <span class="string">'name'</span>: <span class="keyword">None</span>&#125;</span><br><span class="line"><span class="comment"># 首先创建了一个空字典，再对其调用方法fromkeys来创建另一个字典，这显得有点多余。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dict.fromkeys([<span class="string">'name'</span>, <span class="string">'age'</span>])</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="keyword">None</span>, <span class="string">'name'</span>: <span class="keyword">None</span>&#125;</span><br><span class="line"><span class="comment"># 直接对dict调用方法fromkeys。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dict.fromkeys([<span class="string">'name'</span>, <span class="string">'age'</span>], <span class="string">'(unknown)'</span>)</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="string">'(unknown)'</span>, <span class="string">'name'</span>: <span class="string">'(unknown)'</span>&#125;</span><br><span class="line"><span class="comment"># 不使用默认值None，可提供特定的值。</span></span><br></pre></td></tr></table></figure>
<h3 id="字典删除"><a href="#字典删除" class="headerlink" title="字典删除"></a>字典删除</h3><ul>
<li><p>pop(key[,default])</p>
<ul>
<li>key存在，移除它，并返回它的value</li>
<li>key不存在，返回给定的default</li>
<li>default未设置，key不存在则抛出KeyError异常</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法pop可用于获取与指定键相关联的值，并将该键值对从字典中删除。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">'x'</span>: <span class="number">1</span>, <span class="string">'y'</span>: <span class="number">2</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.pop(<span class="string">'x'</span>)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'y'</span>: <span class="number">2</span>&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>popitem()</p>
<ul>
<li>移除并返回一个任意的键值对</li>
<li>字典为empty，抛出KeyError异常</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法popitem类似于list.pop ，但 list.pop弹出列表中的最后一个元素，而popitem随机地弹</span></span><br><span class="line"><span class="comment"># 出一个字典项，因为字典项的顺序是不确定的，没有“最后一个元素”的概念。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">'url'</span>: <span class="string">'http://www.python.org'</span>, <span class="string">'spam'</span>: <span class="number">0</span>, <span class="string">'title'</span>: <span class="string">'Python Web Site'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.popitem()</span><br><span class="line">(<span class="string">'url'</span>, <span class="string">'http://www.python.org'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'spam'</span>: <span class="number">0</span>, <span class="string">'title'</span>: <span class="string">'Python Web Site'</span>&#125;</span><br><span class="line"><span class="comment"># 虽然popitem 类似于列表方法pop，但字典没有与append(它在列表末尾添加一个元素)对应的方</span></span><br><span class="line"><span class="comment"># 法。这是因为字典是无序的，类似的方法毫无意义。</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>clear()</p>
<ul>
<li>清空字典</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clear（删除所有字典项）</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'name'</span>] = <span class="string">'Gumby'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'age'</span>] = <span class="number">42</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;<span class="string">'age'</span>: <span class="number">42</span>, <span class="string">'name'</span>: <span class="string">'Gumby'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>returned_value = d.clear()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d</span><br><span class="line">&#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(returned_value)</span><br><span class="line"><span class="keyword">None</span></span><br><span class="line"><span class="comment"># 这种操作是就地执行的(就像list.sort一样)，因此什么都不返回(或者说返回None)。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = x</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="string">'key'</span>] = <span class="string">'value'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">&#123;<span class="string">'key'</span>: <span class="string">'value'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">&#123;<span class="string">'key'</span>: <span class="string">'value'</span>&#125;</span><br><span class="line"><span class="comment"># x和y最初都指向同一个字典。通过将一个空字典赋给x来“清空”它。这对y没有任何影响，它依然指向</span></span><br><span class="line"><span class="comment"># 原来的字典。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = x</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="string">'key'</span>] = <span class="string">'value'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">&#123;<span class="string">'key'</span>: <span class="string">'value'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.clear()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">&#123;&#125;</span><br><span class="line"><span class="comment"># 要删除原来字典的所有元素，必须使用clear。如果这样做，y也将是空的</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>del语句</p>
<p>a = True</p>
<p>b = [6]</p>
<p>d = {‘a’:1,’b’:b,’c’:[1,3,5]}</p>
<p>del a</p>
<p>del d[‘c’]   # 删除了一个对象[1,3,5]？</p>
<p>del b[0]</p>
<p>c = b</p>
<p>del c</p>
<p>del b</p>
<p>b = d[‘b’]</p>
<ul>
<li>del a[‘c’]看着像删除了一个对象，本质上减少了一个对象的引用，del实际上删除的是名称，而不是对象</li>
</ul>
</li>
</ul>
<h3 id="字典遍历"><a href="#字典遍历" class="headerlink" title="字典遍历"></a>字典遍历</h3><ul>
<li><p>for … in dict</p>
<ul>
<li>遍历key，方法keys返回一个字典视图，其中包含指定字典中的键。</li>
</ul>
<p>for k in d:</p>
<p>​    print(k)</p>
<p>for k in d.keys():</p>
<p>​    print(k)</p>
<p>//下面这种方法较常用</p>
</li>
<li><p>for … in dict</p>
<ul>
<li>遍历value</li>
</ul>
<p>for k in d:</p>
<p>​    print(d[k])</p>
<p>for k in d.keys():</p>
<p>​    print(d.get(k))</p>
<p>for v in d.values():</p>
<p>​    print(v)</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法values返回一个由字典中的值组成的字典视图。不同于方法keys，方法values返回的视图可能包含重复的值。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="number">1</span>] = <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="number">2</span>] = <span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="number">3</span>] = <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="number">4</span>] = <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.values()</span><br><span class="line">dict_values([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<ul>
<li><p>for … in dict</p>
<ul>
<li><p>遍历item，即kv对</p>
<p>for item in d.items():</p>
<p>​    print(item)</p>
<p>for item in d.items():</p>
<p>​    print(item[0],item[1])</p>
<p>for k,v in d.items():</p>
<p>​    print(k,v)</p>
<p>for k,_ in d.items():</p>
<p>​    print(k)</p>
<p>for _,v in d.items():</p>
<p>​    print(v)</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法items返回一个包含所有字典项的列表，其中每个元素都为(key, value)的形式。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d = &#123;<span class="string">'title'</span>: <span class="string">'Python Web Site'</span>, <span class="string">'url'</span>: <span class="string">'http://www.python.org'</span>, <span class="string">'spam'</span>: <span class="number">0</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d.items()</span><br><span class="line">dict_items([(<span class="string">'url'</span>, <span class="string">'http://www.python.org'</span>), (<span class="string">'spam'</span>, <span class="number">0</span>), (<span class="string">'title'</span>, <span class="string">'Python Web Site'</span>)])</span><br><span class="line"><span class="comment"># 字典项在列表中的排列顺序不确定。返回值属于一种名为字典视图的特殊类型。字典视图可用于迭代</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>it = d.items()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(it)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="string">'spam'</span>, <span class="number">0</span>) <span class="keyword">in</span> it</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="comment"># 还可确定其长度以及对其执行成员资格检查。如下 ：</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'spam'</span>] = <span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="string">'spam'</span>, <span class="number">0</span>) <span class="keyword">in</span> it</span><br><span class="line"><span class="keyword">False</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>d[<span class="string">'spam'</span>] = <span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="string">'spam'</span>, <span class="number">0</span>) <span class="keyword">in</span> it</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="comment"># 视图的一个优点是不复制，它们始终是底层字典的反映，即便你修改了底层字典亦如此</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(d.items())</span><br><span class="line">[(<span class="string">'spam'</span>, <span class="number">0</span>), (<span class="string">'title'</span>, <span class="string">'Python Web Site'</span>), (<span class="string">'url'</span>, <span class="string">'http://www.python.org'</span>)]</span><br><span class="line"><span class="comment"># 将字典项复制到列表中</span></span><br></pre></td></tr></table></figure>
<ul>
<li>总结<ul>
<li>Python3中，keys、values、items方法返回一个类似一个生成器的可迭代对象，不会把函数的返回结果复制到内存中<ul>
<li>Dictionary view对象</li>
<li>字典的entry的动态的视图，字典变化，视图将反映出这些变化</li>
</ul>
</li>
<li>Python2中，上面的方法会返回一个新的列表，占据新的内存空间。所以Python2建议使用iterkeys、itervalues、iteritems版本，返回一个迭代器，而不是一个copy</li>
</ul>
</li>
</ul>
<h3 id="字典遍历和移除"><a href="#字典遍历和移除" class="headerlink" title="字典遍历和移除"></a>字典遍历和移除</h3><ul>
<li><p>如何在遍历的时候移除元素</p>
</li>
<li><p>错误的做法</p>
<p>d = dict(a=1,b=2,c=’abc’)</p>
<p>for k,v in d.items():</p>
<p>​    d.pop(k)   # 异常</p>
</li>
</ul>
<p>​     while len(d):   # 相当于清空，不如直接clear()</p>
<p>​        print(d.popitem())</p>
<ul>
<li><p>正确的做法</p>
<p>d = dict(a=1,b=2,c=’abc’)</p>
<p>keys = []</p>
<p>for k,v in d.items():</p>
<p>​    if isinstance(v,str)</p>
<p>​        keys.append(k)</p>
</li>
</ul>
<p>​    for k in keys:</p>
<p>​        d.pop(k)</p>
<p>​    print(d)</p>
<h3 id="字典的key"><a href="#字典的key" class="headerlink" title="字典的key"></a>字典的key</h3><ul>
<li>key的要求和set的元素要求一致<ul>
<li>set的元素可以看做key，set可以看做dict的简化版</li>
<li>hashable可哈希才可以作为key，可以使用hash()测试。可hash的类型是不可变的，可变类型是不可hash的</li>
<li>d = {1:0,2.0:3,”abc”:None,(‘hello’,’world’,’python’):”string”,b’abc’:’135’}</li>
</ul>
</li>
</ul>
<h3 id="defaultdict"><a href="#defaultdict" class="headerlink" title="defaultdict"></a>defaultdict</h3><ul>
<li><p>collections.defaultdict([default_factory[,…]])</p>
<ul>
<li>第一个参数是default_factory，缺省是None，它提供一个初始化函数。当key不存在的时候，会调用这个工厂函数来生成key对应的value</li>
</ul>
<p>import random</p>
<p>d1 = {}</p>
<p>for k in ‘abcdef’:</p>
<p>​    for i in range(random.randint(1,5)):</p>
<p>​        if k not in d1.keys():</p>
<p>​            d1[k] = []</p>
<p>​        d1[k].append(i)</p>
<p>print(d1)</p>
</li>
</ul>
<p>​    from collections import defaultdict</p>
<p>​    import random</p>
<p>​    d1 = defaultdict(list)</p>
<p>​    for k in ‘abcdef’:</p>
<p>​        for i in range(random.randint(1,5)):</p>
<p>​            d1[k].append(i)</p>
<p>​    print(d1)</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># defaultdict</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line">d1 = &#123;&#125;</span><br><span class="line">d2 = defaultdict(list)</span><br><span class="line"><span class="comment"># list放在这里相当于传了一个工厂方法，要求是一个初始化函数，这就是以后的初始化函数</span></span><br><span class="line"><span class="comment"># default_factory，初始化函数什么时候用，只有在key不存在的时候，会调用这个工厂函数来生成</span></span><br><span class="line"><span class="comment"># key对应的value，也就是生成一个缺省值，用来给这个没有value的key赋值，这样就可以凑上一个</span></span><br><span class="line"><span class="comment"># kv对，也就可以加入字典当中了。</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="string">"abcde"</span>:    <span class="comment"># 迭代a到e，这里要创建的是key</span></span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> range(<span class="number">5</span>):     <span class="comment"># 迭代0到4，这里要生成value</span></span><br><span class="line">        <span class="keyword">if</span> k <span class="keyword">not</span> <span class="keyword">in</span> d1.keys():    </span><br><span class="line">        <span class="comment"># d1.keys()开始是空的，第一次的时候找不到上面循环的k是a</span></span><br><span class="line">            d1[k] = []   <span class="comment"># 这里表示，如果上面判断k不存在，就给d1[k]初始化一个空列表</span></span><br><span class="line">        d1[k].append(v)   </span><br><span class="line">        <span class="comment"># 这里把0-4依次追加到d1[k]中，第一次d1[a].append[0]，第二次d1[a].append[1]</span></span><br><span class="line">print(d1)   <span class="comment"># 最后打印出来，这是第一种方式</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="string">'mnopq'</span>:</span><br><span class="line">    <span class="keyword">for</span> v <span class="keyword">in</span> range(<span class="number">3</span>):   <span class="comment"># 这里是3是为了说明v与上面的k的数量可以不一样 </span></span><br><span class="line">        d2[k].append(v)   </span><br><span class="line"><span class="comment"># 这里不做判断，直接赋值。是为了说明上面的key如果不存在，就调用上面定义的</span></span><br><span class="line"><span class="comment"># d2 = defaultdict(list)中的list，这时就是在做创建空列表的动作，也就是list()，因为上</span></span><br><span class="line"><span class="comment"># 面已经说明了当key不存在时调用工厂函数生成key对应的value，并且也定义了d2等于这个工厂函数</span></span><br><span class="line"><span class="comment"># d2[k]就相当于测试一下这个k是否存在，不存在就调用工厂函数。之后也可以自定义函数，并调用。</span></span><br><span class="line"><span class="comment"># 这就相当于替换了d1[k] = []中后面的中括号</span></span><br><span class="line"><span class="comment"># 个人想，如果将list改成tuple是否可以，好像不行，因为tuple是不可变的，没有append这样的方</span></span><br><span class="line"><span class="comment"># 法，那么改成set是不是就可以了？</span></span><br><span class="line">print(d2)</span><br><span class="line">输出：</span><br><span class="line">&#123;<span class="string">'a'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">'b'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">'c'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">'d'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], <span class="string">'e'</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]&#125;</span><br><span class="line">defaultdict(&lt;class 'list'&gt;, &#123;'m': [0, 1, 2], 'n': [0, 1, 2], 'o': [0, 1, 2], 'p': [0, 1, 2], 'q': [0, 1, 2]&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="OrderedDict"><a href="#OrderedDict" class="headerlink" title="OrderedDict"></a>OrderedDict</h3><ul>
<li><p>collections.OrderedDict([items])</p>
<ul>
<li>key并不是按照加入的顺序排列，可以使用OrderedDict记录顺序</li>
</ul>
<p>from collections import OrderedDict</p>
<p>import random</p>
<p>d = {‘banana’:3,’apple’:4,’pear’:1,’orange’:2}</p>
<p>print(d)</p>
<p>keys = list(d.keys())</p>
<p>random.shuffle(keys)</p>
<p>print(keys)</p>
<p>od = OrderedDict()</p>
<p>for key in keys:</p>
<p>​    od[key] = d[key]</p>
<p>print(od)</p>
<p>print(od.keys())</p>
</li>
<li><p>有序字典可以记录元素插入的顺序，打印的时候也是按照这个顺序输出打印</p>
</li>
<li>3.6版本的Python的字典就是记录key插入的顺序（IPython不一定有效果）</li>
<li>应用场景<ul>
<li>假如使用字典记录了N个产品，这些产品使用ID由小到大加入到字典中</li>
<li>除了使用字典检索的遍历，有进修需要取出ID，但是希望是按照输入的顺序，因为输入顺序是有序的</li>
<li>否则还需要重新把遍历到的值排序</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># OrderedDict顺序的字典，这里指key要按顺序而不是值输出。key的顺序应该和我们放入的顺序是</span></span><br><span class="line"><span class="comment"># 一样的</span></span><br><span class="line">d = &#123;&#125;</span><br><span class="line">d[<span class="string">'a'</span>] = <span class="number">1</span></span><br><span class="line">d[<span class="string">'b'</span>] = <span class="number">2</span></span><br><span class="line">d[<span class="number">1</span>] = <span class="number">3</span></span><br><span class="line">print(d)</span><br><span class="line"><span class="comment"># 这里显示的d的值应该是按hash值排列的</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> d:</span><br><span class="line">    print(k)</span><br><span class="line">输出：</span><br><span class="line">&#123;<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="number">2</span>, <span class="number">1</span>: <span class="number">3</span>&#125;</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> OrderedDict</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">d = &#123;<span class="string">'banana'</span>:<span class="number">3</span>,<span class="string">'apple'</span>:<span class="number">4</span>,<span class="string">'pear'</span>:<span class="number">1</span>,<span class="string">'orange'</span>:<span class="number">2</span>&#125;</span><br><span class="line">print(d)</span><br><span class="line">keys = list(d.keys())</span><br><span class="line">random.shuffle(keys)   <span class="comment"># 用shuffle把keys列表打乱</span></span><br><span class="line">od = OrderedDict()</span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> keys:</span><br><span class="line">    od[key] = d[key]   <span class="comment"># 创建od的kv对</span></span><br><span class="line">    </span><br><span class="line">print(od)</span><br><span class="line">print(od.keys())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这种方法可能在ipython中不再起作用，因为显示的值与输入的顺序是一样的。3.5版本之前是解决不</span></span><br><span class="line"><span class="comment"># 了这个问题的。或者是在jupeter中就是可以按顺序显示的？需要在python命令行中再测试一下。视</span></span><br><span class="line"><span class="comment"># 频中测试的3.6.1版本时，发现和这里的显示是一样的，按顺序显示。所以最好在python环境中测</span></span><br><span class="line"><span class="comment"># 试，也就是在命令行输入python，之后执行上面的命令测试。之前视频中用ipython测试会打乱顺序</span></span><br><span class="line">输出：</span><br><span class="line">&#123;<span class="string">'banana'</span>: <span class="number">3</span>, <span class="string">'apple'</span>: <span class="number">4</span>, <span class="string">'pear'</span>: <span class="number">1</span>, <span class="string">'orange'</span>: <span class="number">2</span>&#125;</span><br><span class="line">OrderedDict([(<span class="string">'banana'</span>, <span class="number">3</span>), (<span class="string">'pear'</span>, <span class="number">1</span>), (<span class="string">'orange'</span>, <span class="number">2</span>), (<span class="string">'apple'</span>, <span class="number">4</span>)])</span><br><span class="line">odict_keys([<span class="string">'banana'</span>, <span class="string">'pear'</span>, <span class="string">'orange'</span>, <span class="string">'apple'</span>])</span><br></pre></td></tr></table></figure>
<h3 id="字典练习"><a href="#字典练习" class="headerlink" title="字典练习"></a>字典练习</h3><ul>
<li>用户输入一个数字<ul>
<li>打印每一位数字及其重复的次数</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">num = input(<span class="string">'&gt;&gt;&gt;'</span>)</span><br><span class="line">d = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> num:</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> d.get(c):</span><br><span class="line">        d[c] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    d[c] += <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">print(d)</span><br><span class="line"></span><br><span class="line">d = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> num:</span><br><span class="line">    <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> d.keys():</span><br><span class="line">        d[c] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        d[c] += <span class="number">1</span></span><br><span class="line">print(d)</span><br></pre></td></tr></table></figure>
<ul>
<li>数字重复统计<ul>
<li>随机产生100个整数</li>
<li>数字的范围[-1000,1000]</li>
<li>升序输出所有不同的数字及其重复的次数</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">n = <span class="number">100</span></span><br><span class="line">nums = [<span class="number">0</span>] * n</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">    nums[i] = random.randint(<span class="number">-1000</span>,<span class="number">1000</span>)</span><br><span class="line">print(nums)</span><br><span class="line">t = nums.copy()</span><br><span class="line">t.sort()</span><br><span class="line">print(t)</span><br><span class="line"></span><br><span class="line">d = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> nums:</span><br><span class="line">    <span class="keyword">if</span> x <span class="keyword">not</span> <span class="keyword">in</span> d.keys():</span><br><span class="line">        d[x] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        d[x] += <span class="number">1</span></span><br><span class="line">print(d)</span><br><span class="line">d1 = sorted(d.items())</span><br><span class="line">print(d1)</span><br></pre></td></tr></table></figure>
<ul>
<li>字符串重复统计<ul>
<li>字符表’abcdefghijklmnopqrstuvwxyz’</li>
<li>随机挑选2个字母组成字符串，共挑选100个</li>
<li>降序输出所有不同的字符串及重复的次数</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">alphabet = <span class="string">'abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line"></span><br><span class="line">words = []</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    <span class="comment"># words.append(random.choice(alphabet)+random.choice(alphabet))</span></span><br><span class="line">    <span class="comment"># words.append(''.join(random.sample(alphabet,2)))   随机采样</span></span><br><span class="line">    words.append(<span class="string">''</span>.join(random.choice(alphabet) <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">2</span>))) <span class="comment"># 生成器</span></span><br><span class="line">    </span><br><span class="line">d = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> words:</span><br><span class="line">    d[x] = d.get(x,<span class="number">0</span>) + <span class="number">1</span></span><br><span class="line">print(d)</span><br><span class="line"></span><br><span class="line">d1 = sorted(d.items(),reverse=<span class="keyword">True</span>)</span><br><span class="line">print(d1)</span><br></pre></td></tr></table></figure>
<h4 id="将字符串格式设置功能用于字典"><a href="#将字符串格式设置功能用于字典" class="headerlink" title="将字符串格式设置功能用于字典"></a>将字符串格式设置功能用于字典</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt; phonebook</span><br><span class="line">&#123;<span class="string">'Beth'</span>: <span class="string">'9102'</span>, <span class="string">'Alice'</span>: <span class="string">'2341'</span>, <span class="string">'Cecil'</span>: <span class="string">'3258'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"Cecil's phone number is &#123;Cecil&#125;."</span>.format_map(phonebook)</span><br><span class="line"><span class="string">"Cecil's phone number is 3258."</span></span><br><span class="line"><span class="comment"># 可在字典中包含各种信息，这样只需在格式字符串中提取所需的信息即可。使用format_map来指出你</span></span><br><span class="line"><span class="comment"># 将通过一个映射来提供所需的信息。可使用字符串格式设置功能来设置值的格式，这些值是作为命名或</span></span><br><span class="line"><span class="comment"># 非命名参数提供给方法format的。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>template = <span class="string">'''&lt;html&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>&lt;head&gt;&lt;title&gt;&#123;title&#125;&lt;/title&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>&lt;body&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>&lt;h1&gt;&#123;title&#125;&lt;/h1&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>&lt;p&gt;&#123;text&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string"><span class="meta">... </span>&lt;/body&gt;'''</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>data = &#123;<span class="string">'title'</span>: <span class="string">'My Home Page'</span>, <span class="string">'text'</span>: <span class="string">'Welcome to my home page!'</span>&#125;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(template.format_map(data))</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;&lt;title&gt;My Home Page&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1&gt;My Home Page&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;Welcome to my home page!&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"><span class="comment"># 将data字典的值代入template中。像这样使用字典时，可指定任意数量的转换说明符，条件是所有</span></span><br><span class="line"><span class="comment"># 的字段名都是包含在字典中的键。</span></span><br></pre></td></tr></table></figure>
<p>##### </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/25/python基础学习-使用字符串/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/25/python基础学习-使用字符串/" itemprop="url">
                  python基础学习-使用字符串
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-25 14:28:54" itemprop="dateCreated datePublished" datetime="2019-03-25T14:28:54+08:00">2019-03-25</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-10-28 14:34:45" itemprop="dateModified" datetime="2019-10-28T14:34:45+08:00">2019-10-28</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>​    字符串是一个个字符组成的有序的序列，是字符的集合。可以使用单引号、双引号、三引号引住的字符序列。字符串是不可变对象。从Python3起，字符串就是Unicode类型。</p>
<h4 id="字符串定义-初始化"><a href="#字符串定义-初始化" class="headerlink" title="字符串定义-初始化"></a>字符串定义-初始化</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">s1 = <span class="string">'string'</span></span><br><span class="line">s2 = <span class="string">"string2"</span></span><br><span class="line">s3 = <span class="string">'''this's a "string"'''</span></span><br><span class="line">s4 = <span class="string">'hello \n magedu.com'</span></span><br><span class="line">s5 = <span class="string">r"hello \n magedu.com"</span></span><br><span class="line">s6 = <span class="string">'c:\windows\nt'</span></span><br><span class="line">s7 = R<span class="string">"c:\windows\\nt"</span></span><br><span class="line">s8 = <span class="string">'c:\windows\\nt'</span></span><br><span class="line"><span class="comment"># 使用\\可以转义为一个\</span></span><br><span class="line">sql = <span class="string">"""select * from user where name='tom'"""</span></span><br><span class="line">print(s1,s2,s3,s4,s5,s6,s7,s8,sql)</span><br></pre></td></tr></table></figure>
<h4 id="字符串元素访问-下标"><a href="#字符串元素访问-下标" class="headerlink" title="字符串元素访问-下标"></a>字符串元素访问-下标</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字符串支持使用索引访问</span></span><br><span class="line">sql = <span class="string">"select * from user where name='tom'"</span></span><br><span class="line">sql[<span class="number">4</span>]   </span><br><span class="line">输出：<span class="string">'c'</span></span><br><span class="line"></span><br><span class="line">sql[<span class="number">4</span>] = <span class="string">'o'</span></span><br><span class="line">输出：---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-6</span><span class="number">-9056</span>ec11fda5&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">1</span> sql = <span class="string">"select * from user where name='tom'"</span></span><br><span class="line">----&gt; 2 sql[4] = 'o'</span><br><span class="line"></span><br><span class="line">TypeError: <span class="string">'str'</span> object does <span class="keyword">not</span> support item assignment</span><br><span class="line"><span class="comment"># 字符串是不可变对象，所以报错</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 有序的字符集合，字符序列</span></span><br><span class="line">sql = <span class="string">"select * from user where name='tom'"</span></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> sql:</span><br><span class="line">    print(c)</span><br><span class="line">    print(type(c))</span><br><span class="line">输出：</span><br><span class="line">s</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">str</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">e</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">str</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">l</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">str</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">e</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">str</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">c</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">str</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">t</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">str</span>'&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"># 可迭代</span></span><br><span class="line">sql = "select * from user where name='tom'"</span><br><span class="line">lst = list(sql)</span><br><span class="line">print(lst)</span><br><span class="line">输出：</span><br><span class="line">[<span class="string">'s'</span>, <span class="string">'e'</span>, <span class="string">'l'</span>, <span class="string">'e'</span>, <span class="string">'c'</span>, <span class="string">'t'</span>, <span class="string">' '</span>, <span class="string">'*'</span>, <span class="string">' '</span>, <span class="string">'f'</span>, <span class="string">'r'</span>, <span class="string">'o'</span>, <span class="string">'m'</span>, <span class="string">' '</span>, <span class="string">'u'</span>, <span class="string">'s'</span>, <span class="string">'e'</span>, <span class="string">'r'</span>, <span class="string">' '</span>, <span class="string">'w'</span>, <span class="string">'h'</span>, <span class="string">'e'</span>, <span class="string">'r'</span>, <span class="string">'e'</span>, <span class="string">' '</span>, <span class="string">'n'</span>, <span class="string">'a'</span>, <span class="string">'m'</span>, <span class="string">'e'</span>, <span class="string">'='</span>, <span class="string">"'"</span>, <span class="string">'t'</span>, <span class="string">'o'</span>, <span class="string">'m'</span>, <span class="string">"'"</span>]</span><br><span class="line"></span><br><span class="line">练习：</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>website = <span class="string">'http://www.python.org'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>website[<span class="number">-3</span>:] = <span class="string">'com'</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File "&lt;pyshell#19&gt;", line 1, in ?</span><br><span class="line">website[<span class="number">-3</span>:] = <span class="string">'com'</span></span><br><span class="line">TypeError: object doesn<span class="string">'t support slice assignment</span></span><br><span class="line"><span class="string"># 所有标准序列操作(索引、切片、乘法、成员资格检查、长度、最小值和最大值)都适用于字符串，但字符串是不可变的，因此所有的元素赋值和切片赋值都是非法的。</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串join连接"><a href="#字符串join连接" class="headerlink" title="字符串join连接"></a>字符串join连接</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># "string".join(iterable) -&gt; str</span></span><br><span class="line"><span class="comment"># 将可迭代对象连接起来，使用string作为分隔符</span></span><br><span class="line"><span class="comment"># 可迭代对象本身元素都是字符串</span></span><br><span class="line"><span class="comment"># 返回一个新字符串</span></span><br><span class="line"></span><br><span class="line">lst = [<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>]</span><br><span class="line">print(<span class="string">"\""</span>.join(lst))</span><br><span class="line">输出：<span class="number">1</span><span class="string">"2"</span><span class="number">3</span></span><br><span class="line"><span class="comment"># 分隔符是双引号。\是转义符</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">" "</span>.join(lst))</span><br><span class="line">输出：<span class="number">1</span> <span class="number">2</span> <span class="number">3</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">"\n"</span>.join(lst))</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"></span><br><span class="line">lst = [<span class="string">'1'</span>,[<span class="string">'a'</span>,<span class="string">'b'</span>],<span class="string">'3'</span>]</span><br><span class="line">print(<span class="string">" "</span>.join(lst))</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-11</span>-d6bdd3c2fbc5&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">1</span> lst = [<span class="string">'1'</span>,[<span class="string">'a'</span>,<span class="string">'b'</span>],<span class="string">'3'</span>]</span><br><span class="line">----&gt; 2 print(" ".join(lst))</span><br><span class="line"></span><br><span class="line">TypeError: sequence item <span class="number">1</span>: expected str instance, list found</span><br><span class="line"><span class="comment"># 不能对复杂列表用join()函数</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>seq = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sep = <span class="string">'+'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sep.join(seq) </span><br><span class="line"><span class="comment"># 尝试合并一个数字列表，结果不可以对列表使用join方法</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">File "&lt;stdin&gt;", line 1, in ?</span><br><span class="line">TypeError: sequence item <span class="number">0</span>: expected string, int found</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>seq = [<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sep.join(seq) </span><br><span class="line"><span class="string">'1+2+3+4+5'</span></span><br><span class="line"><span class="comment"># 合并一个字符串列表</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dirs = <span class="string">''</span>, <span class="string">'usr'</span>, <span class="string">'bin'</span>, <span class="string">'env'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'/'</span>.join(dirs)</span><br><span class="line"><span class="string">'/usr/bin/env'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'C:'</span> + <span class="string">'\\'</span>.join(dirs))</span><br><span class="line">C:\usr\bin\env</span><br><span class="line"><span class="comment"># 这里需要对\转义</span></span><br><span class="line"><span class="comment"># 注：所合并序列的元素必须都是字符串。</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串-连接"><a href="#字符串-连接" class="headerlink" title="字符串+连接"></a>字符串+连接</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># + -&gt; str</span></span><br><span class="line"><span class="comment"># 将2个字符串连接在一起</span></span><br><span class="line"><span class="comment"># 返回一个新字符串</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串分割"><a href="#字符串分割" class="headerlink" title="* 字符串分割"></a>* 字符串分割</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分割字符串的方法分为2类</span></span><br><span class="line">	<span class="comment"># split系</span></span><br><span class="line">		<span class="comment"># 将字符串按照分隔符分割成若干字符串，并返回列表</span></span><br><span class="line">	<span class="comment"># partition系</span></span><br><span class="line">    	<span class="comment"># 将字符串按照分隔符分割成2段，返回这2段和分隔符的元组</span></span><br><span class="line">        </span><br><span class="line"><span class="comment"># split(sep=None,maxsplit=-1) -&gt; list of strings</span></span><br><span class="line">	<span class="comment"># 从左至右</span></span><br><span class="line">    <span class="comment"># sep指定分割字符串，缺省的情况下空白字符串作为分隔符</span></span><br><span class="line">    <span class="comment"># maxsplit指定分割的次数，-1表示遍历整个字符串</span></span><br><span class="line">    </span><br><span class="line">s1 = <span class="string">"I'm \ta super student."</span></span><br><span class="line">s1.split()</span><br><span class="line">输出：[<span class="string">"I'm"</span>, <span class="string">'a'</span>, <span class="string">'super'</span>, <span class="string">'student.'</span>]</span><br><span class="line"><span class="comment"># 默认以空白为分割符</span></span><br><span class="line"></span><br><span class="line">s1.split(<span class="string">'s'</span>)</span><br><span class="line">输出：[<span class="string">"I'm \ta "</span>, <span class="string">'uper '</span>, <span class="string">'tudent.'</span>]</span><br><span class="line"><span class="comment"># 以s为分割符</span></span><br><span class="line"></span><br><span class="line">s1.split(<span class="string">'super'</span>)</span><br><span class="line">输出：[<span class="string">"I'm \ta "</span>, <span class="string">' student.'</span>]</span><br><span class="line"></span><br><span class="line">s1.split(<span class="string">'super '</span>)    <span class="comment"># 这比上面的super多了一个空格</span></span><br><span class="line">输出：[<span class="string">"I'm \ta "</span>, <span class="string">'student.'</span>]</span><br><span class="line"></span><br><span class="line">s1.split(<span class="string">' '</span>)</span><br><span class="line">输出：[<span class="string">"I'm"</span>, <span class="string">'\ta'</span>, <span class="string">'super'</span>, <span class="string">'student.'</span>]</span><br><span class="line"></span><br><span class="line">s1.split(<span class="string">' '</span>,maxsplit=<span class="number">2</span>)</span><br><span class="line">输出：[<span class="string">"I'm"</span>, <span class="string">'\ta'</span>, <span class="string">'super student.'</span>]</span><br><span class="line"></span><br><span class="line">s1.split(<span class="string">'\t'</span>,maxsplit=<span class="number">2</span>)</span><br><span class="line">输出：[<span class="string">"I'm "</span>, <span class="string">'a super student.'</span>]</span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'1+2+3+4+5'</span>.split(<span class="string">'+'</span>)</span><br><span class="line">[<span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'/usr/bin/env'</span>.split(<span class="string">'/'</span>)</span><br><span class="line">[<span class="string">''</span>, <span class="string">'usr'</span>, <span class="string">'bin'</span>, <span class="string">'env'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'Using the default'</span>.split()</span><br><span class="line">[<span class="string">'Using'</span>, <span class="string">'the'</span>, <span class="string">'default'</span>]</span><br><span class="line"><span class="comment"># split是一个非常重要的字符串方法，其作用与join相反，用于将字符串拆分为序列。如果没有指定分隔符，将默认在单个或多个连续的空白字符(空格、制表符、换行符等)处进行拆分。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># splitlines([keepends]) -&gt; list of strings</span></span><br><span class="line">	<span class="comment"># 按照行来切分字符串</span></span><br><span class="line">    <span class="comment"># keepends指的是是否保留行分隔符</span></span><br><span class="line">    <span class="comment"># 行分隔符包括\n、\r\n、\r、等</span></span><br><span class="line"><span class="string">'ab c\n\nde fg\rkl\r\n'</span>.splitlines()</span><br><span class="line">输出：[<span class="string">'ab c'</span>, <span class="string">''</span>, <span class="string">'de fg'</span>, <span class="string">'kl'</span>]</span><br><span class="line"></span><br><span class="line"><span class="string">'ab c\n\nde fg\rkl\r\n'</span>.splitlines(<span class="keyword">True</span>)</span><br><span class="line">输出：[<span class="string">'ab c\n'</span>, <span class="string">'\n'</span>, <span class="string">'de fg\r'</span>, <span class="string">'kl\r\n'</span>]</span><br><span class="line"></span><br><span class="line">s1 = <span class="string">'''I'm a super student.</span></span><br><span class="line"><span class="string">You're a super teacher.'''</span></span><br><span class="line">print(s1)</span><br><span class="line">输出：</span><br><span class="line">I<span class="string">'m a super student.</span></span><br><span class="line"><span class="string">You'</span>re a super teacher.</span><br><span class="line"></span><br><span class="line">print(s1.splitlines())</span><br><span class="line">输出：[<span class="string">"I'm a super student."</span>, <span class="string">"You're a super teacher."</span>]</span><br><span class="line"></span><br><span class="line">print(s1.splitlines(<span class="keyword">True</span>))</span><br><span class="line">输出：[<span class="string">"I'm a super student.\n"</span>, <span class="string">"You're a super teacher."</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># * partition(sep) -&gt; (head, sep, tail)</span></span><br><span class="line">	<span class="comment"># 从左至右，遇到分隔符就把字符串分割成两部分，返回头、分隔符、尾三部分的三元组；如果没有找</span></span><br><span class="line">    <span class="comment"># 到分隔符，就返回头、2个空元素的三元组</span></span><br><span class="line">    <span class="comment"># sep分割字符串，心须指定</span></span><br><span class="line">s1 = <span class="string">"I'm a super student."</span></span><br><span class="line">s1.partition(<span class="string">'s'</span>)</span><br><span class="line">输出：(<span class="string">"I'm a "</span>, <span class="string">'s'</span>, <span class="string">'uper student.'</span>)</span><br><span class="line"></span><br><span class="line">s1.partition(<span class="string">'stu'</span>)</span><br><span class="line">输出：(<span class="string">"I'm a super "</span>, <span class="string">'stu'</span>, <span class="string">'dent.'</span>)</span><br><span class="line"></span><br><span class="line">s1.partition(<span class="string">''</span>)</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">ValueError                                Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-29</span><span class="number">-4</span>a93ae92b66c&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">2</span> s1.partition(<span class="string">'s'</span>)</span><br><span class="line">      <span class="number">3</span> s1.partition(<span class="string">'stu'</span>)</span><br><span class="line">----&gt; 4 s1.partition('')</span><br><span class="line"></span><br><span class="line">ValueError: empty separator</span><br><span class="line">    </span><br><span class="line">s1.partition(<span class="string">'abc'</span>)</span><br><span class="line">输出：</span><br><span class="line"></span><br><span class="line"><span class="comment"># rpartition(sep) -&gt; (head, sep, tail)</span></span><br><span class="line">	<span class="comment"># 从右至左，遇到分隔符就把字符串分割成两部分，返回头、分隔符、尾三部分的三元组；如果没有找到分隔符，</span></span><br><span class="line">    <span class="comment"># 就返回2个空元素和尾的三元组</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串大小写"><a href="#字符串大小写" class="headerlink" title="字符串大小写"></a>字符串大小写</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># upper()   全大写</span></span><br><span class="line"><span class="comment"># lower()    全小写</span></span><br><span class="line"><span class="comment"># 大小写，做判断的时候用</span></span><br><span class="line"><span class="comment"># swapcase()    交互大小写</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'Trondheim Hammer Dance'</span>.lower()</span><br><span class="line"><span class="string">'trondheim hammer dance'</span></span><br><span class="line"><span class="comment"># lower返回字符串的小写版本</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> <span class="string">'Gumby'</span> <span class="keyword">in</span> [<span class="string">'gumby'</span>, <span class="string">'smith'</span>, <span class="string">'jones'</span>]: print(<span class="string">'Found it!'</span>)</span><br><span class="line">...</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 这样是找不到的。这里的匹配是区分大小写的</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">'Gumby'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>names = [<span class="string">'gumby'</span>, <span class="string">'smith'</span>, <span class="string">'jones'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> name.lower() <span class="keyword">in</span> names: print(<span class="string">'Found it!'</span>)</span><br><span class="line">...</span><br><span class="line">Found it!</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 使用lower转换后才可以找到</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串排版"><a href="#字符串排版" class="headerlink" title="字符串排版"></a>字符串排版</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># title() -&gt; str</span></span><br><span class="line">	<span class="comment"># 标题的每个单词都大写</span></span><br><span class="line"><span class="comment"># capitalize() -&gt; str</span></span><br><span class="line">    <span class="comment"># 首个单词大写</span></span><br><span class="line"><span class="comment"># center(width[,fillchar]) -&gt; str</span></span><br><span class="line">    <span class="comment"># width    打印宽度</span></span><br><span class="line">    <span class="comment"># fillchar    填充的字符</span></span><br><span class="line"><span class="comment"># zfill(width) -&gt; str</span></span><br><span class="line">    <span class="comment"># width  打印宽度，居右，左边用0填充</span></span><br><span class="line"><span class="comment"># ljust(width[,fillchar]) -&gt; str    左对齐</span></span><br><span class="line"><span class="comment"># rjust(width[,fillchar]) -&gt; str    右对齐</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"The Middle by Jimmy Eat World"</span>.center(<span class="number">39</span>)</span><br><span class="line"><span class="string">'      The Middle by Jimmy Eat World      '</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"The Middle by Jimmy Eat World"</span>.center(<span class="number">39</span>, <span class="string">"*"</span>)</span><br><span class="line"><span class="string">'*****The Middle by Jimmy Eat World*****'</span></span><br><span class="line"><span class="comment"># center通过在两边添加填充字符(默认为空格)让字符串居中。上面表示总长度是39，不足的地方用星号填充</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"that's all folks"</span>.title()</span><br><span class="line"><span class="string">"That'S All, Folks"</span></span><br><span class="line"><span class="comment"># title将字符串转换为词首大写，即所有单词的首字母都大写，其他字母都小写。然而，它确定单词边界的方式可能导致结果不合理。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> string</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>string.capwords(<span class="string">"that's all, folks"</span>)</span><br><span class="line">That<span class="string">'s All, Folks"</span></span><br><span class="line"><span class="string"># 还可以使用模块string中的函数capwords</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串修改"><a href="#字符串修改" class="headerlink" title="* 字符串修改"></a>* 字符串修改</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># replace(old,new[,count]) -&gt; str</span></span><br><span class="line">	<span class="comment"># 字符串中找到匹配替换为新子串，返回新字符串</span></span><br><span class="line">    <span class="comment"># count表示替换几次，不指定就是全部替换</span></span><br><span class="line">    </span><br><span class="line"><span class="string">'www.magedu.com'</span>.replace(<span class="string">'w'</span>,<span class="string">'p'</span>)</span><br><span class="line">输出：<span class="string">'ppp.magedu.com'</span></span><br><span class="line"></span><br><span class="line"><span class="string">'www.magedu.com'</span>.replace(<span class="string">'w'</span>,<span class="string">'p'</span>,<span class="number">2</span>)</span><br><span class="line">输出：<span class="string">'ppw.magedu.com'</span></span><br><span class="line"></span><br><span class="line"><span class="string">'www.magedu.com'</span>.replace(<span class="string">'w'</span>,<span class="string">'p'</span>,<span class="number">3</span>)</span><br><span class="line">输出：<span class="string">'ppp.magedu.com'</span></span><br><span class="line"></span><br><span class="line"><span class="string">'www.magedu.com'</span>.replace(<span class="string">'ww'</span>,<span class="string">'p'</span>,<span class="number">2</span>)</span><br><span class="line">输出：<span class="string">'pw.magedu.com'</span></span><br><span class="line"></span><br><span class="line"><span class="string">'www.magedu.com'</span>.replace(<span class="string">'www'</span>,<span class="string">'python'</span>,<span class="number">2</span>)</span><br><span class="line">输出：<span class="string">'python.magedu.com'</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'This is a test'</span>.replace(<span class="string">'is'</span>, <span class="string">'eez'</span>)</span><br><span class="line"><span class="string">'Theez eez a test'</span></span><br><span class="line"><span class="comment"># replace将指定子串都替换为另一个字符串，并返回替换后的结果。上面是将is替换为eez</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># strip([chars]) -&gt; str</span></span><br><span class="line">	<span class="comment"># 从字符串两端去除指定的字符集chars中的所有字符</span></span><br><span class="line">    <span class="comment"># 如果chars没有指定，去除两端的空白字符</span></span><br><span class="line">    </span><br><span class="line">s = <span class="string">"\r \n \t Hello Python \n \t"</span></span><br><span class="line">s.strip()</span><br><span class="line">输出：<span class="string">'Hello Python'</span></span><br><span class="line"><span class="comment"># 没有指定去除的字符串，所以去除的是空白</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">" I am very very very sorry "</span></span><br><span class="line">s.strip(<span class="string">'Iy'</span>)</span><br><span class="line">输出：<span class="string">' I am very very very sorry '</span></span><br><span class="line"><span class="comment"># 因为前后都有空格，所以输出与原字符串没有区别</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">" I am very very very sorry "</span></span><br><span class="line">s.strip(<span class="string">'Iy '</span>)</span><br><span class="line">输出：<span class="string">'am very very very sorr'</span></span><br><span class="line"><span class="comment"># 在strip中加了空格，所以可以去除字符串中前后的空格和与空格挨着的I和y。</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'      internal whitespace is kept      '</span>.strip()</span><br><span class="line"><span class="string">'internal whitespace is kept'</span></span><br><span class="line"><span class="comment"># strip将字符串开头和末尾的空白(但不包括中间的空白)删除，并返回删除后的结果。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>names = [<span class="string">'gumby'</span>, <span class="string">'smith'</span>, <span class="string">'jones'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = <span class="string">'gumby '</span></span><br><span class="line"><span class="comment"># 这里的gumby后有一个空格</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> name <span class="keyword">in</span> names: print(<span class="string">'Found it!'</span>)</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">if</span> name.strip() <span class="keyword">in</span> names: print(<span class="string">'Found it!'</span>)</span><br><span class="line">...</span><br><span class="line">Found it!</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"><span class="comment"># 需要将输入与存储的值进行比较时，strip很有用。如上面，在用户名后多了一个空格也可以找到</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'*** SPAM * for * everyone!!! ***'</span>.strip(<span class="string">' *!'</span>)</span><br><span class="line"><span class="string">'SPAM * for * everyone'</span></span><br><span class="line"><span class="comment"># 这个方法可以删除开头或末尾的指定字符，中间的星号不会被删除。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># lstrip([chars]) -&gt; str</span></span><br><span class="line">	<span class="comment"># 从左开始</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># rstrip([chars]) -&gt; str</span></span><br><span class="line">	<span class="comment"># 从右开始</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串查找"><a href="#字符串查找" class="headerlink" title="* 字符串查找"></a>* 字符串查找</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># find(sub[,start[,end]]) -&gt; int</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start,end]，从左至右，查找子串sub。查询到结果返回索引，没查询到结果返回-1</span></span><br><span class="line"><span class="comment"># rfind(sub[,start[,end]]) -&gt; int</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start,end]，从右至左，查找子串sub。查询到结果返回索引，没查询到结果返回-1</span></span><br><span class="line">    </span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.find(<span class="string">'very'</span>)</span><br><span class="line">输出：<span class="number">5</span></span><br><span class="line"><span class="comment"># 结果表示从索引5开始，找到了very</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.find(<span class="string">'very'</span>, <span class="number">5</span>)</span><br><span class="line">输出：<span class="number">5</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.find(<span class="string">'very'</span>, <span class="number">6</span>, <span class="number">13</span>)</span><br><span class="line">输出：<span class="number">-1</span></span><br><span class="line"><span class="comment"># 这表示没有找到，区间是从索引6到12，这也是前包后不包。如果将13改成14，就能找到了</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.rfind(<span class="string">'very'</span>, <span class="number">10</span>)</span><br><span class="line">输出：<span class="number">15</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.rfind(<span class="string">'very'</span>, <span class="number">10</span>, <span class="number">15</span>)</span><br><span class="line">输出：<span class="number">10</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.rfind(<span class="string">'very'</span>,<span class="number">-10</span>,<span class="number">-1</span>)</span><br><span class="line">输出：<span class="number">15</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'With a moo-moo here, and a moo-moo there'</span>.find(<span class="string">'moo'</span>)</span><br><span class="line"><span class="number">7</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>title = <span class="string">"Monty Python's Flying Circus"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>title.find(<span class="string">'Monty'</span>)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>title.find(<span class="string">'Python'</span>)</span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>title.find(<span class="string">'Flying'</span>)</span><br><span class="line"><span class="number">15</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>title.find(<span class="string">'Zirquss'</span>)</span><br><span class="line"><span class="number">-1</span></span><br><span class="line"><span class="comment"># find在字符串中查找子串。如果找到，就返回子串的第一个字符的索引，否则返回-1。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject = <span class="string">'$$$ Get rich now!!! $$$'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject.find(<span class="string">'$$$'</span>)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="comment"># 使用find查找在subject字符串中的$$$，字符串方法find返回的并非布尔值。如果find像这样返回0，就意味着它在索引0处找到了指定的子串。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject = <span class="string">'$$$ Get rich now!!! $$$'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject.find(<span class="string">'$$$'</span>)</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject.find(<span class="string">'$$$'</span>, <span class="number">1</span>) </span><br><span class="line"><span class="number">20</span></span><br><span class="line"><span class="comment"># 只指定了起点</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject.find(<span class="string">'!!!'</span>)</span><br><span class="line"><span class="number">16</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject.find(<span class="string">'!!!'</span>, <span class="number">0</span>, <span class="number">16</span>) </span><br><span class="line"><span class="number">-1</span></span><br><span class="line"><span class="comment"># 同时指定了起点和终点</span></span><br><span class="line"><span class="comment"># 起点和终点值(第二个和第三个参数)指定的搜索范围包含起点，但不包含终点。前包后不包</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># index(sub[, start[, end]]) -&gt; int</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start, end)，从左至右，查找子串sub。找到返回索引，没找到抛出异常ValueError</span></span><br><span class="line"><span class="comment"># rindex(sub[, start[, end]]) -&gt; int</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start, end)，从左至右，查找子串sub。找到返回索引，没找到抛出异常ValueError</span></span><br><span class="line"><span class="comment"># 这两个函数与上面两个不同之处就是会抛出异常。</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.index(<span class="string">'very'</span>)</span><br><span class="line">输出：<span class="number">5</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.index(<span class="string">'very'</span>, <span class="number">5</span>)</span><br><span class="line">输出：<span class="number">5</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.index(<span class="string">'very'</span>, <span class="number">6</span>, <span class="number">13</span>)</span><br><span class="line">输出：---------------------------------------------------------------------------</span><br><span class="line">ValueError                                Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-19</span><span class="number">-2</span>b0e56ce0749&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">1</span> s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">----&gt; 2 s.index('very', 6, 13)</span><br><span class="line"></span><br><span class="line">ValueError: substring <span class="keyword">not</span> found</span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.rindex(<span class="string">'very'</span>, <span class="number">10</span>)</span><br><span class="line">输出：<span class="number">15</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.rindex(<span class="string">'very'</span>, <span class="number">10</span>, <span class="number">15</span>)</span><br><span class="line">输出：<span class="number">10</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.rindex(<span class="string">'very'</span>,<span class="number">-10</span>,<span class="number">-1</span>)</span><br><span class="line">输出：<span class="number">15</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 时间复杂度</span></span><br><span class="line">	<span class="comment"># index和count方法都是O(n)</span></span><br><span class="line">	<span class="comment"># 随着列表数据规模的增大,而效率下降</span></span><br><span class="line"><span class="comment"># len(string)</span></span><br><span class="line">	<span class="comment"># 返回字符串的长度,即字符的个数</span></span><br><span class="line"><span class="comment"># count(sub[, start[, end]]) -&gt; int</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start, end),从左至右,统计子串sub出现的次数</span></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.count(<span class="string">'very'</span>)</span><br><span class="line">输出：<span class="number">3</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.count(<span class="string">'very'</span>, <span class="number">5</span>)</span><br><span class="line">输出：<span class="number">3</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.count(<span class="string">'very'</span>, <span class="number">10</span>, <span class="number">14</span>)</span><br><span class="line">输出：<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串判断"><a href="#字符串判断" class="headerlink" title="* 字符串判断"></a>* 字符串判断</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># endswith(suffix[, start[, end]]) -&gt; bool</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start, end)，字符串是否是suffix结尾</span></span><br><span class="line"><span class="comment"># startswith(prefix[, start[, end]]) -&gt; bool</span></span><br><span class="line">	<span class="comment"># 在指定的区间[start, end)，字符串是否是prefix开头</span></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.startswith(<span class="string">'very'</span>)</span><br><span class="line">输出：<span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.startswith(<span class="string">'very'</span>, <span class="number">5</span>)</span><br><span class="line">输出：<span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.startswith(<span class="string">'very'</span>, <span class="number">5</span>, <span class="number">9</span>)</span><br><span class="line">输出：<span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.endswith(<span class="string">'very'</span>, <span class="number">5</span>, <span class="number">9</span>)</span><br><span class="line">输出：<span class="keyword">True</span></span><br><span class="line"><span class="comment"># 因为第一个very是从索引5到索引8，所以上面的命令涵盖了这个区间，所以无论是startswith还是</span></span><br><span class="line"><span class="comment"># endswith都返回True</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.endswith(<span class="string">'sorry'</span>, <span class="number">5</span>)</span><br><span class="line">输出：<span class="keyword">True</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.endswith(<span class="string">'sorry'</span>, <span class="number">5</span>, <span class="number">-1</span>)</span><br><span class="line">输出：<span class="keyword">False</span></span><br><span class="line"><span class="comment"># 因为是前包后不包，所以索引是-1是不行的，就不能从尾部找到sorry了。</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"I am very very very sorry"</span></span><br><span class="line">s.endswith(<span class="string">'sorry'</span>, <span class="number">5</span>, <span class="number">100</span>)</span><br><span class="line">输出：<span class="keyword">True</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串判断-is系列"><a href="#字符串判断-is系列" class="headerlink" title="字符串判断 is系列"></a>字符串判断 is系列</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># isalnum() -&gt; bool 是否是字母和数字组成</span></span><br><span class="line"><span class="comment"># isalpha() 是否是字母</span></span><br><span class="line"><span class="comment"># isdecimal() 是否只包含十进制数字</span></span><br><span class="line"><span class="comment"># isdigit() 是否全部数字(0~9)</span></span><br><span class="line"><span class="comment"># isidentifier() 是不是字母和下划线开头,其他都是字母、数字、下划线</span></span><br><span class="line"><span class="comment"># islower() 是否都是小写</span></span><br><span class="line"><span class="comment"># isupper() 是否全部大写</span></span><br><span class="line"><span class="comment"># isspace() 是否只包含空白字符</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串格式化"><a href="#字符串格式化" class="headerlink" title="*** 字符串格式化"></a>*** 字符串格式化</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字符串的格式化是一种拼接字符串输出样式的手段，更灵活方便</span></span><br><span class="line">	<span class="comment"># join拼接只能使用分隔符，且要求被拼接的是可迭代对象</span></span><br><span class="line">	<span class="comment"># + 拼接字符串还算方便，但是非字符串需要先转换为字符串才能拼接</span></span><br><span class="line"><span class="comment"># 在2.5版本之前，只能使用printf style风格的print输出</span></span><br><span class="line">	<span class="comment"># printf-style formatting，来自于C语言的printf函数</span></span><br><span class="line">	<span class="comment"># 格式要求</span></span><br><span class="line">		<span class="comment"># 占位符:使用%和格式字符组成，例如%s、%d等</span></span><br><span class="line">			<span class="comment"># s调用str()，r会调用repr()。所有对象都可以被这两个转换。</span></span><br><span class="line">		<span class="comment"># 占位符中还可以插入修饰字符，例如%03d表示打印3个位置，不够前面补零</span></span><br><span class="line">		<span class="comment"># format % values，格式字符串和被格式的值之间使用%分隔</span></span><br><span class="line">		<span class="comment"># values只能是一个对象，或是一个和格式字符串占位符数目相等的元组，或一个字典</span></span><br><span class="line"><span class="comment"># printf-style formatting 举例</span></span><br><span class="line"><span class="string">"I am %03d"</span> % (<span class="number">20</span>,)</span><br><span class="line">输出：<span class="string">'I am 020'</span></span><br><span class="line"></span><br><span class="line"><span class="string">'I like %s.'</span> % <span class="string">'Python'</span></span><br><span class="line">输出：<span class="string">'I like Python.'</span></span><br><span class="line"></span><br><span class="line"><span class="string">'%3.2f%% , 0x%x, 0X%02X'</span> % (<span class="number">89.7654</span>, <span class="number">10</span>, <span class="number">15</span>)</span><br><span class="line">输出：<span class="string">'89.77% , 0xa, 0X0F'</span></span><br><span class="line"></span><br><span class="line"><span class="string">"I am %-5d"</span> % (<span class="number">20</span>,)</span><br><span class="line">输出：<span class="string">'I am 20   '</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># format函数格式字符串语法——Python鼓励使用</span></span><br><span class="line">	<span class="comment"># "&#123;&#125; &#123;xxx&#125;".format(*args, **kwargs) -&gt; str</span></span><br><span class="line">	<span class="comment"># args是位置参数,是一个元组</span></span><br><span class="line">	<span class="comment"># kwargs是关键字参数,是一个字典</span></span><br><span class="line">	<span class="comment"># 花括号表示占位符</span></span><br><span class="line">	<span class="comment"># &#123;&#125;表示按照顺序匹配位置参数,&#123;n&#125;表示取位置参数索引为n的值</span></span><br><span class="line">	<span class="comment"># &#123;xxx&#125;表示在关键字参数中搜索名称一致的</span></span><br><span class="line">	<span class="comment"># &#123;&#123;&#125;&#125; 表示打印花括号</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 位置参数</span></span><br><span class="line"><span class="string">"&#123;&#125;:&#123;&#125;"</span>.format(<span class="string">'192.168.1.100'</span>,<span class="number">8888</span>)</span><br><span class="line">输出：<span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span>:<span class="number">8888</span></span><br><span class="line"><span class="comment"># 这就是按照位置顺序用位置参数替换前面的格式字符串的占位符中</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关键字参数或命名参数</span></span><br><span class="line"><span class="string">"&#123;server&#125; &#123;1&#125;:&#123;0&#125;"</span>.format(<span class="number">8888</span>, <span class="string">'192.168.1.100'</span>, server=<span class="string">'Web Server Info : '</span>) </span><br><span class="line">输出：Web Server Info :  <span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span>:<span class="number">8888</span></span><br><span class="line"><span class="comment"># 位置参数按照序号匹配，关键字参数按照名词匹配</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 访问元素</span></span><br><span class="line"><span class="string">"&#123;0[0]&#125;.&#123;0[1]&#125;"</span>.format((<span class="string">'magedu'</span>,<span class="string">'com'</span>))</span><br><span class="line">输出：magedu.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对象属性访问</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line">Point = namedtuple(<span class="string">'_Point'</span>,<span class="string">'x y'</span>)</span><br><span class="line">p = Point(<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line"><span class="string">"&#123;&#123;&#123;0.x&#125;,&#123;0.y&#125;&#125;&#125;"</span>.format(p)</span><br><span class="line">输出：<span class="string">'&#123;4,5&#125;'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对齐</span></span><br><span class="line"><span class="string">'&#123;0&#125;*&#123;1&#125;=&#123;2:&lt;2&#125;'</span>.format(<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>*<span class="number">3</span>)</span><br><span class="line">输出：<span class="number">3</span>*<span class="number">2</span>=<span class="number">6</span> </span><br><span class="line"><span class="string">'&#123;0&#125;*&#123;1&#125;=&#123;2:&lt;02&#125;'</span>.format(<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>*<span class="number">3</span>)</span><br><span class="line">输出：<span class="number">3</span>*<span class="number">2</span>=<span class="number">60</span></span><br><span class="line"><span class="string">'&#123;0&#125;*&#123;1&#125;=&#123;2:&gt;02&#125;'</span>.format(<span class="number">3</span>,<span class="number">2</span>,<span class="number">2</span>*<span class="number">3</span>)</span><br><span class="line">输出：<span class="number">3</span>*<span class="number">2</span>=<span class="number">06</span></span><br><span class="line"><span class="string">'&#123;:^30&#125;'</span>.format(<span class="string">'centered'</span>)</span><br><span class="line">输出：           centered           </span><br><span class="line"><span class="string">'&#123;:*^30&#125;'</span>.format(<span class="string">'centered'</span>)</span><br><span class="line">输出：***********centered***********</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进制</span></span><br><span class="line"><span class="string">"int: &#123;0:d&#125;; hex: &#123;0:x&#125;; oct: &#123;0:o&#125;; bin: &#123;0:b&#125;"</span>.format(<span class="number">42</span>)</span><br><span class="line">输出：int: <span class="number">42</span>; hex: <span class="number">2</span>a; oct: <span class="number">52</span>; bin: <span class="number">101010</span></span><br><span class="line">                </span><br><span class="line"><span class="string">"int: &#123;0:d&#125;; hex: &#123;0:#x&#125;; oct: &#123;0:#o&#125;; bin: &#123;0:#b&#125;"</span>.format(<span class="number">42</span>)</span><br><span class="line">输出：int: <span class="number">42</span>; hex: <span class="number">0x2a</span>; oct: <span class="number">0o52</span>; bin: <span class="number">0b101010</span></span><br><span class="line">                </span><br><span class="line">octets = [<span class="number">192</span>, <span class="number">168</span>, <span class="number">0</span>, <span class="number">1</span>]</span><br><span class="line"><span class="string">'&#123;:02X&#125;&#123;:02X&#125;&#123;:02X&#125;&#123;:02X&#125;'</span>.format(*octets)</span><br><span class="line">输出：C0A80001</span><br><span class="line"><span class="comment"># *号表示参数解构，依次将每个元素分解开。X表示转为16进制</span></span><br><span class="line"></span><br><span class="line">练习</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>format = <span class="string">"Hello, %s. %s enough for ya?"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>values = (<span class="string">'world'</span>, <span class="string">'Hot'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>format % values</span><br><span class="line"><span class="string">'Hello, world. Hot enough for ya?'</span></span><br><span class="line"><span class="comment"># 在%左边指定一个字符串(格式字符串)，并在右边指定要设置其格式的值。指定要设置其格式的值时，可使用单个值(如字符串或数字)，可使用元组(如果要设置多个值的格式)，还可使用字典，其中最常见的是元组。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>format = <span class="string">"Hello, %s. %s enough for ya?"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>values = (<span class="string">'world'</span>, <span class="string">'Hot'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>format % values</span><br><span class="line"><span class="string">'Hello, world. Hot enough for ya?'</span></span><br><span class="line"><span class="comment"># 上述格式字符串中的%s称为转换说明符，指出了要将值插入什么地方。s意味着将值视为字符串进行格式设置。如果指定的值不是字符串，将使用str将其转换为字符串。其他说明符将导致其他形式的转换。例如，%.3f将值的格式设置为包含3位小数的浮点数。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> string <span class="keyword">import</span> Template</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tmpl = Template(<span class="string">"Hello, $who! $what enough for ya?"</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tmpl.substitute(who=<span class="string">"Mars"</span>, what=<span class="string">"Dusty"</span>)</span><br><span class="line"><span class="string">'Hello, Mars! Dusty enough for ya?'</span></span><br><span class="line"><span class="comment"># 包含等号的参数称为关键字参数。在字符串格式设置中，可将关键字参数视为一种向命名替换字段提供值的方式。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;&#125;, &#123;&#125; and &#123;&#125;"</span>.format(<span class="string">"first"</span>, <span class="string">"second"</span>, <span class="string">"third"</span>)</span><br><span class="line"><span class="string">'first, second and third'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;0&#125;, &#123;1&#125; and &#123;2&#125;"</span>.format(<span class="string">"first"</span>, <span class="string">"second"</span>, <span class="string">"third"</span>)</span><br><span class="line"><span class="string">'first, second and third'</span></span><br><span class="line"><span class="comment"># 在最简单的情况下，替换字段没有名称或将索引用作名称。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;3&#125; &#123;0&#125; &#123;2&#125; &#123;1&#125; &#123;3&#125; &#123;0&#125;"</span>.format(<span class="string">"be"</span>, <span class="string">"not"</span>, <span class="string">"or"</span>, <span class="string">"to"</span>)</span><br><span class="line"><span class="string">'to be or not to be'</span></span><br><span class="line"><span class="comment"># 索引无需按顺序排列</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> math <span class="keyword">import</span> pi</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;name&#125; is approximately &#123;value:.2f&#125;."</span>.format(value=pi, name=<span class="string">"π"</span>)</span><br><span class="line"><span class="string">'π is approximately 3.14.'</span></span><br><span class="line"><span class="comment"># 关键字参数的排列顺序无关紧要。在这里，我还指定了格式说明符.2f，并使用冒号将其与字段名隔开。它意味着要使用包含2位小数的浮点数格式。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;name&#125; is approximately &#123;value&#125;."</span>.format(value=pi, name=<span class="string">"π"</span>)</span><br><span class="line"><span class="string">'π is approximately 3.141592653589793.'</span></span><br><span class="line"><span class="comment"># 没有指定.2f的结果</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> math <span class="keyword">import</span> e</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">f"Euler's constant is roughly <span class="subst">&#123;e&#125;</span>."</span></span><br><span class="line"><span class="string">"Euler's constant is roughly 2.718281828459045."</span></span><br><span class="line"><span class="comment"># 如果变量与替换字段同名，可使用f字符串——在字符串前面加上f。创建最终的字符串时，将把替换字段e替换为变量e的值。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"Euler's constant is roughly &#123;e&#125;."</span>.format(e=e)</span><br><span class="line"><span class="string">"Euler's constant is roughly 2.718281828459045."</span></span><br><span class="line"><span class="comment"># 此命令与上面的命令效果是一样的。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;&#123;ceci n'est pas une replacement field&#125;&#125;"</span>.format()</span><br><span class="line"><span class="string">"&#123;ceci n'est pas une replacement field&#125;"</span></span><br><span class="line"><span class="comment"># 要在最终结果中包含花括号，可在格式字符串中使用两个花括号(即&#123;&#123;或 &#125;&#125;)来指定。</span></span><br><span class="line">============================================================================================</span><br><span class="line">在格式字符串中，最激动人心的部分为替换字段。替换字段由如下部分组成，其中每个部分都是可选的。</span><br><span class="line">* 字段名：索引或标识符，指出要设置哪个值的格式并使用结果来替换该字段。除指定值外，还可指定值的特定部分，如列表的元素。</span><br><span class="line">* 转换标志：跟在叹号后面的单个字符。当前支持的字符包括r(表示repr) 、s(表示str)和a(表示ascii)。如果你指定了转换标志，将不使用对象本身的格式设置机制，而是使用指定的函数将对象转换为字符串，再做进一步的格式设置。</span><br><span class="line">* 格式说明符：跟在冒号后面的表达式(这种表达式是使用微型格式指定语言表示的) 。格式说明符让我们能够详细地指定最终的格式，包括格式类型(如字符串、浮点数或十六进制数)，字段宽度和数的精度，如何显示符号和千位分隔符，以及各种对齐和填充方式。</span><br><span class="line">============================================================================================</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;foo&#125; &#123;&#125; &#123;bar&#125; &#123;&#125;"</span>.format(<span class="number">1</span>, <span class="number">2</span>, bar=<span class="number">4</span>, foo=<span class="number">3</span>)</span><br><span class="line"><span class="string">'3 1 4 2'</span></span><br><span class="line"><span class="comment"># 还可通过索引来指定要在哪个字段中使用相应的未命名参数，这样可不按顺序使用未命名参数。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;foo&#125; &#123;1&#125; &#123;bar&#125; &#123;0&#125;"</span>.format(<span class="number">1</span>, <span class="number">2</span>, bar=<span class="number">4</span>, foo=<span class="number">3</span>)</span><br><span class="line"><span class="string">'3 2 4 1'</span></span><br><span class="line"><span class="comment"># 不能同时使用手工编号和自动编号，因为这样很快会变得混乱不堪。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fullname = [<span class="string">"Alfred"</span>, <span class="string">"Smoketoomuch"</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"Mr &#123;name[1]&#125;"</span>.format(name=fullname)</span><br><span class="line"><span class="string">'Mr Smoketoomuch'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tmpl = <span class="string">"The &#123;mod.__name__&#125; module defines the value &#123;mod.pi&#125; for π"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tmpl.format(mod=math)</span><br><span class="line"><span class="string">'The math module defines the value 3.141592653589793 for π'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"&#123;pi!s&#125; &#123;pi!r&#125; &#123;pi!a&#125;"</span>.format(pi=<span class="string">"π"</span>))</span><br><span class="line">π <span class="string">'π'</span> <span class="string">'\u03c0'</span></span><br><span class="line"><span class="comment"># 上述三个标志(s、r和a)指定分别使用str、repr和ascii进行转换。函数str通常创建外观普通的字符串版本(这里没有对输入字符串做任何处理)。函数 repr 尝试创建给定值的Python表示(这里是一个字符串字面量)。函数 ascii创建只包含ASCII字符的表示</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"The number is &#123;num&#125;"</span>.format(num=<span class="number">42</span>)</span><br><span class="line"><span class="string">'The number is 42'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"The number is &#123;num:f&#125;"</span>.format(num=<span class="number">42</span>)</span><br><span class="line"><span class="string">'The number is 42.000000'</span></span><br><span class="line"><span class="comment"># 可指定要转换的值是哪种类型，更准确地说，是要将其视为哪种类型。例如，上面命令提供一个整数，但将其作为小数进行处理。为此可在格式说明(即冒号后面)使用字符f(表示定点数) 。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"The number is &#123;num:b&#125;"</span>.format(num=<span class="number">42</span>)</span><br><span class="line"><span class="string">'The number is 101010'</span></span><br><span class="line"><span class="comment"># 作为二进制数进行处理</span></span><br><span class="line"></span><br><span class="line">============================================================================================</span><br><span class="line">类型			含义</span><br><span class="line">b			将整数表示为二进制数</span><br><span class="line">c			将整数解读为Unicode码点</span><br><span class="line">d			将整数视为十进制数进行处理，这是整数默认使用的说明符</span><br><span class="line">e			使用科学表示法来表示小数(用e来表示指数)</span><br><span class="line">E			与e相同，但使用E来表示指数</span><br><span class="line">f			将小数表示为定点数</span><br><span class="line">F			与 f相同，但对于特殊值(nan和 inf)，使用大写表示</span><br><span class="line">g			自动在定点表示法和科学表示法之间做出选择。这是默认用于小数的说明符，但在默认情况下至少有<span class="number">1</span>位小数</span><br><span class="line">G			与 g相同，但使用大写来表示指数和特殊值</span><br><span class="line">n			与 g相同，但插入随区域而异的数字分隔符</span><br><span class="line">o			将整数表示为八进制数</span><br><span class="line">s			保持字符串的格式不变，这是默认用于字符串的说明符</span><br><span class="line">x			将整数表示为十六进制数并使用小写字母</span><br><span class="line">X			与 x相同，但使用大写字母</span><br><span class="line">%			将数表示为百分比值(乘以<span class="number">100</span>，按说明符 f设置格式，再在后面加上%)</span><br><span class="line">============================================================================================</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;num:10&#125;"</span>.format(num=<span class="number">3</span>)</span><br><span class="line"><span class="string">'          3'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;name:10&#125;"</span>.format(name=<span class="string">"Bob"</span>)</span><br><span class="line"><span class="string">'Bob          '</span></span><br><span class="line"><span class="comment"># 宽度是使用整数指定的。数和字符串的对齐方式不同。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"Pi day is &#123;pi:.2f&#125;"</span>.format(pi=pi)</span><br><span class="line"><span class="string">'Pi day is 3.14'</span></span><br><span class="line"><span class="comment"># 精度也是使用整数指定的，但需要在它前面加上一个表示小数点的句点。这里显式地指定了类型f，因为默认的精度处理方式稍有不同</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;pi:10.2f&#125;"</span>.format(pi=pi)</span><br><span class="line"><span class="string">'          3.14'</span></span><br><span class="line"><span class="comment"># 同时指定宽度和精度</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;:.5&#125;"</span>.format(<span class="string">"Guido van Rossum"</span>)</span><br><span class="line"><span class="string">'Guido'</span></span><br><span class="line"><span class="comment"># 对于其他类型也可指定精度，但是这样做的情形不太常见。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'One googol is &#123;:,&#125;'</span>.format(<span class="number">10</span>**<span class="number">100</span>)</span><br><span class="line"><span class="string">'One googol is 10,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,000,00</span></span><br><span class="line"><span class="string">0,000,000,000,000,000,000,000,000,000,000,000,000,000,000'</span></span><br><span class="line"><span class="comment"># 使用逗号来指出你要添加千位分隔符</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'&#123;:010.2f&#125;'</span>.format(pi)</span><br><span class="line"><span class="string">'0000003.14'</span></span><br><span class="line"><span class="comment"># 在指定宽度和精度的数前面，可添加一个标志。这个标志可以是零、加号、减号或空格，其中零表示使用0来填充数字。</span></span><br><span class="line"><span class="comment"># &#123;:010.2f&#125;指定一共有10位，小数点有两位，前面不足的地方用0填充。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;0:&lt;10.2f&#125;\n&#123;0:^10.2f&#125;\n&#123;0:&gt;10.2f&#125;'</span>.format(pi))</span><br><span class="line"><span class="number">3.14</span></span><br><span class="line">	   <span class="number">3.14</span></span><br><span class="line">	 		<span class="number">3.14</span></span><br><span class="line"><span class="comment"># 指定左对齐、右对齐和居中，可分别使用&lt;、&gt;和^</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;:$^15&#125;"</span>.format(<span class="string">" WIN BIG "</span>)</span><br><span class="line"><span class="string">'$$$ WIN BIG $$$'</span></span><br><span class="line"><span class="comment"># &#123;:$^15&#125;表示一共15位，空格也算，不足的地方用$填充。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;0:10.2f&#125;\n&#123;1:10.2f&#125;'</span>.format(pi, -pi))</span><br><span class="line">            <span class="number">3.14</span></span><br><span class="line">          <span class="number">-3.14</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;0:10.2f&#125;\n&#123;1:=10.2f&#125;'</span>.format(pi, -pi))</span><br><span class="line">            <span class="number">3.14</span></span><br><span class="line">-          <span class="number">3.14</span></span><br><span class="line"><span class="comment"># 指定将填充字符放在符号和数字之间。&#123;1:=10.2f&#125;表示索引为1的元素</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;0:-.2&#125;\n&#123;1:-.2&#125;'</span>.format(pi, -pi)) <span class="comment">#默认设置</span></span><br><span class="line"><span class="number">3.1</span></span><br><span class="line"><span class="number">-3.1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;0:+.2&#125;\n&#123;1:+.2&#125;'</span>.format(pi, -pi))</span><br><span class="line">+<span class="number">3.1</span></span><br><span class="line"><span class="number">-3.1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'&#123;0: .2&#125;\n&#123;1: .2&#125;'</span>.format(pi, -pi))</span><br><span class="line"><span class="number">3.1</span></span><br><span class="line"><span class="number">-3.1</span></span><br><span class="line"><span class="comment"># 要给正数加上符号，可使用说明符+(将其放在对齐说明符后面)，而不是默认的-。如果将符号说明符指定为空格，会在正数前面加上空格而不是+。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;:b&#125;"</span>.format(<span class="number">42</span>)</span><br><span class="line"><span class="string">'101010'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;:#b&#125;"</span>.format(<span class="number">42</span>)</span><br><span class="line"><span class="string">'0b101010'</span></span><br><span class="line"><span class="comment"># 井号( #)选项，可将其放在符号说明符和宽度之间(如果指定了这两种设置)。这个选项将触发另一种转换方式，转换细节随类型而异。例如，对于二进制、八进制和十六进制转换，将加上一个前缀。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;:g&#125;"</span>.format(<span class="number">42</span>)</span><br><span class="line"><span class="string">'42'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"&#123;:#g&#125;"</span>.format(<span class="number">42</span>)</span><br><span class="line"><span class="string">'42.0000'</span></span><br><span class="line"><span class="comment"># 对于各种十进制数,它要求必须包含小数点(对于类型g,它保留小数点后面的零)。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据指定的宽度打印格式良好的价格列表</span></span><br><span class="line">width = int(input(<span class="string">'Please enter width: '</span>))</span><br><span class="line"></span><br><span class="line">price_width = <span class="number">10</span></span><br><span class="line">item_width = width - price_width</span><br><span class="line"></span><br><span class="line">header_fmt = <span class="string">'&#123;&#123;:&#123;&#125;&#125;&#125;&#123;&#123;:&gt;&#123;&#125;&#125;&#125;'</span>.format(item_width, price_width)</span><br><span class="line">fmt = <span class="string">'&#123;&#123;:&#123;&#125;&#125;&#125;&#123;&#123;:&gt;&#123;&#125;.2f&#125;&#125;'</span>.format(item_width, price_width)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'='</span> * width)</span><br><span class="line"></span><br><span class="line">print(header_fmt.format(<span class="string">'Item'</span>, <span class="string">'Price'</span>))</span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span> * width)</span><br><span class="line"></span><br><span class="line">print(fmt.format(<span class="string">'Apples'</span>, <span class="number">0.4</span>))</span><br><span class="line">print(fmt.format(<span class="string">'Pears'</span>, <span class="number">0.5</span>))</span><br><span class="line">print(fmt.format(<span class="string">'Cantaloupes'</span>, <span class="number">1.92</span>))</span><br><span class="line">print(fmt.format(<span class="string">'Dried Apricots (16 oz.)'</span>, <span class="number">8</span>))</span><br><span class="line">print(fmt.format(<span class="string">'Prunes (4 lbs.)'</span>, <span class="number">12</span>))</span><br><span class="line"></span><br><span class="line">print(<span class="string">'='</span> * width)</span><br><span class="line">这个程序的运行情况类似于下面这样:</span><br><span class="line">Please enter width: <span class="number">35</span></span><br><span class="line">===================================</span><br><span class="line">Item						Price</span><br><span class="line">-----------------------------------</span><br><span class="line">Apples						<span class="number">0.40</span></span><br><span class="line">Pears						<span class="number">0.50</span></span><br><span class="line">Cantaloupes					<span class="number">1.92</span></span><br><span class="line">Dried Apricots (<span class="number">16</span> oz.)		<span class="number">8.00</span></span><br><span class="line">Prunes (<span class="number">4</span> lbs.)			   <span class="number">12.00</span></span><br><span class="line">===================================</span><br></pre></td></tr></table></figure>
<h4 id="string模块"><a href="#string模块" class="headerlink" title="string模块"></a>string模块</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">string.digits</span><br><span class="line"><span class="comment"># 包含数字0~9的字符串。</span></span><br><span class="line">string.ascii_letters</span><br><span class="line"><span class="comment"># 包含所有ASCII字母(大写和小写)的字符串。</span></span><br><span class="line">string.ascii_lowercase</span><br><span class="line"><span class="comment"># 包含所有小写ASCII字母的字符串。</span></span><br><span class="line">string.printable</span><br><span class="line"><span class="comment"># 包含所有可打印的ASCII字符的字符串。</span></span><br><span class="line">string.punctuation</span><br><span class="line"><span class="comment"># 包含所有ASCII标点字符的字符串。</span></span><br><span class="line">string.ascii_uppercase</span><br><span class="line"><span class="comment"># 包含所有大写ASCII字母的字符串。</span></span><br><span class="line"><span class="comment"># 虽然说的是ASCII字符，但值实际上是未解码的Unicode字符串。</span></span><br></pre></td></tr></table></figure>
<h4 id="translate（替换字符串）"><a href="#translate（替换字符串）" class="headerlink" title="translate（替换字符串）"></a>translate（替换字符串）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方法translate与replace一样替换字符串的特定部分，但不同的是它只能进行单字符替换。这个方法的优势在于能够同时替换多个字符，因此效率比replace高。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>table = str.maketrans(<span class="string">'cs'</span>, <span class="string">'kz'</span>)</span><br><span class="line"><span class="comment"># 使用translate前必须创建一个转换表。将cs两个字母转换为kz两个字母，字母是单个匹配的。这个转换表指出了不同Unicode码点之间的转换关系。要创建转换表，可对字符串类型str调用方法maketrans，这个方法接受两个参数：两个长度相同的字符串，它们指定要将第一个字符串中的每个字符都替换为第二个字符串中的相应字符。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>table</span><br><span class="line">&#123;<span class="number">115</span>: <span class="number">122</span>, <span class="number">99</span>: <span class="number">107</span>&#125;</span><br><span class="line"><span class="comment"># 查看转换表的内容，但你看到的只是Unicode码点之间的映射。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'this is an incredible test'</span>.translate(table)</span><br><span class="line"><span class="string">'thiz iz an inkredible tezt'</span></span><br><span class="line"><span class="comment"># 创建转换表后，就可将其用作方法translate的参数。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>table = str.maketrans(<span class="string">'cs'</span>, <span class="string">'kz'</span>, <span class="string">' '</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'this is an incredible test'</span>.translate(table)</span><br><span class="line"><span class="string">'thizizaninkredibletezt'</span></span><br><span class="line"><span class="comment"># 调用方法 maketrans时,还可提供可选的第三个参数，指定要将哪些字母删除。上面是将所有的空格删除。</span></span><br></pre></td></tr></table></figure>
<h4 id="判断字符串是否满足特定的条件"><a href="#判断字符串是否满足特定的条件" class="headerlink" title="判断字符串是否满足特定的条件"></a>判断字符串是否满足特定的条件</h4><blockquote>
<p>很多字符串方法都以is打头，如isspace、 isdigit 和isupper，它们判断字符串是否具有特定的性质(如包含的字符全为空白、数字或大写) 。如果字符串具备特定的性质，这些方法就返回True，否则返回False。</p>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/21/python基础学习-列表和元组/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/21/python基础学习-列表和元组/" itemprop="url">
                  python基础学习-列表和元组
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-21 13:29:38" itemprop="dateCreated datePublished" datetime="2019-03-21T13:29:38+08:00">2019-03-21</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-10-28 14:02:54" itemprop="dateModified" datetime="2019-10-28T14:02:54+08:00">2019-10-28</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><h4 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h4><blockquote>
<p>数据结构是以某种方式(如通过编号)组合起来的数据元素(如数、字符乃至其他数据结构)集合。</p>
</blockquote>
<h4 id="序列"><a href="#序列" class="headerlink" title="序列"></a>序列</h4><blockquote>
<p>在Python中，最基本的数据结构为序列(sequence) 。序列中的每个元素都有编号，即其位置或索引，其中第一个元素的索引为0，第二个元素的索引为1，依此类推。Python内置了多种序列，如列表、元组、字符串。列表和元组的主要不同在于，列表是可以修改的，而元组不可以。</p>
</blockquote>
<h5 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一个队列，一个排列整齐的队伍</span></span><br><span class="line"><span class="comment"># 列表内的个体称作元素，由若干元素组成列表</span></span><br><span class="line"><span class="comment"># 元素可以是任意对象（数字、字符串、对象、列表等）</span></span><br><span class="line"><span class="comment"># 列表内元素有顺序，可以使用索引</span></span><br><span class="line"><span class="comment"># 线性的数据结构</span></span><br><span class="line"><span class="comment"># 使用[]表示</span></span><br><span class="line"><span class="comment"># 列表是可变的</span></span><br><span class="line"><span class="comment"># 列表list、链表、queue、stack的差异</span></span><br><span class="line"><span class="comment"># 列表不能一开始就定义大小</span></span><br><span class="line">list()</span><br><span class="line"><span class="comment"># 定义一个空列表</span></span><br><span class="line">list(iterable)</span><br><span class="line"><span class="comment"># 从可交互项初始化的新列表</span></span><br><span class="line">例</span><br><span class="line">lst = list()</span><br><span class="line">lst = []</span><br><span class="line">lst = [<span class="number">2</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="string">'ab'</span>]</span><br><span class="line">lst = list(range(<span class="number">5</span>))</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>edward = [<span class="string">'Edward Gumby'</span>, <span class="number">42</span>]</span><br><span class="line"><span class="comment"># 使用列表来表示</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>edward = [<span class="string">'Edward Gumby'</span>, <span class="number">42</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>john = [<span class="string">'John Smith'</span>, <span class="number">50</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>database = [edward, john]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>database</span><br><span class="line">[[<span class="string">'Edward Gumby'</span>, <span class="number">42</span>], [<span class="string">'John Smith'</span>, <span class="number">50</span>]]</span><br><span class="line"><span class="comment"># 序列还可包含其他序列，上面是创建一个由数据库中所有人员组成的列表。Python支持一种数据结构的基本概念，名为容器(container)。容器基本上就是可包含其他对象的对象。两种主要的容器是序列(如列表和元组)和映射(如字典) 。在序列中，每个元素都有编号，而在映射中，每个元素都有名称(也叫键)。</span></span><br></pre></td></tr></table></figure>
<h4 id="数字的处理函数"><a href="#数字的处理函数" class="headerlink" title="数字的处理函数"></a>数字的处理函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">round()</span><br><span class="line"><span class="comment"># 这个函数是四舍六入五取偶的</span></span><br><span class="line">floor()</span><br><span class="line"><span class="comment"># 这个函数是向下取整的</span></span><br><span class="line">ceil()</span><br><span class="line"><span class="comment"># 这个函数是向上取整的</span></span><br><span class="line">int()</span><br><span class="line"><span class="comment"># 这个函数是取整数部分的</span></span><br><span class="line">//</span><br><span class="line"><span class="comment"># 整除且向下取整</span></span><br><span class="line"><span class="comment"># python只有长整型，数值没有上限。int也是取整的，如int(1.5)，得1。floor是向下取整的。ceil是向上取整的。round是4舍6入5取偶。 bin是二进制，返回的是字符串。oct是八进制。pi是派。 </span></span><br><span class="line">bin()</span><br><span class="line">oct()</span><br><span class="line">hex()</span><br><span class="line"><span class="comment"># 上面三个是进制函数，返回值是字符串</span></span><br><span class="line">math.pi</span><br><span class="line"><span class="comment"># 派</span></span><br><span class="line">math.e</span><br><span class="line"><span class="comment"># 自然常数</span></span><br></pre></td></tr></table></figure>
<h4 id="类型判断"><a href="#类型判断" class="headerlink" title="类型判断"></a>类型判断</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">type(a) == str </span><br><span class="line"><span class="comment"># 这是类型比较的方式</span></span><br><span class="line">type(obj)</span><br><span class="line"><span class="comment"># 返回类型，而不是字符串</span></span><br><span class="line">isinstance(obj,class_or_tuple)</span><br><span class="line"><span class="comment"># 返回布尔值</span></span><br><span class="line">例：</span><br><span class="line">type(a)</span><br><span class="line">type(<span class="string">'abc'</span>)</span><br><span class="line">type(<span class="number">123</span>)</span><br><span class="line">isinstance(<span class="number">6</span>,str)</span><br><span class="line">isinstance(<span class="number">6</span>,(str,bool,int))</span><br><span class="line">type(<span class="number">1</span>+<span class="keyword">True</span>)</span><br><span class="line">type(<span class="number">1</span>+<span class="keyword">True</span>+<span class="number">2.0</span>)</span><br></pre></td></tr></table></figure>
<h3 id="通用的序列操作"><a href="#通用的序列操作" class="headerlink" title="通用的序列操作"></a>通用的序列操作</h3><h4 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 索引，也叫下标</span></span><br><span class="line"><span class="comment"># 正索引：从左至右，从0开始，为列表中每一个元素编号</span></span><br><span class="line"><span class="comment"># 负索引：从右至左，从-1开始</span></span><br><span class="line"><span class="comment"># 正负索引不可以超界，否则引发异常IndexError</span></span><br><span class="line"><span class="comment"># 为了理解方便，可以认为列表是从左至右排列的，左边是头部，右边是尾部，左边是下界，右边是上界</span></span><br><span class="line"><span class="comment"># 列表通过索引访问</span></span><br><span class="line"><span class="comment"># list[index]，index就是索引，使用中括号访问</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>greeting = <span class="string">'Hello'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>greeting[<span class="number">0</span>]</span><br><span class="line"><span class="string">'H'</span></span><br><span class="line"><span class="comment"># 字符串就是由字符组成的序列。索引0指向第一个元素,这里为字母H。Python没有专门用于表示字符的类型，因此一个字符就是只包含一个元素的字符串。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>greeting[<span class="number">-1</span>]</span><br><span class="line"><span class="string">'o'</span></span><br><span class="line"><span class="comment"># 当你使用负数索引时，Python将从右(即从最后一个元素)开始往左数，因此-1是最后一个元素的位置。对于字符串字面量(以及其他的序列字面量)，可直接对其执行索引操作,无需先将其赋给变量。这与先赋给变量再对变量执行索引操作的效果是一样的。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'Hello'</span>[<span class="number">1</span>]</span><br><span class="line"><span class="string">'e'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fourth = input(<span class="string">'Year: '</span>)[<span class="number">3</span>]</span><br><span class="line">Year: <span class="number">2005</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>fourth</span><br><span class="line"><span class="string">'5'</span></span><br><span class="line"><span class="comment"># 如果函数调用返回一个序列，可直接对其执行索引操作。例如：如果你只想获取用户输入的年份的第4位</span></span><br><span class="line"></span><br><span class="line">months = [</span><br><span class="line"><span class="string">'January'</span>,</span><br><span class="line"><span class="string">'February'</span>,</span><br><span class="line"><span class="string">'March'</span>,</span><br><span class="line"><span class="string">'April'</span>,</span><br><span class="line"><span class="string">'May'</span>,</span><br><span class="line"><span class="string">'June'</span>,</span><br><span class="line"><span class="string">'July'</span>,</span><br><span class="line"><span class="string">'August'</span>,</span><br><span class="line"><span class="string">'September'</span>,</span><br><span class="line"><span class="string">'October'</span>,</span><br><span class="line"><span class="string">'November'</span>,</span><br><span class="line"><span class="string">'December'</span></span><br><span class="line">]</span><br><span class="line">endings = [<span class="string">'st'</span>, <span class="string">'nd'</span>, <span class="string">'rd'</span>] + <span class="number">17</span> * [<span class="string">'th'</span>] \</span><br><span class="line">+ [<span class="string">'st'</span>, <span class="string">'nd'</span>, <span class="string">'rd'</span>] + <span class="number">7</span> * [<span class="string">'th'</span>] \</span><br><span class="line">+ [<span class="string">'st'</span>]</span><br><span class="line"><span class="comment"># 这是一个列表的拼接，st,nd,rd表示1,2,3号，4-20使用th，之后只要有1,2,3就要用st,nd,rd表示，其他用th表示</span></span><br><span class="line">year= input(<span class="string">'Year: '</span>)</span><br><span class="line">month= input(<span class="string">'Month (1-12): '</span>)</span><br><span class="line">day= input(<span class="string">'Day (1-31): '</span>)</span><br><span class="line">month_number = int(month)</span><br><span class="line">day_number = int(day)</span><br><span class="line">month_name = months[month_number<span class="number">-1</span>]</span><br><span class="line">ordinal = day + endings[day_number<span class="number">-1</span>]</span><br><span class="line"><span class="comment"># 将表示月和日的数要减1，这样才能得到正确的索引。因为months是一个列表，其索引是从0开始的，所以要减1。</span></span><br><span class="line">print(month_name + <span class="string">' '</span> + ordinal + <span class="string">', '</span> + year)</span><br><span class="line">上面的程序执行结果如下：</span><br><span class="line">Year: <span class="number">1974</span></span><br><span class="line">Month (<span class="number">1</span><span class="number">-12</span>): <span class="number">8</span></span><br><span class="line">Day (<span class="number">1</span><span class="number">-31</span>): <span class="number">16</span></span><br><span class="line">August <span class="number">16</span>th, <span class="number">1974</span></span><br></pre></td></tr></table></figure>
<h4 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 需要注意：使用切片方法时，切片中指定的第一个索引值是一定会取的，第二个元素不一定取得到。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tag = <span class="string">'&lt;a href="http://www.python.org"&gt;Python web site&lt;/a&gt;'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tag[<span class="number">9</span>:<span class="number">30</span>]</span><br><span class="line"><span class="string">'http://www.python.org'</span></span><br><span class="line"><span class="comment"># 这是提取tag变量索引9到29的值</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tag[<span class="number">32</span>:<span class="number">-4</span>]</span><br><span class="line"><span class="string">'Python web site'</span></span><br><span class="line"><span class="comment"># 提取tag变量索引32到倒数第5个的值。中括号中的数字是前包后不包的。也就是第一个索引指定的元素包含在切片内，但第二个索引指定的元素不包含在切片内。如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">3</span>:<span class="number">6</span>] </span><br><span class="line">[<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">0</span>:<span class="number">1</span>] </span><br><span class="line">[<span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">7</span>:<span class="number">10</span>]</span><br><span class="line">[<span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="comment"># 首先明确指定从第8个元素开始取值，在这里，索引10指的是第11个元素，它并不存在，但确实是到达最后一个元素后再前进一步所处的位置。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">-3</span>:<span class="number">-1</span>]</span><br><span class="line">[<span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"><span class="comment"># 从倒数第3个元素取到倒数第二个元素</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">-3</span>:<span class="number">0</span>]</span><br><span class="line">[]</span><br><span class="line"><span class="comment"># 如果第二个元素使用0，那么结果是一个空。因为执行切片操作时，如果第一个索引指定的元素位于第二个索引指定的元素后面(在这里，倒数第3个元素位于第1个元素后面) ，结果就为空序列。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">-3</span>:]</span><br><span class="line">[<span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="comment"># 如果要取到最后一个元素，可以不写第二个索引的值</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[:<span class="number">3</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment"># 同样，如果索引从第一个元素开始取值，也可以不写第一个元素的值</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[:]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="comment"># 要复制整个序列,可将两个索引都省略。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>url = input(<span class="string">'Please enter the URL:'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>domain = url[<span class="number">11</span>:<span class="number">-4</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">"Domain name: "</span> + domain)</span><br><span class="line">Please enter the URL: http://www.python.org</span><br><span class="line">Domain name: python</span><br><span class="line"><span class="comment"># 从类似于http://www.something.com的URL中提取域名</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">0</span>:<span class="number">10</span>:<span class="number">1</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="comment"># 执行切片操作时，你显式或隐式地指定起点和终点，但通常省略另一个参数，即步长。在普通切片中，步长为1。这意味着从一个元素移到下一个元素，因此切片包含起点和终点之间的所有元素。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">0</span>:<span class="number">10</span>:<span class="number">2</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">3</span>:<span class="number">6</span>:<span class="number">3</span>]</span><br><span class="line">[<span class="number">4</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[::<span class="number">4</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">5</span>, <span class="number">9</span>]</span><br><span class="line"><span class="comment"># 要从序列中每隔3个元素提取1个，只需提供步长4即可。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">8</span>:<span class="number">3</span>:<span class="number">-1</span>]</span><br><span class="line">[<span class="number">9</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">10</span>:<span class="number">0</span>:<span class="number">-2</span>]</span><br><span class="line">[<span class="number">10</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">0</span>:<span class="number">10</span>:<span class="number">-2</span>]</span><br><span class="line">[]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[::<span class="number">-2</span>]</span><br><span class="line">[<span class="number">10</span>, <span class="number">8</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">5</span>::<span class="number">-2</span>]</span><br><span class="line">[<span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[:<span class="number">5</span>:<span class="number">-2</span>]</span><br><span class="line">[<span class="number">10</span>, <span class="number">8</span>]</span><br><span class="line"><span class="comment"># 步长不能为0，否则无法向前移动，但可以为负数，即从右向左提取元素。步长为负数时，第一个索引必须比第二个索引大。</span></span><br></pre></td></tr></table></figure>
<h4 id="序列相加"><a href="#序列相加" class="headerlink" title="序列相加"></a>序列相加</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># + -&gt; list</span></span><br><span class="line"><span class="comment"># 连接操作，将两个列表连接起来</span></span><br><span class="line"><span class="comment"># 产生新的列表，原列表不变</span></span><br><span class="line"><span class="comment"># 本质上调用的是__add__()方法</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] + [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'Hello,'</span> + <span class="string">'world!'</span></span><br><span class="line"><span class="string">'Hello, world!'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] + <span class="string">'world!'</span></span><br><span class="line">Traceback (innermost last):</span><br><span class="line">File "&lt;pyshell&gt;", line 1, in ?</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>] + <span class="string">'world!'</span></span><br><span class="line">TypeError: can only concatenate list (<span class="keyword">not</span> <span class="string">"string"</span>) to list</span><br><span class="line"><span class="comment"># 不能拼接列表和字符串，虽然它们都是序列。一般而言，不能拼接不同类型的序列。</span></span><br></pre></td></tr></table></figure>
<h4 id="乘法"><a href="#乘法" class="headerlink" title="乘法"></a>乘法</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># * -&gt; list</span></span><br><span class="line"><span class="comment"># 重复操作，将本列表元素重复n次，返回新的列表。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'python'</span> * <span class="number">5</span></span><br><span class="line"><span class="string">'pythonpythonpythonpythonpython'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="number">42</span>] * <span class="number">10</span></span><br><span class="line">[<span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>]</span><br><span class="line"><span class="comment"># 将序列与数x相乘时，将重复这个序列x次来创建一个新序列</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sequence = [<span class="keyword">None</span>] * <span class="number">10</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sequence</span><br><span class="line">[<span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>, <span class="keyword">None</span>]</span><br><span class="line"><span class="comment"># 空列表是使用不包含任何内容的两个方括号([])表示的。如果要创建一个可包含10个元素的列表，但没有任何有用的内容，可像前面那样使用[42]*10。但更准确的做法是使用[0]*10，这将创建一个包含10个零的列表。然而，在有些情况下，你可能想使用表示“什么都没有”的值，如表示还没有在列表中添加任何内容。在这种情况下，可使用None。在Python中，None表示什么都没有。</span></span><br><span class="line"></span><br><span class="line">sentence = input(<span class="string">"Sentence: "</span>)</span><br><span class="line"><span class="comment"># 这里是要求输入要在框中显示的内容的</span></span><br><span class="line">screen_width = <span class="number">80</span></span><br><span class="line"><span class="comment"># screen_width：屏幕宽度</span></span><br><span class="line">text_width = len(sentence)</span><br><span class="line"><span class="comment"># 文本宽度，len用于取字符串宽度</span></span><br><span class="line">box_width = text_width + <span class="number">4</span></span><br><span class="line"><span class="comment"># 框的宽度，这里加的数需要自行调整，示例中加了6，但测试打印出的内容没有达到效果</span></span><br><span class="line">left_margin = (screen_width - box_width) // <span class="number">2</span></span><br><span class="line"><span class="comment"># 左边缘的宽度，等于屏幕宽度减去框的宽度最后除以2,这是为了使最后的内容居中</span></span><br><span class="line">print()</span><br><span class="line"><span class="comment"># 打印一个空行</span></span><br><span class="line">print(<span class="string">' '</span> * left_margin + <span class="string">'+'</span> + <span class="string">'-'</span> * (box_width<span class="number">-2</span>) + <span class="string">'+'</span>)</span><br><span class="line"><span class="comment"># ' ' * left_margin是整个内容左边空出来的距离，然后输出一个加号，之后输出"-"，输出的数量是外框的长度减2,因为两侧都有一个加号所以要减2.最后输出一个加号。</span></span><br><span class="line">print(<span class="string">' '</span> * left_margin + <span class="string">'| '</span> + <span class="string">' '</span> * text_width  + <span class="string">' |'</span>)</span><br><span class="line"><span class="comment"># 实际打印每一行时只要注意左侧的空格数量就可以了。</span></span><br><span class="line">print(<span class="string">' '</span> * left_margin + <span class="string">'| '</span> +       sentence + <span class="string">' |'</span>)</span><br><span class="line"><span class="comment"># 通过'| '和' |'使内容与边缘间多出一个空格</span></span><br><span class="line">print(<span class="string">' '</span> * left_margin + <span class="string">'| '</span> + <span class="string">' '</span> * text_width + <span class="string">' |'</span>)</span><br><span class="line">print(<span class="string">' '</span> * left_margin + <span class="string">'+'</span> + <span class="string">'-'</span> * (box_width<span class="number">-2</span>) + <span class="string">'+'</span>)</span><br><span class="line">print()</span><br><span class="line">输出结果如下：</span><br><span class="line">Sentence: He<span class="string">'s a very naughty boy!</span></span><br><span class="line"><span class="string">                          +---------------------------------+</span></span><br><span class="line"><span class="string">                          |                                 |</span></span><br><span class="line"><span class="string">                          |    He'</span>s a very naughty boy!     |</span><br><span class="line">                          |                                 |</span><br><span class="line">                          +---------------------------------+</span><br></pre></td></tr></table></figure>
<h4 id="成员资格"><a href="#成员资格" class="headerlink" title="成员资格"></a>成员资格</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 要检查特定的值是否包含在序列中，可使用运算符in。这个运算符与前面讨论的运算符(如乘法或加法运算符)稍有不同。它检查是否满足指定的条件，并返回相应的值:满足时返回True，不满足时返回False。这样的运算符称为布尔运算符，而前述真值称为布尔值。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>permissions = <span class="string">'rw'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'w'</span> <span class="keyword">in</span> permissions</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'x'</span> <span class="keyword">in</span> permissions</span><br><span class="line"><span class="keyword">False</span></span><br><span class="line"><span class="comment"># 使用成员资格测试分别检查'w'和'x'是否包含在字符串变量permissions中</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>users = [<span class="string">'mlh'</span>, <span class="string">'foo'</span>, <span class="string">'bar'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>input(<span class="string">'Enter your user name: '</span>) <span class="keyword">in</span> users</span><br><span class="line">Enter your user name: mlh</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="comment"># 检查提供的用户名mlh是否包含在用户列表中，这在程序需要执行特定的安全策略时很有用(在这种情况下，可能还需检查密码)。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>subject = <span class="string">'$$$ Get rich now!!! $$$'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'$$$'</span> <span class="keyword">in</span> subject</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="comment"># 检查字符串变量subject是否包含字符串'$$$'，这可用于垃圾邮件过滤器中。</span></span><br><span class="line"><span class="comment"># 相比于其他示例，检查字符串是否包含'$$$'的示例稍有不同。一般而言，运算符in检查指定的对象是否是序列(或其他集合)的成员(即其中的一个元素)，但对字符串来说，只有它包含的字符才是其成员或元素，因此下面的代码完全合理：&gt;&gt;&gt; 'P' in 'Python'		True</span></span><br><span class="line"></span><br><span class="line">database = [</span><br><span class="line">[<span class="string">'albert'</span>, <span class="string">'1234'</span>],</span><br><span class="line">[<span class="string">'dilbert'</span>,  <span class="string">'4242'</span>],</span><br><span class="line">[<span class="string">'smith'</span>,  <span class="string">'7524'</span>],</span><br><span class="line">[<span class="string">'jones'</span>,  <span class="string">'9843'</span>]</span><br><span class="line">]</span><br><span class="line">username = input(<span class="string">'User name: '</span>)</span><br><span class="line">pin = input(<span class="string">'PIN code: '</span>)</span><br><span class="line"><span class="keyword">if</span> [username, pin] <span class="keyword">in</span> database: print(<span class="string">'Access granted'</span>)</span><br><span class="line">输出结果如下：</span><br><span class="line">User name: jones</span><br><span class="line">PIN code: <span class="number">9843</span></span><br><span class="line">Access granted</span><br><span class="line"><span class="comment"># 检查用户名和PIN码，程序从用户那里获取一个用户名和一个PIN码，并检查它们组成的列表是否包含在数据库(实际上也是一个列表)中。如果用户名-PIN码对包含在数据库中，就打印字符串'Access granted'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers = [<span class="number">100</span>, <span class="number">34</span>, <span class="number">678</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>len(numbers)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>max(numbers)</span><br><span class="line"><span class="number">678</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>min(numbers)</span><br><span class="line"><span class="number">34</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>max(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>min(<span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">5</span>)</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="comment"># 函数len返回序列包含的元素个数，而min和max分别返回序列中最小和最大的元素。</span></span><br><span class="line"><span class="comment"># 最后两个表达式调用max和min时指定的实参并不是序列，而直接将数作为实参。</span></span><br></pre></td></tr></table></figure>
<h4 id="随机数"><a href="#随机数" class="headerlink" title="随机数"></a>随机数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># random模块</span></span><br><span class="line"><span class="comment"># randint(a,b)返回[a,b]之间的整数</span></span><br><span class="line"><span class="comment"># choice(seq)从非空序列的元素中随机挑选一个元素，比如random.choice(range(10))，从0到9中随机挑选一个整数。random.choice([1,3,5,7])</span></span><br><span class="line"><span class="comment"># randrange([start,]stop[,step])从指定范围内，按指定基数递增的集合中获取一个随机数，基数缺省值为1.random.randrange(1,7,2)</span></span><br><span class="line"><span class="comment"># random.shuffle(list) -&gt; None，就地打乱列表元素</span></span><br><span class="line"><span class="comment"># sample(population,k)从样本空间或总体（序列或者集合类型）中随机取出k个不同的元素，返回一个新的列表</span></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line">random.sample([<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>],<span class="number">2</span>)</span><br><span class="line">random.sample([<span class="string">'a'</span>,<span class="string">'a'</span>],<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<h3 id="列表-1"><a href="#列表-1" class="headerlink" title="列表"></a>列表</h3><h4 id="函数list"><a href="#函数list" class="headerlink" title="函数list"></a>函数list</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(<span class="string">'Hello'</span>)</span><br><span class="line">[<span class="string">'H'</span>, <span class="string">'e'</span>, <span class="string">'l'</span>, <span class="string">'l'</span>, <span class="string">'o'</span>]</span><br><span class="line"><span class="comment"># 鉴于不能像修改列表那样修改字符串，因此在有些情况下使用字符串来创建列表很有帮助。可将任何序列(而不仅仅是字符串)作为list的参数。</span></span><br><span class="line"><span class="comment"># 要将字符列表(如前述代码中的字符列表)转换为字符串。可使用下面的表达式：''.join(somelist)，其中somelist是要转换的列表。</span></span><br></pre></td></tr></table></figure>
<h4 id="基本的列表操作"><a href="#基本的列表操作" class="headerlink" title="基本的列表操作"></a>基本的列表操作</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">* 修改列表：给元素赋值</span><br><span class="line">list[index] = value</span><br><span class="line"><span class="comment"># 索引不要超界</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line"><span class="comment"># 将索引为1的值改为2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"><span class="comment"># 不能给不存在的元素赋值，因此如果列表的长度为2，就不能给索引为100的元素赋值。要这样做，列表的长度至少为101。</span></span><br><span class="line"></span><br><span class="line">* 删除元素</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>names = [<span class="string">'Alice'</span>, <span class="string">'Beth'</span>, <span class="string">'Cecil'</span>, <span class="string">'Dee-Dee'</span>, <span class="string">'Earl'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">del</span> names[<span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>names</span><br><span class="line">[<span class="string">'Alice'</span>, <span class="string">'Beth'</span>, <span class="string">'Dee-Dee'</span>, <span class="string">'Earl'</span>]</span><br><span class="line"></span><br><span class="line">* 给切片赋值</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = list(<span class="string">'Perl'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name</span><br><span class="line">[<span class="string">'P'</span>, <span class="string">'e'</span>, <span class="string">'r'</span>, <span class="string">'l'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name[<span class="number">2</span>:] = list(<span class="string">'ar'</span>)</span><br><span class="line"><span class="comment"># 将索引为2到最后的一个元素改为ar，perl就变成了pear</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name</span><br><span class="line">[<span class="string">'P'</span>, <span class="string">'e'</span>, <span class="string">'a'</span>, <span class="string">'r'</span>]</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name = list(<span class="string">'Perl'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name[<span class="number">1</span>:] = list(<span class="string">'ython'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>name</span><br><span class="line">[<span class="string">'P'</span>, <span class="string">'y'</span>, <span class="string">'t'</span>, <span class="string">'h'</span>, <span class="string">'o'</span>, <span class="string">'n'</span>]</span><br><span class="line"><span class="comment"># 通过使用切片赋值，可将切片替换为长度与其不同的序列。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers = [<span class="number">1</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">1</span>:<span class="number">1</span>] = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="comment"># [1:1] 指在索引为1的地方</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="comment"># 使用切片赋值还可在不替换原有元素的情况下插入新元素。在这里，“替换”了一个空切片，相当于插入了一个序列。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">1</span>:<span class="number">4</span>] = []</span><br><span class="line"><span class="comment"># 将索引1至4的元素值替换为空</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers</span><br><span class="line">[<span class="number">1</span>, <span class="number">5</span>]</span><br><span class="line"><span class="comment"># 上述代码与del numbers[1:4]等效</span></span><br></pre></td></tr></table></figure>
<h4 id="列表方法"><a href="#列表方法" class="headerlink" title="列表方法"></a>列表方法</h4><blockquote>
<p>方法是与对象(列表、数、字符串等)联系紧密的函数。<br>调用方法：<br>object.method(arguments)<br>方法调用与函数调用很像，只是在方法名前加上了对象和句点。列表包含多个可用来查看或修改其内容的方法。</p>
<p>下面的方法中，pop index count copy 这四个方法不会就地修改并返回None；append clear extend insert remove reverse sort 这些方法会就地修改并返回None</p>
</blockquote>
<h5 id="append"><a href="#append" class="headerlink" title="append"></a>append</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># append(object) -&gt; None</span></span><br><span class="line"><span class="comment"># 列表尾部追加元素，返回None</span></span><br><span class="line"><span class="comment"># 返回None就意味着没有新的列表产生，就地修改</span></span><br><span class="line"><span class="comment"># 时间复杂度是O(1)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst.append(<span class="number">4</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="comment"># 方法append用于将一个对象附加到列表末尾。 append也就地修改列表。它不会返回修改后的新列表，而是直接修改旧列表。</span></span><br></pre></td></tr></table></figure>
<h5 id="clear"><a href="#clear" class="headerlink" title="clear"></a>clear</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># clear() -&gt; None</span></span><br><span class="line"><span class="comment"># 清除列表所有元素，剩下一个空列表</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst.clear()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lst</span><br><span class="line">[]</span><br><span class="line"><span class="comment"># 方法clear就地清空列表的内容。这类似于切片赋值语句lst[:] = []。</span></span><br></pre></td></tr></table></figure>
<h5 id="copy"><a href="#copy" class="headerlink" title="copy"></a>copy</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># copy() -&gt; list</span></span><br><span class="line"><span class="comment"># shadow copy返回一个新的列表</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = a</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">[<span class="number">1</span>, <span class="number">4</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment"># 方法 copy 复制列表。常规复制只是将另一个名称关联到列表。要让a 和b 指向不同的列表，就必须将b关联到a的副本。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = a.copy()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b[<span class="number">1</span>] = <span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment"># 这类似于使用a[:]或list(a)，它们也都复制a。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># shadow copy表示影子拷贝，也叫浅拷贝，遇到引用类型，只是复制了一个引用而已</span></span><br><span class="line"><span class="comment"># 深浅拷贝测试</span></span><br><span class="line">lst0 = list(range(<span class="number">4</span>))</span><br><span class="line">id(lst0)</span><br><span class="line"><span class="comment"># 查看内存地址</span></span><br><span class="line">hash(lst0)</span><br><span class="line"><span class="comment"># 列表是不可hash的，所以会报错</span></span><br><span class="line">hash(id(lst0))</span><br><span class="line"><span class="comment"># 这样才行</span></span><br><span class="line">lst1 = list(range(<span class="number">4</span>))</span><br><span class="line">id(lst1)</span><br><span class="line"><span class="comment"># lst0和lst1在内存中的位置是不一样的。</span></span><br><span class="line">lst0 == lst1</span><br><span class="line"><span class="comment"># 这里比较的是两个列表的值</span></span><br><span class="line">lst0 <span class="keyword">is</span> lst1</span><br><span class="line"><span class="comment"># 这里比较的是两个列表的内存地址。id就是查看内存地址的</span></span><br><span class="line">lst1 = lst0</span><br><span class="line"><span class="comment"># 这里是将lst0的内存地址给了lst1，这时两个列表都指向了同一个内存地址，所以下面修改lst1的内容时，lst0也会改变</span></span><br><span class="line">lst1[<span class="number">2</span>] = <span class="number">10</span></span><br><span class="line">lst0</span><br><span class="line">lst0 = list(range(<span class="number">4</span>))</span><br><span class="line">lst5 = lst0.copy()</span><br><span class="line"><span class="comment"># 这里只是复制内容，内存地址是不一样的</span></span><br><span class="line">lst5</span><br><span class="line">lst5 == lst0</span><br><span class="line"><span class="comment"># 返回True</span></span><br><span class="line">lst5 <span class="keyword">is</span> lst0</span><br><span class="line"><span class="comment"># 返回False</span></span><br><span class="line">id(lst0)</span><br><span class="line">id(lst5)</span><br><span class="line"><span class="comment"># 内存地址不一样</span></span><br><span class="line">lst0 = [<span class="number">1</span>,[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],<span class="number">5</span>]</span><br><span class="line">lst5 = lst0.copy()</span><br><span class="line"><span class="comment"># 这是一个影子拷贝或叫浅拷贝。当复制的内容比较复杂时，会复制内存地址，如下面的lst0和lst5的复制。</span></span><br><span class="line">lst5 == lst0</span><br><span class="line"><span class="comment"># 返回True</span></span><br><span class="line">lst5[<span class="number">2</span>] = <span class="number">10</span></span><br><span class="line">lst5 == lst0</span><br><span class="line"><span class="comment"># 返回False</span></span><br><span class="line">lst0</span><br><span class="line">lst5[<span class="number">2</span>] = <span class="number">5</span></span><br><span class="line">lst5 == lst0</span><br><span class="line"><span class="comment"># 返回True</span></span><br><span class="line">lst5[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">20</span></span><br><span class="line"><span class="comment"># 这里修改的是第一个元素中的第一个元素</span></span><br><span class="line">lst5 == lst0</span><br><span class="line"><span class="comment"># 因为是浅拷贝，所以列表中的列表复制的是内存地址，所以会都改变。返回True</span></span><br><span class="line">lst0</span><br><span class="line">lst5</span><br><span class="line"><span class="comment"># 两个列表中的值是一样的</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 深拷贝</span></span><br><span class="line"><span class="comment"># copy模块提供了deepcopy</span></span><br><span class="line"><span class="keyword">import</span> copy</span><br><span class="line">lst0 = [<span class="number">1</span>,[<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],<span class="number">5</span>]</span><br><span class="line">lst5 = copy.deepcopy(lst0)</span><br><span class="line">lst5[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">20</span></span><br><span class="line">lst5 == lst0</span><br></pre></td></tr></table></figure>
<h5 id="count"><a href="#count" class="headerlink" title="count"></a>count</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># count(value)</span></span><br><span class="line"><span class="comment"># 返回列表中匹配value的次数</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">'to'</span>, <span class="string">'be'</span>, <span class="string">'or'</span>, <span class="string">'not'</span>, <span class="string">'to'</span>, <span class="string">'be'</span>].count(<span class="string">'to'</span>)</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [[<span class="number">1</span>, <span class="number">2</span>], <span class="number">1</span>, <span class="number">1</span>, [<span class="number">2</span>, <span class="number">1</span>, [<span class="number">1</span>, <span class="number">2</span>]]]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.count(<span class="number">1</span>)</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.count([<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="comment"># 方法count计算指定的元素在列表中出现了多少次。</span></span><br></pre></td></tr></table></figure>
<h5 id="extend"><a href="#extend" class="headerlink" title="extend"></a>extend</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># extend(iteratable) -&gt; None</span></span><br><span class="line"><span class="comment"># 将可迭代对象的元素追加进来，返回None</span></span><br><span class="line"><span class="comment"># 就地修改</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a.extend(b)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="comment"># 方法extend让你能够同时将多个值附加到列表末尾，为此可将这些值组成的序列作为参数提供给方法extend。换而言之，你可使用一个列表来扩展另一个列表。</span></span><br><span class="line"><span class="comment"># 这可能看起来类似于拼接，但存在一个重要差别，那就是将修改被扩展的序列(这里是a)。在常规拼接中，情况是返回一个全新的序列。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a + b</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment"># 拼接出来的列表与前一个示例扩展得到的列表完全相同，但在这里a并没有被修改。鉴于常规拼接必须使用a和b的副本创建一个新列表，因此如果你要获得类似于下面的效果，拼接的效率将比extend低:</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a = a + b</span><br><span class="line"><span class="comment"># 拼接操作并非就地执行的，即它不会修改原来的列表。</span></span><br></pre></td></tr></table></figure>
<h5 id="index"><a href="#index" class="headerlink" title="index"></a>index</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># index(value,[start,[stop]])</span></span><br><span class="line"><span class="comment"># 通过值value，从指定区间查找列表内的元素是否匹配</span></span><br><span class="line"><span class="comment"># 匹配第一个就立即返回索引</span></span><br><span class="line"><span class="comment"># 匹配不到，抛出异常ValueError</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>knights = [<span class="string">'We'</span>, <span class="string">'are'</span>, <span class="string">'the'</span>, <span class="string">'knights'</span>, <span class="string">'who'</span>, <span class="string">'say'</span>, <span class="string">'ni'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>knights.index(<span class="string">'who'</span>)</span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>knights.index(<span class="string">'herring'</span>)</span><br><span class="line">Traceback (innermost last):</span><br><span class="line">File "&lt;pyshell&gt;", line 1, in ?</span><br><span class="line">knights.index(<span class="string">'herring'</span>)</span><br><span class="line">ValueError: list.index(x): x <span class="keyword">not</span> <span class="keyword">in</span> list</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>knights[<span class="number">4</span>]</span><br><span class="line"><span class="string">'who'</span></span><br><span class="line"><span class="comment"># index在列表中查找指定值第一次出现的索引。搜索单词'who'时，发现它位于索引4处。然而，搜索'herring'时引发了异常，因为根本就没有找到这个单词。</span></span><br></pre></td></tr></table></figure>
<h5 id="insert"><a href="#insert" class="headerlink" title="insert"></a>insert</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># insert(index,object) -&gt; None</span></span><br><span class="line"><span class="comment"># 在指定的索引index处插入元素object</span></span><br><span class="line"><span class="comment"># 返回None就意味着没有新的列表产生，就地修改</span></span><br><span class="line"><span class="comment"># 时间复杂度是O(n)</span></span><br><span class="line"><span class="comment"># 索引超越上界，尾部追加</span></span><br><span class="line"><span class="comment"># 索引超越下界，头部追加</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers.insert(<span class="number">3</span>, <span class="string">'four'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">'four'</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"><span class="comment"># insert用于将一个对象插入列表。与extend一样，也可使用切片赋值来获得与insert一样的效果。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers[<span class="number">3</span>:<span class="number">3</span>] = [<span class="string">'four'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>numbers</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="string">'four'</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>]</span><br><span class="line"><span class="comment"># 这虽巧妙，但可读性根本无法与使用insert媲美。</span></span><br></pre></td></tr></table></figure>
<h5 id="pop"><a href="#pop" class="headerlink" title="pop"></a>pop</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pop([index]) -&gt; item</span></span><br><span class="line"><span class="comment"># 不指定索引index，就从列表尾部弹出一个元素</span></span><br><span class="line"><span class="comment"># 指定索引index，就从索引处弹出一个元素，索引超界抛出IndexError错误</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.pop()</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="comment"># 如果用pop()，会删除最后一个元素</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.pop(<span class="number">0</span>)</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">2</span>]</span><br><span class="line"><span class="comment"># pop从列表中删除一个元素(末尾为最后一个元素)，并返回这一元素。</span></span><br><span class="line"><span class="comment"># pop是唯一既修改列表又返回一个非None值的列表方法。</span></span><br><span class="line"><span class="comment"># 使用pop可实现一种常见的数据结构——栈 (stack)。栈就像一叠盘子，你可在上面添加盘子，还可从上面取走盘子。最后加入的盘子最先取走，这被称为后进先出(LIFO)。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.append(x.pop())</span><br><span class="line"><span class="comment"># 每次弹出的都是3，再将3追加到列表的尾部，就还是[1,2,3]</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="comment"># 使用append代替push方法，因为python中没有提供push。此将刚弹出的值压入(或附加)后，得到的栈将与原来相同。要创建先进先出(FIFO)的队列，可使用insert(0, ...)代替append。另外，也可继续使用append，但用 pop(0)替代 pop() 。</span></span><br></pre></td></tr></table></figure>
<h5 id="remove"><a href="#remove" class="headerlink" title="remove"></a>remove</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># remove(value) -&gt; None</span></span><br><span class="line"><span class="comment"># 从左至右查找第一个匹配value的值，移除该元素，返回None</span></span><br><span class="line"><span class="comment"># 就地修改</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="string">'to'</span>, <span class="string">'be'</span>, <span class="string">'or'</span>, <span class="string">'not'</span>, <span class="string">'to'</span>, <span class="string">'be'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.remove(<span class="string">'be'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="string">'to'</span>, <span class="string">'or'</span>, <span class="string">'not'</span>, <span class="string">'to'</span>, <span class="string">'be'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.remove(<span class="string">'bee'</span>)</span><br><span class="line">Traceback (innermost last):</span><br><span class="line">File "&lt;pyshell&gt;", line 1, in ?</span><br><span class="line">x.remove(<span class="string">'bee'</span>)</span><br><span class="line">ValueError: list.remove(x): x <span class="keyword">not</span> <span class="keyword">in</span> list</span><br><span class="line"><span class="comment"># remove用于删除第一个为指定值的元素。这只删除了为指定值的第一个元素，无法删除列表中其他为指定值的元素</span></span><br><span class="line"><span class="comment"># remove是就地修改且不返回值的方法之一。不同于 pop的是，它修改列表，但不返回任何值。</span></span><br></pre></td></tr></table></figure>
<h5 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># reverse() -&gt; None</span></span><br><span class="line"><span class="comment"># 将列表元素反转，返回None</span></span><br><span class="line"><span class="comment"># 就地修改</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.reverse()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"><span class="comment"># reverse按相反的顺序排列列表中的元素。但不返回任何值(与remove和sort等方法一样) 。</span></span><br><span class="line"><span class="comment"># 如果要按相反的顺序迭代序列，可使用函数reversed 。这个函数不返回列表，而是返回一个迭代器 。你可使用list将返回的对象转换为列表。如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>list(reversed(x))</span><br><span class="line">[<span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<h5 id="sort"><a href="#sort" class="headerlink" title="sort"></a>sort</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sort(key=None,reverse=False) -&gt; None</span></span><br><span class="line"><span class="comment"># 对列表元素进行排序，就地修改，默认升序</span></span><br><span class="line"><span class="comment"># reverse为True，反转，降序</span></span><br><span class="line"><span class="comment"># key一个函数，指定key如何排序</span></span><br><span class="line"><span class="comment"># lst.sort(key=functionname)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.sort()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="comment"># sort是修改列表而不返回任何值的方法，sort用于对列表就地排序。就地排序意味着对原来的列表进行修改，使其元素按顺序排列，而不是返回排序后的列表的副本。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = x.sort() <span class="comment"># Don't do this!</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(y)</span><br><span class="line"><span class="keyword">None</span></span><br><span class="line"><span class="comment"># 这种方法是错误的，sort修改x后是不返回任何值的，最终的结果是，x是经过排序的，而y包含 None。正确做法如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = x.copy()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y.sort()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="comment"># 只是将x赋给y是不可行的，因为这样x和y将指向同一个列表。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = sorted(x)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="comment"># sorted函数可用于任何可迭代的对象，但总是返回一个列表。如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sorted(<span class="string">'Python'</span>)</span><br><span class="line">[<span class="string">'P'</span>, <span class="string">'h'</span>, <span class="string">'n'</span>, <span class="string">'o'</span>, <span class="string">'t'</span>, <span class="string">'y'</span>]</span><br></pre></td></tr></table></figure>
<h5 id="高级排序"><a href="#高级排序" class="headerlink" title="高级排序"></a>高级排序</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="string">'aardvark'</span>, <span class="string">'abalone'</span>, <span class="string">'acme'</span>, <span class="string">'add'</span>, <span class="string">'aerate'</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.sort(key=len)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="string">'add'</span>, <span class="string">'acme'</span>, <span class="string">'aerate'</span>, <span class="string">'abalone'</span>, <span class="string">'aardvark'</span>]</span><br><span class="line"><span class="comment"># 方法sort接受两个可选参数：key 和reverse。这两个参数通常是按名称指定的，称为关键字参数，参数 key类似于参数cmp：你将其设置为一个用于排序的函数。然而，不会直接使用这个函数来判断一个元素是否比另一个元素小，而是使用它来为每个元素创建一个键，再根据这些键对元素进行排序。因此，要根据长度对元素进行排序，可将参数 key 设置为函数len。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = [<span class="number">4</span>, <span class="number">6</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x.sort(reverse=<span class="keyword">True</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x</span><br><span class="line">[<span class="number">9</span>, <span class="number">7</span>, <span class="number">6</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"><span class="comment"># 对于另一个关键字参数reverse，只需将其指定为一个真值（True或False），以指出是否要按相反的顺序对列表进行排序。</span></span><br><span class="line"><span class="comment"># 函数sorted也接受参数key和reverse。在很多情况下，将参数key设置为一个自定义函数很有用。</span></span><br></pre></td></tr></table></figure>
<h5 id="时间复杂度"><a href="#时间复杂度" class="headerlink" title="时间复杂度"></a>时间复杂度</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index和count方法都是O(n)。随着列表数据规模的增大，而效率下降</span><br></pre></td></tr></table></figure>
<h5 id="如何查帮助"><a href="#如何查帮助" class="headerlink" title="如何查帮助"></a>如何查帮助</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 官方帮助文档，搜索关键字</span></span><br><span class="line"><span class="comment"># IPython中</span></span><br><span class="line">help(keyword)</span><br><span class="line"><span class="comment"># keyword可以是变量、对象、类名、函数名、方法名</span></span><br></pre></td></tr></table></figure>
<h3 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h3><blockquote>
<p>与列表一样，元组也是序列，唯一的差别在于元组是不能修改的。元组语法很简单，只要将一些值用逗号分隔，就能自动创建一个元组。元组就是一个有序的元素组成的集合，使用小括号()表示。元组是不可变对象。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># index(value,[start,[stop]])</span></span><br><span class="line">	<span class="comment"># 通过值value,从指定区间查找列表内的元素是否匹配</span></span><br><span class="line">	<span class="comment"># 匹配第一个就立即返回索引</span></span><br><span class="line">	<span class="comment"># 匹配不到,抛出异常ValueError</span></span><br><span class="line"><span class="comment"># count(value)</span></span><br><span class="line">	<span class="comment"># 返回列表中匹配value的次数</span></span><br><span class="line"><span class="comment"># 时间复杂度</span></span><br><span class="line">	<span class="comment"># index和count方法都是O(n)</span></span><br><span class="line">	<span class="comment"># 随着列表数据规模的增大,而效率下降</span></span><br><span class="line"><span class="comment"># len(tuple)</span></span><br><span class="line">	<span class="comment"># 返回元素的个数</span></span><br><span class="line"><span class="comment"># 元组是只读的,所以增、改、删方法都没有</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># 元组还可用圆括号括起(这也是通常采用的做法) 。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>()</span><br><span class="line">()</span><br><span class="line"><span class="comment"># 空元组用两个不包含任何内容的圆括号表示。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">42</span></span><br><span class="line"><span class="number">42</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">42</span>,</span><br><span class="line">(<span class="number">42</span>,)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="number">42</span>,)</span><br><span class="line">(<span class="number">42</span>,)</span><br><span class="line"><span class="comment"># 表示一个值的元组也必须在它后面加上逗号。最后两个示例创建的元组长度为1，而第一个示例根本没有创建元组。逗号至关重要，仅将值用圆括号括起不管用：(42)与 42完全等效。但仅仅加上一个逗号，就能完全改变表达式的值。如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">3</span> * (<span class="number">40</span> + <span class="number">2</span>)</span><br><span class="line"><span class="number">126</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">3</span> * (<span class="number">40</span> + <span class="number">2</span>,)</span><br><span class="line">(<span class="number">42</span>, <span class="number">42</span>, <span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tuple([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tuple(<span class="string">'abc'</span>)</span><br><span class="line">(<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>tuple((<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="comment"># 函数tuple的工作原理与list很像：它将一个序列作为参数，并将其转换为元组。如果参数已经是元组，就原封不动地返回它。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">1</span>]</span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment"># 元组的切片也是元组,就像列表的切片也是列表一样。为何要熟悉元组呢?原因有以下两个。</span></span><br><span class="line"><span class="comment"># 1. 它们用作映射中的键(以及集合的成员)，而列表不行。</span></span><br><span class="line"><span class="comment"># 2. 有些内置函数和方法返回元组，这意味着必须跟它们打交道。只要不尝试修改元组，与元组“打交道”通常意味着像处理列表一样处理它们(需要使用元组没有的index和count等方法时例外)。</span></span><br><span class="line"><span class="comment"># 一般而言，使用列表足以满足对序列的需求。</span></span><br></pre></td></tr></table></figure>
<h4 id="命名元组namedtuple"><a href="#命名元组namedtuple" class="headerlink" title="命名元组namedtuple"></a>命名元组namedtuple</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 帮助文档中，查阅namedtuple，有使用教程</span></span><br><span class="line"><span class="comment"># 语法：</span></span><br><span class="line">	<span class="comment"># namedtuple(typename,field_names,verbose=False,rename=False)</span></span><br><span class="line">    <span class="comment"># 命名元组，返回一个元组的子类，并定义了字段</span></span><br><span class="line">    <span class="comment"># typename表示此元组的名称</span></span><br><span class="line">    <span class="comment"># field_names表示元组中元素的名称，此字段有多种表达方式，可以是空白符或逗号分隔的字段的字符串，可以是字段的列表</span></span><br><span class="line">    <span class="comment"># rename表示如果元素名称中含有python的关键字，则必须设置为rename=True</span></span><br><span class="line">    <span class="comment"># verbose使用默认就可以。</span></span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line">Point = namedtuple(<span class="string">'_Point'</span>,[<span class="string">'x'</span>,<span class="string">'y'</span>])</span><br><span class="line"><span class="comment"># Point为返回的类</span></span><br><span class="line">p = Point(<span class="number">11</span>,<span class="number">22</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>Student = namedtuple(<span class="string">'Student'</span>, [<span class="string">'name'</span>, <span class="string">'age'</span>, <span class="string">'sex'</span>, <span class="string">'email'</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = Student(<span class="string">'Jim'</span>, <span class="number">21</span>, <span class="string">'male'</span>, <span class="string">'123@qq.com'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.name</span><br><span class="line"><span class="string">'Jim'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.age</span><br><span class="line"><span class="number">21</span></span><br><span class="line"><span class="comment"># namedtuple 函数这里接收两个参数，第一个参数为要创建类型的名称，第二个参数是一个列表，代表了每一个</span></span><br><span class="line"><span class="comment"># 索引的名字。当建立完这个 Student 类之后，就可以使用正常的构造方法来构造新的对象如 s，并且可以直接</span></span><br><span class="line"><span class="comment"># 通过访问属性的方式来访问所需要的值。</span></span><br><span class="line"><span class="comment"># 此时使用isinstance函数对比内置的tuple：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(s, tuple)</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="comment"># 可见用namedtuple构造出来的类其本质就是一个tuple元组，所以仍然可以使用下标的方式来访问属性。并且在</span></span><br><span class="line"><span class="comment"># 任何要求类型为元组的地方都可以使用这个namedtuple。</span></span><br></pre></td></tr></table></figure>
<h4 id="冒泡法"><a href="#冒泡法" class="headerlink" title="冒泡法"></a>冒泡法</h4><ul>
<li><p>属于交换排序</p>
</li>
<li><p>两两比较大小，交换位置。如同水泡咕嘟咕嘟往上冒</p>
</li>
<li>结果分为升序和降序排列</li>
<li>升序<ul>
<li>n个数从左至右，编号从0开始到n-1，索引0和1的值比较，如果索引0大，则交换两者位置，如果索引1大，则不交换。继续比较索引1和2的值，将大值放在右侧。直至n-2和n-1比较完，第一轮比较完成。第二轮从索引0比较到n-2，因为最右侧n-1位置上已经是最大值了。依次类推，每一轮都会减少最右侧的不参与比较的数，直至剩下最后2个数比较。</li>
</ul>
</li>
<li><p>降序</p>
<ul>
<li>和升序相反</li>
</ul>
</li>
<li><p>图示</p>
</li>
</ul>
<p><img src="/images/python冒泡法/冒泡法1.png" alt=""></p>
<p><img src="/images/python冒泡法/冒泡法2.png" alt=""></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 冒泡法代码实现一，简单冒泡实现</span></span><br><span class="line">num_list = [[<span class="number">1</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]]</span><br><span class="line"><span class="comment"># 定义一个列表，这个列表中还有两个子列表</span></span><br><span class="line">nums = num_list[<span class="number">1</span>]</span><br><span class="line"><span class="comment"># 定义nums等于第2个子列表</span></span><br><span class="line">print(nums)</span><br><span class="line"><span class="comment"># 先打印一次nums列表</span></span><br><span class="line">length = len(nums)</span><br><span class="line"><span class="comment"># 计算nums列表的长度</span></span><br><span class="line">count_swap = <span class="number">0</span></span><br><span class="line"><span class="comment"># 交换</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="comment"># 统计次数</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line"><span class="comment"># 用length也就是列表长度来循环，length是一共要比较的次数，也就是要用每个数字与所有的数字比较一次，所有数字比较一遍的次数。i表示第几个数字</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(length-i<span class="number">-1</span>):</span><br><span class="line"><span class="comment"># 这里j是长度减去之前比较的次数后，还要比较的次数。也就是每次每个数字要与列表中数字比较的次数，如第一次从第一个数字比较到最后一个数字，</span></span><br><span class="line"><span class="comment"># 那么，第二次比较时就从第一个数字比较到倒数第二个数字了，因为第一次已经将最大的数字放到最后了。最后减1是因为i是从0开始的，所以要多减1.</span></span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line"><span class="comment"># 计算比较的次数</span></span><br><span class="line">        <span class="keyword">if</span> nums[j] &gt; nums[j+<span class="number">1</span>]:</span><br><span class="line"><span class="comment"># 按循环每次比较，nums列表中的第j个元素是否与j+1个元素大，也就是前面的数字与后面的数字比较，如第一次是第1个和第2个数字比较，下一次就是第2个和第3个比较</span></span><br><span class="line">            tmp = nums[j]</span><br><span class="line"><span class="comment"># 如果前面的数字大，就将数字给tmp</span></span><br><span class="line">            nums[j] = nums[j+<span class="number">1</span>]</span><br><span class="line"><span class="comment"># 之后将前面的数字向后移</span></span><br><span class="line">            nums[j+<span class="number">1</span>] = tmp</span><br><span class="line"><span class="comment"># 再把后面的数字放在临时空间中</span></span><br><span class="line">            count_swap += <span class="number">1</span></span><br><span class="line"><span class="comment"># 记录一次交换</span></span><br><span class="line">print(nums, count_swap, count)</span><br><span class="line"><span class="comment"># 打印列表，交换次数，比较次数</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 冒泡法代码实现二，优化实现</span></span><br><span class="line">num_list = [[<span class="number">1</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">8</span>]]</span><br><span class="line">nums = num_list[<span class="number">2</span>]</span><br><span class="line">print(nums)</span><br><span class="line">length = len(nums)</span><br><span class="line">count_swap = <span class="number">0</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line">    flag = <span class="keyword">False</span></span><br><span class="line"><span class="comment"># 每次每个数比较之前都加一个标记</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(length-i<span class="number">-1</span>):</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> nums[j] &gt; nums[j+<span class="number">1</span>]:</span><br><span class="line">            tmp = nums[j]</span><br><span class="line">            nums[j] = nums[j+<span class="number">1</span>]</span><br><span class="line">            nums[j+<span class="number">1</span>] = tmp</span><br><span class="line">            flag = <span class="keyword">True</span></span><br><span class="line">            <span class="comment"># 如果前面的数字比后面的大，进行了交换，就将flag改为True</span></span><br><span class="line">            count_swap += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> flag:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># 当flag为False时，证明没有交换，也就证明没必要再进行之后的动作，顺序已经排好了。</span></span><br><span class="line">print(nums, count_swap, count)</span><br></pre></td></tr></table></figure>
<ul>
<li>冒泡法总结<ul>
<li>冒泡法需要数据一轮轮比较</li>
<li>可以设定一个标记判断此轮是否有数据交换发生，如果没有发生交换，可以结束排序，如果发生交换，继续下一轮排序</li>
<li>最差的排序情况是，初始顺序与目标顺序完全相反，遍历次数1,…,n-1之和n(n/1)/2</li>
<li>最好的排序情况是，初始顺序与目标顺序完全相同，遍历次数n-1</li>
<li>时间复杂度O(n**2)</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/20/python基础学习-基础知识/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/20/python基础学习-基础知识/" itemprop="url">
                  python基础学习-基础知识
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-20 09:04:26" itemprop="dateCreated datePublished" datetime="2019-03-20T09:04:26+08:00">2019-03-20</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-03-26 16:33:01" itemprop="dateModified" datetime="2019-03-26T16:33:01+08:00">2019-03-26</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><h4 id="算法"><a href="#算法" class="headerlink" title="算法"></a>算法</h4><blockquote>
<p>算法是流程或菜谱的时髦说法，详尽地描述了如何完成某项任务。算法由对象（原料）和语句（操作说明）组成。从本质上说，编写计算机程序就是使用计算机能够理解的语言(如Python)描述一种算法。这种对机器友好的描述被称为程序，主要由表达式和语句组成。</p>
</blockquote>
<h4 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h4><blockquote>
<p>表达式为程序的一部分，结果为一个值。例如：2 + 2就是一个表达式，结果为4 。简单表达式是使用运算符(如+或% )和函数(如pow)将字面值(如2或”Hello” )组合起来得到的。通过组合简单的表达式，可创建复杂的表达式，如(2 + 2) *(3 - 1)。表达式还可能包含变量。</p>
<p>圆整，是科技术语，通常理解为因满足某种要求而进行的数据修正。按照修正后的数据在数值上是否比原数据大，又可分为向上圆整和向下圆整。</p>
<p>整除符号：//，当结果为整数时向下圆整，如：10 // 3。如果余数为0，就不会向下圆整了，如：9 // 3。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">10</span> % <span class="number">3</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">10</span> % <span class="number">-3</span></span><br><span class="line"><span class="number">-2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">-10</span> % <span class="number">3</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">-10</span> % <span class="number">-3</span></span><br><span class="line"><span class="number">-1</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">10</span> // <span class="number">3</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">10</span> // <span class="number">-3</span></span><br><span class="line"><span class="number">-4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">-10</span> // <span class="number">3</span></span><br><span class="line"><span class="number">-4</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">-10</span> // <span class="number">-3</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="comment"># 对于整数运算，结果是向下圆整的。在结果是负数时，圆整后将离0更远。</span></span><br></pre></td></tr></table></figure>
<h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><blockquote>
<p>变量是表示值的名称。通过赋值,可将新值赋给变量,如x = 2。赋值是一种语句。</p>
<p>使用python变量前必须给它赋值，因此python变量没有默认值。在python中，名称（标识符）只能由字母、数字和下划线(_)构成，且不能以数字开头。最好也不要以下划线开头。</p>
</blockquote>
<h4 id="语句"><a href="#语句" class="headerlink" title="语句"></a>语句</h4><blockquote>
<p>语句是让计算机执行特定操作的指示。这种操作可能是修改变量(通过赋值) 、将信息打印到屏幕上(如print(“Hello, world!”))、导入模块或执行众多其他任务。</p>
<p>表达式是一些东西，而语句是一些事情。上面介绍的都是表达式。如表达式：2 <em> 2，语句：print(2 </em> 2)</p>
<p>语句的特征是执行修改操作。赋值语句可以改变变量，print语句改变屏幕的外观。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = input(<span class="string">"x: "</span>)</span><br><span class="line">x: <span class="number">34</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = input(<span class="string">"y: "</span>)</span><br><span class="line">y: <span class="number">42</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(int(x) * int(y))</span><br><span class="line"><span class="number">1428</span></span><br><span class="line"><span class="comment"># int可以将字符串转换为整数。</span></span><br></pre></td></tr></table></figure>
<h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><blockquote>
<p>Python函数类似于数学函数，它们可以接受参数，并返回结果。函数犹如小型程序，可用来执行特定的操作。通常将标准函数称为内置函数。使用函数称为调用函数，可以向函数提供实参，之后函数返回一个值。因为函数调用返回一个值，因此它们也是表达式。可以结合使用函数调用和运算符来编写更复杂的表达式。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">2</span> ** <span class="number">3</span></span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pow(<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="comment"># pow函数是计算幂运算的。</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">10</span> + pow(<span class="number">2</span>,<span class="number">3</span>*<span class="number">5</span>) / <span class="number">3.0</span></span><br><span class="line"><span class="number">10932.6666666</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>abs(<span class="number">-10</span>)</span><br><span class="line"><span class="comment"># abs函数计算绝对值</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>round(<span class="number">2</span> / <span class="number">3</span>)</span><br><span class="line"><span class="comment"># round将浮点数圆整为与之最接近的整数。</span></span><br><span class="line"><span class="comment"># 整数总是向下圆整，而round圆整到最接近的整数，并在两个整数一样近时圆整到偶数。</span></span><br></pre></td></tr></table></figure>
<h4 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h4><blockquote>
<p>模块是扩展，可通过导入它们来扩展Python的功能。例如：模块math包含多个很有用的函数。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>math.floor(<span class="number">32.9</span>)</span><br><span class="line"><span class="number">32</span></span><br><span class="line"><span class="comment"># 使用import导入模块，再以module.function的方式使用模块中的函数。floor函数与上面的round函数相反，可以将浮点数向下圆整</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>math.ceil(<span class="number">32.3</span>)</span><br><span class="line"><span class="number">33</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>math.ceil(<span class="number">32</span>)</span><br><span class="line"><span class="number">32</span></span><br><span class="line"><span class="comment"># ceil与floor相反，返回大于或等于给定数的最小整数。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sqrt(<span class="number">9</span>)</span><br><span class="line"><span class="number">3.0</span></span><br><span class="line"><span class="comment"># sqrt函数用于计算平方根。如果确定不会从不同模块导入多个同名函数，可使用from math import function的方法调用函数，之后就不用再指定模块前缀了。一般还是不使用此种方法，容易出现无法使用常规函数的问题</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> math</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo = math.sqrt</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>foo(<span class="number">4</span>)</span><br><span class="line"><span class="comment"># 可以将函数赋值给变量，之后变量就有了函数的功能</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> math <span class="keyword">import</span> sqrt</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sqrt(<span class="number">-1</span>)</span><br><span class="line">nan</span><br><span class="line"><span class="comment"># nan具有特殊含义，指的是"非数值"(not a number)。</span></span><br><span class="line"><span class="comment"># 如果将值域限定为实数，并使用其近似的浮点数实现，就无法计算负数的平方根。负数的平方根是虚数，而由实部和虚部组成的数为复数</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> cmath</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>cmath.sqrt(<span class="number">-1</span>)</span><br><span class="line"><span class="number">1j</span></span><br><span class="line"><span class="comment"># 1j是个虚数，虚数都以j（或J）结尾。复数算术运算都基于如下定义：-1的平方根为1j。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>(<span class="number">1</span> + <span class="number">3j</span>) * (<span class="number">9</span> + <span class="number">4j</span>)</span><br><span class="line">(<span class="number">-3</span> + <span class="number">31j</span>)</span><br><span class="line"><span class="comment"># python提供了对复数的支持。</span></span><br><span class="line"><span class="comment"># python没有专门表示虚数的类型，而将虚数视为实部为零的复数。</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h4><blockquote>
<p>字符串的主要用途是表示一段文本。在Python 3中，所有的字符串都是Unicode字符串。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"Let's go!"</span></span><br><span class="line"><span class="string">"Let's go!"</span></span><br><span class="line"><span class="comment"># 这里用了一个单引号，因此不能用单引号再将整个字符串括起，否则解释器将报错。如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">'Let'</span>s go!<span class="string">'</span></span><br><span class="line"><span class="string">SyntaxError: invalid syntax</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt;&gt;&gt; '</span><span class="string">"Hello, world!"</span> she said<span class="string">'</span></span><br><span class="line"><span class="string">'</span><span class="string">"Hello, world!"</span> she said<span class="string">'</span></span><br><span class="line"><span class="string"># 因为字符串包含双引号，因此必须使用单引号将整个字符串括起</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt;&gt;&gt; '</span>Let\<span class="string">'s go!'</span></span><br><span class="line"><span class="string">"Let's go!"</span></span><br><span class="line"><span class="comment"># 可使用反斜杠( \ )对引号进行转义</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"\"Hello, world!\" she said"</span></span><br><span class="line"><span class="string">'"Hello, world!" she said'</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"Let's say "</span> <span class="string">'"Hello, world!"'</span></span><br><span class="line"><span class="string">'Let\'s say "Hello, world!"'</span></span><br><span class="line"><span class="comment"># Python可以自动将字符串拼接起来</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">"Hello, "</span> + <span class="string">"world!"</span></span><br><span class="line"><span class="string">'Hello, world!'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x = <span class="string">"Hello, "</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>y = <span class="string">"world!"</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>x + y</span><br><span class="line"><span class="string">'Hello, world!'</span></span><br><span class="line"><span class="comment"># 拼接字符串的方法</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">'''This is a very long string. It continues here.</span></span><br><span class="line"><span class="string">And it's not over yet. "Hello, world!"</span></span><br><span class="line"><span class="string">Still here.'''</span>)</span><br><span class="line"><span class="comment"># 表示长字符串时可以使用三个单引号或三个双引号，这让解释器能够识别表示字符串开始和结束位置的引号，因此字符串本身可包含单引号和双引号，无需使用反斜杠进行转义。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1</span> + <span class="number">2</span> + \</span><br><span class="line"><span class="number">4</span> + <span class="number">5</span></span><br><span class="line"><span class="number">12</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">print</span> \</span><br><span class="line">(<span class="string">'Hello, world'</span>)</span><br><span class="line">Hello, world</span><br><span class="line"><span class="comment"># 常规字符串也可横跨多行。只要在行尾加上反斜杠,反斜杠和换行符将被转义,即被忽略。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">r'C:\nowhere'</span>)</span><br><span class="line">C:\nowhere</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">r'C:\Program Files\fnord\foo\bar\baz\frozz\bozz'</span>)</span><br><span class="line">C:\Program Files\fnord\foo\bar\baz\frozz\bozz</span><br><span class="line"><span class="comment"># 原始字符串用前缀r表示。看起来可在原始字符串中包含任何字符，这大致是正确的。一个例外是，引号需要像通常那样进行转义，但这意味着用于执行转义的反斜杠也将包含在最终的字符串中。如下：</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>print(<span class="string">r'Let\'s go!'</span>)</span><br><span class="line">Let\<span class="string">'s go!</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&gt;&gt;&gt; print(r"This is illegal\")</span></span><br><span class="line"><span class="string">SyntaxError: EOL while scanning string literal</span></span><br><span class="line"><span class="string"># 原始字符串不能以单个反斜杠结尾。除非你对其进行转义(但进行转义时,用于转义的反斜杠也将是字符串的一部分) 。</span></span><br><span class="line"><span class="string">&gt;&gt;&gt; print(r'</span>C:\Program Files\foo\ba<span class="string">r' '</span>\\<span class="string">')</span></span><br><span class="line"><span class="string">C:\Program Files\foo\bar\</span></span><br><span class="line"><span class="string"># 可以将反斜杠单独作为一个字符串</span></span><br></pre></td></tr></table></figure>
<h4 id="函数表"><a href="#函数表" class="headerlink" title="函数表"></a>函数表</h4><table>
<thead>
<tr>
<th style="text-align:left">函数</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">abs(number)</td>
<td style="text-align:left">返回指定数的绝对值</td>
</tr>
<tr>
<td style="text-align:left">bytes(string, encoding[, errors])</td>
<td style="text-align:left">对指定的字符串进行编码，并以指定的方式处理错误</td>
</tr>
<tr>
<td style="text-align:left">cmath.sqrt(number)</td>
<td style="text-align:left">返回平方根；可用于负数</td>
</tr>
<tr>
<td style="text-align:left">float(object)</td>
<td style="text-align:left">将数字转换为浮点数</td>
</tr>
<tr>
<td style="text-align:left">help([object])</td>
<td style="text-align:left">提供交互式帮助</td>
</tr>
<tr>
<td style="text-align:left">input(prompt)</td>
<td style="text-align:left">以字符串的方式获取用户输入</td>
</tr>
<tr>
<td style="text-align:left">int(object)</td>
<td style="text-align:left">将字符串或数转换为整数</td>
</tr>
<tr>
<td style="text-align:left">math.ceil(number)</td>
<td style="text-align:left">以浮点数的方式返回向上圆整的结果</td>
</tr>
<tr>
<td style="text-align:left">math.floor(number)</td>
<td style="text-align:left">以浮点数的方式返回向下圆整的结果</td>
</tr>
<tr>
<td style="text-align:left">math.sqrt(number)</td>
<td style="text-align:left">返回平方根；不能用于负数</td>
</tr>
<tr>
<td style="text-align:left">pow(x, y[, z])</td>
<td style="text-align:left">返回x的y次方对z求模的结果</td>
</tr>
<tr>
<td style="text-align:left">print(object, …)</td>
<td style="text-align:left">将提供的实参打印出来,并用空格分隔</td>
</tr>
<tr>
<td style="text-align:left">repr(object)</td>
<td style="text-align:left">返回指定值的字符串表示</td>
</tr>
<tr>
<td style="text-align:left">round(number[, ndigits])</td>
<td style="text-align:left">四舍五入为指定的精度，正好为5时舍入到偶数</td>
</tr>
<tr>
<td style="text-align:left">str(object)</td>
<td style="text-align:left">将指定的值转换为字符串。用于转换 bytes 时，可指定编码和错误处理方式</td>
</tr>
<tr>
<td style="text-align:left">len(seq)</td>
<td style="text-align:left">返回序列的长度</td>
</tr>
<tr>
<td style="text-align:left">list(seq)</td>
<td style="text-align:left">将序列转换为列表</td>
</tr>
<tr>
<td style="text-align:left">max(args)</td>
<td style="text-align:left">返回序列或一组参数中的最大值</td>
</tr>
<tr>
<td style="text-align:left">min(args)</td>
<td style="text-align:left">返回序列和一组参数中的最小值</td>
</tr>
<tr>
<td style="text-align:left">reversed(seq)</td>
<td style="text-align:left">让你能够反向迭代序列</td>
</tr>
<tr>
<td style="text-align:left">sorted(seq)</td>
<td style="text-align:left">返回一个有序列表，其中包含指定序列中的所有元素</td>
</tr>
<tr>
<td style="text-align:left">tuple(seq)</td>
<td style="text-align:left">将序列转换为元组</td>
</tr>
<tr>
<td style="text-align:left">string.capwords(s[, sep])</td>
<td style="text-align:left">使用split 根据sep拆分s，将每项的首字母大写，再以空格为分隔符将它们合并起来</td>
</tr>
<tr>
<td style="text-align:left">ascii(obj)</td>
<td style="text-align:left">创建指定对象的ASCII表示</td>
</tr>
<tr>
<td style="text-align:left">dict(seq)</td>
<td style="text-align:left">从键值对、映射或关键字参数创建字典</td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/17/搭建个人博客github-pages/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/17/搭建个人博客github-pages/" itemprop="url">
                  搭建个人博客github-pages
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-17 22:03:29" itemprop="dateCreated datePublished" datetime="2019-03-17T22:03:29+08:00">2019-03-17</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-10-25 15:31:38" itemprop="dateModified" datetime="2019-10-25T15:31:38+08:00">2019-10-25</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/hexo/" itemprop="url" rel="index"><span itemprop="name">hexo</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="下载软件"><a href="#下载软件" class="headerlink" title="下载软件"></a>下载软件</h1><ol>
<li>下载安装Node.js，官网地址：<a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">https://nodejs.org/en/download/</a></li>
<li>下载安装git，官网地址：<a href="https://git-scm.com/download/win" target="_blank" rel="noopener">https://git-scm.com/download/win</a></li>
<li>下载安装githubDesktop，官网地址：<a href="https://desktop.github.com/" target="_blank" rel="noopener">https://desktop.github.com/</a></li>
</ol>
<p>注：实际git与githubDesktop安装一个就可以，只是不习惯使用命令行的人使用githubDesktop更方便。</p>
<h1 id="注册github"><a href="#注册github" class="headerlink" title="注册github"></a>注册github</h1><p>官方地址：<a href="https://github.com/" target="_blank" rel="noopener">https://github.com/</a></p>
<p>注册后登录，创建一个自己的github pages项目，项目名称一般与自己的登录名一致。</p>
<h1 id="Hexo"><a href="#Hexo" class="headerlink" title="Hexo"></a>Hexo</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">在本地创建一个Hexo目录，并进入目录，右键选择Git Bash Here</span><br><span class="line">npm install hexo-cli -g</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">hexo init</span><br><span class="line">hexo generate</span><br><span class="line">hexo server</span><br><span class="line">访问localhost:4000</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在执行hexo命令时提示：</span></span><br><span class="line">internal/modules/cjs/loader.js:596</span><br><span class="line">    throw err;</span><br><span class="line">    ^</span><br><span class="line"></span><br><span class="line">Error: Cannot find module 'D:\Git\node_modules\hexo-cli\bin\hexo'</span><br><span class="line">之后在C:\Users\r\AppData\Roaming\npm中找到node_modules，将其复制到D:\Git下后，可以正常使用hexo命令</span><br></pre></td></tr></table></figure>
<h2 id="配置SSH密钥"><a href="#配置SSH密钥" class="headerlink" title="配置SSH密钥"></a>配置SSH密钥</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C "your_email@example.com"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这将按照你提供的邮箱地址，创建一对密钥。一直回车就可以完成</span></span><br><span class="line">cat ~/.ssh/id_rsa.pub</span><br><span class="line">复制公钥，将公钥放到github页面中的Settings中的SSH and GPG keys中</span><br><span class="line">ssh -T git@github.com</span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试密钥是否生效，如果生效会有向用户打招呼的提示</span></span><br></pre></td></tr></table></figure>
<h2 id="设置用户信息"><a href="#设置用户信息" class="headerlink" title="设置用户信息"></a>设置用户信息</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.name "ryanlijianchang"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 用户名</span></span><br><span class="line">git config --global user.email  "liji.anchang@163.com"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 填写自己的邮箱</span></span><br></pre></td></tr></table></figure>
<h2 id="将本地的Hexo文件更新到Github的库中"><a href="#将本地的Hexo文件更新到Github的库中" class="headerlink" title="将本地的Hexo文件更新到Github的库中"></a>将本地的Hexo文件更新到Github的库中</h2><ol>
<li>登录github</li>
<li>打开自己的项目</li>
<li>点击Clone or download，选择SSH，并复制地址</li>
<li>打开本地创建的Hexo目录，打开_config.yml文件</li>
<li><p>在配置文件中修改</p>
</li>
<li><p>执行命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo g -d</span><br><span class="line"><span class="meta">#</span><span class="bash"> 完成远程部署，如果有报错 ERROR Deployer not found: git，可以删除node_modules目录，再重新执行下面的命令</span></span><br><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
</li>
<li><p>访问name.github.io</p>
</li>
</ol>
<h1 id="美化自己博客"><a href="#美化自己博客" class="headerlink" title="美化自己博客"></a>美化自己博客</h1><h2 id="安装主题"><a href="#安装主题" class="headerlink" title="安装主题"></a>安装主题</h2><ol>
<li>进入<a href="https://hexo.io/themes/" target="_blank" rel="noopener">https://hexo.io/themes/</a></li>
<li>选择自己喜欢的主题，并打开，打开后是一个github的页面，复制git地址</li>
<li>到本地Hexo目录中的themes右键选择Git Hash Here</li>
<li><p>克隆主题到本地<figure class="highlight plain"><figcaption><span>clone</span><a href="https://github.com/iissnan/hexo-theme-next```" target="_blank" rel="noopener">link</a></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">5. 修改Hexo配置文件，将_config.yml文件中的theme后的参数改为自己下载的主题的名字</span><br><span class="line">6. 部署主题，本地查看。</span><br><span class="line"></span><br><span class="line">```shell</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br><span class="line">访问localhost:4000</span><br></pre></td></tr></table></figure></p>
</li>
<li><p>部署到Github上</p>
</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g -d</span><br></pre></td></tr></table></figure>
<h2 id="主题设定"><a href="#主题设定" class="headerlink" title="主题设定"></a>主题设定</h2><ol>
<li>打开主题配置文件</li>
</ol>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:<span class="symbol">\G</span>itHub<span class="symbol">\r</span>uopu89.github.io<span class="symbol">\t</span>hemes<span class="symbol">\h</span>exo-theme-next<span class="symbol">\_</span>config.yml</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>设置</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Schemes</span></span><br><span class="line"><span class="meta">#</span><span class="bash">scheme: Muse</span></span><br><span class="line"><span class="meta">#</span><span class="bash">scheme: Mist</span></span><br><span class="line"><span class="meta">#</span><span class="bash">scheme: Pisces</span></span><br><span class="line">scheme: Gemini</span><br><span class="line"><span class="meta">#</span><span class="bash"> 现在有四种风格，使用哪个就去掉其前面的注释</span></span><br></pre></td></tr></table></figure>
<h2 id="设置语言"><a href="#设置语言" class="headerlink" title="设置语言"></a>设置语言</h2><ol>
<li>打开站点配置文件</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">E:\GitHub\ruopu89.github.io\_config.yml</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意这里一定是在站点配置文件中设置</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>设置</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">language: zh-TW</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在主题配置目录中有一个languages目录，在这里是可以使用的语言的文件。上面设置的语言应该和languages目录中的文件名是一样的。</span></span><br></pre></td></tr></table></figure>
<h2 id="设置菜单"><a href="#设置菜单" class="headerlink" title="设置菜单"></a>设置菜单</h2><ol>
<li>打开主题配置文件</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:\GitHub\ruopu89.github.io\themes\hexo-theme-next\_config.yml</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>设置</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: / || home	//主页</span><br><span class="line"><span class="meta">  #</span><span class="bash">about: /about/ || user	//关于页面</span></span><br><span class="line"><span class="meta">  #</span><span class="bash">tags: /tags/ || tags</span></span><br><span class="line">  tags: /tags || tags	//标签页 </span><br><span class="line">  categories: /categories/ || th	//分类页 </span><br><span class="line">  archives: /archives/ || archive	//归档页</span><br><span class="line"><span class="meta">  #</span><span class="bash">schedule: /schedule/ || calendar</span></span><br><span class="line"><span class="meta">  #</span><span class="bash">sitemap: /sitemap.xml || sitemap</span></span><br><span class="line"><span class="meta">  #</span><span class="bash">commonweal: /404/ || heartbeat	//公益 404</span></span><br><span class="line">//这里最前面的name:表示在页面中显示的内容；后面是路径；最后的|| name表示显示的图标样式。除了主页与归档页外，其他需要手动创建这个页面</span><br></pre></td></tr></table></figure>
<h2 id="设置侧栏"><a href="#设置侧栏" class="headerlink" title="设置侧栏"></a>设置侧栏</h2><blockquote>
<p>默认情况下，侧栏仅在文章页面（拥有目录列表）时才显示，并放置于右侧位置。</p>
</blockquote>
<ol>
<li>打开主题配置文件</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E:\GitHub\ruopu89.github.io\themes\hexo-theme-next\_config.yml</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>设置位置</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sidebar:</span><br><span class="line">  position: left</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以使用的值有left和right</span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>设置侧栏显示的时机</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sidebar:</span><br><span class="line">  display: post</span><br><span class="line">//可选项：</span><br><span class="line">//post - 默认行为，在文章页面（拥有目录列表）时显示</span><br><span class="line">//always - 在所有页面中都显示</span><br><span class="line">//hide - 在所有页面中都隐藏（可以手动展开）</span><br><span class="line">//remove - 完全移除</span><br><span class="line">//已知侧栏在 use motion: false 的情况下不会展示。 影响版本5.0.0及更低版本。</span><br></pre></td></tr></table></figure>
<h2 id="添加标签"><a href="#添加标签" class="headerlink" title="添加标签"></a>添加标签</h2><ol>
<li>新建页面</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在项目目录中右键打开git</span><br><span class="line">hexo new page tags</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在项目目录中的<span class="built_in">source</span>创建一个tags目录，如果没有这个目录，在页面上就没法打开这个标签</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>设置页面类型</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">在新建的tags目录中会自动生成一个叫index的文件，打开它</span><br><span class="line">---</span><br><span class="line">title: 标签</span><br><span class="line">date: 2014-12-22 12:39:04</span><br><span class="line">type: "tags"</span><br><span class="line">---</span><br><span class="line"><span class="meta">#</span><span class="bash"> index文件中的内容如上，添加<span class="built_in">type</span>: <span class="string">"tags"</span></span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>修改菜单</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">修改主题配置文件</span><br><span class="line">menu:</span><br><span class="line">  home: /</span><br><span class="line">  archives: /archives</span><br><span class="line">  tags: /tags</span><br><span class="line"><span class="meta">#</span><span class="bash"> tags一行要取消注释，这样在页面中才能显示tags标签</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>写作</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">在新建文章后，在文章头部会有如下内容</span><br><span class="line">---</span><br><span class="line">hetitle: 搭建个人博客github_pages</span><br><span class="line">date: 2018-08-30 08:32:00</span><br><span class="line">tags: hexo</span><br><span class="line">---</span><br><span class="line"><span class="meta">#</span><span class="bash"> 要指定此文章的tags，这样就可以将文章加入上面创建的tags中了，打开页面时在tags标签中会有一个hexo，在hexo中有我们的文章</span></span><br></pre></td></tr></table></figure>
<h2 id="添加分类页面"><a href="#添加分类页面" class="headerlink" title="添加分类页面"></a>添加分类页面</h2><ol>
<li>新建页面</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在项目目录中右键打开git</span><br><span class="line">hexo new page categories</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在项目目录中的<span class="built_in">source</span>创建一个categories目录，如果没有这个目录，在页面上就没法打开这个标签</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>设置页面类型</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">在新建的tags目录中会自动生成一个叫index的文件，打开它</span><br><span class="line">---</span><br><span class="line">title: 标签</span><br><span class="line">date: 2014-12-22 12:39:04</span><br><span class="line">type: "categories"</span><br><span class="line">---</span><br><span class="line"><span class="meta">#</span><span class="bash"> index文件中的内容如上，添加<span class="built_in">type</span>: <span class="string">"categories"</span></span></span><br></pre></td></tr></table></figure>
<ol start="3">
<li>修改菜单</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">修改主题配置文件</span><br><span class="line">menu:</span><br><span class="line">  home: /</span><br><span class="line">  archives: /archives</span><br><span class="line">  categories: /categories</span><br><span class="line"><span class="meta">#</span><span class="bash"> categories一行要取消注释，这样在页面中才能显示categories标签</span></span><br></pre></td></tr></table></figure>
<ol start="4">
<li>写作</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">在新建文章后，在文章头部会有如下内容</span><br><span class="line">---</span><br><span class="line">hetitle: 搭建个人博客github_pages</span><br><span class="line">date: 2018-08-30 08:32:00</span><br><span class="line">categories: hexo</span><br><span class="line">---</span><br><span class="line"><span class="meta">#</span><span class="bash"> 要指定此文章的tags，这样就可以将文章加入上面创建的tags中了，打开页面时在tags标签中会有一个hexo，在hexo中有我们的文章</span></span><br></pre></td></tr></table></figure>
<h2 id="添加搜索功能"><a href="#添加搜索功能" class="headerlink" title="添加搜索功能"></a>添加搜索功能</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">cd /home/ruopu/文档/Github/ruopu.github.io</span><br><span class="line"><span class="meta">#</span><span class="bash"> 先到博客的根目录</span></span><br><span class="line">npm install hexo-generator-searchdb --save</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装搜索插件</span></span><br><span class="line">vim /home/ruopu/文档/Github/ruopu.github.io/_config.yml</span><br><span class="line">search:</span><br><span class="line">  path: search.xml</span><br><span class="line">  field: post</span><br><span class="line">  format: html</span><br><span class="line">  limit: 10000</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在博客的配置文件中添加上述内容</span></span><br><span class="line">vim /home/ruopu/文档/Github/ruopu.github.io/theme/hexo-next/_config.yml</span><br><span class="line">local_search:</span><br><span class="line">    enable: true</span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置主题的功能，上面内容默认是flase，改为<span class="literal">true</span></span></span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br><span class="line"><span class="meta">#</span><span class="bash"> 上传后就可以看到搜索功能了。</span></span><br></pre></td></tr></table></figure>
<h2 id="添加访客人数统计"><a href="#添加访客人数统计" class="headerlink" title="添加访客人数统计"></a>添加访客人数统计</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/layout/_partials/footer.swig</span><br><span class="line"><span class="meta">#</span><span class="bash"> 打开使用的主题下的这个文件</span></span><br><span class="line">&lt;div class="copyright"&gt;</span><br><span class="line">    ...</span><br><span class="line">    ...</span><br><span class="line">    &lt;script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"&gt;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line"></span><br><span class="line">    &lt;span class="post-meta-divider"&gt;|&lt;/span&gt;</span><br><span class="line">    &lt;span id="busuanzi_container_site_pv"&gt;</span><br><span class="line">        本站总访问量: &lt;span id="busuanzi_value_site_pv"&gt;&lt;/span&gt;次</span><br><span class="line">    &lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在上方的两个div之间配置上面的代码，script是安装不蒜子的统计脚本，下面的本部总访问量是统计的PV量</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> pv：单个用户连续点击n篇文章，记录n次访问量</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> uv：单个用户连续点击n篇文章，只记录1次访客数</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用uv的方法</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> &lt;span id=<span class="string">"busuanzi_container_site_uv"</span>&gt;</span></span><br><span class="line"><span class="meta">#</span><span class="bash">     本站访客数&lt;span id=<span class="string">"busuanzi_value_site_uv"</span>&gt;&lt;/span&gt;人次</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> &lt;/span&gt;</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://hexo-guide.readthedocs.io/zh_CN/latest/third-service/[%E4%B8%8D%E8%92%9C%E5%AD%90]%E8%AE%BF%E5%AE%A2%E4%BA%BA%E6%95%B0.html</span></span><br></pre></td></tr></table></figure>
<h2 id="添加文章阅读量统计"><a href="#添加文章阅读量统计" class="headerlink" title="添加文章阅读量统计"></a>添加文章阅读量统计</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">方法一</span><br><span class="line">vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/_config.yml            </span><br><span class="line">busuanzi_count:</span><br><span class="line">	enable: true    # 这里默认是false，改为true即可。next主题自带了不蒜子的统计功能</span><br><span class="line">	total_visitors: true</span><br><span class="line">	total_visitors_icon: user</span><br><span class="line">	total_views: true</span><br><span class="line">	total_views_icon: eye</span><br><span class="line">	post_views: true</span><br><span class="line">	post_views_icon: eye</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个方法在进入文章后，可以看到阅读次数</span></span><br><span class="line"></span><br><span class="line">方法二</span><br><span class="line">vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/layout/_macro/post.swig</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在&#123;<span class="comment"># LeanCould PageView #&#125;下添加下面内容</span></span></span><br><span class="line">&#123;# LeanCould PageView #&#125;</span><br><span class="line">&lt;span id="busuanzi_container_page_pv"&gt;                                                     &lt;span class="post-meta-divider"&gt;|&lt;/span&gt;</span><br><span class="line">    &lt;span class="post-meta-item-icon"&gt;</span><br><span class="line">    &lt;i class="fa fa-eye"&gt;&lt;/i&gt;</span><br><span class="line">	&lt;/span&gt; </span><br><span class="line">	阅读量: &lt;span id="busuanzi_value_page_pv"&gt;&lt;/span&gt;次</span><br><span class="line">&lt;/span&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个方法在首页就能看到每篇文章的阅读次数</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://hexo-guide.readthedocs.io/zh_CN/latest/third-service/[%E4%B8%8D%E8%92%9C%E5%AD%90]%E6%96%87%E7%AB%A0%E9%98%85%E8%AF%BB%E6%AC%A1%E6%95%B0.html</span></span><br></pre></td></tr></table></figure>
<h2 id="添加文章评论功能"><a href="#添加文章评论功能" class="headerlink" title="添加文章评论功能"></a>添加文章评论功能</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">1. 注册github应用，首先登录github，之后在settings-&gt;Developer settings-&gt;OAuth Apps中注册。注意需要输入四项内容，应用名称是自定义的，主页地址是自己的github页面的地址，但要注意，地址前要加https://，</span><br><span class="line">不然会报错，应用说明是自定义的，授权回调地址与主页地址一样。注册成功后会得到Client ID和Client Secret</span><br><span class="line"></span><br><span class="line">2. vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89</span><br><span class="line">.github.io/themes/hexo-theme-next/layout/_third-party/comments/gitalk.swig</span><br><span class="line">&#123;% if page.comments &amp;&amp; theme.gitalk.enable %&#125;</span><br><span class="line">  &lt;link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css"&gt;</span><br><span class="line">  &lt;script src="https://unpkg.com/gitalk/dist/gitalk.min.js"&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script type="text/javascript"&gt;</span><br><span class="line">        var gitalk = new Gitalk(&#123;</span><br><span class="line">          clientID: '&#123;&#123; theme.gitalk.ClientID &#125;&#125;',</span><br><span class="line">          clientSecret: '&#123;&#123; theme.gitalk.ClientSecret &#125;&#125;',</span><br><span class="line">          repo: '&#123;&#123; theme.gitalk.repo &#125;&#125;',</span><br><span class="line">          owner: '&#123;&#123; theme.gitalk.githubID &#125;&#125;',</span><br><span class="line">          admin: ['&#123;&#123; theme.gitalk.adminUser &#125;&#125;'],</span><br><span class="line">          id: location.pathname,</span><br><span class="line">          distractionFreeMode: '&#123;&#123; theme.gitalk.distractionFreeMode &#125;&#125;'</span><br><span class="line">        &#125;)</span><br><span class="line">        gitalk.render('gitalk-container')           </span><br><span class="line">       &lt;/script&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line">3. vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/layout/_partials/comments.swig</span><br><span class="line">&#123;% elseif theme.gitalk.enable %&#125;</span><br><span class="line"> &lt;div id="gitalk-container"&gt;&lt;/div&gt;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意，添加的内容与前面的elseif同一级别上即可，但不要加在最后，测试时加在了18行左右的位置</span></span><br><span class="line"></span><br><span class="line">4. vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89</span><br><span class="line">.github.io/themes/hexo-theme-next/layout/_third-party/comments/index.swig</span><br><span class="line">&#123;% include 'gitalk.swig' %&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在最后一行添加内容</span></span><br><span class="line"></span><br><span class="line">5. vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/source/css/_common/components/third-party/third-party.styl</span><br><span class="line">@import "gitalk";</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在最后一行上添加内容</span></span><br><span class="line"></span><br><span class="line">6. vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/source/css/_common/components/third-party/gitalk.styl</span><br><span class="line">.gt-header a, .gt-comments a, .gt-popup a</span><br><span class="line">  border-bottom: none;</span><br><span class="line">.gt-container .gt-popup .gt-action.is--active:before</span><br><span class="line">  top: 0.7em;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 新建文件，加入内容</span></span><br><span class="line"></span><br><span class="line">7. vim /media/shouyu/C64CC89B4CC8879F/works/GitHub/ruopu89.github.io/themes/hexo-theme-next/_config.yml                                               </span><br><span class="line"><span class="meta">#</span><span class="bash"> Gitalk                                                                               <span class="comment"># Demo: https://gitalk.github.io</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Reference: https://asdfv1929.github.io/2018/01/20/gitalk/, https://liujunzhou.top/2018/8/10/gitalk-error/</span></span><br><span class="line">gitalk:</span><br><span class="line">	enable: true</span><br><span class="line">	github_id: abc89  # github帐号，不用写邮箱地址</span><br><span class="line">	repo: abc   # 仓库名称</span><br><span class="line">	client_id: # 注册得到的</span><br><span class="line">	client_secret: # 注册得到的</span><br><span class="line">	admin_user: abc89  # github帐号</span><br><span class="line">	distraction_free_mode: true # Facebook-like distraction free mode</span><br><span class="line">	</span><br><span class="line">8. 问题</span><br><span class="line">描述：在文章底部评论框中出现错误信息“Error: Not Found”</span><br><span class="line">解决办法：和repo属性有关，换一个新的仓库，比如新建仓库guestbook。</span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://extremegtr.github.io/2017/09/07/Add-Gitment-comment-system-to-hexo-theme-NexT/<span class="comment">#%E4%BF%AE%E6%94%B9NexT%E4%B8%BB%E9%A2%98%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6</span></span></span><br></pre></td></tr></table></figure>
<h2 id="高亮显示代码"><a href="#高亮显示代码" class="headerlink" title="高亮显示代码"></a>高亮显示代码</h2><ol>
<li>编辑主题配置文件E:\GitHub\ruopu89.github.io\themes\hexo-theme-next_config.yml</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">highlight_theme: night blue</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可选的选择有：normal，night， night blue， night bright， night eighties</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>编辑站点配置文件E:\GitHub\ruopu89.github.io</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">highlight:</span><br><span class="line">  enable: true</span><br><span class="line">  line_number: true</span><br><span class="line">  auto_detect: true</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这里默认是<span class="literal">false</span></span></span><br><span class="line">  tab_replace:</span><br><span class="line"><span class="meta">  #</span><span class="bash"> 设置后，博客中的代码会有高亮显示，但显示的还是有问题。无论是否在代码中加入语言标记。</span></span><br></pre></td></tr></table></figure>
<h2 id="添加图片"><a href="#添加图片" class="headerlink" title="添加图片"></a>添加图片</h2><blockquote>
<p>图片默认被保存在主题目录中的source中的images中，如：E:\GitHub\ruopu89.github.io\themes\hexo-theme-next\source\images，我们可以在这个目录下新建目录，与博客名称相同，所有图片都保存在这里<br>使用图片的网络地址也可上传图片。这种方式的问题应该是，当图片的网络地址失效时，这个图片也就看不到了。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![](https://raw.githubusercontent.com/higoge/image/master/basic01/01.png)</span><br></pre></td></tr></table></figure></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">使用markdown语法添加图片时可以使用下面的语法</span><br><span class="line">&lt;img src="/images/image.jpg"/&gt;</span><br><span class="line">![](/images/images.jpg)</span><br><span class="line"><span class="meta">#</span><span class="bash"> 上面两种方法都可以添加图片，系统会自动到主题目录中的<span class="built_in">source</span>中的images中找图片。问题是，在markdown中是看不到图片的。因为提交后，系统会到images中找图片，所以要用这种格式，斜线也要用/。如果输入在windows中的路径，上传后是找不到图片的，所以也无法显示。</span></span><br></pre></td></tr></table></figure>
<h1 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h1><h3 id="github-Desktop提交时提示“Commit-failed-exit-code-1-received”"><a href="#github-Desktop提交时提示“Commit-failed-exit-code-1-received”" class="headerlink" title="github Desktop提交时提示“Commit failed - exit code 1 received”"></a>github Desktop提交时提示“Commit failed - exit code 1 received”</h3><p>解决：原因是不能提示的目录中也有.git目录，删除.git目录再上传就正常了。</p>
<h3 id="在另一台ubuntu18-04系统上重新部署hexo"><a href="#在另一台ubuntu18-04系统上重新部署hexo" class="headerlink" title="在另一台ubuntu18.04系统上重新部署hexo"></a>在另一台ubuntu18.04系统上重新部署hexo</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">* 安装所需软件包</span><br><span class="line">apt install -y nodejs</span><br><span class="line">apt install -y npm</span><br><span class="line">apt install -y git</span><br><span class="line">npm install hexo-cli -g</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line"><span class="meta">#</span><span class="bash"> 上面安装的nodejs是一个8.10的版本，也可以升级nodejs</span></span><br><span class="line">ssh-keygen -t rsa -C "ruopu1989@hotmail.com"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成密钥</span></span><br><span class="line">cat .ssh/id_rsa.pub</span><br><span class="line"><span class="meta">#</span><span class="bash"> 获取密钥</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这两步在root和普通用户上都做了一遍。之后将得到的密钥复制到github上</span></span><br><span class="line">ssh -T git@github.com</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在两个帐户上都测试一下连接是否成功。如果成功会有下面的提示，测试发现只在root用户下执行成功，在普通用户上执行也可以通过，但提示github不提供shell访问</span></span><br><span class="line">    Hi ruopu89! You've successfully authenticated, but GitHub does not provide shell access.</span><br><span class="line">git config --global user.name "ruopu1989"</span><br><span class="line">git config --global user.email "ruopu1989@hotmail.com"</span><br><span class="line">cd /media/rp/00E219519546E/MyFile/GitHub/rp.github.io</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果这一步报错，可以尝试使用hexo clean撤消hexo g生成的静态文件，再执行hexo g重新生成再部署。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试</span></span><br></pre></td></tr></table></figure>
<h3 id="github个人博客多电脑使用"><a href="#github个人博客多电脑使用" class="headerlink" title="github个人博客多电脑使用"></a>github个人博客多电脑使用</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">apt install nodejs</span><br><span class="line">apt install npm</span><br><span class="line">npm install hexo-cli -g</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">cd /home/GitHub/ruopu.github.io</span><br><span class="line">ssh-keygen -t rsa -C "ruopu19@hotmail.com"</span><br><span class="line"><span class="meta">#</span><span class="bash"> -C后的是一些描述信息</span></span><br><span class="line">cat .ssh/id_rsa.pub</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将密钥复制到github上</span></span><br><span class="line">ssh -T git@github.com</span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试与github连接是否成功</span></span><br><span class="line">git config --global user.name "ruopu1989"</span><br><span class="line">git config --global user.email "ruopu1989@hotmail.com"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 自报家门</span></span><br><span class="line">git init</span><br><span class="line"><span class="meta">#</span><span class="bash"> 给源文件目录初始化git，虽然目录中已有内容，但这也不会报错的</span></span><br><span class="line">git remote add origin https://github.com/abc/abc.github.io.git</span><br><span class="line"><span class="meta">#</span><span class="bash"> 与远程的origin分支关联，最后的地址是github上项目的地址。使用git push时如果提示需要输入用户名和密码，可以删除远程地址，再试。命令：git remote remove origin。另外，这里也可以使用git@github.com:abc/abc.github.io.git地址。</span></span><br><span class="line">git checkout -b source</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建并切换分支，使用-b选择就是为了创建并切换。这与git branch <span class="built_in">source</span> &amp;&amp; git checkout <span class="built_in">source</span>两条命令的执行结果是一样的。</span></span><br><span class="line">git branch</span><br><span class="line"><span class="meta">#</span><span class="bash"> 现在本地只有一个<span class="built_in">source</span>分支，这也就是主分支</span></span><br><span class="line">git add .</span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加所有内容到暂存区</span></span><br><span class="line">git commit -m 'add source'</span><br><span class="line"><span class="meta">#</span><span class="bash"> 提交</span></span><br><span class="line">git push origin source</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将本地的<span class="built_in">source</span>分支推送到远程的origin分支上</span></span><br><span class="line">在github上将source设置为主分支，这样之后clone的就都是这个source分支上的内容了。</span><br><span class="line">** 上传中会有一个问题，就是theme目录中的主题文件上传后可能是灰色的，这是因为获得主题文件时就是从另一个库clone来的，所以主题文件目录中也有.git文件。如果上传了目录，解决方法如下：</span><br><span class="line">1. 将主题文件目录剪切到另一个不相干的目录中</span><br><span class="line">2. git add .</span><br><span class="line">3. git commit -m 'delete theme'</span><br><span class="line">4. git push</span><br><span class="line"><span class="meta">#</span><span class="bash"> 以上几步是为了将没有主题文件目录的信息再次提交，之后推送到远程库，也就删除了远程库上的主题文件目录</span></span><br><span class="line">5. 将主题文件目录中的.git、.gitignore、.gitattributes三个文件删除，之后将主题文件目录再剪切回github的theme目录中</span><br><span class="line">6. git add .</span><br><span class="line">7. git commit -m 'new theme'</span><br><span class="line">8. git push</span><br><span class="line"><span class="meta">#</span><span class="bash"> 再次将没有.git文件的主题推送到远程库就没有问题了。</span></span><br><span class="line">==============================================================================================</span><br><span class="line">推送时出现问题，原因是想将本地的文件推送到远程，但与远程有很多不同。可以使用下面命令强行推送。但本地的文件可能丢失。推送前将文件备份，推送后将丢失的文再复制到相应目录，再推送就可以了。</span><br><span class="line">git push -f origin source</span><br><span class="line"></span><br><span class="line">==============================================================================================</span><br><span class="line">另外还涉及一些常用命令</span><br><span class="line">git branch</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看当前分支</span></span><br><span class="line">git checkout master</span><br><span class="line"><span class="meta">#</span><span class="bash"> 切换分支。加-b选项是创建并切换分支</span></span><br><span class="line">git merge source</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将<span class="built_in">source</span>分支内容合并到当前分支</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m "abc"</span><br><span class="line">git push origin source</span><br><span class="line">git diff</span><br><span class="line">git status</span><br><span class="line">git log</span><br><span class="line">git remote add origin https://github.com/abc/rab.github.io.git</span><br><span class="line">git reset --hard HEAD^</span><br><span class="line"><span class="meta">#</span><span class="bash"> 回退到上一个版本</span></span><br><span class="line">git reflog</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看提交与回退历史</span></span><br><span class="line">==============================================================================================</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/12/kali使用记录/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/12/kali使用记录/" itemprop="url">
                  kali使用记录
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-12 08:53:20" itemprop="dateCreated datePublished" datetime="2019-03-12T08:53:20+08:00">2019-03-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-10-28 08:25:08" itemprop="dateModified" datetime="2019-10-28T08:25:08+08:00">2019-10-28</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/渗透测试/" itemprop="url" rel="index"><span itemprop="name">渗透测试</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="软件安装"><a href="#软件安装" class="headerlink" title="软件安装"></a>软件安装</h3><h4 id="需要安装的包"><a href="#需要安装的包" class="headerlink" title="需要安装的包"></a>需要安装的包</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install -y tmux fping mtr htop net-tools bind9utils gimp axel screenfetch preload okular xarchiver meld jq remmina* smplayer keepnote thunderbird evolution tofrodos ffmpeg obs-studio indicator-china-weather nethogs ethstatus bmon gufw fish</span><br><span class="line"><span class="meta">#</span><span class="bash"> gimp是作图工具</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> axel是命令行下载工具</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> screenfetch是显示系统信息的</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> preload安装即可，开机时会将数据预加载到内存中。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> okular为PDF阅读器，按F6快捷键打开注释功能。参考：https://blog.csdn.net/yangzhongxuan/article/details/8242740</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> xarchiver为解压缩软件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> meld是文件对比软件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> jq命令可以将json格式文件格式化</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> remmina是远程连接软件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> smplayer为视频播放软件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> keepnote为树状记录软件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> thunderbird evolution均为邮件管理软件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 此包安装后有两个命令，todos和fromdos，相当于unix2dos和dos2unix。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ffmpeg obs-studio是视频录制软件及依赖包</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> indicator-china-weather是优客天气</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> nethogs可以查看实时进程网络占用，例：nethogs wlan0</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ethstatus可以监控实时的网卡带宽占用，例：ethstatus -i wlan0</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> bmon可以监控网卡状态，例：bmon -p wlan0，输入g控制流量面板的显示和隐藏，输入d控制详情信息的显示和隐藏，输入q退出面板。可以配合nginx部署通过浏览器监控网络</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Netspeed是拥有GUI界面实时显示网速的工具，未测试</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sudo add-apt-repository ppa:ferramroberto/linuxfreedomlucid &amp;&amp; sudo apt-get update </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加源：sudo apt-get install netspeed</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> gufw为ufw防火墙的图形界面。Uncomplicated FireWall，是 debian 系发行版中为了轻量化配置</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> iptables 而开发的一款工具。使用本机及本机中的虚拟机测试不出防火墙的效果，使用其他主机可以。原因是虚拟</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 机使用了NAT联网的方式</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> fish是一个命令行提示工具，安装后，要运行fish到一个新的shell中才能使用其功能。源：apt-add-repository ppa:fish-shell/release-2</span></span><br></pre></td></tr></table></figure>
<h4 id="ubuntu18-04-鼠标插入时，自动关闭触摸板"><a href="#ubuntu18-04-鼠标插入时，自动关闭触摸板" class="headerlink" title="ubuntu18.04 鼠标插入时，自动关闭触摸板"></a>ubuntu18.04 鼠标插入时，自动关闭触摸板</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:atareao/atareao</span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install touchpad-indicator</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装后，可以使用命令行启动touchpad-indicator，启动后可能看不到设置页面，但在屏幕上方可</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 以看到一个触摸板的图标，可以左键点击它进行设置，设置页面第一个标签页可以设置快捷键，快捷键</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以打开或关闭触摸板。第二个标签页第一项是设置插入鼠标就禁用触摸板的，第三个标签页可以设置</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在开机的时候就启动这个小程序</span></span><br></pre></td></tr></table></figure>
<h4 id="oh-my-zsh及问题解决"><a href="#oh-my-zsh及问题解决" class="headerlink" title="oh-my-zsh及问题解决"></a>oh-my-zsh及问题解决</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">apt install -y zsh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装zsh</span></span><br><span class="line">echo $SHELL</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看当前shell</span></span><br><span class="line">cat /etc/shell</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看系统安装的shell</span></span><br><span class="line">chsh -s /bin/zsh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改用户shell，修改后在/etc/passwd中的用户shell也会变为/bin/zsh</span></span><br><span class="line">重启系统用户shell生效</span><br><span class="line">wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装oh-my-zsh，前提是要先安装过git</span></span><br><span class="line"></span><br><span class="line">-------------------</span><br><span class="line">   oh-my-zsh配置</span><br><span class="line">-------------------</span><br><span class="line">***下面是安装历史命令提示功能***</span><br><span class="line">git clone https://github.com/zsh-users/zsh-autosuggestions $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-autosuggestions</span><br><span class="line"></span><br><span class="line">***语法高亮功能***</span><br><span class="line">git clone https://github.com/zsh-users/zsh-syntax-highlighting.git $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-syntax-highlighting</span><br><span class="line"></span><br><span class="line">***history-substring-search 插件***</span><br><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">clone</span> https://github.com/zsh-users/zsh-history-substring-search.git <span class="variable">$ZSH_CUSTOM</span>/plugins/<span class="built_in">history</span>-substring-search</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 历史命令搜索插件，如果和 zsh-syntax-highlighting 插件共用，要配置到语法高亮插件之后。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 效果是上下键查询历史命令记录，可模糊匹配历史命令记录中任意字符串。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">vim ~/.zshrc</span><br><span class="line">export ZSH="/home/shouyu/.oh-my-zsh"</span><br><span class="line">ZSH_THEME="agnoster"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改为这个主题，个人喜欢。主题也可以使用random，每次打开一个终端窗口时都会随机打开一个主题</span></span><br><span class="line">export PATH=/usr/bin:/usr/sbin:/bin:/sbin:/opt/electron-ssr:/usr/local/bin:/usr/local/sbin:/usr/local/jdk1.8/jdk1.8.0_211/bin/:/home/shouyu/anaconda3/bin</span><br><span class="line">setopt no_nomatch</span><br><span class="line">if [[ -r /usr/local/lib/python2.7/dist-packages/powerline/bindings/zsh/powerline.zsh ]];then</span><br><span class="line">    source /usr/local/lib/python2.7/dist-packages/powerline/bindings/zsh/powerline.zsh</span><br><span class="line">fi</span><br><span class="line">plugins=(git zsh-autosuggestions zsh-syntax-highlighting z web-search sudo history-substring-search)</span><br><span class="line"><span class="meta">#</span><span class="bash"> z插件可以快速跳转目录</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> web-search可以在命令行使用百度、必应、google搜索，如：google abc，这表示打开默认浏览器在google中搜索abc</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> sudo插件可以在使用sudo时按两次ECS</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">history</span>-substring-search是历史自动补全命令，oh-my-zsh 自带插件</span></span><br><span class="line"></span><br><span class="line">export HISTSIZE=10000</span><br><span class="line"><span class="meta">#</span><span class="bash"> 历史纪录条目数量，测试时用<span class="built_in">echo</span>查看这个变量是50000，不知是在哪儿定义的</span></span><br><span class="line">export SAVEHIST=10000</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注销后保存的历史纪录条目数量</span></span><br><span class="line">export HISTFILE=~/.zhistory</span><br><span class="line"><span class="meta">#</span><span class="bash"> 历史纪录文件，这会在家目录自动生成此文件</span></span><br><span class="line">setopt EXTENDED_HISTORY</span><br><span class="line"><span class="meta">#</span><span class="bash"> 为历史纪录中的命令添加时间戳，在查看.zsh_history和.zhistory时可以看到命令前有时间戳</span></span><br><span class="line">setopt INC_APPEND_HISTORY</span><br><span class="line"><span class="meta">#</span><span class="bash">以附加的方式写入历史纪录</span></span><br><span class="line">setopt HIST_IGNORE_DUPS</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果连续输入的命令相同，历史纪录中只保留一个</span></span><br><span class="line">setopt AUTO_PUSHD</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启用 <span class="built_in">cd</span> 命令的历史纪录，<span class="built_in">cd</span> -[TAB]进入历史路径</span></span><br><span class="line">setopt PUSHD_IGNORE_DUPS</span><br><span class="line"><span class="meta">#</span><span class="bash"> 相同的历史路径只保留一个</span></span><br><span class="line">HIST_STAMPS="yyyy-mm-dd"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 给<span class="built_in">history</span>命令的输出添加时间</span></span><br><span class="line">DISABLE_UPDATE_PROMPT=true</span><br><span class="line"><span class="meta">#</span><span class="bash"> 自动更新oh-my-zsh</span></span><br><span class="line"></span><br><span class="line">source $ZSH/oh-my-zsh.sh</span><br><span class="line">=======================================================================================</span><br><span class="line">source .zshrc</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加载文件生效</span></span><br><span class="line">ls ~/.oh-my-zsh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这是安装后的目录，其中的lib提供了核心功能的脚本库，tools提供安装、升级等功能的快捷工具、plugins自带插件的存放位置，templates是自带的zshrc模板，也就是家目录中的.zshrc文件，temes是主题存放位置，custom是个性化配置目录，自安装的插件和主题存在这里。</span></span><br><span class="line">主题效果查看地址：https://github.com/robbyrussell/oh-my-zsh/wiki/Themes</span><br><span class="line">zsh学习地址：https://www.ibm.com/developerworks/cn/linux/shell/z/</span><br><span class="line"></span><br><span class="line">===============================</span><br><span class="line">  在zsh中使用find命令不能使用星号</span><br><span class="line">===============================</span><br><span class="line">⚡ root@ruopu64  ~  vim .zshrc </span><br><span class="line">setopt no_nomatch</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在使用find / -name *.txt命令时，提示<span class="string">"zsh : no matchs found: *.txt"</span>，在.zshrc文件中加入上面内容就可以在find命令中使用星号了。这是因为默认星号是由zsh解释的，不会传递给find命令。</span></span><br><span class="line"> </span><br><span class="line">=====================================</span><br><span class="line">  除kde桌面外，其他桌面环境命令行显示问题</span><br><span class="line">=====================================</span><br><span class="line"><span class="meta">#</span><span class="bash"> 原因是没有安装Powerline字体，按下面方法操作后，重启终端即可解决。</span></span><br><span class="line">wget https://raw.githubusercontent.com/powerline/powerline/develop/font/10-powerline-symbols.conf</span><br><span class="line">wget https://raw.githubusercontent.com/powerline/powerline/develop/font/PowerlineSymbols.otf</span><br><span class="line">sudo mkdir /usr/share/fonts/OTF</span><br><span class="line">sudo cp 10-powerline-symbols.conf /usr/share/fonts/OTF/</span><br><span class="line">sudo mv 10-powerline-symbols.conf /etc/fonts/conf.d/</span><br><span class="line">sudo mv PowerlineSymbols.otf /usr/share/fonts/OTF/</span><br><span class="line"></span><br><span class="line">=====================</span><br><span class="line">   手动更新oh-my-zsh</span><br><span class="line">=====================</span><br><span class="line">upgrade_oh_my_zsh</span><br></pre></td></tr></table></figure>
<h4 id="tilix"><a href="#tilix" class="headerlink" title="tilix"></a>tilix</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">apt install -y tilix</span><br><span class="line"><span class="meta">#</span><span class="bash"> 一款不错的linux终端仿真器</span></span><br><span class="line">下载配色方案，https://www.ctolib.com/Gogh.html，这里提供了一个配色方法，大根提供进200种方案，如果选择ALL，表示全部安装，或只输入要安装的方案的编号即可。如果安装全部，可能会比较慢。在https://mayccoll.github.io/Gogh/中有配色方案的样例。</span><br><span class="line">bash -c  "$(wget -qO- https://git.io/vQgMr)"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 运行此命令即可安装配色方案。个人比较喜欢Mona Lisa这个方案，还有google的，github的，方</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 案号有04，05，07，12，51，53，54，56，90，172</span></span><br><span class="line">apt install dconf-cli</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装配色方案前要安装此包。</span></span><br><span class="line"></span><br><span class="line">--------------</span><br><span class="line">  修改默认终端</span><br><span class="line">--------------  </span><br><span class="line">shouyu@shouyu-pc  ~  sudo update-alternatives --config x-terminal-emulator</span><br><span class="line"><span class="meta">#</span><span class="bash"> 执行命令后会让用户选择默认终端，选择后即可修改。如下：</span></span><br><span class="line"> Selection    Path                             Priority   Status</span><br><span class="line">------------------------------------------------------------------------------------</span><br><span class="line">* 0            /usr/bin/gnome-terminal.wrapper   40        auto mode</span><br><span class="line">  1            /usr/bin/gnome-terminal.wrapper   40        manual mode</span><br><span class="line">  2            /usr/bin/tilix.wrapper            30        manual mode</span><br><span class="line"></span><br><span class="line">Press &lt;enter&gt; to keep the current choice[*], or type selection number: 2</span><br><span class="line">update-alternatives: using /usr/bin/tilix.wrapper to provide /usr/bin/x-terminal-emulator (x-terminal-emulator) in manual mode</span><br><span class="line"></span><br><span class="line">---------------------</span><br><span class="line">   配色方案支持的终端</span><br><span class="line">---------------------</span><br><span class="line">Supported terminals:</span><br><span class="line">   mintty and deriviates</span><br><span class="line">   guake</span><br><span class="line">   iTerm2</span><br><span class="line">   elementary terminal (pantheon/elementary)</span><br><span class="line">   mate-terminal</span><br><span class="line">   gnome-terminal</span><br><span class="line">   tili</span><br></pre></td></tr></table></figure>
<h4 id="meta-terminal"><a href="#meta-terminal" class="headerlink" title="meta-terminal"></a>meta-terminal</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">apt install mate-terminal</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个终端使用起来更好用一些</span></span><br><span class="line">bash -c  "$(wget -qO- https://git.io/vQgMr)"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在选择安装后，可以试着选n来安装使用，这需要尝试，当使用y会有dconf的错误提示的时候可以这样试一下。</span></span><br><span class="line">安装主题后，这个终端是通过新建配置文件来修改终端主题的，安装一个主题后就可以创建一个新的配置文件了。但在设置时还是会有一些混乱的问题，需要反复测试。</span><br><span class="line">root@ruopu:~# mv /usr/bin/konsole&#123;,.bak&#125;</span><br><span class="line">root@ruopu:~# mv /usr/bin/mate-terminal.wrapper /usr/bin/konsole</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这只是修改默认终端的权宜之计，还没有找到更好的办法。另外，一定要修改mate-terminal.wrapper，如果修改的是mate-terminal是打不开终端的。</span></span><br></pre></td></tr></table></figure>
<h4 id="远程终端Terminus-amp-Termius"><a href="#远程终端Terminus-amp-Termius" class="headerlink" title="远程终端Terminus &amp; Termius"></a>远程终端Terminus &amp; Termius</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Terminus下载地址：https://github.com/Eugeny/terminus</span><br><span class="line"><span class="meta">#</span><span class="bash"> 主题已经安装，无需像tilix那样自己再安装主题。可配置性很高。</span></span><br><span class="line">Termius下载地址：https://www.termius.com/</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个软件可以创建用户并登录，它可以记录用户登录的帐户信息并在其他电脑上同步。</span></span><br></pre></td></tr></table></figure>
<h4 id="SecureCRT"><a href="#SecureCRT" class="headerlink" title="SecureCRT"></a>SecureCRT</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">1. 安装secureCRT7.3.3 </span><br><span class="line">vim /etc/apt/sources.list </span><br><span class="line">deb http://ftp.de.debian.org/debian jessie main </span><br><span class="line"><span class="meta">#</span><span class="bash"> 因为安装secureCRT7.3.3需要先安装libssl1.0.0，但kalilinux中安装的是1.0.2版本，所以要加入一个源地址。这个源很关键，对于之后安装如google，很有用。 </span></span><br><span class="line">apt update </span><br><span class="line">apt install libssl1.0.0 </span><br><span class="line">gdebi scrt-7.3.3-779.ubuntu13-64.x86_64.deb </span><br><span class="line"><span class="meta">#</span><span class="bash"> 要用gdebi，用dpkg不能安装 </span></span><br><span class="line">perl securecrt_linux_crack.pl /usr/bin/SecureCRT </span><br><span class="line"></span><br><span class="line">2. 启动SecureCRT </span><br><span class="line"></span><br><span class="line">3. 将perl命令的执行结果输入到SecureCRT中即可</span><br><span class="line"></span><br><span class="line">4. options-&gt; session Options -&gt; Terminal -&gt; audio bell （删除勾选）</span><br><span class="line"><span class="meta">#</span><span class="bash"> 关闭SecureCRT输入命令时按Tab的声音</span></span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line">安装SecureCRT8.3.4、SecureFX8.3.4。这里的安装与上面一样，只要注意，在注册软件时，如果.pl文件中的内容与下面的内容不附，请修改.pl文件中的内容与下面内容一致，不然无法注册。安装时主要是SecureFX8.3.4的注册文件有问题。</span><br><span class="line"><span class="meta">#</span><span class="bash"> SecureCRT8.3.4</span></span><br><span class="line">License:</span><br><span class="line">	Name:		xiaobo_l</span><br><span class="line">	Company:	www.boll.me</span><br><span class="line">	Serial Number:	03-94-294583</span><br><span class="line">	License Key:	ABJ11G 85V1F9 NENFBK RBWB5W ABH23Q 8XBZAC 324TJJ KXRE5D</span><br><span class="line">	Issue Date:	04-20-2017</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> SecureFX8.3.4</span></span><br><span class="line">License:</span><br><span class="line">	Name:	ygeR</span><br><span class="line">	Company:	TEAM ZWT</span><br><span class="line">	Serial Number:	06-70-001589</span><br><span class="line">	License Key:	ACUYJV Q1V2QU 1YWRCN NBYCYK ABU767 D4PQHA S1C4NQ GVZDQF</span><br><span class="line">	Issue Date:	03-10-2017</span><br></pre></td></tr></table></figure>
<h4 id="tmux-powerline并添加天气"><a href="#tmux-powerline并添加天气" class="headerlink" title="tmux-powerline并添加天气"></a>tmux-powerline并添加天气</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">shouyu@shouyu-pc  ~  git clone https://github.com/erikw/tmux-powerline.git</span><br><span class="line"><span class="meta">#</span><span class="bash"> 克隆到家目录中</span></span><br><span class="line">shouyu@shouyu-pc  ~  vim .tmux.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建配置文件并加入下面内容</span></span><br><span class="line">set-option -g status on                                                  </span><br><span class="line">set-option -g status-interval 2</span><br><span class="line">set-option -g status-justify "centre"</span><br><span class="line">set-option -g status-left-length 60</span><br><span class="line">set-option -g status-right-length 60</span><br><span class="line">set-option -g status-left "#(~/tmux-powerline/powerline.sh left)"</span><br><span class="line">set-option -g status-right "#(~/tmux-powerline/powerline.sh right)"</span><br><span class="line">set-window-option -g window-status-current-format "#[fg=colour235,bg=colour27] #[fg=colour255,bg=colour27] #I #W #[fg=colour27,bg=colour235] "</span><br><span class="line">set-window-option -g mouse on</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这一条是设置在所有窗口中启用鼠标滚动</span></span><br><span class="line"></span><br><span class="line">shouyu@shouyu-pc  ~  tmux</span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试是否可以看到命令行窗口下面的信息，在ubuntu18.04上按上面方法配置后，发现打开tmux后命</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 令行下面只有一个绿色的横条，之后将窗口放大，才能看到绿色的横条变成了一些有用的信息</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加天气方法</span></span><br><span class="line">shouyu@shouyu-pc  ~  cd ~/tmux-powerline </span><br><span class="line"><span class="meta">#</span><span class="bash"> 到克隆的项目中</span></span><br><span class="line">shouyu@shouyu-pc  ~/tmux-powerline   master ●  ./generate_rc.sh </span><br><span class="line"><span class="meta">#</span><span class="bash"> 执行generate_rc.sh脚本</span></span><br><span class="line">shouyu@shouyu-pc  ~/tmux-powerline   master ●  mv ~/.tmux-powerlinerc.default ~/.tmux-powerlinerc</span><br><span class="line"><span class="meta">#</span><span class="bash"> 把生成的文件改名</span></span><br><span class="line">shouyu@shouyu-pc  ~/tmux-powerline   master ●  vim segments/weather.sh</span><br><span class="line">TMUX_POWERLINE_SEG_WEATHER_LOCATION="CHXX0008" </span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改TMUX_POWERLINE_SEG_WEATHER_LOCATION为当地的城市代码，因为要使用雅虎的服务，所以</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 需要到雅虎的网站查看城市代码，但找到的网页提示已经不再使用之前的域名，所以想直接找城市代码</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 有一些麻烦，在百度上找到一个，仅供参考。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 地址：https://wenku.baidu.com/view/35cc2b10cf84b9d529ea7a35.html</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装后发现只是在右下角显示详细的时间，并没有天气情况</span></span><br></pre></td></tr></table></figure>
<h4 id="powerline-status"><a href="#powerline-status" class="headerlink" title="powerline-status"></a>powerline-status</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 官方使用手册：https://powerline.readthedocs.io/en/master/</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在ubuntu18.04上测试成功</span></span><br><span class="line">1. sudo apt install python-pip</span><br><span class="line">2. sudo pip install powerline-status</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这里的pip应该使用的pip2版本</span></span><br><span class="line">3. git clone https://github.com/powerline/fonts.git &amp;&amp; cd fonts &amp;&amp; sh ./install.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 克隆安装字体，在家目录中运行即可</span></span><br><span class="line">4. 设置vim使用powerline</span><br><span class="line">vim .vimrc</span><br><span class="line">set rtp+=/usr/local/lib/python2.7/dist-packages/powerline/bindings/vim/</span><br><span class="line">set laststatus=2</span><br><span class="line">set t_Co=256 </span><br><span class="line">5. github上提供的bash和zsh方法，会使命令行改变显示效果，与oh-my-zsh有冲突，所以在root</span><br><span class="line">用户进行此设置。github上提供的下面两个配置文件路径有问题，均提供成了</span><br><span class="line">/usr/local/lib/python2.7/site-packages/powerline/bindings/bash/powerline.sh</span><br><span class="line">查看发现site-packages目录中没有任何东西</span><br><span class="line">=========</span><br><span class="line"> .bashrc</span><br><span class="line">=========</span><br><span class="line">root  ~  vim .bashrc </span><br><span class="line">if [ -f /usr/local/lib/python2.7/dist-packages/powerline/bindings/bash/powerline.sh ];then</span><br><span class="line">        source /usr/local/lib/python2.7/dist-packages/powerline/bindings/bash/powerline.sh</span><br><span class="line">fi</span><br><span class="line">=========</span><br><span class="line"> .zshrc</span><br><span class="line">=========</span><br><span class="line">if [[ -r /usr/local/lib/python2.7/dist-packages/powerline/bindings/zsh/powerline.zsh ]];then</span><br><span class="line">    source /usr/local/lib/python2.7/dist-packages/powerline/bindings/zsh/powerline.zsh</span><br><span class="line">fi</span><br><span class="line">6. .tmux.conf的配置，未测试</span><br><span class="line">source /usr/local/lib/python2.7/dist-packages/powerline/bindings/tmux/powerline.conf</span><br><span class="line">set-option -g default-terminal "screen-256color"</span><br></pre></td></tr></table></figure>
<h4 id="截图软件"><a href="#截图软件" class="headerlink" title="截图软件"></a>截图软件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apt install flameshot</span><br><span class="line">设置&gt;工作区&gt;快捷键&gt;全局快捷键，之后选择加号，然后选择要使用快捷键的程序，命令使用 flameshot gui，在右侧设置此程序的快捷键。</span><br><span class="line"></span><br><span class="line">⚡ root@ruopu64  ~  apt install deepin-screenshot</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个软件在xfce4环境下更管用，在xfce4环境中安装上面的软件打不开。</span></span><br></pre></td></tr></table></figure>
<h4 id="Wunderlist奇妙清单"><a href="#Wunderlist奇妙清单" class="headerlink" title="Wunderlist奇妙清单"></a>Wunderlist奇妙清单</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">下载地址：https://github.com/edipox/wunderlistux/releases/tag/v0.0.9-linux-x64</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可能下载deb，AppImage，和原码包。使用deb包安装即可，桌面图标显示有问题，可以在命令行使</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 用wunderlist &amp;运行</span></span><br><span class="line">参考：https://sourcedigit.com/21169-install-wunderlist-app-wunderlistux-ubuntu-16-10-ubuntu-16-04/</span><br></pre></td></tr></table></figure>
<h4 id="apt-fast"><a href="#apt-fast" class="headerlink" title="apt-fast"></a>apt-fast</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:apt-fast/stable</span><br><span class="line">sudo apt-get install apt-fast</span><br><span class="line"><span class="meta">#</span><span class="bash"> 会弹出一些信息要求选择，按默认选择即可</span></span><br><span class="line">sudo apt-fast upgrade</span><br><span class="line"><span class="meta">#</span><span class="bash"> 没有命令补全，有点不好。</span></span><br></pre></td></tr></table></figure>
<h4 id="GitKraken"><a href="#GitKraken" class="headerlink" title="GitKraken"></a>GitKraken</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">官网：https://www.gitkraken.com/，首页左侧有git客户端下载，安装即可。</span><br></pre></td></tr></table></figure>
<h4 id="linux下载工具motrix"><a href="#linux下载工具motrix" class="headerlink" title="linux下载工具motrix"></a>linux下载工具motrix</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">号称是一款全能的下载工具，使用上的确比以往的下载工具好用。下载地址：https://motrix.app/zh-CN/</span><br></pre></td></tr></table></figure>
<h4 id="pycharm"><a href="#pycharm" class="headerlink" title="pycharm"></a>pycharm</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">将pycharm- 2018.3.4 .tar.gz复制 到所需的安装位置（确保您具有该目录的rw权限）</span><br><span class="line">使用以下命令将pycharm- 2018.3.4 .tar.gz文件解压缩到空目录： </span><br><span class="line">tar -xzf pycharm- 2018.3.4 .tar.gz</span><br><span class="line"><span class="meta">#</span><span class="bash"> 新的实例必须不超过现有的提取。目标文件夹必须为空。</span></span><br><span class="line">删除pycharm- 2018.3.4 .tar.gz以节省磁盘空间（可选）</span><br><span class="line">从bin子目录运行pycharm.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> pycharm启动器</span></span><br><span class="line">[Desktop Entry]</span><br><span class="line">Type = Application      </span><br><span class="line">Name = Pycharm</span><br><span class="line">GenericName = Pycharm</span><br><span class="line">Comment = Pycharm:The Python IDE</span><br><span class="line">Exec = "your_dir/pycharm-2017.3.1/bin/pycharm.sh"</span><br><span class="line">Icon = your_dir/pycharm-2017.3.1/bin/pycharm.png</span><br><span class="line">Terminal = pycharm</span><br><span class="line">Categories = Pycharm</span><br></pre></td></tr></table></figure>
<h4 id="anaconda3"><a href="#anaconda3" class="headerlink" title="anaconda3"></a>anaconda3</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">下载https://www.anaconda.com/download/，下载后是一个shell脚本，执行即可，回答都是yes或回车。使用root用户安装没有问题，使用其他用户安装时无法连接图形界面。这里有一个问题，就是要安装anaconda3后，python命令会变成anaconda3中bin目录中的python命令，这修改了系统的默认python版本，建议删除anaconda目录中bin目录下的python软链接，bin目录中的jupyter-noteboot打开后，修改第一行的内容，在python后加上3.7，也就是使用anaconda目录中bin目录下的python3.7打开jupyter-notebook，这样就可以使用jupyter-notebook了。</span><br></pre></td></tr></table></figure>
<h4 id="7zip"><a href="#7zip" class="headerlink" title="7zip"></a>7zip</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install p7zip</span><br><span class="line">7z x Windows.iso</span><br><span class="line"><span class="meta">#</span><span class="bash"> 解压iso文件</span></span><br><span class="line">7z l Windows.iso</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看压缩文件的内容</span></span><br><span class="line">7zr a win10.7z cn_windows_10_multi-***.iso</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建压缩文件</span></span><br></pre></td></tr></table></figure>
<h4 id="glances"><a href="#glances" class="headerlink" title="glances"></a>glances</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">wget -O- https://bit.ly/glances | /bin/bash</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用此方法安装比较完整。安装过程时间比较长。不可使用apt安装，</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 因为安装后会有python的报错。</span></span><br><span class="line">glances -w</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用此命令后，即可打开网页http://0.0.0.0:61208/查看监控的页面了。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试发现，这样在前台运行，在使用浏览器打开时显示没有问题。如果使用nohup在后台运行，</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用浏览器打开时，显示不了CPU、MEM、SWAP的百分比与代表百分比的线条。在前台运行后，使用</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Ctrl+z放到后台，再用<span class="built_in">bg</span> %1在后台运行显示也没有问题。再次测试，发现如果不使用nohup，只</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用&amp;在后台运行，显示是没有问题的。</span></span><br><span class="line">glances -t 2</span><br><span class="line"><span class="meta">#</span><span class="bash"> Glances 的默认刷新频率是 1 （秒），但是你可以通过在终端指定参数来手动定义其刷新频率</span></span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line">Glances 的选项</span><br><span class="line"></span><br><span class="line">· a – 对进程自动排序</span><br><span class="line">· c – 按 CPU 百分比对进程排序</span><br><span class="line">· m – 按内存百分比对进程排序</span><br><span class="line">· p – 按进程名字母顺序对进程排序</span><br><span class="line">· i – 按读写频率（I/O）对进程排序</span><br><span class="line">· d – 显示/隐藏磁盘 I/O 统计信息</span><br><span class="line">· f – 显示/隐藏文件系统统计信息</span><br><span class="line">· n – 显示/隐藏网络接口统计信息</span><br><span class="line">· s – 显示/隐藏传感器统计信息</span><br><span class="line">· y – 显示/隐藏硬盘温度统计信息</span><br><span class="line">· l – 显示/隐藏日志（log）</span><br><span class="line">· b – 切换网络 I/O 单位（Bytes/bits）</span><br><span class="line">· w – 删除警告日志</span><br><span class="line">· x – 删除警告和严重日志</span><br><span class="line">· 1 – 切换全局 CPU 使用情况和每个 CPU 的使用情况</span><br><span class="line">· h – 显示/隐藏这个帮助画面</span><br><span class="line">· t – 以组合形式浏览网络 I/O</span><br><span class="line">· u – 以累计形式浏览网络 I/O</span><br><span class="line">· q – 退出（‘ESC‘ 和 ‘Ctrl&amp;C‘ 也可以）</span><br><span class="line"></span><br><span class="line">Glances 中颜色的含义</span><br><span class="line"></span><br><span class="line">· 绿色：OK（一切正常）</span><br><span class="line">· 蓝色：CAREFUL（需要注意）</span><br><span class="line">· 紫色：WARNING（警告）</span><br><span class="line">· 红色：CRITICAL（严重）</span><br><span class="line">阀值可以在配置文件中设置，一般阀值被默认设置为（careful=50、warning=70、critical=90）。</span><br><span class="line">我们可以按照自己的需求在配置文件（默认在 /etc/glances/glances.conf）中自定义。</span><br><span class="line">=======================================================================================</span><br></pre></td></tr></table></figure>
<h4 id="albert"><a href="#albert" class="headerlink" title="albert"></a>albert</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> albert类似mac的alfred。可以搜索包括主机与网络上的信息。</span></span><br><span class="line"></span><br><span class="line">1. 下载deb包，也可以添加repo地址</span><br><span class="line">下载地址：http://download.opensuse.org/repositories/home:/manuelschneid3r/xUbuntu_16.04/amd64/albert_0.16.1_amd64.deb.mirrorlist，下载包名：albert_0.16.1_amd64.deb。这是opensuse包的下载地址，里面会包含其他发行版的包。</span><br><span class="line"><span class="meta">#</span><span class="bash"> sudo add-apt-repository ppa:nilarimogard/webupd8，此命令显示超时。如果可以使用，之后更新软件库，</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 就可以使用apt安装albert了。</span></span><br><span class="line">2. 安装时可能还需要依赖其他包，可以到https://pkgs.org下载。</span><br><span class="line">3. 第一次启动时需要设置一下快捷键，另外需要设置一下要搜索的位置</span><br></pre></td></tr></table></figure>
<h4 id="输入法fcitx"><a href="#输入法fcitx" class="headerlink" title="输入法fcitx"></a>输入法fcitx</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">apt install fcitx-* -y </span><br><span class="line">im-config</span><br><span class="line"><span class="meta">#</span><span class="bash"> 选择fcitx作为默认输入法</span></span><br><span class="line">vim /etc/default/im-config </span><br><span class="line">    IM_CONFIG_DEFAULT_MODE=fcitx</span><br><span class="line"><span class="meta">	#</span><span class="bash">  原来的值是auto，将其改为fcitx。这一步非常关键。重启后可以使用fcitx输入法，但右上角没有输入法的显示，不明原因。</span></span><br><span class="line">fcitx-config-gtk3</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置输入法</span></span><br><span class="line"></span><br><span class="line">apt install kde-config-fcitx </span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装后就可以执行im-config，如果没有此命令就先下载 </span></span><br><span class="line">vim /etc/X11/xinit/xinputrc</span><br><span class="line">    run_im fcitx</span><br><span class="line"><span class="meta">	#</span><span class="bash"> 这项也一定要改</span></span><br><span class="line"></span><br><span class="line">*** 下面可以不用设置</span><br><span class="line">vim ~/.bashrc  </span><br><span class="line"><span class="meta">#</span><span class="bash"> 在最下方添加</span></span><br><span class="line">export XMODIFIERS=@im=fcitx</span><br><span class="line">export QT_IM_MODULE=xim</span><br><span class="line">export GTK_IM_MODULE=xim</span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="built_in">export</span> XMODIFIERS=@im=ibus</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="built_in">export</span> QT_IM_MODULE=ibus</span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="built_in">export</span> GTK_IM_MODULE=ibus</span></span><br></pre></td></tr></table></figure>
<h4 id="everynote云笔记"><a href="#everynote云笔记" class="headerlink" title="everynote云笔记"></a>everynote云笔记</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">apt install nixnote2</span><br><span class="line"></span><br><span class="line">whatever是一款evernote第三方客户端，下载地址：https://sourceforge.net/projects/whatever-evernote-client/files/v1.0.0/Whatever_1.0.0_amd64.deb/download。登录有些慢，功能可以使用，问题还是图片粘贴有问题。</span><br><span class="line"></span><br><span class="line">tusk是另一款evernote第三方客户端，下载地址：https://github.com/klaussinani/tusk/releases/tag/v0.22.0</span><br><span class="line">使用中发现两个问题，一是打开软件需要等待较长时间，才能登录evernote，大概三至五分钟。第二是复制到软件内的图片无法显示，如果单独再复制一次，在网页版的evernote上就会看到两张同样的图片。</span><br></pre></td></tr></table></figure>
<h4 id="启动盘制作软件"><a href="#启动盘制作软件" class="headerlink" title="启动盘制作软件"></a>启动盘制作软件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">官网：https://unetbootin.github.io/linux_download.html</span><br><span class="line">下载binary文件</span><br><span class="line">chmod +x unetbootin-linux</span><br><span class="line">./unetbootin-linux</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在官网上有安装的方法可以查看。执行时可能界面显示有问题</span></span><br><span class="line"></span><br><span class="line">sudo add-apt-repository ppa:gezakovacs/ppa</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install unetbootin</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用此方法也可以安装</span></span><br><span class="line">sudo QT_X11_NO_MITSHM=1 /usr/bin/unetbootin</span><br><span class="line"><span class="meta">#</span><span class="bash"> 执行软件时会提示必须以root用户执行，并使用上面命令</span></span><br><span class="line">=======================================================================================</span><br><span class="line"><span class="meta">#</span><span class="bash"> 此软件为启动盘制作工具，地址：https://www.balena.io/etcher/。下载相应版本的AppImage版本，</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 之后直接执行这个下载的软件即可。</span></span><br><span class="line"></span><br><span class="line">另一种安装方法：</span><br><span class="line">1. 添加Etcher debian存储库：</span><br><span class="line">echo  “ deb https://deb.etcher.io stable etcher ”  | sudo tee /etc/apt/sources.list.d/balena-etcher.list</span><br><span class="line">2. 信任Bintray.com的GPG密钥：</span><br><span class="line">sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 379CE192D401AB61</span><br><span class="line">3. 更新并安装：</span><br><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install balena-etcher-electron</span><br><span class="line"></span><br><span class="line">卸载</span><br><span class="line">sudo apt-get del balena-etcher-electron</span><br><span class="line">sudo rm /etc/apt/sources.list.d/balena-etcher.list</span><br><span class="line">sudo apt-get update</span><br><span class="line">安装说明地址：https://github.com/balena-io/etcher#debian-and-ubuntu-based-package-repository-gnulinux-x86x64</span><br><span class="line">=======================================================================================</span><br><span class="line">安装live-usb-install-2.5.12-all.deb</span><br><span class="line">下载地址：http://live.learnfree.eu/wp-content/uploads/2017/12/wp-static-html-output-1-lokster/download/</span><br></pre></td></tr></table></figure>
<h4 id="老版本firefox"><a href="#老版本firefox" class="headerlink" title="老版本firefox"></a>老版本firefox</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 因为需要连接VPN，且在linux主机上只能安装在老版本的firefox上，所以不得不先安装老版本的firefox</span></span><br><span class="line">首先在https://pkgs.org/download/firefox中找到了一个debian7上安装的firefox-esr_52.8.0esr-1~deb7u1_amd64.deb。安装时还会依赖一些包，也需要从这个网址下载，所需包有libhunspell-1.3-0_1.3.3-3_amd64.deb、libevent-2.0-5_2.0.21-stable-3_amd64.deb、libjsoncpp0_0.6.0_rc2-3.1_amd64.deb、libffi5_3.0.10-3_amd64.deb、libpango1.0-0_1.40.5-1_amd64.deb。</span><br><span class="line"> ⚡ root@ruopu64  ~  apt remove firefox-esr</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 首先卸载之前安装的firefox</span></span><br><span class="line"> ⚡ root@ruopu64  ~  find / -name firefox</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 找一下是否还有残留的文件，发现只在用户家目录中有一些缓存文件，都删除即可</span></span><br><span class="line"> ⚡ root@ruopu64  ~  gdebi firefox-esr_52.8.0esr-1\~deb7u1_amd64.deb</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 安装老版本的firefox，如果有依赖问题，就先安装依赖包</span></span><br><span class="line"> 安装好之后，需要使用root权限打开firefox，在/usr/share/applications/firefox-esr.desktop中的Exec一项中，加入sudo即可。在地址栏输入about:config，找到最下方的xpinstall.signatures.required，双击将此项改为false。这样就可以安装未验证的插件了。</span><br><span class="line"> 访问https://211.99.15.34:6443下载插件，之后解压，先以root身份到SSLVPNClientLinux目录中执行解压后目录中的install.sh脚本，如果不到SSLVPNClientLinux目录中执行脚本会报错。之后在firefox中选择Add-ons，在页面中上方有一个小齿轮，打开后有一个Install Add-ons From File...，点击后会打开电脑的目录，在其中找到解压后的插件，根据系统，这里要选择安装64位的插件，安装后再重启，这样就可以在VPN登录页面使用帐号登录了，这里一定要注意，不可以选择密码下面的保存配置，如果选择了此项，就无法连接到内网了。登录后就可以访问内网了。</span><br></pre></td></tr></table></figure>
<h4 id="java-jdk8"><a href="#java-jdk8" class="headerlink" title="java-jdk8"></a>java-jdk8</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">下载地址：https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html</span><br><span class="line">下载前需要先登录</span><br><span class="line">cd works/ubuntutool/java-jdk</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入下载目录</span></span><br><span class="line">tar xf jdk-8u211-linux-x64.tar.gz</span><br><span class="line">mv jdk1.8.0_211 /usr/local/jdk1.8</span><br><span class="line"><span class="meta">#</span><span class="bash"> 移动到/usr/<span class="built_in">local</span>目录下</span></span><br><span class="line">vim /etc/profile.d/java.sh</span><br><span class="line">export JAVA_HOME=/usr/local/jdk1.8                                         </span><br><span class="line">export JRE_HOME=$&#123;JAVA_HOME&#125;/jre</span><br><span class="line">source /etc/profile</span><br><span class="line"><span class="meta">$</span><span class="bash"> java -version</span></span><br><span class="line">java version "1.8.0_211"</span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_211-b12)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.211-b12, mixed mode)</span><br></pre></td></tr></table></figure>
<h4 id="微信"><a href="#微信" class="headerlink" title="微信"></a>微信</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/geeeeeeeeek/electronic-wechat/releases/download/v1.4.0/linux-x64.tar.gz</span><br><span class="line">tar xf linux-x64.tar.gz</span><br><span class="line">./electronic-wechat-linux-x64/electronic-wechat</span><br></pre></td></tr></table></figure>
<h4 id="钉钉"><a href="#钉钉" class="headerlink" title="钉钉"></a>钉钉</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">下载地址：https://pan.baidu.com/s/1NznYL5fV8sUWInmUgciXXQ。</span><br><span class="line">下载后打开压缩包，是一个dingding.deb文件，使用gdebi命令安装即可。</span><br><span class="line">dingding运行时的名称是dtalk，如果关闭了打开的钉钉，无法再打开钉钉，需要使用pkill dtalk杀死钉钉的进程，才能再打开钉钉。</span><br></pre></td></tr></table></figure>
<h4 id="fiddler"><a href="#fiddler" class="headerlink" title="fiddler"></a>fiddler</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. sudo apt install mono-complete</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装这个包是为了在linux环境中运行fiddler.exe程序，这个包可以跨平台跑.NET的程序</span></span><br><span class="line">2. mono Fiddler.exe</span><br><span class="line"><span class="meta">#</span><span class="bash"> 运行程序</span></span><br></pre></td></tr></table></figure>
<h4 id="监控软件netdata"><a href="#监控软件netdata" class="headerlink" title="监控软件netdata"></a>监控软件netdata</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br><span class="line">apt install zlib1g-dev uuid-dev libmnl-dev gcc make autoconf autoconf-archive autogen automake pkg-config curl</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装Netdata的依赖项，其中包括gcc（一个C编译器），GNU Autoconf工具，GUID管理和Netdata内部Web服务器的压缩库。</span></span><br><span class="line">apt install python python-yaml python-mysqldb python-psycopg2 nodejs lm-sensors netcat</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下一组软件包是可选的，但Netdata推荐使用，包括Python，一些Python软件包和Node.JS。与系统包管理器捆绑在一起的稳定版Node.js适用于Netdata的要求。</span></span><br><span class="line">git clone https://github.com/firehol/netdata.git --depth=1 ~/netdata</span><br><span class="line">cd ~/netdata</span><br><span class="line">./netdata-installer.sh</span><br><span class="line">安装时执行回车即可，等待完成。脚本中有一步会使用curl -sSL 命令下载安装包，如果速度太慢，可以到netdata-installer.sh脚本中取消curl的这三个选项。</span><br></pre></td></tr></table></figure>
<h4 id="微软字体"><a href="#微软字体" class="headerlink" title="微软字体"></a>微软字体</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install ttf-mscorefonts-installer</span><br></pre></td></tr></table></figure>
<h4 id="mac字体"><a href="#mac字体" class="headerlink" title="mac字体"></a>mac字体</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">下载Monaco字体，地址：https://github.com/todylu/monaco.ttf/blob/master/monaco.ttf?raw=true</span><br><span class="line">https://github.com/cstrap/monaco-font</span><br><span class="line">sudo mkdir /usr/share/fonts/mac</span><br><span class="line">sudo cp -a MONACO.TTF /usr/share/fonts/mac</span><br><span class="line">cd /usr/share/fonts/mac</span><br><span class="line">sudo chmod 744 /usr/share/fonts/custom/Monaco.ttf</span><br><span class="line">sudo mkfontscale</span><br><span class="line">sudo mkfontdir</span><br><span class="line">sudo fc-cache -vf	# 刷新系统字体缓存</span><br><span class="line">sudo apt install gnome-tweak-tool</span><br><span class="line">gnome-tweaks</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用此工具再设置一下默认字体，将字体大小均改为10更好一些</span></span><br></pre></td></tr></table></figure>
<h4 id="wine的安装与使用"><a href="#wine的安装与使用" class="headerlink" title="wine的安装与使用"></a>wine的安装与使用</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install -y wine64</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装系统自带的wine64位版本，也有32位版本的</span></span><br><span class="line">==============================================================================================</span><br><span class="line"><span class="meta">#</span><span class="bash"> 也可用使用官方的最新版本</span></span><br><span class="line">wget -nc https://dl.winehq.org/wine-builds/winehq.key</span><br><span class="line">sudo apt-key add winehq.key</span><br><span class="line">sudo apt-add-repository https://dl.winehq.org/wine-builds/ubuntu/</span><br><span class="line">sudo apt-get install --install-recommends winehq-stable</span><br><span class="line">==============================================================================================</span><br><span class="line">sudo apt install --no-install-recommends winetricks</span><br><span class="line"><span class="meta">#</span><span class="bash">  安装winetricks（Wine的辅助配置工具，超级便利）。--no-install-recommends选项表示避免安装非必须的文件，</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 从而减小镜像的体积</span></span><br><span class="line">winecfg</span><br><span class="line"><span class="meta">#</span><span class="bash"> 初始化wine，也就是在家目录创建一个.wine目录，这个目录就相当于windows系统的C盘。</span></span><br><span class="line">==============================================================================================</span><br><span class="line"><span class="meta">#</span><span class="bash"> 初始化的另一个方法 </span></span><br><span class="line">WINEARCH=win32 WINEPREFIX=~/.win32 winecfg </span><br><span class="line">WINEPREFIX=~/.win64 winecfg</span><br><span class="line"><span class="meta">#</span><span class="bash"> 对于64位用户，默认创建的系统目录是64位环境的。若想使用纯32位环境，修改WINEARCH 变量win32为即可： </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> WINEARCH=win32 winecfg 这样就会生成32位Wine环境。若不设置 WINEARCH 得到的就是64位环境。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 或可以使用初始执行winecfg或wine或winetricks，这三个命令都可以。不必执行上面的命令也可以，这会生成</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> ~/.wine目录</span></span><br><span class="line">将windows中的\windows\Fonts下的所有字体复制到/opt/wine-stable/share/wine/fonts中，这样可以解决安装的软</span><br><span class="line">件有乱码的问题。</span><br><span class="line">==============================================================================================</span><br><span class="line">因为使用的是ubuntu官方提供的包，所以将字体复制到家目录中的.wine/drive_c/windows/Fonts目录中即可解决乱码问题。</span><br><span class="line">winetricks corefonts colorprofile</span><br><span class="line">winetricks fontfix fontsmooth-gray fontsmooth-rgb fontsmooth-bgr</span><br><span class="line">winetricks gdiplus</span><br><span class="line">winetricks d3dx9</span><br><span class="line">winetricks riched20 riched30</span><br><span class="line">winetricks mfc40 mfc42</span><br><span class="line">winetricks vcrun6 vb6run vcrun2003 vcrun2005 vcrun2008</span><br><span class="line">winetricks msxml3 msxml4 msxml6</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装依赖库。测试中上面四条命令执行失败了</span></span><br><span class="line">wine uninstaller</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在打开的窗口中可以选择卸载已安装的程序</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装的软件除了在~/.wine中外，在.<span class="built_in">local</span>/share/applications中也有wine目录，安装的软件的图标就在这个wine目录中。</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://blog.csdn.net/buildcourage/article/details/80871141、https://ywnz.com/linuxjc/2553.html</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在使用中发现wine并不好用。不建议使用。</span></span><br></pre></td></tr></table></figure>
<h4 id="鼠标主题"><a href="#鼠标主题" class="headerlink" title="鼠标主题"></a>鼠标主题</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">到https://limitland.gitlab.io/flatbedcursors/下载主题，FlatbedCursors-0.5.tar.bz2 </span><br><span class="line">解压主题</span><br><span class="line">将解压的目录都放入/usr/share/icons/中</span><br></pre></td></tr></table></figure>
<h4 id="锐捷客户端"><a href="#锐捷客户端" class="headerlink" title="锐捷客户端"></a>锐捷客户端</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 公司搬家之后需要使用锐捷交换机上网，所以需要安装锐捷客户端才能联网。但使用锐捷客户端无法连接。所以需要使用mentohust包进行连接验证。下面的前两步是下载安装锐捷客户端，可以忽略。</span></span><br><span class="line">1. 下载地址：http://pan.baidu.com/s/1hrhaYrU，包名：RG_SU_For_Linux_1_30_Setup.zip</span><br><span class="line">2. 解压</span><br><span class="line">unzip RG_SU_For_Linux_1_30_Setup.zip</span><br><span class="line">3. 下载mentohust，此包为了可以通过锐捷用户名密码验证，也解决使用锐捷脚本验证时提示"不允许使用的客户端类型"。感觉使用这个包，就不需要锐捷的软件包了。</span><br><span class="line">下载地址：https://code.google.com/archive/p/mentohust/。下载包名：mentohust_0.3.4-1_amd64.deb</span><br><span class="line">4. 用户名密码验证</span><br><span class="line">sudo mentohust -v4.44 -w</span><br><span class="line">欢迎使用MentoHUST	版本: 0.3.4</span><br><span class="line">Copyright (C) 2009-2010 HustMoon Studio</span><br><span class="line">人到华中大，有甜亦有辣。明德厚学地，求是创新家。</span><br><span class="line">Bug report to http://code.google.com/p/mentohust/issues/list</span><br><span class="line"></span><br><span class="line">** 网卡[1]:	enp1s0</span><br><span class="line">** 网卡[2]:	wlp0s20f3</span><br><span class="line">** 网卡[5]:	bluetooth0</span><br><span class="line">** 网卡[6]:	nflog</span><br><span class="line">** 网卡[7]:	nfqueue</span><br><span class="line">** 网卡[8]:	usbmon1</span><br><span class="line">** 网卡[9]:	usbmon2</span><br><span class="line">?? 请选择网卡[1-9]: 1</span><br><span class="line">** 您选择了第[1]块网卡。</span><br><span class="line">?? 请输入用户名: guanxiaoman</span><br><span class="line">?? 请输入密码: Qc3!Kp89</span><br><span class="line">?? 请选择组播地址(0标准 1锐捷私有 2赛尔): 0</span><br><span class="line">?? 请选择DHCP方式(0不使用 1二次认证 2认证后 3认证前): 1</span><br><span class="line">** 用户名:	guanxiaoman</span><br><span class="line">** 网卡: 	enp1s0</span><br><span class="line">** 认证超时:	8秒</span><br><span class="line">** 心跳间隔:	30秒</span><br><span class="line">** 失败等待:	15秒</span><br><span class="line">** 允许失败:	8次</span><br><span class="line">** 组播地址:	标准</span><br><span class="line">** DHCP方式:	二次认证</span><br><span class="line">** 通知超时:	5秒</span><br><span class="line">** DHCP脚本:	dhclient</span><br><span class="line">!! 在网卡enp1s0上获取IP失败!</span><br><span class="line">!! 在网卡enp1s0上获取子网掩码失败!</span><br><span class="line">** 本机MAC:	e4:e7:49:3d:34:92</span><br><span class="line">** 使用IP:	0.0.0.0</span><br><span class="line">** 子网掩码:	255.255.255.255</span><br><span class="line">** 认证参数已成功保存到/etc/mentohust.conf.</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt; 寻找服务器...</span></span><br><span class="line">** 认证MAC:	00:1a:a9:48:2a:b1</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt; 发送用户名...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt; 发送密码...</span></span><br><span class="line">** 客户端版本:	4.44</span><br><span class="line">** MD5种子:	23:ed:66:15:a6:f8:dd:93:2e:63:64:a8:97:52:3d:d2</span><br><span class="line">!! 缺少8021x.exe信息，客户端校验无法继续！</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt; 发送用户名...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt; 发送密码...</span></span><br><span class="line">** 客户端版本:	4.44</span><br><span class="line">** MD5种子:	23:ed:66:15:a6:f8:dd:93:2e:63:64:a8:97:52:3d:d2</span><br><span class="line">!! 缺少8021x.exe信息，客户端校验无法继续！</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt; 认证成功!</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt; 正在获取IP...</span></span><br><span class="line">RTNETLINK answers: File exists</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt; 操作结束。</span></span><br><span class="line">!! 在网卡enp1s0上获取IP失败!</span><br><span class="line">!! 在网卡enp1s0上获取子网掩码失败!</span><br><span class="line">** 本机MAC:	e4:e7:49:3d:34:92</span><br><span class="line">** 使用IP:	0.0.0.0</span><br><span class="line">** 子网掩码:	255.255.255.255</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt; 寻找服务器...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt; 发送用户名...</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt; 发送密码...</span></span><br><span class="line">** 客户端版本:	4.44</span><br><span class="line">** MD5种子:	a5:3a:82:3c:58:6a:2a:00:0a:80:a9:0c:de:13:50:86</span><br><span class="line">!! 缺少8021x.exe信息，客户端校验无法继续！</span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt; 认证成功!</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash">&gt; 发送心跳包以保持在线...</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 上面需要输入和选择一些信息。另外，有一个问题，成功认证后没有分配网关地址。需要手动配置。第一次配置成功后，之后再使用sudo mentohust -v4.44 -w命令连接时就不需要再输入任何信息了，第一次输入的信息会被保存。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://blog.csdn.net/tales_/article/details/50533748</span></span><br></pre></td></tr></table></figure>
<h4 id="测试网速"><a href="#测试网速" class="headerlink" title="测试网速"></a>测试网速</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Speedtest.net强大而知名的全球宽带网络速度测试网站，采用Flash载入界面，Alexa世界排名非常高，</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Speedtest.net在全球有数百个测试节点，国内有测速节点几十个。作为一款在线并且可视化的网速测试工具。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用方法简单，无需下载、安装。Speedtest.net还推出了命令行下测速工具speedtest.py 就能够实时测试网速。</span></span><br><span class="line">shouyu@shouyu-pc  ~  wget https://raw.githubusercontent.com/sivel/speedtest-cli/master/speedtest.py</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载工具</span></span><br><span class="line">shouyu@shouyu-pc  ~  chmod +x speedtest.py</span><br><span class="line"><span class="meta">#</span><span class="bash"> 给执行权限</span></span><br><span class="line">shouyu@shouyu-pc  ~  ./speedtest.py </span><br><span class="line"><span class="meta">#</span><span class="bash"> 执行。下面是执行结果：</span></span><br><span class="line">Retrieving speedtest.net configuration...</span><br><span class="line">Testing from Beijing Primezone Technologies (211.99.134.28)...</span><br><span class="line">Retrieving speedtest.net server list...</span><br><span class="line">Selecting best server based on ping...</span><br><span class="line">Hosted by Beijing Unicom (Beijing) [1.67 km]: 7.089 ms</span><br><span class="line">Testing download speed................................................................................</span><br><span class="line">Download: 15.14 Mbit/s</span><br><span class="line">Testing upload speed................................................................................................</span><br><span class="line">Upload: 34.94 Mbit/s</span><br><span class="line"> shouyu@shouyu-pc  /media/shouyu/C64CC89B4CC8879F/Tools/ubuntutool/网速测试  sudo cp -a speedtest.py /usr/bin</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 将脚本入到/usr/bin目录下</span></span><br><span class="line">shouyu@shouyu-pc  ~  source .zshrc</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 加载环境变量</span></span><br><span class="line">shouyu@shouyu-pc  ~  speedtest.py </span><br><span class="line">Retrieving speedtest.net configuration...</span><br><span class="line">Testing from Beijing Primezone Technologies (211.99.134.28)...</span><br><span class="line">Retrieving speedtest.net server list...</span><br><span class="line">Selecting best server based on ping...</span><br><span class="line">Hosted by Beijing Broadband Network (Beijing) [1.67 km]: 4.367 ms</span><br><span class="line">Testing download speed................................................................................</span><br><span class="line">Download: 15.06 Mbit/s</span><br><span class="line">Testing upload speed................................................................................................</span><br><span class="line">Upload: 34.47 Mbit/s</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这时就可以直接使用此脚本了。最好有线情况测试，无线可能会超时。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：http://www.mamicode.com/info-detail-2329407.html</span></span><br></pre></td></tr></table></figure>
<h4 id="xfce4桌面"><a href="#xfce4桌面" class="headerlink" title="xfce4桌面"></a>xfce4桌面</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt install xfce4 xfce4-goodies kali-desktop-xfce</span><br><span class="line"><span class="meta">#</span><span class="bash"> xfce4是基础的包，xfce4-goodies是很多插件的包，kali-desktop-xfce安装后才能看到系统托盘中的网络图</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 标。但最后还是有一些图标在系统托盘中看不到，原因不明。</span></span><br></pre></td></tr></table></figure>
<h4 id="KVM安装"><a href="#KVM安装" class="headerlink" title="KVM安装"></a>KVM安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">apt install  libvirt-daemon-system  libvirt-daemon qemu-kvm qemu virt-manager virt-viewer bridge-utils virtinst</span><br><span class="line"><span class="meta">#</span><span class="bash"> qemu-kvm：QEMU在KVM中主要用于虚拟化IO设备，CPU和内存虚拟化调用KVM内核模块加速实现。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> libvirt-daemon-system, libvirt-daemon：libvirt库提供虚拟机操作接口，用于控制和管理各类虚拟机。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装virtinst包，提供一整套虚拟机命令行管理工具，包括安装、克隆等命令。如virt-install, virt-clone, virsh</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> virt-manager,virt-viewer：图形化管理工具</span></span><br><span class="line">systemctl enable libvirtd</span><br><span class="line">systemctl start libvirtd</span><br><span class="line">systemctl status libvirtd</span><br><span class="line">sudo virt-manager</span><br><span class="line"><span class="meta">#</span><span class="bash"> 直接运行virt-manager有问题，无法创建虚拟机。如果使用root用户运行virt-manager提示<span class="string">"Unable to init server"</span>，可能是root用户或sudo时执行图形化应用程序时出现，无法连接到X server显示界面，解决方法如下：</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">export</span> DISPLAY=<span class="string">":0"</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> xhost +</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> virt-manager</span></span><br></pre></td></tr></table></figure>
<h4 id="samba图形配置工具"><a href="#samba图形配置工具" class="headerlink" title="samba图形配置工具"></a>samba图形配置工具</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">下载地址：https://packages.ubuntu.com/xenial/system-config-samba</span><br><span class="line">system-config-samba</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动时可能会提示: could not open configuration file `/etc/libuser.conf<span class="string">'</span></span></span><br><span class="line">sudo touch /etc/libuser.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 手动添加这个配置文件</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://www.linuxidc.com/Linux/2018-01/150493.htm</span></span><br></pre></td></tr></table></figure>
<h3 id="设置方法"><a href="#设置方法" class="headerlink" title="设置方法"></a>设置方法</h3><h4 id="apt源"><a href="#apt源" class="headerlink" title="apt源"></a>apt源</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/apt/sources.list </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">中科大（加入这一个源即可） </span></span><br><span class="line">deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib </span><br><span class="line">deb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">阿里云 </span></span><br><span class="line"><span class="meta">#</span><span class="bash">deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib </span></span><br><span class="line"><span class="meta">#</span><span class="bash">deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">清华大学 </span></span><br><span class="line"><span class="meta">#</span><span class="bash">deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free </span></span><br><span class="line"><span class="meta">#</span><span class="bash">deb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">浙大 </span></span><br><span class="line"><span class="meta">#</span><span class="bash">deb http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free </span></span><br><span class="line"><span class="meta">#</span><span class="bash">deb-src http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">东软大学 </span></span><br><span class="line">deb http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib </span><br><span class="line"><span class="meta">#</span><span class="bash">deb-src http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">官方源 </span></span><br><span class="line"><span class="meta">#</span><span class="bash">deb http://http.kali.org/kali kali-rolling main non-free contrib </span></span><br><span class="line"><span class="meta">#</span><span class="bash">deb-src http://http.kali.org/kali kali-rolling main non-free contrib </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">重庆大学 </span></span><br><span class="line"><span class="meta">#</span><span class="bash">deb http://http.kali.org/kali kali-rolling main non-free contrib </span></span><br><span class="line"><span class="meta">#</span><span class="bash">deb-src http://http.kali.org/kali kali-rolling main non-free contrib </span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入上面一行即可 </span></span><br><span class="line">apt update </span><br><span class="line"><span class="meta">#</span><span class="bash"> 这样就可使用源了。</span></span><br></pre></td></tr></table></figure>
<h4 id="Tmux-启用鼠标滚动"><a href="#Tmux-启用鼠标滚动" class="headerlink" title="Tmux 启用鼠标滚动"></a>Tmux 启用鼠标滚动</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 先按ctrl+B</span><br><span class="line">2. set -g mouse on</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这时就启用对所有窗口的鼠标滚动了，但不能选中文本进行复制粘贴</span></span><br><span class="line">3. 按住shift再点击鼠标右键，这时就可以看到复制粘贴了，也可以选中文本了</span><br></pre></td></tr></table></figure>
<h4 id="history结果显示操作时间方法"><a href="#history结果显示操作时间方法" class="headerlink" title="history结果显示操作时间方法"></a>history结果显示操作时间方法</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">让history命令显示时间，需要在/etc/profile中加入export HISTTIMEFORMAT="[%F %T]"。但在普通用户使用zsh时没有起作用，不明原因。</span><br></pre></td></tr></table></figure>
<h4 id="开启bbr（tcp拥塞控制）"><a href="#开启bbr（tcp拥塞控制）" class="headerlink" title="开启bbr（tcp拥塞控制）"></a>开启bbr（tcp拥塞控制）</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">echo "net.core.default_qdisc=fq" &gt;&gt; /etc/sysctl.conf</span><br><span class="line">echo "net.ipv4.tcp_congestion_control=bbr" &gt;&gt; /etc/sysctl.conf</span><br><span class="line">sysctl -p </span><br><span class="line">lsmod | grep bbr  #检查是否有tcp_bbr</span><br></pre></td></tr></table></figure>
<h4 id="vim设置"><a href="#vim设置" class="headerlink" title="vim设置"></a>vim设置</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">在用户家目录中创建的.vimrc文件只对当前用户生效，配置后不用重新加载，立即生效。但/etc下的vimrc配置会失效，所以这个文件中要将需要的功能都写入。</span><br><span class="line">vim ~/.vimrc</span><br><span class="line">set nocompatible</span><br><span class="line"><span class="meta">#</span><span class="bash"> 不与 Vi 兼容（采用 Vim 自己的操作命令）</span></span><br><span class="line">set nu      </span><br><span class="line"><span class="meta">#</span><span class="bash"> 显示行号                                                                </span></span><br><span class="line">set hlsearch</span><br><span class="line"><span class="meta">#</span><span class="bash"> 搜索时，高亮显示匹配结果。</span></span><br><span class="line">set showmatch</span><br><span class="line"><span class="meta">#</span><span class="bash"> 光标遇到圆括号、方括号、大括号时，自动高亮对应的另一个圆括号、方括号和大括号。</span></span><br><span class="line">set history=1000</span><br><span class="line"><span class="meta">#</span><span class="bash"> Vim 需要记住多少次历史操作。</span></span><br><span class="line">syntax on</span><br><span class="line"><span class="meta">#</span><span class="bash"> 打开语法高亮。自动识别代码，使用多种颜色显示。即使加载时报错，也要加入此行</span></span><br><span class="line">set cursorline</span><br><span class="line"><span class="meta">#</span><span class="bash"> 光标所在的当前行高亮。</span></span><br><span class="line">set showcmd</span><br><span class="line"><span class="meta">#</span><span class="bash"> 命令模式下，在底部显示，当前键入的指令。比如，键入的指令是2y3d，那么底部就会显示2y3，当键入d的时候，操作完成，显示消失。</span></span><br><span class="line">set autoindent</span><br><span class="line"><span class="meta">#</span><span class="bash"> 按下回车键后，下一行的缩进会自动跟上一行的缩进保持一致。</span></span><br><span class="line">set expandtab</span><br><span class="line"><span class="meta">#</span><span class="bash"> 由于 Tab 键在不同的编辑器缩进不一致，该设置自动将 Tab 转为空格。</span></span><br><span class="line">set wrap</span><br><span class="line"><span class="meta">#</span><span class="bash"> 自动折行，即太长的行分成几行显示。</span></span><br><span class="line">set incsearch</span><br><span class="line"><span class="meta">#</span><span class="bash"> 输入搜索模式时，每输入一个字符，就自动跳到第一个匹配的结果。</span></span><br><span class="line">set ignorecase</span><br><span class="line"><span class="meta">#</span><span class="bash"> 搜索时忽略大小写。</span></span><br><span class="line">colorscheme slate # 即使加载时报错，也要加入此行</span><br><span class="line"><span class="meta">#</span><span class="bash"> 调整配色方案，还有default、blue、darkblue、delek、desert、elflord、evening、industry、koehler、morning、murphy、pablo、peachpuff、ron、shine、slate、torte、zellner</span></span><br><span class="line">highlight StatusLine guifg=SlateBlue guibg=Yellow </span><br><span class="line">highlight StatusLineNC guifg=Gray guibg=White</span><br><span class="line"><span class="meta">#</span><span class="bash"> 状态行颜色，不使用</span></span><br><span class="line">set tabstop=4 </span><br><span class="line"><span class="meta">#</span><span class="bash"> 制表符为4</span></span><br><span class="line">set softtabstop=4 </span><br><span class="line">set shiftwidth=4</span><br><span class="line"><span class="meta">#</span><span class="bash"> 统一缩进为4</span></span><br><span class="line">set rtp+=/usr/local/lib/python2.7/dist-packages/powerline/bindings/vim/</span><br><span class="line">set laststatus=2</span><br><span class="line">set t_Co=256</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建.vimrc文件后就可以在命令行中使用鼠标右键了，这是抵消了/etc/vimrc文件中的设置。</span></span><br><span class="line"></span><br><span class="line">vim命令粘贴带数字或符号的信息时格式混乱解决</span><br><span class="line">使用vim打开文件时，使用:set paste命令关闭缩进功能就可以解决了。如果要开启缩进功能，使用命令:set nopaste。或一种方法是，打开.vimrc文件，加入set pastetoggle=&lt;F9&gt;，之后可以使用F9键来切换缩进功能了。配置文件中的&lt;F9&gt;是按F9键录入的。</span><br><span class="line"></span><br><span class="line">在vim中，使用%表示全文</span><br><span class="line"></span><br><span class="line">关闭高亮</span><br><span class="line">:nohl</span><br></pre></td></tr></table></figure>
<h4 id="创建启动器"><a href="#创建启动器" class="headerlink" title="创建启动器"></a>创建启动器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Linux 系统中的Desktop Entry 文件以desktop为后缀名。Desktop Entry 文件是 Linux 桌面系统中用于描述程序启动配置信息的文件。</span></span><br><span class="line">wget https://raw.githubusercontent.com/geeeeeeeeek/electronic-wechat/master/assets/icon.png -O electronic-wechat.png</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载一个微信图标</span></span><br><span class="line">mv electronic-wechat.png works/ubuntutool/electronWechat/electronic-wechat-linux-x64/</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将图标与执行程序放在一起</span></span><br><span class="line">vim /usr/share/applications/electronic-wechat.desktop</span><br><span class="line">[Desktop Entry]                                                                 </span><br><span class="line">Name=Electronic Wechat</span><br><span class="line">Name[zh_CN]=微信电脑版</span><br><span class="line">Name[zh_TW]=微信电脑版</span><br><span class="line">Exec=/root/works/ubuntutool/electronWechat/electronic-wechat-linux-x64/electronic-wechat</span><br><span class="line">Icon=/root/works/ubuntutool/electronWechat/electronic-wechat-linux-x64/electronic-wechat.png</span><br><span class="line">Terminal=false</span><br><span class="line"><span class="meta">#</span><span class="bash"> 软件打开时是否启动终端</span></span><br><span class="line">X-MultipleArgs=false</span><br><span class="line">Type=Application</span><br><span class="line">Encoding=UTF-8</span><br><span class="line">Categories=Application;Utility;Network;InstantMessaging;</span><br><span class="line">StartupNotify=false</span><br><span class="line">编辑完上面的文件，进入/usr/share/applications 目录就可以看到一个叫微信电脑版的图标，可以在图标上右键，将其发送至桌面，之后就可以双击这个图标启动微信了。</span><br></pre></td></tr></table></figure>
<h4 id="设置桥接"><a href="#设置桥接" class="headerlink" title="设置桥接"></a>设置桥接</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 目前有五种方法。因为需要锐捷客户端拨号上网，所以这里只测试通过nm-connection-editor连接成功。或者说，在测试nm-connection-editor才反应过来这里的问题。</span></span><br><span class="line"></span><br><span class="line">1. nmcli</span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://www.zcfy.cc/article/how-to-add-network-bridge-with-nmcli-networkmanager-on-linux</span></span><br><span class="line">nmcli con show</span><br><span class="line">nmcli connection show --active</span><br><span class="line"><span class="meta">#</span><span class="bash"> 取当前连接状态</span></span><br><span class="line">nmcli con add ifname br0 type bridge con-name br0 </span><br><span class="line">nmcli con add type bridge-slave ifname eno1 master br0 </span><br><span class="line">nmcli connection show</span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加新的br0网桥</span></span><br><span class="line">nmcli con down "Wired connection 1"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 先关闭网卡</span></span><br><span class="line">nmcli con up br0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 打开 br0</span></span><br><span class="line">sudo nmcli con modify br0 bridge.stp no   </span><br><span class="line"><span class="meta">#</span><span class="bash"> 是不是这里改成yes就开启stp了，stp是生成树协议 </span></span><br><span class="line">nmcli con show </span><br><span class="line">nmcli -f bridge con show br0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 禁用 STP</span></span><br><span class="line"></span><br><span class="line">2. brctl</span><br><span class="line">参考：https://www.cnblogs.com/yinzhengjie/p/7446226.html</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这种方法显得更简单，但连接后br0可以分配到地址，也可以ping通网关。但不能ping能DNS，如114</span></span><br><span class="line">brctl addbr br0       #创建一个名称为"br0"的网卡</span><br><span class="line">ifconfig eth0 0 up     #将需要桥接的网卡IP清空</span><br><span class="line">brctl addif br0 eth0                       #在"br0"上添加"eth0"；</span><br><span class="line">ifconfig  br0 192.168.16.107/24 up        #给"br0"配置IP；</span><br><span class="line">route add default gw 192.168.16.1        #设置默认的网关地址；</span><br><span class="line">brctl stp br0 on        # 开启stp服务</span><br><span class="line"></span><br><span class="line">3. 修改/etc/netplan/50-cloud-init.yaml</span><br><span class="line">network:</span><br><span class="line">  version: 2</span><br><span class="line">  ethernets:</span><br><span class="line">    enp1s0:</span><br><span class="line">      dhcp4: no</span><br><span class="line">      dhcp6: no</span><br><span class="line">    wlp0s20f3:</span><br><span class="line">      dhcp4: yes</span><br><span class="line">      dhcp6: yes</span><br><span class="line"></span><br><span class="line">  bridges:</span><br><span class="line">    br0:</span><br><span class="line">      interfaces: [enp1s0]</span><br><span class="line">      dhcp4: yes</span><br><span class="line"><span class="meta">#</span><span class="bash"> yaml文件对缩进很严格，一定要注意缩进</span></span><br><span class="line">netplan --debug apply</span><br><span class="line"><span class="meta">#</span><span class="bash"> 让设置生效，生效后NetworkManager就失效了</span></span><br><span class="line"></span><br><span class="line">4. nm-connection-editor 。测试发现，通过路由器直接连接到电脑后，网桥可用。但如果还要经过锐捷播号，就有问题了。</span><br><span class="line">- nm-connection-editor    # 启动图形界面</span><br><span class="line">- 点左下角的加号创建一个网桥 -&gt; 在标签页桥接中点击添加 -&gt; 选择以太网 -&gt; 选择设备为本机的有线网卡，其他默认，保存。-&gt; 这时在桥接标签页中就多了一个添加的以太网，其他默认，IPV4选择与本机网卡相同的配置，如DHCP或静态IP，保存。</span><br><span class="line">- 删除原有的以太网卡，重启NetworkManager即可。</span><br><span class="line"></span><br><span class="line">5. nmtui</span><br></pre></td></tr></table></figure>
<h4 id="设置远程使用root用户登录"><a href="#设置远程使用root用户登录" class="headerlink" title="设置远程使用root用户登录"></a>设置远程使用root用户登录</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/ssh/sshd_config</span><br><span class="line">    PermitRootLogin yes</span><br><span class="line">    # PermitRootLogin prohibit-password</span><br><span class="line"><span class="meta">#</span><span class="bash"> 注释一条，写入上面一条即可。</span></span><br><span class="line">systemctl restart ssh</span><br></pre></td></tr></table></figure>
<h4 id="固态硬盘优化"><a href="#固态硬盘优化" class="headerlink" title="固态硬盘优化"></a>固态硬盘优化</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">sudo hdparm -I /dev/sdx | grep "TRIM supported"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看固态硬盘是否支持trim</span></span><br><span class="line">vim fstrim.sh</span><br><span class="line">    #!/bin/sh</span><br><span class="line">    LOG=/var/log/trim.log</span><br><span class="line">    echo "*** $(date -R) ***" &gt;&gt; $LOG</span><br><span class="line">    fstrim -v / &gt;&gt; $LOG</span><br><span class="line">    fstrim -v /home &gt;&gt; $LOG</span><br><span class="line">chmod +x fstrim.sh</span><br><span class="line">crontab -e</span><br><span class="line">    0 9 * * * /bin/bash /root/sh/fstrim.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 每天9点定时执行</span></span><br></pre></td></tr></table></figure>
<h4 id="修改默认编辑器"><a href="#修改默认编辑器" class="headerlink" title="修改默认编辑器"></a>修改默认编辑器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo update-alternatives --config editor</span><br></pre></td></tr></table></figure>
<h4 id="修改程序默认终端模拟器"><a href="#修改程序默认终端模拟器" class="headerlink" title="修改程序默认终端模拟器"></a>修改程序默认终端模拟器</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">root@ruopu64:~#mv /usr/bin/konsole&#123;,.bak&#125;</span><br><span class="line">root@ruopu64:~#ln -sv /usr/bin/tilix.wrapper /usr/bin/konsole</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这样打开终端时就会使用tilix了。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 尝试使用root@ruopu64:~<span class="comment">#update-alternatives --config x-terminal-emulator命令修改没有成功</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在设置中的应用程序中修改默认打开的终端也没有成功</span></span><br><span class="line"></span><br><span class="line">====================================================</span><br><span class="line">gsettings set org.gnome.desktop.default-applications.terminal exec /usr/bin/mate-terminal</span><br><span class="line">gsettings set org.gnome.desktop.default-applications.terminal exec-arg "-x"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 上面是设置默认打开的终端命令与选项。但这只可以设置使用Ctrl + Alt + t打开的默认终端。使用鼠标右键打开的终端并不会变。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> gsettings的使用为，先使用list-schemas查看有哪些schemas，再通过list-keys查看schemas有哪些key，再通过get可以获取key的值，使用<span class="built_in">set</span>可以设置key的值。</span></span><br><span class="line">====================================================</span><br><span class="line">gsettings命令使用</span><br><span class="line">GConf是在基于 GNOME2 的 Linux 操作系统中实现对应用程序的配置及管理功能的工具。</span><br><span class="line">我们可以把 GConf 理解为 Linux 操作系统中的注册表。然而，它克服了 Windows 注册表的一些缺点，比如 Windows 注册表遭到破坏，可能会导致操作系统崩溃，而且 GConf 的配置信息存储于纯文本的文件中，可读性很好。</span><br><span class="line">在 GNOME3 中，GConf 已经被 DConf/Gsettings 替代，但还是用些应用在使用 GConf。</span><br><span class="line"></span><br><span class="line">1.dconf-editor 的使用</span><br><span class="line"></span><br><span class="line">还可以用 dconf 进行操作，明细请通过 man dconf 查看，而 dconf-editor 是 dconf 的一个图形化操作程序。</span><br><span class="line"></span><br><span class="line">2.使用 gsettings 编辑设置,如下示例在Ubuntu16.04上的效果</span><br><span class="line"></span><br><span class="line">1.显示系统都安装了哪些不可重定位的schema</span><br><span class="line">gsettings list-schemas</span><br><span class="line"></span><br><span class="line">2.查看org.mate.applications-office都有哪些子schema</span><br><span class="line">gsettings list-children  org.mate.applications-office</span><br><span class="line"></span><br><span class="line">3.查看org.mate.applications-office.calendar的schema下都有哪些项(key)</span><br><span class="line">gsettings list-keys org.mate.applications-office.calendar</span><br><span class="line"></span><br><span class="line">4.查看org.mate.applications-office.calendar的schema下所有项的取值</span><br><span class="line">gsettings list-recursively  org.mate.applications-office.calendar</span><br><span class="line"></span><br><span class="line">5.查看org.mate.applications-office.calendar的schema下的项needs-term的值</span><br><span class="line">gsettings get org.mate.applications-office.calendar needs-term</span><br><span class="line"></span><br><span class="line">6.查看org.mate.applications-office.calendar的schema下的项needs-term的取值范围</span><br><span class="line">gsettings range  org.mate.applications-office.calendar needs-term</span><br><span class="line"></span><br><span class="line">7.修改设置org.mate.media-handling的schema下的项automount-open的值为true</span><br><span class="line">gsettings set org.mate.media-handling automount-open  false</span><br><span class="line">gsettings get org.mate.media-handling automount-open </span><br><span class="line"></span><br><span class="line">8. 恢复org.mate.media-handling的schema下的项automount-open的值为默认值</span><br><span class="line">gsettings reset org.mate.media-handling automount-open</span><br><span class="line"></span><br><span class="line">9. 修改org.mate.media-handling的schema下的多项值后，恢复整个schema的所有项为默认值</span><br><span class="line">gsettings list-recursively org.mate.media-handling</span><br></pre></td></tr></table></figure>
<h4 id="连接VPN网络"><a href="#连接VPN网络" class="headerlink" title="连接VPN网络"></a>连接VPN网络</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当宿主机的firefox连接到VPN后，虚拟机使用NAT方式联网，就可以连接到VPN网络内，无需设置。</span><br></pre></td></tr></table></figure>
<h4 id="修改命令提示符显示效果"><a href="#修改命令提示符显示效果" class="headerlink" title="修改命令提示符显示效果"></a>修改命令提示符显示效果</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc</span><br><span class="line">export PS1='\[\e]0;\u@\h: \w\a\]$&#123;debian_chroot:+($debian_chroot)&#125;    \[\033[01;31m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\W\[\033[00m\]\$'</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这里就是将最后的小写w改为大写W，这条PS1的命令也是从.bashrc文件内容中的一部分复制过来的</span></span><br></pre></td></tr></table></figure>
<h4 id="关闭-avahi-daemon-服务"><a href="#关闭-avahi-daemon-服务" class="headerlink" title="关闭 avahi-daemon 服务"></a>关闭 avahi-daemon 服务</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">avahi-daemon造成过网络异常，用处也不大，停止服务并关闭开机启动：</span><br><span class="line">sudo systemctl stop avahi-daemon.socket</span><br><span class="line">sudo systemctl stop avahi-daemon.service</span><br><span class="line">sudo /lib/systemd/systemd-sysv-install disable avahi-daemon</span><br><span class="line"></span><br><span class="line">sudo systemctl disable avahi-daemon.socket</span><br><span class="line">sudo systemctl disable avahi-daemon.service</span><br></pre></td></tr></table></figure>
<h4 id="清理家目录中的-cache文件"><a href="#清理家目录中的-cache文件" class="headerlink" title="清理家目录中的.cache文件"></a>清理家目录中的.cache文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">⚡ root@ruopu64  ~  df -h</span><br><span class="line">文件系统                      容量  已用  可用 已用% 挂载点</span><br><span class="line">udev                          7.7G     0  7.7G    0% /dev</span><br><span class="line">tmpfs                         1.6G  9.8M  1.6G    1% /run</span><br><span class="line">/dev/mapper/ruopu64--vg-root   53G   48G  2.8G   95% /</span><br><span class="line"><span class="meta">#</span><span class="bash"> root目录增长太大</span></span><br><span class="line">⚡ root@ruopu64  ~  find ~/.cache -size +100M -delete</span><br><span class="line"><span class="meta">#</span><span class="bash"> 清理大于100M的文件</span></span><br><span class="line">⚡ root@ruopu64  ~  find ~/.cache -type f -atime +365</span><br><span class="line"><span class="meta">#</span><span class="bash"> 清理日期大于365天的文件</span></span><br></pre></td></tr></table></figure>
<h4 id="清理-boot-分区"><a href="#清理-boot-分区" class="headerlink" title="清理/boot/分区"></a>清理/boot/分区</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"> ✘ ⚡ ⚙ root@ruopu64  ~  df -h</span><br><span class="line">文件系统                      容量  已用  可用 已用% 挂载点</span><br><span class="line">udev                          7.7G     0  7.7G    0% /dev</span><br><span class="line">tmpfs                         1.6G  9.4M  1.6G    1% /run</span><br><span class="line">/dev/mapper/ruopu64--vg-root   53G   49G  2.0G   97% /</span><br><span class="line">tmpfs                         7.8G   13M  7.7G    1% /dev/shm</span><br><span class="line">tmpfs                         5.0M     0  5.0M    0% /run/lock</span><br><span class="line">tmpfs                         7.8G     0  7.8G    0% /sys/fs/cgroup</span><br><span class="line">/dev/sda1                     236M  227M     0  100% /boot</span><br><span class="line"><span class="meta">#</span><span class="bash"> boot分区没有空间了</span></span><br><span class="line">⚡ ⚙ root@ruopu64  ~  dpkg --get-selections|grep linux-image</span><br><span class="line">linux-image-4.14.0-kali3-amd64			install</span><br><span class="line">linux-image-4.18.0-kali2-amd64			install</span><br><span class="line">linux-image-4.18.0-kali3-amd64			install</span><br><span class="line">linux-image-4.19.0-kali1-amd64			install</span><br><span class="line">linux-image-4.19.0-kali3-amd64			install</span><br><span class="line">linux-image-amd64				install</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看已安装的内核</span></span><br><span class="line"> ⚡ ⚙ root@ruopu64  ~  uname -a</span><br><span class="line">Linux ruopu64 4.19.0-kali3-amd64 #1 SMP Debian 4.19.20-1kali1 (2019-02-14) x86_64 GNU/Linux</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看正在使用的内核</span></span><br><span class="line"> ⚡ ⚙ root@ruopu64  ~  apt autoremove linux-image-4.14.0-kali3-amd64</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 自动删除不用的内核，这除了删除4.14版本外，4.18版本也会自动删除</span></span><br><span class="line">  ⚡ ⚙ root@ruopu64  ~  dpkg --get-selections|grep linux-image       </span><br><span class="line">linux-image-4.14.0-kali3-amd64			deinstall</span><br><span class="line">linux-image-4.18.0-kali2-amd64			deinstall</span><br><span class="line">linux-image-4.18.0-kali3-amd64			deinstall</span><br><span class="line">linux-image-4.19.0-kali1-amd64			install</span><br><span class="line">linux-image-4.19.0-kali3-amd64			install</span><br><span class="line">linux-image-amd64				install</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除后查看，被删除的内核后标有deinstall，这表示有卸载残留</span></span><br><span class="line">⚡ ⚙ root@ruopu64  ~  dpkg -P linux-image-4.14.0-kali3-amd64 linux-image-4.18.0-kali2-amd64 linux-image-4.18.0-kali3-amd64</span><br><span class="line"><span class="meta">#</span><span class="bash"> 清理卸载残留</span></span><br><span class="line"> ⚡ ⚙ root@ruopu64  ~  dpkg --get-selections|grep linux-image</span><br><span class="line">linux-image-4.19.0-kali1-amd64			install</span><br><span class="line">linux-image-4.19.0-kali3-amd64			install</span><br><span class="line">linux-image-amd64				install</span><br><span class="line"><span class="meta">#</span><span class="bash"> 再次查看就没有了</span></span><br><span class="line"> ⚡ ⚙ root@ruopu64  ~  df -h</span><br><span class="line">文件系统                      容量  已用  可用 已用% 挂载点</span><br><span class="line">udev                          7.7G     0  7.7G    0% /dev</span><br><span class="line">tmpfs                         1.6G  9.4M  1.6G    1% /run</span><br><span class="line">/dev/mapper/ruopu64--vg-root   53G   47G  3.1G   94% /</span><br><span class="line">tmpfs                         7.8G   30M  7.7G    1% /dev/shm</span><br><span class="line">tmpfs                         5.0M     0  5.0M    0% /run/lock</span><br><span class="line">tmpfs                         7.8G     0  7.8G    0% /sys/fs/cgroup</span><br><span class="line">/dev/sda1                     236M  104M  120M   47% /boot</span><br><span class="line"><span class="meta">#</span><span class="bash"> boot分区也有空间了</span></span><br></pre></td></tr></table></figure>
<h3 id="命令使用"><a href="#命令使用" class="headerlink" title="命令使用"></a>命令使用</h3><h4 id="apt使用"><a href="#apt使用" class="headerlink" title="apt使用"></a>apt使用</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get包管理在卸载软件后不要轻易使用apt-get autoremove，否则极容易各种悲剧。如果真想卸载干净，可以用apt-get purge</span><br></pre></td></tr></table></figure>
<h4 id="忽略某个可以升级的包"><a href="#忽略某个可以升级的包" class="headerlink" title="忽略某个可以升级的包"></a>忽略某个可以升级的包</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">⚡ ⚙ root@ruopu64  ~  apt-mark hold firefox-esr </span><br><span class="line">firefox-esr 设置为保留。</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用此命令可以忽略某个可以升级的包，再使用apt upgrade时就不会升级此包了。</span></span><br><span class="line">apt-mark unhold firefox-esr</span><br><span class="line"><span class="meta">#</span><span class="bash"> 此命令可以解除忽略的包</span></span><br></pre></td></tr></table></figure>
<h4 id="添加用户"><a href="#添加用户" class="headerlink" title="添加用户"></a>添加用户</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@ruopu64:~#useradd -m python</span><br><span class="line">root@ruopu64:~#passwd python</span><br><span class="line">root@ruopu64:~#vim /etc/passwd</span><br><span class="line"><span class="meta">#</span><span class="bash"> 将用户的shell改为/bin/bash，默认是sh，切换到用户后没有自动补全，命令提示符也有问题，改为bash后就正常了。</span></span><br></pre></td></tr></table></figure>
<h4 id="设置开机启动"><a href="#设置开机启动" class="headerlink" title="设置开机启动"></a>设置开机启动</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"> ⚡ ⚙ root@ruopu64  ~  vim /lib/systemd/system/rc.local.service</span><br><span class="line"><span class="meta"> #</span><span class="bash">  SPDX-License-Identifier: LGPL-2.1+</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">  This file is part of systemd.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash">  systemd is free software; you can redistribute it and/or modify it</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  under the terms of the GNU Lesser General Public License as published by</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  the Free Software Foundation; either version 2.1 of the License, or</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  (at your option) any later version.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> This unit gets pulled automatically into multi-user.target by</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> systemd-rc-local-generator <span class="keyword">if</span> /etc/rc.local is executable.</span></span><br><span class="line">[Unit]</span><br><span class="line">Description=/etc/rc.local Compatibility</span><br><span class="line">Documentation=man:systemd-rc-local-generator(8)</span><br><span class="line">ConditionFileIsExecutable=/etc/rc.local</span><br><span class="line">After=network.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">ExecStart=/etc/rc.local start</span><br><span class="line">TimeoutSec=0</span><br><span class="line">RemainAfterExit=yes</span><br><span class="line">GuessMainPID=no</span><br><span class="line"></span><br><span class="line"> ⚡ ⚙ root@ruopu64  ~  vim /etc/rc.local</span><br><span class="line"><span class="meta"> #</span><span class="bash">!/bin/sh -e</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> rc.local</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> This script is executed at the end of each multiuser runlevel.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Make sure that the script will <span class="string">"exit 0"</span> on success or any other</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> value on error.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> In order to <span class="built_in">enable</span> or <span class="built_in">disable</span> this script just change the execution</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> bits.</span></span><br><span class="line"><span class="meta">#</span><span class="bash"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> By default this script does nothing.</span></span><br><span class="line"></span><br><span class="line">electron-ssr</span><br><span class="line">/bin/bash /root/sh/Typora.sh</span><br><span class="line"></span><br><span class="line">exit 0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 此文件需要手动创建。服务启动后，将要启动的命令或脚本放入此文件即可。</span></span><br><span class="line"></span><br><span class="line"> ⚡ ⚙ root@ruopu64  ~  systemctl start rc-local.service</span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动服务</span></span><br><span class="line">  ⚡ ⚙ root@ruopu64  ~  systemctl status rc-local.service</span><br><span class="line">  ● rc-local.service - /etc/rc.local Compatibility</span><br><span class="line">   Loaded: loaded (/lib/systemd/system/rc-local.service; static; vendo</span><br><span class="line">  Drop-In: /lib/systemd/system/rc-local.service.d</span><br><span class="line">           └─debian.conf</span><br><span class="line">   Active: active (exited) since Fri 2019-03-22 08:15:42 CST; 7min ago</span><br><span class="line">     Docs: man:systemd-rc-local-generator(8)</span><br><span class="line">  Process: 4063 ExecStart=/etc/rc.local start (code=exited, status=0/S</span><br><span class="line"></span><br><span class="line">3月 22 08:15:42 ruopu64 systemd[1]: Starting /etc/rc.local Compatibili</span><br><span class="line">3月 22 08:15:42 ruopu64 systemd[1]: Started /etc/rc.local Compatibilit</span><br><span class="line">lines 1-10/10 (END)</span><br><span class="line"><span class="meta">#</span><span class="bash"> 状态应该是active</span></span><br><span class="line">⚡ ⚙ root@ruopu64  ~  systemctl enable rc-local</span><br><span class="line">⚡ ⚙ root@ruopu64  ~  systemctl list-unit-files</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看开机启动项</span></span><br></pre></td></tr></table></figure>
<h4 id="重装grub"><a href="#重装grub" class="headerlink" title="重装grub"></a>重装grub</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">grub-install –target=i386-pc /dev/sda # 由于我的系统装在/dev/sda上面，所以这里用的是/dev/sda # –target=i386-pc这个option指的是：只安装BIOS系统的grub。# 我在使用时没有使用--target选项，只是简单地安装</span><br><span class="line"></span><br><span class="line">grub-mkconfig -o /boot/grub/grub.cfg </span><br><span class="line"><span class="meta">#</span><span class="bash">安装好之后，将配置文件输出</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考： https://blog.csdn.net/panglinzhuo/article/details/77599641</span></span><br></pre></td></tr></table></figure>
<h4 id="dd命令制作启动盘"><a href="#dd命令制作启动盘" class="headerlink" title="dd命令制作启动盘"></a>dd命令制作启动盘</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo umount /dev/sdb*</span><br><span class="line">sudo mkfs.vfat /dev/sdb -I</span><br><span class="line"><span class="meta">#</span><span class="bash"> 直接格式化即可</span></span><br><span class="line">sudo dd if=ubuntu-18.04.1-desktop-amd64.iso of=/dev/sdb bs=10M</span><br><span class="line"><span class="meta">#</span><span class="bash"> 直接将镜像写入U盘</span></span><br></pre></td></tr></table></figure>
<h4 id="命令行操作无线网络"><a href="#命令行操作无线网络" class="headerlink" title="命令行操作无线网络"></a>命令行操作无线网络</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 因更新内核或其他原因，使网络设置的选项在设置中消失了。没有找到好的解决办法。无奈之下，只有使用命令行操作。不过，塞翁失马，焉知非福?</span></span><br><span class="line">1. 查看无线网络名称</span><br><span class="line"> ⚡ root@shouyu  ~  iwlist wlan0 scan|grep ESSID</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查找现在可以找到的无线网络的名称</span></span><br><span class="line"> ⚡ root@shouyu  ~  iw dev wlan0 scan|grep SSID</span><br><span class="line"><span class="meta">#</span><span class="bash"> iw命令也可以查看，建议使用此命令</span></span><br><span class="line"></span><br><span class="line">2. 生成配置文件</span><br><span class="line"> ⚡ root@shouyu  ~  wpa_passphrase ruopu2.4 </span><br><span class="line"><span class="meta">#</span><span class="bash"> 此命令可以输出配置文件信息，如下：</span></span><br><span class="line">network=&#123;                                                                                 </span><br><span class="line">    ssid="ruopu2.4"</span><br><span class="line">    #psk="X5kzxctScjn"</span><br><span class="line">    psk=7f06ac6de165b153ec899b9cc600678e92a68c5e53a044182ba9dcf50ddd153a</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">3. 保存配置信息</span><br><span class="line"> ⚡ root@shouyu  ~  vim ruopu24.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 保存的位置是自定义的</span></span><br><span class="line"></span><br><span class="line">4. 连接无线网络</span><br><span class="line"> ⚡ root@shouyu  ~  wpa_supplicant -i wlan0 -c ruopu24.conf</span><br><span class="line"><span class="meta">#</span><span class="bash"> 用-i指定网卡，-c指定配置文件。连接的过程需要一些时间</span></span><br><span class="line"></span><br><span class="line">5. 查看连接状态</span><br><span class="line"> ⚡ root@shouyu  ~  iwconfig wlan0</span><br><span class="line">wlan0     IEEE 802.11  ESSID:"ruopu24"  </span><br><span class="line">          Mode:Managed  Frequency:2.412 GHz  Access Point: C0:C1:C0:D9:75:32   </span><br><span class="line">          Bit Rate=144.4 Mb/s   Tx-Power=22 dBm   </span><br><span class="line">          Retry short limit:7   RTS thr:off   Fragment thr:off</span><br><span class="line">          Encryption key:off</span><br><span class="line">          Power Management:on</span><br><span class="line">          Link Quality=55/70  Signal level=-55 dBm  </span><br><span class="line">          Rx invalid nwid:0  Rx invalid crypt:0  Rx invalid frag:0</span><br><span class="line">          Tx excessive retries:0  Invalid misc:5   Missed beacon:0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 连接后可以看到是否连接成功</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://www.cnblogs.com/v5captain/p/8724850.html</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://blog.csdn.net/u010164190/article/details/68942070</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://pluhuxc.github.io/2018/08/19/use-wpa_supplicant-connect-wifi.html</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：http://rickgray.me/2015/08/03/useful-command-tool-for-wifi-connection/</span></span><br><span class="line">6. 查看已连接的wifi信息</span><br><span class="line"> ⚡ root@shouyu  ~  cd /etc/NetworkManager/system-connections</span><br><span class="line"><span class="meta">#</span><span class="bash"> 在此目录中有已经连接的无线信息，以文件形式保存，文件中有密码等信息</span></span><br><span class="line">7. 问题解决</span><br><span class="line">出现：nl80211: Could not set interface 'p2p-dev-wlan0' UP</span><br><span class="line"> ⚡ ⚙ root@shouyu  ~  killall wpa_supplicant </span><br><span class="line"><span class="meta"> #</span><span class="bash"> 杀死这个进程再重新执行 wpa_supplicant -i wlan0 -c ruopu24.conf命令即可。</span></span><br><span class="line"></span><br><span class="line">另一种方法：</span><br><span class="line"><span class="meta">#</span><span class="bash"> 两种方法只能选择一种。</span></span><br><span class="line">1. 创建配置文件</span><br><span class="line"> ⚡ root@shouyu  ~  vim /etc/wpa_supplicant/example.conf</span><br><span class="line">ctrl_interface=/run/wpa_supplicant                                                        </span><br><span class="line">update_config=1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这样配置是为了后面可以使用 wpa_cli 命令来实时地扫描和配置网络，并能够保存配置信息。</span></span><br><span class="line"></span><br><span class="line">2. 初始化网卡</span><br><span class="line"> ⚡ root@shouyu  ~  wpa_supplicant -B -D nl80211 -i wlan0 -c /etc/wpa_supplicant/example.conf</span><br><span class="line">Successfully initialized wpa_supplicant</span><br><span class="line">ctrl_iface exists and seems to be in use - cannot override it</span><br><span class="line">Delete '/run/wpa_supplicant/wlan0' manually if it is not used anymore</span><br><span class="line">Failed to initialize control interface '/run/wpa_supplicant'.</span><br><span class="line">You may have another wpa_supplicant process already running or the file was</span><br><span class="line">left by an unclean termination of wpa_supplicant in which case you will need</span><br><span class="line">to manually remove this file before starting wpa_supplicant again.</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果初始化如上面这样，是因为已经使用无线网卡连接了wifi，需要删除/run/wpa_supplicant/wlan0文件</span></span><br><span class="line"> ⚡ root@shouyu  ~  rm -rf /run/wpa_supplicant/wlan0</span><br><span class="line"> ⚡ root@shouyu  ~  wpa_supplicant -B -D nl80211 -i wlan0 -c /etc/wpa_supplicant/example.conf</span><br><span class="line">Successfully initialized wpa_supplicant</span><br><span class="line">nl80211: Could not set interface 'p2p-dev-wlan0' UP</span><br><span class="line">nl80211: deinit ifname=p2p-dev-wlan0 disabled_11b_rates=0</span><br><span class="line">p2p-dev-wlan0: Failed to initialize driver interface</span><br><span class="line">P2P: Failed to enable P2P Device interface</span><br><span class="line"><span class="meta">#</span><span class="bash"> 再将初始化成功，-B参数表示后台运行。如果遇到驱动不支持所插入的无线网卡，可选择wired或者wext等，具体详情可使用 wpa_supplicant -h 进行查看。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 此方法连接无线网络后速度并不理想，不知是否与-D nl80211选项有关。</span></span><br><span class="line"></span><br><span class="line">3. 使用交互式命令wpa_cli</span><br><span class="line">⚡ root@shouyu  ~  wpa_cli</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入 wpa_cli 的交互界面后，它会自动地扫描周围的无线网络，你也可以使用 scan 命令进行手动扫描</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> scan</span></span><br><span class="line">OK</span><br><span class="line">&lt;3&gt;CTRL-EVENT-SCAN-STARTED </span><br><span class="line">&lt;3&gt;CTRL-EVENT-SCAN-RESULTS </span><br><span class="line">&lt;3&gt;WPS-AP-AVAILABLE </span><br><span class="line">&lt;3&gt;CTRL-EVENT-NETWORK-NOT-FOUND </span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> scan_results </span></span><br><span class="line">bssid / frequency / signal level / flags / ssid</span><br><span class="line">74:05:a5:7a:14:a0	5765	-58	[WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]	TP-LINK_503</span><br><span class="line">8e:6d:77:87:b5:8c	5180	-70	[WPA-PSK-CCMP+TKIP][WPA2-PSK-CCMP+TKIP][WPS][ESS]ChinaNet-7MRq-5G-Q</span><br><span class="line">74:05:a5:7a:14:9e	2412	-53	[WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]	TP-LINK_503</span><br><span class="line">d4:ee:07:60:88:00	2427	-53	[WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]	ziroom602</span><br><span class="line">80:89:17:5a:9b:4a	2462	-68	[WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]	dingdingdingding</span><br><span class="line">c0:c1:c0:d9:75:32	2412	-52	[WPA-PSK-CCMP+TKIP][WPA2-PSK-CCMP+TKIP][WPS][ESS]home2</span><br><span class="line">8c:6d:77:69:7f:58	2462	-69	[WPA-PSK-CCMP+TKIP][WPA2-PSK-CCMP+TKIP][WPS][ESS]ruopu2.4</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用scan_results搜索到的无线网络</span></span><br><span class="line"></span><br><span class="line">4. 创建网络配置信息</span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> add_network</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这条命令会生成一条网络配置信息的编号，从0开始，下面就对这个第0条配置信息进行配置</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> set_network 1 ssid <span class="string">"ruopu2.4"</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> set_network 1 psk <span class="string">"12345678"</span></span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> set_network 1 key_mgmt WPA-PSK</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试中这里只能这样配置，因为使用WPA2-PSK会提示FAIL。命令最后的Wifi的加密方式可以是WPA-PSK或WPA2-PSK</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> enable_network 0</span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">#</span><span class="bash"> 执行过此命令后就开始连接了，需要等待一段时间。再使用iwconfig查看是否连接到了目标网络。注意，这里输出的信息并不会停下来。所以直接使用下面的命令即可。</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> save_config</span></span><br><span class="line">OK</span><br><span class="line"><span class="meta">#</span><span class="bash"> 保存配置信息到/etc/wpa_supplicant/example.conf</span></span><br><span class="line"><span class="meta">&gt;</span><span class="bash"> status</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看状态</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：http://rickgray.me/2015/08/03/useful-command-tool-for-wifi-connection/</span></span><br></pre></td></tr></table></figure>
<h4 id="制作linux启动盘工具"><a href="#制作linux启动盘工具" class="headerlink" title="制作linux启动盘工具"></a>制作linux启动盘工具</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">U盘安装KaliLinux时，用win32diskimager将镜像拷到U盘中，用软碟通拷到U盘后，安装时提示启动失败。 </span><br><span class="line">关于双系统启动盘的制作，可以使用WinSetupFromUSB</span><br><span class="line">使用方法：https://www.cnblogs.com/zx525/p/7783504.html。</span><br><span class="line">官网：http://www.winsetupfromusb.com</span><br></pre></td></tr></table></figure>
<h4 id="设置區域，不然會是英文，即使選了中文安裝"><a href="#设置區域，不然會是英文，即使選了中文安裝" class="headerlink" title="设置區域，不然會是英文，即使選了中文安裝"></a>设置區域，不然會是英文，即使選了中文安裝</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo LANG="zh_CN.UTF-8" &gt; /etc/default/locale </span><br><span class="line">reboot </span><br><span class="line">apt update</span><br></pre></td></tr></table></figure>
<h3 id="问题解决"><a href="#问题解决" class="headerlink" title="问题解决"></a>问题解决</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">1. 系统提示“KDEInit无法启动/usr/bin/systemsettings5”，这时桌面上的图标均不可点，鼠标左右键在桌面上也失灵。需要关闭有问题的程序，之后才会有上面的错误提示。使用中发现是“系统设置”出了问题，需要在系统设置的图标上右键--&gt;属性--&gt;应用程序--&gt;高级选项--&gt;D-Bus注册中要选择“无”。这样就解决问题了。如果其他图标也有此问题，也可按此方法解决。</span><br><span class="line"></span><br><span class="line">2. 新装系统后，无法安装fcitx输入法，提示有lib的软件版本不对，需要使用apt install命令按要求再装一次lib软件，千万不要使用apt autoremove命令卸载软件，或卸载任何软件，不然会出现其他问题。</span><br><span class="line"></span><br><span class="line">3. 新装系统后，安装完各种包后，重启无法进入系统，发现是登录页面的左上角的会话中没有了相应的图形环境。需要重新安装。如：apt install kali-defaults kali-root-login desktop-base kde-plasma-desktop，安装完之后重启即可解决。</span><br><span class="line">参考： https://www.52os.net/articles/kail-change-desktop-environment.html(kali切换桌面环境)</span><br><span class="line"></span><br><span class="line">4. 调整LVM后，开机启动有问题，无法正常进入图形界面，注释/etc/fstab文件中有问题的LVM卷自动挂载后正常，进入系统后修复。</span><br><span class="line"></span><br><span class="line">5. 挂载提示"The disk contains an unclean file system (0, 0).Metadata kept in Windows cache, refused to mount. Falling back to read-only mount because the NTFS partition is in an unsafe state. Please resume and shutdown Windows fully (no hibernation or fast restartin"</span><br><span class="line">root@ruopu64:~# ntfsfix /dev/sda4</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修复有问题的分区即可</span></span><br><span class="line"></span><br><span class="line">6. 修改命令提示符</span><br><span class="line">vim ~/.bashrc</span><br><span class="line">export PS1='\[\e]0;\u@\h: \w\a\]$&#123;debian_chroot:+($debian_chroot)&#125;\[\033[01;31    m\]\u@\h\[\033[00m\]:\[\033[01;34m\]\W\[\033[00m\]\$'</span><br><span class="line"><span class="meta">#</span><span class="bash"> 加入这一行后，提示符只显示当前目录</span></span><br><span class="line"></span><br><span class="line">7. 报错"GLib-GIO-Message: 21:55:51.450: Using the 'memory' GSettings backend.  Your settings will not be saved or shared with other applications."</span><br><span class="line">vim ~/.zshrc</span><br><span class="line">export GIO_EXTRA_MODULES=/usr/lib/x86_64-linux-gnu/gio/modules </span><br><span class="line">source  ~/.zshrc</span><br><span class="line"></span><br><span class="line">8. Opera浏览器无法启动</span><br><span class="line">解决：右键Opera图标 --&gt; 应用程序 --&gt; 在命令栏中的最后加入--no-sandbox</span><br><span class="line"></span><br><span class="line">9. 在没有全局代理的情况下让chrome登录google帐号</span><br><span class="line">root@shouyu:~# google-chrome-stable %U --proxy-pac-url="http://127.0.0.1:2333/proxy.pac"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用此命令启动google浏览器就可以连接到本地的端口</span></span><br><span class="line"></span><br><span class="line">10. 安装xfce4桌面后，启动electron-ssr看不到系统托盘中的图标，可以使用Ctrl + Shift + w 调出程序的窗口。</span><br><span class="line"></span><br><span class="line">11. 在系统托盘中没有网络图标时，可以使用nmtui进入启用连接中连接无线网络。</span><br><span class="line"></span><br><span class="line">12. 安装xfce4桌面系统后没有声音。</span><br><span class="line">apt install alsamixergui</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装此软件后部分解决声音问题</span></span><br><span class="line"></span><br><span class="line">13. vscode显示中文乱码</span><br><span class="line">a. 点击右下解的编码模式，一般这时是UTF-8</span><br><span class="line">b. 之后软件上方弹出窗口，有两个选择，一个是Reopen with Encoding，一个是Save with Encoding。点击Reopen with Encoding</span><br><span class="line">c. 选择第一项Simplified Chinese(GB2312)。这样就解决中文乱码问题了。</span><br><span class="line"></span><br><span class="line">14. 使用gnome-tweaks工具取消桌面上的磁盘图标</span><br><span class="line"></span><br><span class="line">15. 系统报错，提示有问题</span><br><span class="line">sudo rm/var/crash/* </span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除这些错误报告</span></span><br><span class="line">gksu gedit/etc/default/apport</span><br><span class="line">enable=0</span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置0表示禁用Apportw，或者1开启它。把enabled=1改为enabled=0。保存并关闭文件。完成之后你就再也不会看到弹窗报告错误了。很显然，如果我们想重新开启错误报告功能，只要再打开这个文件，把enabled设置为1就可以了。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> gksu是linux下图形化的su/sudo工具</span></span><br><span class="line"></span><br><span class="line">16. 解决升级内核后无法使用无线网络问题</span><br><span class="line"><span class="meta">#</span><span class="bash"> 问题：现象反映为电脑不停打开关闭飞行模式，无法使用无线网络。在电源中关闭无线后，打开关闭的现象停止了。查找问题原因是最难的，能想到的有两种情况，一种是驱动问题，一种是内核问题。还好是能想到的两种情况中的一种。</span></span><br><span class="line">a. 查看内核列表</span><br><span class="line">sudo dpkg --get-selections |grep linux-image</span><br><span class="line">b. 查看当前使用的内核</span><br><span class="line">uname -r</span><br><span class="line">c. 升级/安装内核</span><br><span class="line">sudo apt install linux-image-4.4.0-75-generic</span><br><span class="line">d. 删除内核</span><br><span class="line">sudo apt-get remove linux-image-4.4.0-75-generic</span><br><span class="line"><span class="meta">#</span><span class="bash"> 卸载内核时，在图形画面要选择否。安装kali的新内核linux-image-5.2版本时有问题，会使无线网络无法使用。</span></span><br><span class="line">e. firmware-iwlwifi</span><br><span class="line"><span class="meta">#</span><span class="bash"> 无线网卡驱动名称。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> kde下载的是broadcom-wl-5.100.138.tar.bz2</span></span><br><span class="line">f. http://http.kali.org/kali/pool/main/l/linux/</span><br><span class="line"><span class="meta">#</span><span class="bash"> kali内核下载地址。</span></span><br><span class="line"></span><br><span class="line">17. 安装钉钉时提示"/var/lib/dpkg/info/dtalk.postinst:行7: desktop-file-install：未找到命令"，需要安装desktop-file-utils。之后就可以正常安装了。</span><br><span class="line"></span><br><span class="line">18. linux 命令行 提示符前面多了 (base)</span><br><span class="line">(base) shouyu@shouyu-pc:~$ conda deactivate</span><br><span class="line"><span class="meta">#</span><span class="bash"> 是aconda自动加入了命令到 .bashrc中。执行上面的命令可以去掉前面的(base)</span></span><br><span class="line">shouyu@shouyu-pc:~$ </span><br><span class="line"></span><br><span class="line">19. 关于electron-ssr打开后看不到图标的解决办法</span><br><span class="line">首先，尝试安装libappindicator1应用程序指示器。如果不行，使用下面的快捷键。</span><br><span class="line">Control+Shift+W</span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用快捷键切换主窗口显隐，需要在空白桌面上使用上面的快捷键。</span></span><br><span class="line"></span><br><span class="line">20. 取消PPA库的方法</span><br><span class="line">sudo add-apt-repository --remove ppa:nilarimogard/webupd8</span><br></pre></td></tr></table></figure>
<h4 id="更新软件源时的公钥问题"><a href="#更新软件源时的公钥问题" class="headerlink" title="更新软件源时的公钥问题"></a>更新软件源时的公钥问题</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">apt update</span><br><span class="line">错误提示：W: GPG error: http://mirrordirector.raspbian.org/raspbian stretch InRelease: The following signatures couldn't be verified because the public key is not available: NO_PUBKEY 9165938D90FDDD2E</span><br><span class="line">W: The repository 'http://mirrordirector.raspbian.org/raspbian stretch InRelease' is not signed.</span><br><span class="line">N: Data from such a repository can't be authenticated and is therefore potentially dangerous to use.</span><br><span class="line">N: See apt-secure(8) manpage for repository creation and user configuration details.</span><br><span class="line">W: There is no public key available for the following key IDs:</span><br><span class="line">9165938D90FDDD2E</span><br><span class="line">E: Failed to fetch http://mirrordirector.raspbian.org/raspbian/dists/stretch/main/binary-armhf/Packages.xz Hash Sum mismatch</span><br><span class="line">E: Some index files failed to download. They have been ignored, or old ones used instead.</span><br><span class="line"><span class="meta">#</span><span class="bash"> 错误信息大致意思为没有找到对应的公钥，所以软件源地址不被信任。</span></span><br><span class="line"></span><br><span class="line">解决办法：</span><br><span class="line">apt install software-properties-common dirmngr</span><br><span class="line">gpg --keyserver  keyserver.ubuntu.com --recv-keys 9165938D90FDDD2E</span><br><span class="line"><span class="meta">#</span><span class="bash"> keyserver.ubuntu.com是key服务器，9165938D90FDDD2E是上面错误提示中提到的，这是公钥签名。</span></span><br><span class="line">gpg --export --armor  9165938D90FDDD2E | sudo apt-key add -</span><br><span class="line"><span class="meta">#</span><span class="bash"> 参考：https://www.cnblogs.com/lanqie/p/8513102.html</span></span><br></pre></td></tr></table></figure>
<h4 id="网易云音乐无法启动"><a href="#网易云音乐无法启动" class="headerlink" title="网易云音乐无法启动"></a>网易云音乐无法启动</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">直接无法启动，没有反应</span><br><span class="line"> vim /usr/share/applications/netease-cloud-music.desktop</span><br><span class="line">    ...</span><br><span class="line">    # Exec=netease-cloud-music --no-sandbox %U</span><br><span class="line">    Exec=sh -c "unset SESSION_MANAGER &amp;&amp; netease-cloud-music %U"</span><br><span class="line">    ...</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改上面一行的设置为sh -c ...一行的样子</span></span><br><span class="line">如果上面的设置不起作用，就需要使用sudo启动软件了</span><br><span class="line">sudo netease-cloud-music</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动时提示<span class="string">"Gtk-Message: 10:33:56.116: Failed to load module "</span>canberra-gtk-module<span class="string">""</span></span></span><br><span class="line">⚙ shouyu@shouyu-pc  ~/下载  sudo apt install libcanberra-gtk-module</span><br></pre></td></tr></table></figure>
<h4 id="google-chrome不能启动"><a href="#google-chrome不能启动" class="headerlink" title="google-chrome不能启动"></a>google-chrome不能启动</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">下载chrome：wget https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb</span><br><span class="line"></span><br><span class="line">從官網下載瀏覽器，启动時會有報錯，但可以使用google-chrome-stable --no-sandbox啟動。 </span><br><span class="line"></span><br><span class="line">vim /usr/bin/google-chrome </span><br><span class="line">    exec -a "$0" "$HERE/chrome" "$@" --user-data-dir --no-sandbox</span><br><span class="line"><span class="meta">#</span><span class="bash"> 无法直接启动谷歌浏览器，要在启动文件中修改上面一行，在配置文件的最后一行 </span></span><br><span class="line">或者 </span><br><span class="line">google-chrome --no-sandbox </span><br><span class="line"><span class="meta">#</span><span class="bash"> 用此种方法也可以启动 </span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 启动chromium浏览器也可用此方法</span></span><br></pre></td></tr></table></figure>
<h3 id="VMWare"><a href="#VMWare" class="headerlink" title="VMWare"></a>VMWare</h3><h4 id="VMWare问题解决"><a href="#VMWare问题解决" class="headerlink" title="VMWare问题解决"></a>VMWare问题解决</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">* 安装vmware-workstation前一定要先安装build-essential。Built Essential包含对编译Ubuntu二进制安装包所需的所有包的引用。</span><br><span class="line">sudo apt install build-essential</span><br><span class="line"></span><br><span class="line">1. 安装完VMware后，无法启动，提示“GNU C Compiler(gcc)version 7.3 was not found”</span><br><span class="line">gcc --version</span><br><span class="line"><span class="meta">#</span><span class="bash"> 现在是8.2版本</span></span><br><span class="line">apt install -y gcc-7</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装7版本</span></span><br><span class="line">rm /usr/bin/gcc</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除软连接</span></span><br><span class="line">ln -s /usr/bin/gcc-7 /usr/bin/gcc</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建新的软链接</span></span><br><span class="line">gcc --version</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这时查看的版本就是7.3了。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 再启动提示linux headers不对</span></span><br><span class="line">apt install linux-headers-$(uname -r)</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装后重启系统，就可以进入软件了。</span></span><br><span class="line"></span><br><span class="line">2. 安装vmware-workstation15，安装完成后启动提示“Kernel Headers for version X.X.XX-XX-XX were not found”</span><br><span class="line">解决办法</span><br><span class="line">apt install linux-headers-$(uname -r)</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装这个头文件后，启动就正常了</span></span><br><span class="line"></span><br><span class="line">3. 安装VMWare-tools时报错:"there was a problem updating a software component. try again later and if the"，实际是下载有问题</span><br><span class="line">手动解决：</span><br><span class="line">下载地址：http://softwareupdate.vmware.com/cds/vmw-desktop/ws/15.0.4/12990004/windows/packages/，下载其中的tools-windows.tar，之后将其解压，在虚拟机中加载解压后的iso文件即可手动安装。</span><br><span class="line"></span><br><span class="line">4. 添加共享文件夹后，在虚拟机的网络中可以查看到，前提是安装了vmware-tools。</span><br><span class="line"></span><br><span class="line">5. 卸载VMware-Workstation</span><br><span class="line">sudo vmware-installer -u vmware-workstation</span><br><span class="line"></span><br><span class="line">6. vmware或virtualbox无法启动，要求加载vmmon模块，用modprobe。但使用modprobe加载也会报错。可能是电脑开启了安全引导模式，关闭后就可以了。</span><br><span class="line"></span><br><span class="line">7. vmware使用NAT方式不能连接到网络，提示：Could not connect 'Ethernet0' to virtual network '/dev/vmnet8'. More information can be found in the vmware.log file. Failed to connect virtual device 'Ethernet0'. 将这个虚拟交换机删除，重新创建一个虚拟交换机，选择NAT方式即可解决。</span><br><span class="line"></span><br><span class="line">8. 挂起是虚拟机的操作本身的休眠功能，关闭即可。如win7的休眠功能</span><br></pre></td></tr></table></figure>
<h3 id="VirtualBox"><a href="#VirtualBox" class="headerlink" title="VirtualBox"></a>VirtualBox</h3><h4 id="问题解决-1"><a href="#问题解决-1" class="headerlink" title="问题解决"></a>问题解决</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 启动虚拟机时提示"Kernel driver not installed ... as root ... /sbin/vboxconfig"</span><br><span class="line">问题解决时发现自己只做了三件有用的事，但不确定是否是这些问题造成的虚拟机无法启动。一、关闭BIOS的安全启动功能；二、重装VirtualBox；三、启动虚拟机时无法启动，但提示要执行 </span><br><span class="line">sudo modprobe vboxdrv。当完成上面三步后，虚拟机可以启动了。</span><br></pre></td></tr></table></figure>
<h4 id="VirtualBox虚拟机安装Ubuntu-16-04-3-LTS后安装增强功能"><a href="#VirtualBox虚拟机安装Ubuntu-16-04-3-LTS后安装增强功能" class="headerlink" title="VirtualBox虚拟机安装Ubuntu 16.04.3 LTS后安装增强功能"></a>VirtualBox虚拟机安装Ubuntu 16.04.3 LTS后安装增强功能</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">点击安装增强功能--&gt;bash VBoxLinuxAdditions.run</span><br><span class="line"><span class="meta">#</span><span class="bash"> 实际使用时先安装了autorun.sh，但没有效果。安装VBoxLinuxAdditions.run后需要重启。</span></span><br></pre></td></tr></table></figure>
<h4 id="VirtualBox安装MacOS方法"><a href="#VirtualBox安装MacOS方法" class="headerlink" title="VirtualBox安装MacOS方法"></a>VirtualBox安装MacOS方法</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1. 创建MacOS虚拟机，自定义虚拟机名称为MacOS</span><br><span class="line">2. 在命令行执行</span><br><span class="line">VBoxManage modifyvm "MacOS" --cpuidset 00000001 000106e5 00100800 0098e3fd bfebfbff</span><br><span class="line">VBoxManage setextradata "MacOS" "VBoxInternal/Devices/efi/0/Config/DmiSystemProduct" "iMac11,3"</span><br><span class="line">VBoxManage setextradata "MacOS" "VBoxInternal/Devices/efi/0/Config/DmiSystemVersion" "1.0"</span><br><span class="line">VBoxManage setextradata "MacOS" "VBoxInternal/Devices/efi/0/Config/DmiBoardProduct" "Iloveapple"</span><br><span class="line">VBoxManage setextradata "MacOS" "VBoxInternal/Devices/smc/0/Config/DeviceKey" "ourhardworkbythesewordsguardedpleasedontsteal(c)AppleComputerInc"</span><br><span class="line">VBoxManage setextradata "MacOS" "VBoxInternal/Devices/smc/0/Config/GetKeyFromRealSMC" 1</span><br><span class="line"><span class="meta">#</span><span class="bash"> MacOS为虚拟机名。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> VirtualBox原生支持Mac OS X的安装，但是只有在系统环境为Mac的环境下，才能正常引导，因为在非Mac环境下，安装程序会检测出我们的CPU不是已经识别的型号，从而拒绝进一步的安装。为此，我们需要执行以下命令来Hack</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果VBoxManage没有被加入PATH的话，可能会提示VBoxManage不是可执行的命令。只需要进入VirtualBox的安装目录下Shift+右键在当前目录打开命令行执行即可~</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 原理非常简单：利用VBox的命令行工具在虚拟机的DeviceKey中加入Apple的声明即可。</span></span><br></pre></td></tr></table></figure>
<h4 id="VirtualBox共享文件夹"><a href="#VirtualBox共享文件夹" class="headerlink" title="VirtualBox共享文件夹"></a>VirtualBox共享文件夹</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">因为使用apt安装的VirtualBox在安装增强功能时会有网络问题，无法下载安装，所以采用下载安装包的方法安装，另外，安装6.0版本时会有包依赖问题，所以使用了5.2.20版本</span><br><span class="line">下载地址：http://download.virtualbox.org/virtualbox/5.2.20/</span><br><span class="line">下载 Oracle_VM_VirtualBox_Extension_Pack-5.2.20-125813.vbox-extpack包，此为增强功能的包，virtualbox-5.2_5.2.20-125813~Ubuntu~bionic_amd64.deb为程序安装包</span><br><span class="line">安装好程序包后，打开页面左上解的管理，之后选择全局设定，在其中的扩展中选择添加刚才下载的增强功能包，之后就可以自动安装了。下面需要在已安装操作系统的页面上点击上方设备中的安装增强功能，之后就可以看到虚拟机操作系统中的光驱中挂载了光盘，打开安装后就可以使用VirtualBox的共享文件夹功能了。</span><br><span class="line">进入虚拟机后可以在网络中看到共享的文件夹。</span><br></pre></td></tr></table></figure>
<h4 id="VirtualBox虚拟机挂载宿主机U盘"><a href="#VirtualBox虚拟机挂载宿主机U盘" class="headerlink" title="VirtualBox虚拟机挂载宿主机U盘"></a>VirtualBox虚拟机挂载宿主机U盘</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1. 下载扩展插件，地址：http://download.virtualbox.org/virtualbox/5.2.32/。因为ubuntu18.04默认安装的是5.2.32版本所以下载这个插件Oracle_VM_VirtualBox_Extension_Pack-5.2.20-125813.vbox-extpack。</span><br><span class="line"><span class="meta">#</span><span class="bash"> 6.0使用的插件：Oracle_VM_VirtualBox_Extension_Pack-6.0.0_RC1.vbox-extpack</span></span><br><span class="line">2. 到VirtualBox的全局设置中的扩展中加载这个插件</span><br><span class="line">3. 创建usbfs组</span><br><span class="line">sudo groupadd usbfs</span><br><span class="line">4. 将当前用户加入vboxusers和usbfs组。</span><br><span class="line">shouyu@shouyu-pc  ~  sudo vim /etc/group</span><br><span class="line">vboxusers:x:127:shouyu </span><br><span class="line">usbfs:x:1001:shouyu </span><br><span class="line">5. 打开虚拟机的设置，在系统中的芯片组选择ICH9，在USB设备中选择USB3.0控制器。启动虚拟机，如果是windows虚拟机，可以使用360驱动大师安装USB的驱动。这一步是必须做的。</span><br><span class="line">6. 关闭虚拟机与重启宿主机。</span><br><span class="line">7. 再次打开VirtualBox，启动虚拟机，插入U盘。会发现右下角的USB设置已经可以正常识别，勾选U盘的设备。</span><br></pre></td></tr></table></figure>
<h4 id="NAT模式下宿主机与虚拟机通讯"><a href="#NAT模式下宿主机与虚拟机通讯" class="headerlink" title="NAT模式下宿主机与虚拟机通讯"></a>NAT模式下宿主机与虚拟机通讯</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下，桥接方式支持虚拟机到主机、主机到虚拟机、虚拟机到其他主机、其他主机到虚拟机以及虚拟机之间的通讯。NAT方式只支持虚拟机到主机、虚拟机到其他主机的通讯。如果需要用宿主机与虚拟</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 机通讯，就要配置Prot Forwarding。方法是在全局模式下找到Network，在其中创建一个虚拟网卡，之后在网卡中配置地址，如192.168.1.0/24，再点击Prot Forwarding，其中Host IP指宿主</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 机的IP，Guest IP指虚拟机的IP，另外，端口要配置成宿主机与虚拟机都没有使用的端口</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这相当于VirtualBox只做了SNAT，但没有做DNAT</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/11/storm概念/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/11/storm概念/" itemprop="url">
                  storm概念
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-03-11 17:00:54" itemprop="dateCreated datePublished" datetime="2019-03-11T17:00:54+08:00">2019-03-11</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-03-13 13:00:26" itemprop="dateModified" datetime="2019-03-13T13:00:26+08:00">2019-03-13</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/大数据/" itemprop="url" rel="index"><span itemprop="name">大数据</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><blockquote>
<p>Storm 是一个分布式的，可靠的，容错的数据流处理系统。它会把工作任务委托给不同类型的组件，每个组件负责处理一项简单特定的任务。Storm 集群的输入流由一个被称作 spout 的组件管理，spout 把数据传递给 bolt， bolt 要么把数据保存到某种存储器，要么把数据传递给其它的 bolt。你可以想象一下，一个 Storm 集群就是在一连串的 bolt 之间转换 spout 传过来的数据。</p>
<p>这里用一个简单的例子来说明这个概念。昨晚我在新闻节目里看到主持人在谈论政治人物和他们对于各种政治话题的立场。他们一直重复着不同的名字，而我开始考虑这些名字是否被提到了相同的次数，以及不同次数之间的偏差。</p>
<p>想像播音员读的字幕作为你的数据输入流。你可以用一个 spout 读取一个文件（或者 socket，通过 HTTP，或者别的方法）。文本行被 spout 传给一个 bolt，再被 bolt 按单词切割。单词流又被传给另一个 bolt，在这里每个单词与一张政治人名列表比较。每遇到一个匹配的名字，第二个 bolt 为这个名字在数据库的计数加1。你可以随时查询数据库查看结果， 而且这些计数是随着数据到达实时更新的。</p>
<p>现在想象一下，很容易在整个 Storm 集群定义每个 bolt 和 spout 的并行性级别，因此你可以无限的扩展你的拓扑结构。很神奇，是吗？尽管这是个简单例子，你也可以看到 Storm 的强大。</p>
</blockquote>
<h3 id="应用案例"><a href="#应用案例" class="headerlink" title="应用案例"></a>应用案例</h3><blockquote>
<ul>
<li><p>数据处理流</p>
<p>正如上例所展示的，不像其它的流处理系统，Storm 不需要中间队列。</p>
</li>
<li><p>连续计算</p>
<p>连续发送数据到客户端，使它们能够实时更新并显示结果，如网站指标。</p>
</li>
<li><p>分布式远程过程调用</p>
<p>频繁的 CPU 密集型操作并行化。</p>
</li>
</ul>
</blockquote>
<h3 id="Storm-组件"><a href="#Storm-组件" class="headerlink" title="Storm 组件"></a>Storm 组件</h3><blockquote>
<p>Storm 集群由一个主节点(也可称为控制节点)和多个工作节点组成。主节点运行一个名为“Nimbus”的守护进程，工作节点都运行一个名为“Supervisor”的守护进程，两者的协调工作由 ZooKeeper 来完成， ZooKeeper 用于管理集群中的不同组件。</p>
<p>每一个工作节点上运行的 Supervisor 监听分配给它那台机器的工作，根据需要启动 / 关闭工作进程，每一个工作进程执行一个 Topology 的一个子集；一个运行的 Topology 由运行在很多机器上的很多工作进程 Worker 组成。那么Storm 的核心就是主节点（Nimbus）、工作节点（Supervisor）、协调器（ZooKeeper）、工作进程（ Worker）、任务线程（Task）。</p>
<p>在系统底层，Storm 使用了 zeromq(0mq, zeromq(<a href="http://www.zeromq.org/" target="_blank" rel="noopener">http://www.zeromq.org</a>))。这是一种先进的，可嵌入的网络通讯库，它提供的绝妙功能使 Storm 成为可能。下面列出一些 zeromq 的特性。</p>
<ul>
<li>一个并发架构的 Socket 库</li>
<li>对于集群产品和超级计算，比 TCP 要快</li>
<li>可通过 inproc（进程内）, IPC（进程间）, TCP 和 multicast(多播协议)通信</li>
<li>异步 I / O 的可扩展的多核消息传递应用程序</li>
<li>利用扇出(fanout), 发布订阅（PUB-SUB）,管道（pipeline）, 请求应答（REQ-REP），等方式实现 N-N 连接</li>
</ul>
<p>Storm 只用了 push/pull sockets</p>
</blockquote>
<h4 id="Nimbus"><a href="#Nimbus" class="headerlink" title="Nimbus"></a>Nimbus</h4><blockquote>
<p>主节点通常运行一个后台程序——Nimbus，用于响应分布在集群中的节点，分配任务和监测故障，这类似于 Hadoop 中的 JobTracker。<br>Nimbus 进程是快速失败（ fail-fast）和无状态的，所有的状态要么在 ZooKeeper 中，要么在本地磁盘上。可以使用 kill -9 来杀死 Nimbus 进程，然后重启即可继续工作。</p>
</blockquote>
<h4 id="Supervisor"><a href="#Supervisor" class="headerlink" title="Supervisor"></a>Supervisor</h4><blockquote>
<p>工作节点同样会运行一个后台程序——Supervisor，用于收听工作指派并基于要求运行工作进程。每个工作节点都是Topology中一个子集的实现。而Nimbus 和 Supervisor 之间的协调则通过 ZooKeeper 系统。<br>同 样，Supervisor进程也是快速失败（fail-fast）和无状态的， 所有的状态要么在ZooKeeper中，要么在本地磁盘上，用kill -9来杀死Supervisor进程，然后重启就可以继续工作。这个设计使得storm不可思议的稳定。</p>
</blockquote>
<h4 id="ZooKeeper"><a href="#ZooKeeper" class="headerlink" title="ZooKeeper"></a>ZooKeeper</h4><blockquote>
<p>ZooKeeper 是完成 Nimbus 和 Supervisor 之间协调的服务。 Storm使用ZooKeeper 协调集群，由于ZooKeeper 并不用于消息传递，所以Storm给ZooKeeper 带来的压力相当低。<strong>在大多数情况下，单个节点的 ZooKeeper 集群足够胜任，不过为了确保故障恢复或者部署大规模Storm集群，可能需要更大规模的 ZooKeeper 集群</strong>。</p>
</blockquote>
<h4 id="worker"><a href="#worker" class="headerlink" title="worker"></a>worker</h4><blockquote>
<p>运行具体处理组件逻辑的进程。</p>
</blockquote>
<h4 id="Topology"><a href="#Topology" class="headerlink" title="Topology"></a>Topology</h4><blockquote>
<p>拓扑。一个Storm拓扑打包了一个实时处理程序的逻辑。一个Storm拓扑类似一个Hadoop的MapReduce任务(Job)。主要区别是MapReduce任务最终会结束，而拓扑会一直运行（当然直到你杀死它)。一个拓扑是一个通过流分组(stream grouping)把Spout和Bolt连接到一起的拓扑结构。一个拓扑就是一个复杂的多阶段的流计算。</p>
<p>所有Topology任务的提交必须在Storm客户端节点上进行(需要配置~/.storm/storm.yaml文件)，由Nimbus节点分配给其他Supervisor节点进行处理。Nimbus节点首先将提交的Topology进行分片，分成一个个的Task，并将Task和Supervisor相关的信息提交到<strong>zookeeper</strong>集群上，Supervisor会去zookeeper集群上认领自己的Task，通知自己的Worker进程进行Task的处理。总体的Topology处理流程图为：</p>
</blockquote>
<p><img src="/images/storm/topology处理流程.png" alt=""></p>
<blockquote>
<p>每个Topology都由<strong>Spout和Bolt</strong>组成，在Spout和Bolt传递信息的基本单位叫做<strong>Tuple</strong>，由Spout发出的连续不断的Tuple及其在相应Bolt上处理的子Tuple连起来称为一个<strong>Steam</strong>，每个Stream的命名是在其首个Tuple被Spout发出的时候，此时Storm会利用内部的<strong>Ackor机制</strong>保证每个Tuple可靠的被处理。</p>
<p>而Tuple可以理解成键值对，其中，键就是定义在declareStream方法中的Fields字段，而值就是在emit方法中发送的Values字段。</p>
<p>在运行Topology之前，可以通过一些参数的配置来调节运行时的状态，参数的配置是通过Storm框架部署目录下的<strong>conf/storm.yaml</strong>文件来完成的。在此文件中可以配置运行时的Storm本地目录路径、运行时Worker的数目等。</p>
<p>在代码中，也可以设置Config的一些参数，但是优先级是不同的，不同位置配置Config参数的优先级顺序为：外部组件的special configuration &gt; 内部组件的special configuration &gt; topology内部的configuration &gt; storm.yaml &gt; default.yaml</p>
</blockquote>
<h4 id="Spout"><a href="#Spout" class="headerlink" title="Spout"></a>Spout</h4><blockquote>
<p>一个在Topology中产生源数据流的组件。通常情况下Spout会从外部数据源中读取数据，然后转换为Topology内部的源数据。Spout 是一个主动的角色，其接口中有个nextTuple()函数， Storm框架会不停地调用此函数，用户只要在其中生成源数据即可。</p>
</blockquote>
<h4 id="Bolt"><a href="#Bolt" class="headerlink" title="Bolt"></a>Bolt</h4><blockquote>
<p>一个在Topology中接收由Spout或者其他上游Bolt类发来的Tuple数据然后执行处理的组件。Bolt可以执行过滤、函数操作、合并、写数据库等任何操作。Bolt是一个被动的角色，其接口中有个execute(Tuple input)函数，在接收到消息后会调用此函数，用户可以在其中执行自己想要的操作。</p>
</blockquote>
<h4 id="Task"><a href="#Task" class="headerlink" title="Task"></a>Task</h4><blockquote>
<p>Worker中每一个Spout/Bolt的线程称为一个Task。在 Storm 0.8之后，task不再与物理线程对应，同一个Spout/Bolt的Task可能会共享一个物理线程，该线程称为Executor。</p>
</blockquote>
<h4 id="Tuple"><a href="#Tuple" class="headerlink" title="Tuple"></a>Tuple</h4><blockquote>
<p>元组，一次消息传递的基本单元。</p>
</blockquote>
<h4 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h4><blockquote>
<p>源源不断传递的Tuple就组成了stream。</p>
</blockquote>
<h4 id="Stream-Grouping"><a href="#Stream-Grouping" class="headerlink" title="Stream Grouping"></a>Stream Grouping</h4><blockquote>
<p>即消息的partition方法。流分组策略告诉Topology如何在两个组件之间发送Tuple。 Storm 中提供若干种实用的grouping方式，包括shuffle, fields hash, all, global, none, direct和localOrShuffle等。</p>
<ul>
<li>ShuffleGrouping:随机分组，随机分发Stream中的tuple，保证每个Bolt的Task接收Tuple数量大致一致；</li>
<li>FieldsGrouping：按照字段分组，保证相同字段的Tuple分配到同一个Task中；</li>
<li>AllGrouping：广播发送，每一个Task都会受到所有的Tuple；</li>
<li>GlobalGrouping：全局分组，所有的Tuple都发送到同一个Task中，此时一般将当前Component的并发数目设置为1；</li>
<li>NonGrouping：不分组，和ShuffleGrouping类似，当前Task的执行会和它的被订阅者在同一个线程中执行；</li>
<li>DirectGrouping：直接分组，直接指定由某个Task来执行Tuple的处理，而且，此时必须有emitDirect方法来发送；</li>
<li>localOrShuffleGrouping：和ShuffleGrouping类似，若Bolt有多个Task在同一个进程中，Tuple会随机发给这些Task。</li>
</ul>
</blockquote>
<h3 id="Storm-的特性"><a href="#Storm-的特性" class="headerlink" title="Storm 的特性"></a>Storm 的特性</h3><blockquote>
<p>在所有这些设计思想与决策中，有一些非常棒的特性成就了独一无二的 Storm。</p>
<ul>
<li>简化编程：如果你曾试着从零开始实现实时处理，你应该明白这是一件多么痛苦的事情。使用 Storm，复杂性被大大降低了。</li>
<li>使用一门基于 JVM 的语言开发会更容易，但是你可以借助一个小的中间件，在 Storm 上使用任何语言开发。有现成的中间件可供选择，当然也可以自己开发中间件。</li>
<li>容错：Storm 集群会关注工作节点状态，如果宕机了必要的时候会重新分配任务。</li>
<li>可扩展：所有你需要为扩展集群所做的工作就是增加机器。Storm 会在新机器就绪时向它们分配任务。</li>
<li>可靠的：所有消息都可保证至少处理一次。如果出错了，消息可能处理不只一次，不过你永远不会丢失消息。</li>
<li>快速：速度是驱动 Storm 设计的一个关键因素</li>
<li>事务性：You can get exactly once messaging semantics for pretty much any computation. 你可以为几乎任何计算得到恰好一次消息语义。</li>
</ul>
</blockquote>
<h3 id="Topology运行流程"><a href="#Topology运行流程" class="headerlink" title="Topology运行流程"></a>Topology运行流程</h3><blockquote>
<p>Topology的运行可以分为<strong>本地模式</strong>和<strong>分布式模式</strong>，模式的设置可以在配置文件中设定，也可以在代码中设置。需要注意的是，在Storm代码编写完成之后，需要打包成jar包放到Nimbus中运行，打包的时候，不需要把依赖的jar都打进去，否则如果把依赖的storm.jar包打进去的话，运行时会出现重复的配置文件错误导致Topology无法运行。因为Topology运行之前，会加载本地的storm.yaml配置文件。</p>
<ul>
<li>Storm提交后，会把代码首先存放到<strong>Nimbus节点的inbox目录</strong>下，之后，会把当前Storm运行的配置生成一个<strong>stormconf.ser文件</strong>放到<strong>Nimbus节点的stormdist目录</strong>中，在此目录中同时还有<strong>序列化之后的Topology代码文件</strong>；</li>
<li>在<strong>设定Topology所关联的Spouts和Bolts</strong>时，可以同时<strong>设置当前Spout和Bolt的executor数目和task数目</strong>，默认情况下，一个Topology的task的总和是和executor的总和一致的。之后，系统根据worker的数目，尽量平均的分配这些task的执行。worker在哪个supervisor节点上运行是由storm本身决定的；</li>
<li>任务分配好之后，Nimbus节点会将任务的信息提交到<strong>zookeeper集群</strong>，同时在zookeeper集群中会有<strong>workerbeats节点</strong>，这里<strong>存储了当前Topology的所有worker进程的心跳信息</strong>；</li>
<li>Supervisor节点会不断的<strong>轮询</strong>zookeeper集群，在<strong>zookeeper的assignments节点中保存了所有Topology的任务分配信息、代码存储目录、任务之间的关联关系</strong>等，Supervisor通过轮询此节点的内容，来领取自己的任务，启动worker进程运行；</li>
<li>一个Topology运行之后，就会不断的通过Spouts来发送Stream流，通过Bolts来不断的处理接收到的Stream流，Stream流是无界的。这一步会不间断的执行，除非<strong>手动结束Topology</strong>。</li>
</ul>
</blockquote>
<h3 id="Topology并行度"><a href="#Topology并行度" class="headerlink" title="Topology并行度"></a>Topology并行度</h3><blockquote>
<ul>
<li>worker：每个worker都属于一个特定的Topology，每个Supervisor节点的worker可以有多个，每个worker使用一个单独的端口，它对Topology中的每个component运行一个或者多个executor线程来提供task的运行服务。</li>
<li>executor：executor是产生于worker进程内部的线程，会执行同一个component的一个或者多个task。</li>
<li>task：实际的数据处理由task完成，在Topology的生命周期中，每个组件的task数目是不会发生变化的，而executor的数目却不一定。executor数目小于等于task的数目，默认情况下，二者是相等的。</li>
</ul>
<p>​    在运行一个Topology时，可以根据具体的情况来设置不同数量的worker、task、executor，而<strong>设置的位置</strong>也可以在多个地方。</p>
<ul>
<li><p>worker设置：</p>
<ul>
<li>可以通过设置yaml中的topology.workers属性</li>
<li>在代码中通过<strong>Config的setNumWorkers方法设定</strong></li>
</ul>
</li>
<li><p>executor设置：</p>
<ul>
<li>通过<strong>在Topology的入口类中setBolt、setSpout方法的最后一个参数指定</strong>，不指定的话，默认为1；</li>
</ul>
</li>
<li><p>task设置：</p>
<ul>
<li>默认情况下，<strong>和executor数目一致</strong>；</li>
<li>在代码中通过<strong>TopologyBuilder的setNumTasks方法设定具体某个组件的task数目</strong>；</li>
</ul>
</li>
</ul>
</blockquote>
<p>参考：</p>
<p><a href="http://www.cnblogs.com/zlslch/p/5989256.html" target="_blank" rel="noopener">http://www.cnblogs.com/zlslch/p/5989256.html</a></p>
<p><a href="https://blog.yaodataking.com/2017/03/07/storm-2/" target="_blank" rel="noopener">https://blog.yaodataking.com/2017/03/07/storm-2/</a></p>
<p><a href="http://www.cnblogs.com/xymqx/p/4366429.html" target="_blank" rel="noopener">http://www.cnblogs.com/xymqx/p/4366429.html</a></p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left" aria-label="上一頁"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">ruopu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">159</span>
                    <span class="site-state-item-name">文章</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">30</span>
                    <span class="site-state-item-name">分類</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">124</span>
                    <span class="site-state-item-name">標籤</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ruopu</span>

  

  

  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>
  <span class="post-meta-divider">|</span>
  <span id="busuanzi_container_site_pv">
    本站总访问量: <span id="busuanzi_value_site_pv"></span>次
  </span>
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 強力驅動 v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主題 – <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Gemini</a> v6.4.0</div>





        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="訪客總數">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="總瀏覽次數">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.4.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.4.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.0"></script>



  



  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
