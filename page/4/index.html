<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-TW">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



















  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.4.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.4.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.4.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.4.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.4.0',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="ruopu&#39;s blog">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="ruopu&#39;s blog">
<meta property="og:locale" content="zh-TW">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ruopu&#39;s blog">






  <link rel="canonical" href="http://yoursite.com/page/4/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>ruopu's blog</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-TW">

  
  
    
  

  <div class="container sidebar-position-right 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ruopu's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切換導航欄">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首頁</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />標籤</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分類</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />歸檔</a>
  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜尋</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜尋..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/15/ngrok简单配置与使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/15/ngrok简单配置与使用/" itemprop="url">
                  ngrok简单配置与使用
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-11-15 17:08:50 / 修改時間：17:41:28" itemprop="dateCreated datePublished" datetime="2019-11-15T17:08:50+08:00">2019-11-15</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/网络/" itemprop="url" rel="index"><span itemprop="name">网络</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>​    ngrok是一个内网穿透的解决方案，它可以使你通过公网服务器连接到你本地的服务器</p>
<h3 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">--------------</span><br><span class="line">   公网服务器</span><br><span class="line">--------------</span><br><span class="line">yum install -y gcc git mercurial bzr subversion golang golang-pkg-windows-amd64 golang-pkg-windows-386</span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装所需包</span></span><br><span class="line">git clone https://github.com/inconshreveable/ngrok.git</span><br><span class="line"><span class="meta">#</span><span class="bash"> 克隆到本地</span></span><br></pre></td></tr></table></figure>
<h3 id="生成证书"><a href="#生成证书" class="headerlink" title="生成证书"></a>生成证书</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">cd ngrok</span><br><span class="line">mkdir cert</span><br><span class="line">cd cert</span><br><span class="line">export NGROK_DOMAIN="abc.com"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这里的域名就是你要访问的域名，需要在互联网可以解析到</span></span><br><span class="line">openssl genrsa -out rootCA.key 2048</span><br><span class="line">openssl req -x509 -new -nodes -key rootCA.key -subj "/CN=$NGROK_DOMAIN" -days 5000 -out rootCA.pem</span><br><span class="line">openssl genrsa -out device.key 2048</span><br><span class="line">openssl req -new -key device.key -subj "/CN=$NGROK_DOMAIN" -out device.csr</span><br><span class="line">openssl x509 -req -in device.csr -CA rootCA.pem -CAkey rootCA.key -CAcreateserial -out device.crt -days 5000</span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成密钥</span></span><br><span class="line">cp rootCA.pem ../assets/client/tls/ngrokroot.crt </span><br><span class="line">cp device.crt ../assets/server/tls/snakeoil.crt </span><br><span class="line">cp device.key ../assets/server/tls/snakeoil.key </span><br><span class="line"><span class="meta">#</span><span class="bash"> 将密钥复制到指定位置</span></span><br><span class="line">cd ..</span><br><span class="line">GOOS=linux GOARCH=amd64 make release-server</span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成服务端包</span></span><br><span class="line">GOOS=linux GOARCH=amd64 make release-client</span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成linux客户端名</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> windows客户端</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> GOOS=windows GOARCH=amd64 make release-client</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> GOOS=windows GOARCH=386 make release-client</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> MacOS客户端</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> GOOS=darwin GOARCH=amd64 make release-client</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> GOOS=darwin GOARCH=386 make release-client</span></span><br><span class="line">./bin/ngrokd -domain="$NGROK_DOMAIN" -httpAddr=":28080" -httpsAddr=":28443" -tunnelAddr=":24443"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定端口并启动ngrok服务，如果不指定端口，http默认端口80，https默认端口443，tunnel默认端口4443，</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> tunnel端口是服务端与客户端联系的端口</span></span><br></pre></td></tr></table></figure>
<h3 id="客户端配置"><a href="#客户端配置" class="headerlink" title="客户端配置"></a>客户端配置</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">登录服务器下载上面生成的客户端包，因为使用的是ubuntu客户端，所以下载ngrok包就可以了</span><br><span class="line">vim ngrok.cfg                                                                   </span><br><span class="line">server_addr: "abc.com:24443"</span><br><span class="line">trust_host_root_certs: false</span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加一个ngrok的配置文件，注意这个文件是yaml文件，所以对格式要求很严格。冒号与后面引号之间是有空格的。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置的配置文件可以放在家目录，叫.ngrok</span></span><br><span class="line">./ngrok -config ngrok.cfg -proto=tcp 22</span><br><span class="line"><span class="meta">#</span><span class="bash"> 这样可以启动客户端，这里用-config指定了配置文件，本地与服务器都使用tcp协议，本地监听22端口，服务器会</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 监听一个随机端口，本地要监听哪个端口，要取决于要连接的服务监听的端口，如这里要使用ssh服务，输出如下：</span></span><br><span class="line">ngrok                                                                                    </span><br><span class="line">Tunnel Status                 online   # 这里要变成online才是正常，开始是connecting</span><br><span class="line">Version                       1.7/1.7</span><br><span class="line">Forwarding                    tcp://abc.com:38139 -&gt; 127.0.0.1:22</span><br><span class="line">Web Interface                 127.0.0.1:4040</span><br><span class="line"><span class="meta">#</span><span class="bash"> Conn                        1</span></span><br><span class="line">Avg Conn Time                 24193.12ms                                               </span><br><span class="line"><span class="meta">#</span><span class="bash"> 这里有一个问题，当连接成功后，域名是没有前缀的。所有添加域名解析时，就直接解析域名即可。使用这种方法可</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 以添加不同的端口映射到本地，如3389端口。但这里的问题是，服务器一端打开的随机端口，所以每次都需要手动修</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 改安全组的配置，放开指定端口</span></span><br><span class="line"></span><br><span class="line">./ngrok -subdomain ngrok -config=./ngrok.cfg</span><br><span class="line"><span class="meta">#</span><span class="bash"> -subdomain指定域名的前缀，如域名是abc.com，那么连接后就是ngrok.abc.com，这样启动客户端后要监听80</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 端口。这里如果加了域名前缀，那么在添加域名解析时，就要在添加A记录时，添加一个泛域名解析，如*.ngrok</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/14/python基础学习-生成器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/14/python基础学习-生成器/" itemprop="url">
                  python基础学习-生成器
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-11-14 11:26:56" itemprop="dateCreated datePublished" datetime="2019-11-14T11:26:56+08:00">2019-11-14</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-12-09 12:03:44" itemprop="dateModified" datetime="2019-12-09T12:03:44+08:00">2019-12-09</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><ul>
<li>生成器 generator ***<ul>
<li>生成器指的是生成器对象，可以由生成器表达式得到，也可以使用yield关键字得到一个生成器函数，调用这个函数得到一个生成器对象</li>
</ul>
</li>
<li>生成器函数<ul>
<li>函数体中包含yield语句的函数就是生成器函数，返回生成器对象</li>
<li>生成器对象，是一个可迭代对象，是一个迭代器。迭代器一定是一个可迭代对象，但可迭代对象不一定是迭代器</li>
<li>生成器对象，是延迟计算、惰性求值的</li>
<li>包含yield语句的生成器函数生成<strong><em>生成器对象</em></strong>的时候，<strong><em>生成器函数的函数体不会立即执行</em></strong></li>
<li>next(generator)会从函数的当前位置向后执行到之后碰到的第一个yield语句，会弹出值，并暂停函数执行</li>
<li>再次调用next函数，和上一条一样的处理过程</li>
<li>没有多余的yield语句能被执行，继续调用next函数，会抛出StopIteration异常</li>
<li>通过生成器表达式或生成器函数就可以得到一个生成器对象或简称生成器</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inc</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">yield</span> i</span><br><span class="line"></span><br><span class="line">print(type(inc))   <span class="comment"># 返回函数类型，因为inc是标识符</span></span><br><span class="line">print(type(inc()))   <span class="comment"># 返回值是generator类型，是生成器对象</span></span><br><span class="line"></span><br><span class="line">x = inc()</span><br><span class="line">print(type(x))</span><br><span class="line">print(next(x))</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> x:</span><br><span class="line">    print(m,<span class="string">'*'</span>)</span><br><span class="line"><span class="keyword">for</span> m <span class="keyword">in</span> x:  <span class="comment"># 不会进入这里执行</span></span><br><span class="line">    print(m,<span class="string">'**'</span>)</span><br><span class="line">输出：</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">function</span>'&gt;</span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">generator</span>'&gt;</span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">generator</span>'&gt;</span></span><br><span class="line"><span class="class">0</span></span><br><span class="line"><span class="class">1 *</span></span><br><span class="line"><span class="class">2 *</span></span><br><span class="line"><span class="class">3 *</span></span><br><span class="line"><span class="class">4 *</span></span><br><span class="line"><span class="class"># 普通的函数调用<span class="title">fn</span><span class="params">()</span>，函数会立即执行完毕，因为用的是<span class="title">return</span>语句，但是生成器函数可以使用<span class="title">next</span>函数多次执行</span></span><br><span class="line"><span class="class"># 生成器函数等价于生成器表达式，只不过生成器函数可以更加的复杂。</span></span><br><span class="line"><span class="class"></span></span><br><span class="line">y = (i for i in range(5))</span><br><span class="line">print(type(y))</span><br><span class="line">print(type(y))</span><br><span class="line">print(type(y))</span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">'line 1'</span>)</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line">    print(<span class="string">'line 2'</span>)</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line">    print(<span class="string">'line 3'</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">3</span>    <span class="comment"># 生成器内一般不会加return语句</span></span><br><span class="line"></span><br><span class="line">next(gen())  <span class="comment"># line 1 遇到yield暂停，之后跳到下一句next(gen())执行</span></span><br><span class="line"><span class="comment"># 有yiele语句就会是一个生成器，这里调用一次这个gen()函数，就会返回一个生成器对象，生成器对象要拨一下转</span></span><br><span class="line"><span class="comment"># 一下，转到第一次遇到yield的时候，会返回1给next()，但我们不关心，print函数第一次返回line 1。</span></span><br><span class="line"><span class="comment"># 遇到yield语句就要暂停一下，yield语句就是拨一下转一下，是next函数在拨它，执行到第一次碰到yield为止。</span></span><br><span class="line"><span class="comment"># 所以第一次返回line 1，这个返回值我们是可以拿到的。(***return会终止当前函数执行，yield不会终止当前</span></span><br><span class="line"><span class="comment"># 函数执行，而是暂停到yield，这个暂停很特别，一般地如果一个函数没有执行完是不能执行下一句的。但这里没有</span></span><br><span class="line"><span class="comment"># 执行完gen()函数，而直接跳到了下一个gen()函数去执行了。***)yield有让出的意思，这里yield就让出了函</span></span><br><span class="line"><span class="comment"># 数，让出了当前的控制，给下一个语句，这里就是让给下一个next(gen())执行，让出给谁并不重要。所以执行第</span></span><br><span class="line"><span class="comment"># 二次gen()又生成了一个生成器，之后又重新开始执行，这是一个新的gen()函数调用，所以还是返回line 1。函</span></span><br><span class="line"><span class="comment"># 数随着调用的结束而消亡了，所以第二次调用会重新开始。</span></span><br><span class="line">next(gen())  <span class="comment"># line 1 </span></span><br><span class="line">g = gen()  <span class="comment"># 这里是第三次生成一个生成器对象并赋给了变量g</span></span><br><span class="line">print(next(g)) </span><br><span class="line"><span class="comment"># line 1   # 执行到这里先打印一个line 1，然后 yield返回一个1，这回next(g)是拨同一个生成器对象了，</span></span><br><span class="line"><span class="comment"># 因为用print包裹起来了，所以还会打印一个1，</span></span><br><span class="line"><span class="comment"># print </span></span><br><span class="line">print(next(g)) <span class="comment"># line 2  # 这里是又拨了g函数一下，所以找下一个yield，先打印line 2，再打印2</span></span><br><span class="line">print(next(g))  <span class="comment"># StopIteration  这里先打印一个line 3，之后没有yield了，而且我们使用了next</span></span><br><span class="line"><span class="comment"># 函数调用，next函数是找下一个yield的，也就是找下一个生成器对象的值的，而不是找return的，因为找不到</span></span><br><span class="line"><span class="comment"># yield，所以返回StopIteration。最后一句也不会执行了。如果注释这一行就不会报错了，因为next是找下一个</span></span><br><span class="line"><span class="comment"># yield的，但没有了，这里会抛异常，但我们给了一个缺省值'End'，所以打印‘End'，而不会抛异常</span></span><br><span class="line">print(next(g, <span class="string">'End'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 一个生成器函数中，可以有多个yield表达式或return语句，碰到return，这个函数就结束了，但生成器对象还</span></span><br><span class="line"><span class="comment"># 在，因为引用还在，但每一次next都是要找到下一个yield</span></span><br><span class="line"><span class="comment"># 这里为什么用next()调用就会重新调用函数，一直返回line 1，而用print(next())就会在函数中继续向下执</span></span><br><span class="line"><span class="comment"># 行？这与g = gen()有关系，这一句是将gen()函数调用的值都赋给了g，而且是一个generator类型，用next()</span></span><br><span class="line"><span class="comment"># 一直取g的下一个值，所以会显示line 1 1 line 2 2。如果用print(next(gen()))，这一样会一直显示line 1</span></span><br><span class="line">- 在生成器函数中，使用多个<span class="keyword">yield</span>语句，执行一次后会暂停执行，把<span class="keyword">yield</span>表达式的值返回</span><br><span class="line">- 再次执行会执行到下一个<span class="keyword">yield</span>语句</span><br><span class="line">- <span class="keyword">return</span>语句依然可以终止函数运行，但<span class="keyword">return</span>语句的返回值不能被获取到</span><br><span class="line">- <span class="keyword">return</span>会导致无法继续获取下一个值，抛出StopIteration异常</span><br><span class="line">- 如果函数没有显示的<span class="keyword">return</span>语句，如果生成器函数执行到结尾，一样会抛出StopIteration异常</span><br></pre></td></tr></table></figure>
<h3 id="生成器应用"><a href="#生成器应用" class="headerlink" title="生成器应用"></a>生成器应用</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 无限循环</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">()</span>:</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">yield</span> i</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inc</span><span class="params">(c)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> next(c)</span><br><span class="line">c = counter()</span><br><span class="line">print(inc(c))</span><br><span class="line">print(inc(c))</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">()</span>:</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        <span class="keyword">yield</span> i</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inc</span><span class="params">()</span>:</span></span><br><span class="line">    c = counter()</span><br><span class="line">    <span class="keyword">return</span> next(c)</span><br><span class="line"></span><br><span class="line">print(inc())</span><br><span class="line">print(inc())</span><br><span class="line">print(inc())</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="comment"># 执行了三次print(inc())，因为每次都创建一个生成器对象inc()，所以并不是同一个生成器对象，所以打印三次1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计数器</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inc</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">()</span>:</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">yield</span> i</span><br><span class="line">    c = counter()</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">lambda</span>:next(c)   <span class="comment"># c对于lambda来讲是自由变量，这里是一个闭包</span></span><br><span class="line">foo = inc()</span><br><span class="line">print(foo())</span><br><span class="line">print(foo())</span><br><span class="line"><span class="comment"># inc()函数调用的返回值是lambda:next(c)，lambda:next(c)不是生成器而只是拨了一下c，</span></span><br><span class="line"><span class="comment"># lambda:next(c)是一个新的函数，新的函数中并没有yield语句。counter()才是生成器函数。c是生成器对象，</span></span><br><span class="line"><span class="comment"># 我们在lambda函数中拨它，所以foo只是lambda函数的引用值，之后再调用 foo()函数，这相当于在拨c，所以这里输出1和2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># lambda表达式是匿名函数</span></span><br><span class="line"><span class="comment"># return返回的是一个匿名函数</span></span><br><span class="line"><span class="comment"># 等价于下面的代码</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inc</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">()</span>:</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            <span class="keyword">yield</span> i</span><br><span class="line">   c = counter()</span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">_inc</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">return</span> next(c)</span><br><span class="line">   <span class="keyword">return</span> _inc</span><br><span class="line"><span class="comment"># 上面三行相当于之前的lambda:next(c)</span></span><br><span class="line">foo = inc()</span><br><span class="line">print(foo())</span><br><span class="line">print(foo())</span><br><span class="line">print(foo())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理递归问题</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">()</span>:</span></span><br><span class="line">    x = <span class="number">0</span> </span><br><span class="line">    y = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">yield</span> y</span><br><span class="line">        x,y = y,x+y</span><br><span class="line">        </span><br><span class="line">foo = fib()</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">    print(next(foo))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    next(foo)</span><br><span class="line">print(next(foo))    </span><br><span class="line"><span class="comment"># 等价于下面的代码</span></span><br><span class="line">pre = <span class="number">0</span></span><br><span class="line">cur = <span class="number">1</span>  <span class="comment"># No1</span></span><br><span class="line">print(pre,cur,end=<span class="string">' '</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># recursion</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib1</span><span class="params">(n,pre=<span class="number">0</span>,cur=<span class="number">1</span>)</span>:</span></span><br><span class="line">    pre,cur = cur,pre+cur</span><br><span class="line">    print(cur,end=<span class="string">' '</span>)</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    fib1(n<span class="number">-1</span>,pre,cur)</span><br></pre></td></tr></table></figure>
<ul>
<li>协程 coroutine<ul>
<li>生成器的高级用法</li>
<li>比进程、线程轻量级</li>
<li>是在用户空间调度函数的一种实现</li>
<li>Python3 asyncio就是协程实现，已经加入到标准库</li>
<li>Python3.5 使用 async、await关键字直接原生支持协程</li>
<li>协程调度器实现思路<ul>
<li>有2个生成器A、B</li>
<li>next(A)后，A执行到了yield语句暂停，然后去执行next(B)，B执行到yield语句也暂停，然后再次调用 next(A)，再调用next(B)，周而复始，就实现了调度的效果</li>
<li>可以引入调度的策略来实现切换的方式</li>
</ul>
</li>
<li>协程是一种非抢占式调度</li>
</ul>
</li>
</ul>
<h3 id="yield-from"><a href="#yield-from" class="headerlink" title="yield from"></a>yield from</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inc</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">1000</span>):</span><br><span class="line">        <span class="keyword">yield</span> x</span><br><span class="line">        </span><br><span class="line">foo = inc()</span><br><span class="line">print(next(foo))</span><br><span class="line">print(next(foo))</span><br><span class="line">print(next(foo))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 等价于下面的代码</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inc</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="keyword">from</span> range(<span class="number">1000</span>)</span><br><span class="line">    <span class="comment"># 这一种代码相当于上面的for循环的两句代码</span></span><br><span class="line">foo = inc()</span><br><span class="line">print(next(foo))</span><br><span class="line">print(next(foo))</span><br><span class="line">print(next(foo))</span><br></pre></td></tr></table></figure>
<ul>
<li><p>yield from是Python3出现的新的语法</p>
</li>
<li><p>yield from iterable 是 for item in iterable: yield item 形式的语法糖</p>
<ul>
<li>从可迭代对象中一个个拿元素</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">(n)</span>:</span>   <span class="comment"># 生成器、迭代器</span></span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> range(n):</span><br><span class="line">		<span class="keyword">yield</span> x</span><br><span class="line">          </span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">inc</span><span class="params">(n)</span>:</span></span><br><span class="line">		<span class="keyword">yield</span> <span class="keyword">from</span> counter(n)</span><br><span class="line">          </span><br><span class="line">foo = inc(<span class="number">10</span>)</span><br><span class="line">print(next(foo))</span><br><span class="line">print(next(foo))</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/13/python基础学习-匿名函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/13/python基础学习-匿名函数/" itemprop="url">
                  python基础学习-匿名函数
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-11-13 13:50:23" itemprop="dateCreated datePublished" datetime="2019-11-13T13:50:23+08:00">2019-11-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-11-15 08:46:05" itemprop="dateModified" datetime="2019-11-15T08:46:05+08:00">2019-11-15</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h3><ul>
<li>匿名，即没有名字</li>
<li>匿名函数，即没有名字的函数<ul>
<li>没有名字如何定义</li>
<li>没有名字如何调用</li>
<li>如果能调用，如何使用</li>
</ul>
</li>
<li>python借助Lambda表达式构建匿名函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">语法：<span class="keyword">lambda</span> 参数列表: 表达式</span><br><span class="line"><span class="keyword">lambda</span> x:x**<span class="number">2</span></span><br><span class="line">(<span class="keyword">lambda</span> x:x**<span class="number">2</span>)(<span class="number">4</span>)  <span class="comment"># 调用</span></span><br><span class="line">输出：<span class="number">16</span></span><br><span class="line">foo = <span class="keyword">lambda</span> x,y:(x+y)**<span class="number">2</span>  <span class="comment"># 不推荐这么用</span></span><br><span class="line">foo(<span class="number">2</span>,<span class="number">1</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(x,y)</span>:</span>  <span class="comment"># 建议使用普通函数</span></span><br><span class="line">    <span class="keyword">return</span>(x+y)**<span class="number">2</span></span><br><span class="line">foo(<span class="number">2</span>,<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>使用lambda关键字来定义匿名函数</li>
<li>参数列表不需要小括号</li>
<li>冒号是用来分割参数列表和表达式的</li>
<li>不需要使用return，表达式的值，就是匿名函数返回值</li>
<li>lambda表达式(匿名函数)只能写在一行上，被称为单行函数</li>
<li>用途<ul>
<li>在高阶函数传参时，使用lambda表达式，往往能简化代码</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">lst = [<span class="number">1</span>]</span><br><span class="line"><span class="comment"># lst.sort?</span></span><br><span class="line"><span class="comment"># key=None,reverse=False</span></span><br><span class="line">lst.sort(key=str)</span><br><span class="line">lst.append(<span class="string">'a'</span>)</span><br><span class="line"><span class="comment"># lst.sort()</span></span><br><span class="line"><span class="comment"># 没办法比较，因为类型不一样，需要统一类型</span></span><br><span class="line">lst.sort(key=str)   <span class="comment"># 送进去一个函数，和lambda函数一样，都是送进去函数</span></span><br><span class="line">lst.append(<span class="number">2</span>)</span><br><span class="line">lst.sort(key=str)   <span class="comment"># 这里key就是向进传函数的</span></span><br><span class="line">lst </span><br><span class="line"></span><br><span class="line">print((<span class="keyword">lambda</span> :<span class="number">0</span>)())</span><br><span class="line"><span class="comment"># 上面一句相当于</span></span><br><span class="line"><span class="comment"># def fn():</span></span><br><span class="line"><span class="comment">#     return 0</span></span><br><span class="line">print((<span class="keyword">lambda</span> x,y=<span class="number">3</span>:x+y)(<span class="number">5</span>))</span><br><span class="line">print((<span class="keyword">lambda</span> x,y=<span class="number">3</span>:x+y)(<span class="number">5</span>,<span class="number">6</span>))</span><br><span class="line">输出：<span class="number">11</span></span><br><span class="line">print((<span class="keyword">lambda</span> x,*,y=<span class="number">30</span>:x+y)(<span class="number">5</span>))</span><br><span class="line">输出：<span class="number">35</span></span><br><span class="line">print((<span class="keyword">lambda</span> x,*,y=<span class="number">30</span>:x+y)(<span class="number">5</span>,y=<span class="number">10</span>))</span><br><span class="line">输出：<span class="number">15</span></span><br><span class="line">print((<span class="keyword">lambda</span> *args:(x <span class="keyword">for</span> x <span class="keyword">in</span> args))(*range(<span class="number">5</span>)))</span><br><span class="line">输出：&lt;generator object &lt;<span class="keyword">lambda</span>&gt;.&lt;locals&gt;.&lt;genexpr&gt; at <span class="number">0x7f056cf7c138</span>&gt;</span><br><span class="line">print((<span class="keyword">lambda</span> *args:[x+<span class="number">1</span> <span class="keyword">for</span> x <span class="keyword">in</span> args])(*range(<span class="number">5</span>)))</span><br><span class="line">输出：[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">print((<span class="keyword">lambda</span> *args:&#123;x+<span class="number">2</span> <span class="keyword">for</span> x <span class="keyword">in</span> args&#125;)(*range(<span class="number">5</span>)))</span><br><span class="line">输出：&#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>&#125;</span><br><span class="line">[x <span class="keyword">for</span> x <span class="keyword">in</span> (<span class="keyword">lambda</span> *args:map(<span class="keyword">lambda</span> x:x+<span class="number">1</span>,args))(*range(<span class="number">5</span>))]  <span class="comment"># 高阶函数</span></span><br><span class="line">标准输出：Out:[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">[x <span class="keyword">for</span> x <span class="keyword">in</span> (<span class="keyword">lambda</span> *args:map(<span class="keyword">lambda</span> x:(x+<span class="number">1</span>,args),args))(*range(<span class="number">5</span>))]</span><br><span class="line">标准输出：</span><br><span class="line">Out:[(<span class="number">1</span>, (<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)),</span><br><span class="line"> 	 (<span class="number">2</span>, (<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)),</span><br><span class="line"> 	 (<span class="number">3</span>, (<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)),</span><br><span class="line"> 	 (<span class="number">4</span>, (<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>)),</span><br><span class="line"> 	 (<span class="number">5</span>, (<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>))]</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/13/python基础练习-递归函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/13/python基础练习-递归函数/" itemprop="url">
                  python基础练习-递归函数
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-11-13 09:48:30" itemprop="dateCreated datePublished" datetime="2019-11-13T09:48:30+08:00">2019-11-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-11-15 09:13:51" itemprop="dateModified" datetime="2019-11-15T09:13:51+08:00">2019-11-15</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>求n的阶乘</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(num)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> num == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> num * func(num<span class="number">-1</span>)</span><br><span class="line">    <span class="comment"># 这是阶乘的关键，也是公式，就是总是自已乘以比自己小1的数</span></span><br><span class="line"></span><br><span class="line">func(<span class="number">5</span>)</span><br><span class="line"><span class="comment"># 执行过程是，进入函数后，直接到num * func(num-1)这一行。代入数字就是5*func(4)，func(4)再进入函</span></span><br><span class="line"><span class="comment"># 数，返回4*fun(3)，之后是3*func(2)，2*func(1)，再进入函数时，num等于1了，所以返回1。把1代入</span></span><br><span class="line"><span class="comment"># 2*func(1)，也就是2*1=2，再向上返回到3×func(2)，因为之前func(2)已经返回了2，所以这里是3*2=6，再</span></span><br><span class="line"><span class="comment"># 向上返回，代入后是4*6=24，再向上，5*24=120，这样阶乘的结果就出来了。返回条件是当条件满足时返回一个</span></span><br><span class="line"><span class="comment"># 值，之后依次向前返回并计算</span></span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factorial</span><span class="params">(n,mu1 = <span class="number">1</span>)</span>:</span></span><br><span class="line">    mu1 *= n   </span><br><span class="line"><span class="comment"># 当前乘以当前值就完了，如果调用时n给了2，那么这里就是1*2。这里又重新给mu1赋了值，那么这时mu1就是2了</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:   <span class="comment"># 这是边界条件</span></span><br><span class="line">        <span class="keyword">return</span> mu1</span><br><span class="line">    <span class="keyword">return</span> factorial(n<span class="number">-1</span>,mu1)   </span><br><span class="line"><span class="comment"># 调用自己，这时n-1=1，mu1=2，这样再进入函数时，mul=2*1=2，n等于1,满足了条件，就会返回mu1的2</span></span><br><span class="line"></span><br><span class="line">factorial(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fac</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> n * fac(n<span class="number">-1</span>)</span><br><span class="line">fac(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fac1</span><span class="params">(n,p = <span class="number">1</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> p</span><br><span class="line">    p *= n</span><br><span class="line">    print(p)</span><br><span class="line">    fac1(n<span class="number">-1</span>,p)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line">fac1(<span class="number">5</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">20</span></span><br><span class="line"><span class="number">60</span></span><br><span class="line"><span class="number">120</span></span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fac2</span><span class="params">(n, p = None)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> p <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        p = [<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> p[<span class="number">0</span>]</span><br><span class="line">    p[<span class="number">0</span>] *= n</span><br><span class="line">    print(p[<span class="number">0</span>])</span><br><span class="line">    fac2(n<span class="number">-1</span>,p)</span><br><span class="line">    <span class="keyword">return</span> p</span><br><span class="line"></span><br><span class="line">n =<span class="number">5</span></span><br><span class="line">print(fac2(n))</span><br><span class="line">输出：</span><br><span class="line"><span class="number">5</span></span><br><span class="line"><span class="number">20</span></span><br><span class="line"><span class="number">60</span></span><br><span class="line"><span class="number">120</span></span><br><span class="line">[<span class="number">120</span>]</span><br><span class="line"><span class="comment"># fac函数性能最好，因为时间复杂度是相同的，fac最简单</span></span><br></pre></td></tr></table></figure>
<ul>
<li>将一个数逆序放入列表中，例如1234 -&gt; [4,3,2,1]</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 把1234改为4321</span></span><br><span class="line">data = str(<span class="number">1234</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reversal</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">-1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> data[x] + reversal(x<span class="number">-1</span>)   </span><br><span class="line"><span class="comment"># 这是一个字符串连接，最后一次return出去。这个return才是我们可以拿到的值，上面的return是拿不到的</span></span><br><span class="line">    </span><br><span class="line">print(reversal(len(data)<span class="number">-1</span>))</span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse</span><span class="params">(n,lst=None)</span>:</span>  <span class="comment"># lst=None应该改为一个[]</span></span><br><span class="line">    <span class="keyword">if</span> lst <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        lst = []</span><br><span class="line">        </span><br><span class="line">    lst.append(n%<span class="number">10</span>)   <span class="comment"># 这里可以用divmod函数，可以拿到商和模两个数</span></span><br><span class="line">    <span class="keyword">if</span> n//<span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> lst</span><br><span class="line">    <span class="keyword">return</span> reverse(n//<span class="number">10</span>,lst)</span><br><span class="line"></span><br><span class="line">reverse(<span class="number">12345</span>)</span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line"></span><br><span class="line">data = str(<span class="number">1234</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">revert</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">-1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">''</span></span><br><span class="line">    <span class="keyword">return</span> data[x] + revert(x<span class="number">-1</span>)</span><br><span class="line">print(revert(len(data)<span class="number">-1</span>))</span><br><span class="line">输出：</span><br><span class="line"><span class="number">4321</span></span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">revert</span><span class="params">(n,lst=None)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> lst <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        lst = []</span><br><span class="line">        </span><br><span class="line">    x,y = divmod(n,<span class="number">10</span>)</span><br><span class="line">    lst.append(y)</span><br><span class="line">    <span class="keyword">if</span> x == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> lst</span><br><span class="line">    <span class="keyword">return</span> revert(x,lst)</span><br><span class="line"></span><br><span class="line">revert(<span class="number">12345</span>)</span><br><span class="line">输出：</span><br><span class="line">[<span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line"></span><br><span class="line">num = <span class="number">1234</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">revert</span><span class="params">(num,target=[])</span>:</span>  <span class="comment"># 这里的target不是关键字参数，而是位置参数</span></span><br><span class="line">    <span class="keyword">if</span> num:  <span class="comment"># 表示当num为空时，是false，就不满足条件了</span></span><br><span class="line">        target.append(num[len(num)<span class="number">-1</span>])  <span class="comment"># target.append(num[-1:])  因为使用了切片，所以有一个copy的过程</span></span><br><span class="line">        revert(num[:len(num)<span class="number">-1</span>])</span><br><span class="line">    <span class="keyword">return</span> target   <span class="comment"># 里面return多少次都没有关系。我们只关心最外层的return出的内容</span></span><br><span class="line"></span><br><span class="line">print(revert(str(num)))</span><br><span class="line">输出：</span><br><span class="line">[<span class="string">'4'</span>, <span class="string">'3'</span>, <span class="string">'2'</span>, <span class="string">'1'</span>]</span><br></pre></td></tr></table></figure>
<ul>
<li>解决猴子吃桃问题。猴子第一天摘下若干个桃子，当即吃了一半，还不过瘾，又多吃了一个。第二天早上又将剩下的桃子吃掉一半，又多吃了一个。以后每天早上都吃了前一天剩下的一半零一个。到第10天早上想吃时，只剩下一个桃子了。求第一天共摘多少个桃子</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 发现公式：(后一天的桃子数量+1) * 2 = 前一天的桃子数量</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">peach</span><span class="params">(day=<span class="number">9</span>,sum=<span class="number">1</span>)</span>:</span></span><br><span class="line">    sum=<span class="number">2</span>*(sum+<span class="number">1</span>)</span><br><span class="line">    day-=<span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> day==<span class="number">0</span>:   <span class="comment"># 要循环10次，所以这里要到0</span></span><br><span class="line">        <span class="keyword">return</span> sum</span><br><span class="line">    <span class="keyword">return</span> peach(day,sum)</span><br><span class="line">print(peach())</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1534</span></span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">monkey</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">2</span> * monkey(n - <span class="number">1</span>) + <span class="number">2</span></span><br><span class="line"></span><br><span class="line">peach = monkey(<span class="number">10</span>)</span><br><span class="line">print(peach)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1534</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">10</span>,<span class="number">0</span>,<span class="number">-1</span>):   </span><br><span class="line">    <span class="comment"># 这里的range()一定要写成这种形式，不然会超出递归最大深度，主要因为这里如果是0就会成为列循环</span></span><br><span class="line">    print(_,<span class="string">"-&gt;"</span>,monkey(_))</span><br><span class="line">输出：</span><br><span class="line">10 -&gt; 1534</span><br><span class="line">9 -&gt; 766</span><br><span class="line">8 -&gt; 382</span><br><span class="line">7 -&gt; 190</span><br><span class="line">6 -&gt; 94</span><br><span class="line">5 -&gt; 46</span><br><span class="line">4 -&gt; 22</span><br><span class="line">3 -&gt; 10</span><br><span class="line">2 -&gt; 4</span><br><span class="line">1 -&gt; 1</span><br><span class="line">=======================================================================================</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">peach</span><span class="params">(days=<span class="number">10</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> days == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> (peach(days<span class="number">-1</span>)+<span class="number">1</span>)*<span class="number">2</span></span><br><span class="line"></span><br><span class="line">print(peach())</span><br><span class="line"><span class="comment"># 注意这里必须是10，因为return(peach(days-1)+1)*2立即拿不到结果，必须通过再一次进入函数时判断是不是</span></span><br><span class="line"><span class="comment"># 到了最后一天。也就是当前使用的值是由下一次函数调用得到，所以要执行10次函数调用</span></span><br><span class="line"></span><br><span class="line">=======================================================================================</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">peach</span><span class="params">(days=<span class="number">1</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> days == <span class="number">10</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> (peach(days+<span class="number">1</span>)+<span class="number">1</span>)*<span class="number">2</span></span><br><span class="line"></span><br><span class="line">print(peach())</span><br></pre></td></tr></table></figure>
<ul>
<li>递归调用对比</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="comment"># Fib Seq</span></span><br><span class="line">start = datetime.datetime.now()</span><br><span class="line">pre = <span class="number">0</span></span><br><span class="line">cur = <span class="number">1</span> <span class="comment"># No1</span></span><br><span class="line">print(pre, cur, end=<span class="string">' '</span>)</span><br><span class="line">n = <span class="number">35</span></span><br><span class="line"><span class="comment"># loop</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">    pre, cur = cur, pre + cur</span><br><span class="line">    print(cur, end=<span class="string">' '</span>)</span><br><span class="line">delta = (datetime.datetime.now() - start).total_seconds()</span><br><span class="line">print(delta)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Fib Seq</span></span><br><span class="line">start = datetime.datetime.now()</span><br><span class="line">pre = <span class="number">0</span></span><br><span class="line">cur = <span class="number">1</span> <span class="comment"># No1</span></span><br><span class="line">print(pre, cur, end=<span class="string">' '</span>)</span><br><span class="line"><span class="comment"># recursion</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib1</span><span class="params">(n, pre=<span class="number">0</span>,cur=<span class="number">1</span>)</span>:</span></span><br><span class="line">    pre, cur = cur, pre + cur</span><br><span class="line">    print(cur, end=<span class="string">' '</span>)</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    fib1(n<span class="number">-1</span>, pre, cur)</span><br><span class="line"></span><br><span class="line">fib1(n)</span><br><span class="line">delta = (datetime.datetime.now() - start</span><br><span class="line">         ).total_seconds()</span><br><span class="line">print(delta)</span><br><span class="line"></span><br><span class="line">start = datetime.datetime.now()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib2</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> n &lt; <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> fib2(n<span class="number">-1</span>) + fib2(n<span class="number">-2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">    print(fib2(i), end=<span class="string">' '</span>)</span><br><span class="line">delta = (datetime.datetime.now() - start).total_seconds()</span><br><span class="line">print(delta)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/12/python基础学习-递归函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/12/python基础学习-递归函数/" itemprop="url">
                  python基础学习-递归函数
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-11-12 18:04:35" itemprop="dateCreated datePublished" datetime="2019-11-12T18:04:35+08:00">2019-11-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-11-14 10:14:09" itemprop="dateModified" datetime="2019-11-14T10:14:09+08:00">2019-11-14</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="函数执行流程"><a href="#函数执行流程" class="headerlink" title="函数执行流程"></a>函数执行流程</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># http://pythontutor.com/visualize.html#mode=edit</span></span><br><span class="line"><span class="comment"># 建议自己想像函数执行流程，先不要去上面的网站上看</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo1</span><span class="params">(b,b1=<span class="number">3</span>)</span>:</span></span><br><span class="line">    print(<span class="string">"foo1 called"</span>,b,b1)</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo2</span><span class="params">(c)</span>:</span></span><br><span class="line">    foo3(c)</span><br><span class="line">    print(<span class="string">"foo2 called"</span>,c)</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo3</span><span class="params">(d)</span>:</span></span><br><span class="line">    print(<span class="string">"foo3 called"</span>,d)</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"main called"</span>)</span><br><span class="line">    foo1(<span class="number">100</span>,<span class="number">101</span>)</span><br><span class="line">    foo2(<span class="number">200</span>)</span><br><span class="line">    print(<span class="string">"main ending"</span>)</span><br><span class="line">    </span><br><span class="line">main()</span><br></pre></td></tr></table></figure>
<p><img src="/images/python递归函数/函数执行流程1.png" alt=""></p>
<ul>
<li>全局帧中生成foo1、foo2、foo3、main函数对象</li>
<li>main函数调用</li>
<li>main中查找内建函数print压栈，将常量字符串压栈，调用函数，弹出栈顶</li>
<li>main中全局查找函数foo1压栈，将常量100、101压栈，调用函数foo1，创建栈帧。print函数压栈，字符串和变量b、b1压栈，调用函数，弹出栈顶，返回值</li>
<li>main中全局查找foo2函数压栈，将常量200压栈，调用foo2，创建栈帧。foo3函数压栈，变量c引用压栈，调用foo3，创建栈帧。foo3完成print函数调用后返回。foo2恢复调用，执行print后，返回值。main中foo2调用结束弹出栈顶。main继续执行print函数调用，弹出栈顶。main函数返回。</li>
<li>内存中分栈和堆，对函数来讲，它有一个栈，栈就是落盘子，只能从上面拿。栈是一个内存区域，它一直不停在被使用。它是一个先进后出，后进先出的。谁在压栈，谁就在使用内存，内存中的其他数据会先保存起来，保存起来以后给它压下去，之后再把print()压在它上面。这里指PPT中的代码def main(): print(“main called”)一段。这样当前就是print环境了，然后将字符常量也压到栈里。调用函数就是print()真的要执行了，它会把print()栈内的所有数据依次拿出来执行，执行完以后，栈上的数据就依次拿完了，它刚压进去的数据就消耗完了，这时print就可以弹出了，print一弹出，之前有为main保存的数据，依次再加载起来。main函数就可以继续执行了。之后在main中查找foo1并压栈，将常量100、101压栈。要依次用掉函数内的数据。在栈内要创建一段，这一段叫帧，因为在栈上，所以叫栈帧。函数的执行过程就是压栈与弹出的过程</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字节码不是重点，当对语言掌握的很好了，写程序没问题了，再来了解字节码</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo1</span><span class="params">(b, b1=<span class="number">3</span>)</span>:</span></span><br><span class="line">    print(<span class="string">"foo1 called"</span>, b, b1)</span><br><span class="line">    foo2(<span class="number">2</span>)</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo2</span><span class="params">(A)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># foo1字节码</span></span><br><span class="line"><span class="number">4</span>          <span class="number">0</span> LOAD_GLOBAL             <span class="number">0</span> (<span class="keyword">print</span>)</span><br><span class="line">           <span class="number">3</span> LOAD_CONST              <span class="number">1</span> (<span class="string">'foo1 called)</span></span><br><span class="line"><span class="string">           6 LOAD_FAST               0 (b)</span></span><br><span class="line"><span class="string">           9 LOAD_FAST               1 (b1)</span></span><br><span class="line"><span class="string">          12 CALL_FUNCTION           3 (1 positional, 0 keyword pair)</span></span><br><span class="line"><span class="string">          函数调用，调用完成后，弹出所有函数参数，函数本身关闭堆栈，并推送返回值</span></span><br><span class="line"><span class="string">          15 POP_TOP  # 删除顶部(TOS)项目</span></span><br><span class="line"><span class="string">          </span></span><br><span class="line"><span class="string">5         16 LOAD_GLOBAL             1 (foo2)</span></span><br><span class="line"><span class="string">          19 LOAD_CONST              2 (2)</span></span><br><span class="line"><span class="string">          22 CALL_FUNCTION           1 (1 positional, 0 keyword pair)</span></span><br><span class="line"><span class="string">          25 POP_TOP           </span></span><br><span class="line"><span class="string">          26 LOAD_CONST              0 (None)   # 这两行是foo1的返回值，None这个空值是一个常量，所以是LOAD_CONST</span></span><br><span class="line"><span class="string">          29 RETURN_VALUE</span></span><br><span class="line"><span class="string"># python中所有函数都有返回值</span></span><br></pre></td></tr></table></figure>
<h3 id="递归Recursion"><a href="#递归Recursion" class="headerlink" title="递归Recursion"></a>递归Recursion</h3><ul>
<li>函数直接或者间接调用自身就是递归</li>
<li>递归需要有边界条件、递归前进段、递归返回段</li>
<li>递归一定要有边界条件</li>
<li>当边界条件不满足的时候，递归前进</li>
<li><p>当边界条件满足的时候，递归返回</p>
</li>
<li><p>斐波那契数列 Fibonacci number: 1,1,2,3,5,8,13,21,34,55,89,144, …</p>
</li>
<li>如果设F(n) 为该数列的第n项，那么这句话可以写成如下形式：F(n)=F(n-1)+F(n-2)</li>
<li>F(0)=0，F(1)=1，F(n)=F(n-1)+F(n-2)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">pre = <span class="number">0</span></span><br><span class="line">cur = <span class="number">1</span> </span><br><span class="line">print(pre, cur, end=<span class="string">' '</span>)</span><br><span class="line">n = <span class="number">4</span></span><br><span class="line"><span class="comment"># loop</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">    pre,cur = cur,pre + cur</span><br><span class="line">    print(cur,end=<span class="string">' '</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 递归解决斐波那契数列</span></span><br><span class="line"><span class="comment"># F(0)=0, F(1)=1, F(n)=F(n-1)+F(n-2)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(n)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> <span class="keyword">if</span> n &lt; <span class="number">2</span> <span class="keyword">else</span> fib(n<span class="number">-1</span>)+fib(n<span class="number">-2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">    print(fib(i),end=<span class="string">''</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 把4代入，就是fib(3)+fib(2)，fib(3)要再次压栈，这时就又进fib这个函数了，这时要调用fib(2)+fib(1)</span></span><br><span class="line"><span class="comment"># fib(2)不小于2,所以还要调用一次fib(1)。fib(1)就是边界，因为小于2，这时就会执行return了，之前都不会</span></span><br><span class="line"><span class="comment"># return。这里的fib(3)+fib(2)会分别执行fib(3)和fib(2)，也就是执行2次</span></span><br><span class="line"><span class="comment"># 而且这个递归的效率非常低，因为压栈太多</span></span><br></pre></td></tr></table></figure>
<ul>
<li>递归要求<ul>
<li>递归一定要有退出条件，递归调用一定要执行到这个退出条件。没有退出条件的递归调用 ，就是无限调用 </li>
<li>递归调用 的深度不宜过深<ul>
<li>Python对递归调用的深度做了限制，以保护解释器</li>
<li>超过递归深度限制，抛出RecursionError: maxinum recursion depth exceeded 超出最大深度</li>
<li>sys.getrecursionlimit()</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用pycharm测试</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo1</span><span class="params">(b,b1=<span class="number">3</span>)</span>:</span></span><br><span class="line">    foo1(b)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># foo1(3)</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">print(sys.getrecursionlimit())</span><br><span class="line"><span class="comment"># 视频中是1000,超过这个值就会报错，这是一种保护机制</span></span><br><span class="line">sys.setrecursionlimit(<span class="number">1000</span>)</span><br><span class="line"><span class="comment"># 修改递归的层数，太消耗内存了</span></span><br></pre></td></tr></table></figure>
<h3 id="递归的性能"><a href="#递归的性能" class="headerlink" title="递归的性能"></a>递归的性能</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># for 循环</span></span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line">start = datetime.datetime.now()</span><br><span class="line">pre = <span class="number">0</span></span><br><span class="line">cur = <span class="number">1</span> <span class="comment"># No1</span></span><br><span class="line">print(pre, cur, end=<span class="string">' '</span>)</span><br><span class="line">n = <span class="number">35</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n<span class="number">-1</span>):</span><br><span class="line">pre, cur = cur, pre + cur</span><br><span class="line">	print(cur, end=<span class="string">' '</span>)</span><br><span class="line">	delta = (datetime.datetime.now() - start).total_seconds()</span><br><span class="line">print(delta)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 递归</span></span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line">n = <span class="number">35</span></span><br><span class="line">start = datetime.datetime.now()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(n)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span> <span class="keyword">if</span> n &lt; <span class="number">2</span> <span class="keyword">else</span> fib(n<span class="number">-1</span>) + fib(n<span class="number">-2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(n):</span><br><span class="line">	print(fib(i), end=<span class="string">' '</span>)</span><br><span class="line">delta = (datetime.datetime.now() - start).total_seconds()</span><br><span class="line">print(delta)</span><br></pre></td></tr></table></figure>
<ul>
<li>循环稍微复杂一些，但是只要不是死循环，可以多次迭代直至算出结果</li>
<li>fib函数代码极简易懂，但是只能获取到最外层的函数调用，内部递归结果都是中间结果。而且给定一个n都要进行近2n次递归，深度越深，效率越低。为了获取斐波那契数列需要外面再套一个n次的循环，效率就更低了</li>
<li>递归还有深度限制，如果递归复杂，函数反复压栈，栈内存很快就溢出了</li>
<li>思考：这个极简的递归代码能否提高性能？</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 斐波寻契数列的改进</span></span><br><span class="line">pre = <span class="number">0</span></span><br><span class="line">cur = <span class="number">1</span></span><br><span class="line">print(pre, cur, end=<span class="string">' '</span>)  <span class="comment"># 这里打印的是最前面的0和1</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fib</span><span class="params">(n, pre=<span class="number">0</span>, cur =<span class="number">1</span>)</span>:</span></span><br><span class="line">    pre, cur = cur, pre + cur</span><br><span class="line">    print(cur, end=<span class="string">' '</span>)</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">2</span>:   <span class="comment"># 这是最外层的条件，当满足条件时执行一次return。n是计数的，</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    fib(n<span class="number">-1</span>, pre, cur)   </span><br><span class="line">    <span class="comment"># 这一句后隐含有return，每次都会执行return。我们不关心这个，因为我们要的是上面print的值</span></span><br><span class="line">    <span class="comment"># 上一次的结果，作为下一次的参数传进来</span></span><br><span class="line">fib(<span class="number">5</span>)</span><br><span class="line">- 改进</span><br><span class="line">	- 左边的fib函数和循环的思想类似</span><br><span class="line">    - 参数n是边界条件，用n来计数</span><br><span class="line">    - 上一次的计算结果直接作为函数的实参</span><br><span class="line">    - 效率很高</span><br><span class="line">    - 和循环比较，性能相近。所以并不是说递归一定效率代下。但是递归有深度限制</span><br><span class="line">- 对比一下三个fib函数的性能</span><br></pre></td></tr></table></figure>
<ul>
<li>间接递归</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo1</span><span class="params">()</span>:</span></span><br><span class="line">    foo2()</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo2</span><span class="params">()</span>:</span></span><br><span class="line">    foo1()</span><br><span class="line">    </span><br><span class="line">foo1()</span><br><span class="line">- 间接递归，是通过别的函数调用了函数自身。但是如果构成了循环递归调用是非常危险的，但是往往这种情况在代码</span><br><span class="line">复杂的情况下，还是可能发生这种调用。要用代码的规范来避免这种递归调用的发生</span><br></pre></td></tr></table></figure>
<h3 id="递归总结"><a href="#递归总结" class="headerlink" title="递归总结"></a>递归总结</h3><ul>
<li>递归是一种很自然的表达，符合逻辑思维</li>
<li>递归相对运行效率低，每一次调用函数都要开辟栈帧</li>
<li>递归有深度限制，如果递归层次太深，函数反复压栈，栈内存很快就溢出了</li>
<li>如果是有限次数的递归，可以使用递归调用，或者使用循环代替，循环代码稍微复杂一些，但是只要不是死循环，可以多次迭代直至算出结果</li>
<li>绝大多数递归，都可以使用循环实现</li>
<li>即使递归代码很简洁，但是能不用则不用递归</li>
<li>个人感觉，递归最重要的有三点。一是定义时，函数的参数就是变量，它一直在变化，所以可以向下执行。二是找到公式，也就是函数要完成的功能，如何不断的用一个公式递归自己，这可以通过要实现的功能来发现其中的规律。三是返回，实际就是告诉函数到什么地方就可以一级一级地向上返回值了，这个也可以从要实现的功能中找到，看功能到什么时候就可以结束。</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/12/python基础学习-树/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/12/python基础学习-树/" itemprop="url">
                  python基础学习-树
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-11-12 10:35:16" itemprop="dateCreated datePublished" datetime="2019-11-12T10:35:16+08:00">2019-11-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-11-13 09:39:22" itemprop="dateModified" datetime="2019-11-13T09:39:22+08:00">2019-11-13</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="树的概念"><a href="#树的概念" class="headerlink" title="树的概念"></a>树的概念</h3><ul>
<li>非线性结构，每个元素可以有多个前驱和后继</li>
<li>树是n(n&gt;0)个元素的集合<ul>
<li>n = 0时，称为空树</li>
<li>树只有一个特殊的没有前驱的元素，称为树的根root</li>
<li>树中除了根结点外，其余元素只能有一个前驱，可以有零个或多个后继</li>
</ul>
</li>
<li>递归定义<ul>
<li>树T是n(n&gt;=0)个元素的集合。n=0时，称为空树</li>
<li>有且只有一个特殊元素根，剩余元素都可以被划分为m个互不相交的集合T1、T2、T3、…、Tm，而每一个集合都是树，称为T的子树Subtree</li>
<li>子树也有自己的根</li>
</ul>
</li>
<li>结点：树中的数据元素</li>
<li>结点的度degree：结点拥有的子树的数目称为度，记作d(v)。</li>
<li>叶子结点：结点的度不为0，称为非终端结点或分支结点</li>
<li>分支：结点之间的关系</li>
<li>内部结点：除根结点外的分支结点，当然也不包括叶子结点</li>
<li>树的度是树内各结点的度的最大值。D结点度最大为3，树的度数就是3</li>
</ul>
<p><img src="/images/python树/树的概念1.png" alt=""></p>
<ul>
<li>孩子(儿子Child)结点：结点的子树的根结点称为该结点的孩子</li>
<li>双亲(父Parent)结点：一个结点是它各子树的根结点的双亲</li>
<li>兄弟(Sibling)结点：具有相同双亲结点的结点</li>
<li>祖先结点：从根结点到该结点所经分支上所有的结点。A、B、D都是G的祖先结点</li>
<li>子孙结点：结点的所有子树上的结点都称为该结点的子孙。B的子孙是D、G、H、I</li>
<li>结点的层次(Level)：根节点为第一层，根的孩子为第二层，以此类推，记作L(v)</li>
<li>树的深度(高度Depth)：树的层次的最大值。上图的树深度为4</li>
<li>堂兄弟：双亲在同一层的结点</li>
<li>有序树：结点的子树是有顺序的(兄弟有大小，有先后次序)，不能交换。</li>
<li>无序树：结点的子树是有无序的，可以交换</li>
<li>路径：树中的k个结点n1、n2、…、nk，满足ni是n(i+1)的双亲，称为n1到nk的一条路径。就是一条线串下来的，前一个都是后一个的父(前驱)结点。</li>
<li>路径长度=路径上结点数-1，也是分支数</li>
<li>森林：m(m&gt;=0)棵不相交的树的集合<ul>
<li>对于结点而言，其子树的集合就是森林。A结点的2棵子树的集合就是森林</li>
</ul>
</li>
<li>树的特点<ul>
<li>唯一的根</li>
<li>子树不相交</li>
<li>除了根以外，每个元素只能有一个前驱，可以有零个或多个后继</li>
<li>根结点没有双亲结点(前驱)，叶子结点没有孩子结点(后继)</li>
<li>vi是vj的双亲，则L(vi) = L(vj) - 1，也就是说双亲比孩子结点的层次小1</li>
</ul>
</li>
<li>堂兄弟的双亲是兄弟关系吗？</li>
</ul>
<h3 id="二叉树"><a href="#二叉树" class="headerlink" title="二叉树"></a>二叉树</h3><ul>
<li>每个结点最多两棵子树<ul>
<li>二叉树不存在度数大于2的结点</li>
</ul>
</li>
<li>它是有序树，左子树、右子树是顺序的，不能交换次序</li>
<li>即使某个结点只有一棵子树，也要确定它是左子树还是右子树</li>
<li>二叉树的五种基本形态<ul>
<li>空二叉树</li>
<li>只有一个根结点</li>
<li>根结点只有左子树</li>
<li>根结点只有右子树</li>
<li>根结点有左子树和右子树</li>
</ul>
</li>
</ul>
<h3 id="斜树"><a href="#斜树" class="headerlink" title="斜树"></a>斜树</h3><ul>
<li>左斜树，所有结点都只有左子树</li>
<li>右斜树，所有结点都只有右子树</li>
</ul>
<p><img src="/images/python树/斜树1.png" alt=""></p>
<h3 id="满二叉树"><a href="#满二叉树" class="headerlink" title="满二叉树"></a>满二叉树</h3><ul>
<li>一棵二叉树的所有分支结点都存在左子树和右子树，并且所有叶子结点只存在在最下面一层。</li>
<li>同样深度二叉树中，满二叉树结点最多。</li>
<li>k为深度(1&lt;=k&lt;=n)，则结点总数为2^k-1</li>
<li>如下图，一个深度为4的15个结点的满二叉树</li>
</ul>
<p><img src="/images/python树/满二叉树1.png" alt=""></p>
<h3 id="完全二叉树-Complete-Binary-Tree"><a href="#完全二叉树-Complete-Binary-Tree" class="headerlink" title="完全二叉树 Complete Binary Tree"></a>完全二叉树 Complete Binary Tree</h3><ul>
<li>若二叉树的深度为k，二叉树的层数从1到k-1层的结点数都达到了最大个数，在第k层的所有结点都集中在最左边，这就是完全二叉树</li>
<li>完全二叉树由满二叉树引出</li>
<li>满二叉树一定是完全二叉树，但完全二叉树不是满二叉树</li>
<li>k为深度(1&lt;=k&lt;=n)，则结点总数最大值为2^k-1，当达到最大值的时候就是满二叉树</li>
<li>举例，完全二叉树，最下一层的叶子结点都连续的集中在左边</li>
</ul>
<p><img src="/images/python树/完全二叉树1.png" alt=""></p>
<ul>
<li>举例，完全二叉树，最下一层的叶子结点都连续的集中在左边</li>
</ul>
<p><img src="/images/python树/完全二叉树2.png" alt=""></p>
<ul>
<li>举例，完全二叉树，最下一层的叶子结点都连续的集中在左边</li>
</ul>
<p><img src="/images/python树/完全二叉树3.png" alt=""></p>
<ul>
<li>举例，<strong><em>不是完全二叉树</em></strong></li>
</ul>
<p><img src="/images/python树/完全二叉树4.png" alt=""></p>
<h3 id="二叉树性质"><a href="#二叉树性质" class="headerlink" title="二叉树性质"></a>二叉树性质</h3><ul>
<li>性质1<ul>
<li>在二叉树的第i层上至多有2^(i-1)个结点(i&gt;=1)</li>
</ul>
</li>
<li>性质2<ul>
<li>深度为k的二叉树，至多有2^k-1个结点(k&gt;=1)</li>
<li>一层 2-1=1</li>
<li>二层4-1=1+2=3</li>
<li>三层 8-1=1+2+4=7</li>
</ul>
</li>
<li>性质3<ul>
<li>对任何一棵二叉树T，如果其终端结点数为n0，度数为2的结点为n2，则有n0=n2+1</li>
<li>换句话说，就是叶子结点数-1就等于度数为2的结点数</li>
<li>证明：<ul>
<li>总结点数为n=n0+n1+n2，n1为度数为1的结点总数。</li>
<li>一棵树的分支数为n-1，因为除了根结点外，其余结点都有一个分支，即n0+n1+n2-1</li>
<li>分支数还等于n0<em>0+n1</em>1+n2<em>2，n2是2分支结点所以乘以2,2</em>n2+n1</li>
<li>可行2*n2+n1=n0+n1+n2-1 =&gt; n2 = n0-1</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/images/python树/二叉树性质1.png" alt=""></p>
<ul>
<li><p>其他性质</p>
<ul>
<li>高度为k的二叉树，至少有k个结点</li>
<li>含有n(n&gt;=1)的结点的二叉树高度至多为n。和上句一个意思</li>
<li>含有n(n&gt;=1)的结点的二叉树的高度至多为n，最小为math.ceil(log2(n+1))，不小于对数值的最小整数，向上取整<ul>
<li>假设高度为h，2^h-1=n=&gt;h=log2(n+1)，层次数是取整。如果是8个结点，3.1699就要向上取整为4,为4层。</li>
</ul>
</li>
</ul>
</li>
<li><p>性质4</p>
<ul>
<li>具有n个结点的完全二叉树的深度为int(log2n)+1或者math.ceil(log2(n+1))</li>
</ul>
</li>
</ul>
<p><img src="/images/python树/二叉树性质2.png" alt=""></p>
<ul>
<li>性质5<ul>
<li>如果有一棵n个结点的完全二叉树(深度为性质4)，结点按照层序编号，如下图</li>
<li>如果i=1，则结点i是二叉树的根，无双新；如果i&gt;1，则其双亲是int(i/2)，向下取整。就是子结点的编号整除2得到的就是父结点的编号。父结点如果是i，那么左孩子结点就是2i，右孩子结点就是2i+1</li>
<li>如果2i&gt;n，则结点i无左孩子，即结点i为叶子结点；否则其左孩子结点存在编号为2i</li>
<li>如果2i+1&gt;n，则结点i无右孩子，注意这里并不能说明结点i没有左孩子；否则右孩子结点存在编号为2i+1</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/11/python算法-插入排序/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/11/python算法-插入排序/" itemprop="url">
                  python算法-插入排序
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-11-11 08:19:40" itemprop="dateCreated datePublished" datetime="2019-11-11T08:19:40+08:00">2019-11-11</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-12-06 15:33:37" itemprop="dateModified" datetime="2019-12-06T15:33:37+08:00">2019-12-06</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="直接插入排序-Direct-Insertion-Sort"><a href="#直接插入排序-Direct-Insertion-Sort" class="headerlink" title="直接插入排序 Direct Insertion Sort"></a>直接插入排序 Direct Insertion Sort</h3><ul>
<li>直接插入排序原理<ul>
<li>在未排序序列中，构建一个子排序序列，直至全部数据排序完成</li>
<li>将待排序的数，插入到<strong><em>已经排序</em></strong>的序列中合适的位置</li>
<li>增加一个哨兵，放入待比较值，让它和后面已经排好序的序列比较，找到合适的插入点</li>
</ul>
</li>
</ul>
<p><img src="/images/python插入排序/插入排序1.png" alt=""></p>
<ul>
<li><p>初始的0及下面开头的红色数字为哨兵，即待插入值</p>
</li>
<li><p>从第二个数字开始排序，即9</p>
</li>
<li><p>第一趟，哨兵是9，用1和哨兵比较，1小，哨兵插入，本轮比较结束</p>
</li>
<li><p>第二趟，哨兵是8，用9和哨兵比较大于哨兵，9向右移，1和哨兵比较，1小，哨兵插入本轮比较结束</p>
</li>
<li><p>以此类推，直至把最后一个数字放到哨兵并比较，插入完成</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">m_list = [[<span class="number">1</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>],[<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>]]</span><br><span class="line">nums = [<span class="number">0</span>] + m_list[<span class="number">0</span>]    <span class="comment"># nums为[0,1,9,8,5,6,7,4,3,2]</span></span><br><span class="line"><span class="comment"># print(nums)</span></span><br><span class="line">sentinel,*origin = nums   <span class="comment"># 哨兵位，待比较数字。sentinel为0，origin为[1,9,8,5,6,7,4,3,2]</span></span><br><span class="line"><span class="comment"># print(sentinel)</span></span><br><span class="line"><span class="comment"># print(origin)</span></span><br><span class="line">count_swap = <span class="number">0</span>   <span class="comment"># 计算每轮循环中，与哨兵位比较后要交换的次数</span></span><br><span class="line">count_iter = <span class="number">0</span>   <span class="comment"># 计算从第二个数字到最后一个数字，一共要循环的资源</span></span><br><span class="line">length = len(nums)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>,length):   <span class="comment"># 从m_list[0]的第二个数字开始，第一个数字是待比较数字</span></span><br><span class="line">    nums[<span class="number">0</span>] = nums[i]    </span><br><span class="line"><span class="comment"># 放置哨兵，把比较的数字赋值给第一个数字，第一个数字就是哨兵位。如第一次就是把9放到哨兵位。这里的哨兵是在按列表中的数字不停顺序变化的，</span></span><br><span class="line"><span class="comment"># ，第一次是9，之后是8,5,6，一直到最后，如果要比较的数字比哨兵位的数字小，就不动，如果比哨兵位的数字大，就向右移</span></span><br><span class="line">    j = i - <span class="number">1</span>    <span class="comment"># 得出要比较数字的索引位置，下面就要用1和9比较</span></span><br><span class="line">    count_iter += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> nums[j] &gt; nums[<span class="number">0</span>]:    <span class="comment"># 大数右移，找到插入位置。如果要比较的数字比哨兵位的数字大</span></span><br><span class="line">        <span class="keyword">while</span> nums[j] &gt; nums[<span class="number">0</span>]:</span><br><span class="line">            nums[j+<span class="number">1</span>] = nums[j]    <span class="comment"># 依次右移</span></span><br><span class="line">            j -= <span class="number">1</span></span><br><span class="line"><span class="comment"># 如果索引j比哨兵位的数字大，就把索引j向后移一个位置，之后把索引j减1，再进行同样的比较。当8是哨兵位时，9与8比较，因为比8大，就会把9</span></span><br><span class="line"><span class="comment"># 的索引向后移动，之后再用1和哨兵位的8比较，1小于8,那么执行下面的哨兵插入，这时正好插入到了之前9的位置</span></span><br><span class="line">            count_swap += <span class="number">1</span></span><br><span class="line">        nums[j+<span class="number">1</span>] = nums[<span class="number">0</span>]    <span class="comment"># 将哨兵插入，注意插入在右侧要+1</span></span><br><span class="line">print(nums, count_swap, count_iter)</span><br><span class="line">输出：</span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>] <span class="number">25</span> <span class="number">8</span></span><br><span class="line"><span class="comment"># 可以看到最后一个数字2在哨兵位上。</span></span><br></pre></td></tr></table></figure>
<ul>
<li>增加一个哨兵位，每轮比较将待比较数放入</li>
<li>哨兵依次和待比较数的前一个数据比较，大数向右移动，找到哨兵中值的插入位置</li>
<li>每一轮结束后，得到一个从开始到待比较数位置的一个有序序列，如上面第一次的有序序列是1,9，第二次是1,8,9</li>
<li>最好情况，正好是升序排列，比较迭代n-1次</li>
<li>最差情况，正好是降序排列，比较迭代1,2,…,n-1即n(n-1)/2</li>
<li>使用两层嵌套循环，时间复杂度O(n^2)</li>
<li>稳定排序算法</li>
<li>使用在小规模数据比较</li>
<li>优化<ul>
<li>如果比较操作耗时大的话，可以采用二分查找来提高效率，即二分查找插入排序</li>
</ul>
</li>
</ul>
<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">=======================================================================================</span><br><span class="line">代码编写过程：</span><br><span class="line"><span class="number">1.</span> 向列表元素中加入哨兵位的位置</span><br><span class="line"><span class="number">2.</span> 计算需要循环的次数</span><br><span class="line"><span class="number">3.</span> 开始循环，从原列表中第二个数字开始插入哨兵位</span><br><span class="line"><span class="number">4.</span> 设置待比较数字的索引值，将第二个数字放到哨兵位</span><br><span class="line"><span class="number">5.</span> 判断待比较数字是否大于哨兵位数字，如果不大于就结束本轮循环</span><br><span class="line"><span class="number">6.</span> 如果待比较数字是否大于哨兵位数字，就进入将循环，把待比较数字的索引加<span class="number">1</span>或叫向后移</span><br><span class="line"><span class="number">7.</span> 将待比较数字的索引值减<span class="number">1</span>，这是为了设置下一个待比较的数字，直到待比较数字不大于哨兵位数字</span><br><span class="line"><span class="number">8.</span> 将哨兵位数字插入到目前待比较数字的后面</span><br><span class="line"><span class="number">9.</span> 这个代码中，每次比较的都是用哨兵位上数字之前的数字和哨兵位上的数字相比</span><br><span class="line">=======================================================================================</span><br><span class="line">m_list = [[<span class="number">1</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>],[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>],[<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>]]</span><br><span class="line">nums = [<span class="number">0</span>] + m_list[<span class="number">0</span>]   <span class="comment"># 没有优化方法，无论如何都要跑完整个过程</span></span><br><span class="line">sentinel,*origin = nums  <span class="comment"># 这一句没有意义，但是可以看出解构的方法</span></span><br><span class="line">count_swap = <span class="number">0</span></span><br><span class="line">count_iter = <span class="number">0</span></span><br><span class="line">length = len(nums)   <span class="comment"># 这步是为了计算循环的次数</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>,length):   <span class="comment"># 从实际的第二个数字开始</span></span><br><span class="line">    nums[<span class="number">0</span>] = nums[i]   <span class="comment"># 把第二个数字开始插入哨兵位</span></span><br><span class="line">    j = i - <span class="number">1</span>   <span class="comment"># 设置待比较数字的索引</span></span><br><span class="line">    count_iter += <span class="number">1</span></span><br><span class="line">    print(<span class="string">"count_iter"</span>,nums)</span><br><span class="line">    <span class="keyword">if</span> nums[j] &gt; nums[<span class="number">0</span>]:   </span><br><span class="line"><span class="comment"># 如果待比较数字大于哨兵位数字，第一次这里的nums[j]是1，nums[0]是9，所以直接进入下一轮循环，第二次nums[j]是9，nums[0]是8。</span></span><br><span class="line">        <span class="keyword">while</span> nums[j] &gt; nums[<span class="number">0</span>]:   </span><br><span class="line">        <span class="comment"># 待比较数字大于哨兵位数字时，第二次nums[j]是9，nums[0]是8时进入</span></span><br><span class="line">            nums[j+<span class="number">1</span>] = nums[j]    </span><br><span class="line">            <span class="comment"># 把nums[j]是9赋值给nums[j+1]也就是把9后移一个位置，到8的位置</span></span><br><span class="line">            j -= <span class="number">1</span>    </span><br><span class="line">        <span class="comment"># 索引减1，方便下次比较。下一次到while处，看nums[j]是否大于nums[0]，这时nums[j]是1，nums[0]是8，退出本轮循环</span></span><br><span class="line">            print(<span class="string">"count_swap"</span>,nums)</span><br><span class="line">            count_swap += <span class="number">1</span></span><br><span class="line">        nums[j+<span class="number">1</span>] = nums[<span class="number">0</span>]  </span><br><span class="line"><span class="comment"># 这里一定是将哨兵位的数字插入到j+1索引上，一是j已经减1了，二是新的j+1的位置就是上一个j索引的位置，这时</span></span><br><span class="line"><span class="comment"># 的j+1和j+2索引位置是同一数字，所以插入到j+1的位置正合适。可以看一下下面输出的内容</span></span><br><span class="line">print(nums,count_swap,count_iter)</span><br><span class="line">输出：</span><br><span class="line">count_iter [<span class="number">0</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_iter [<span class="number">9</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">8</span>, <span class="number">1</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]   <span class="comment"># 第一次进入循环比较，8在哨兵位，用9和8比较后移</span></span><br><span class="line">count_iter [<span class="number">8</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">5</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]   </span><br><span class="line"><span class="comment"># 第二次进入循环后5在哨兵位，比较后9和8都后移，之后把5插入</span></span><br><span class="line">count_swap [<span class="number">5</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_iter [<span class="number">5</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">6</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">6</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_iter [<span class="number">6</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_iter [<span class="number">7</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">4</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_iter [<span class="number">4</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">3</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">9</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">3</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">2</span>]</span><br><span class="line">count_iter [<span class="number">3</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">2</span>]</span><br><span class="line">count_swap [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">9</span>]</span><br><span class="line">count_swap [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">count_swap [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">count_swap [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">count_swap [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">count_swap [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">count_swap [<span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">[<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>] <span class="number">25</span> <span class="number">8</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/08/python基础练习-函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/08/python基础练习-函数/" itemprop="url">
                  python基础练习-函数
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-11-08 08:23:10" itemprop="dateCreated datePublished" datetime="2019-11-08T08:23:10+08:00">2019-11-08</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-12-05 16:19:04" itemprop="dateModified" datetime="2019-12-05T16:19:04+08:00">2019-12-05</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>编写一个函数，能够接受至少2个参数，返回最小值和最大值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">double_values</span><span class="params">(*nums)</span>:</span></span><br><span class="line">    print(nums)</span><br><span class="line">    <span class="keyword">return</span> max(nums), min(nums)</span><br><span class="line"></span><br><span class="line">print(*double_values(*[random.randint(<span class="number">10</span>,<span class="number">20</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> range(<span class="number">10</span>)]))</span><br><span class="line"><span class="comment"># 这里调用double_values()时给的参数使用了参数解构，并且使用了列表解析式，</span></span><br><span class="line"><span class="comment"># random.randint(10,20)表示返回10到20之间的随机整数，后面的for循环表示执行10次，这将组成一个列表，</span></span><br><span class="line"><span class="comment"># 然后用参数解构挨个给double_balues函数。double_values前面的星号也是参数解构，打印时会将</span></span><br><span class="line"><span class="comment"># double_values中得到的最大最小值分开打印，不然会按元组形式打印在一起</span></span><br><span class="line"><span class="comment"># 这里的print()还有一个隐含的强制类型转换，并数字转换为字符串再打印</span></span><br><span class="line">输出：</span><br><span class="line">(<span class="number">11</span>, <span class="number">10</span>, <span class="number">16</span>, <span class="number">13</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">13</span>, <span class="number">11</span>, <span class="number">16</span>, <span class="number">13</span>)</span><br><span class="line"><span class="number">16</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>
<ul>
<li>编写一个函数，接受一个参数n，n为正整数，左右两种打印方式。要求数字必须对齐</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 上三角</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(n)</span>:</span></span><br><span class="line">    tail = <span class="string">" "</span>.join([str(i) <span class="keyword">for</span> i <span class="keyword">in</span> range(n,<span class="number">0</span>,<span class="number">-1</span>)])</span><br><span class="line"><span class="comment"># 这一行算的是最下面一行的值，不管有几位数，知道最后一行就可以知道上面的行的字符串长度了join用于字符串</span></span><br><span class="line"><span class="comment"># 连接，以" "为分隔符，列表解析式将n到0倒序传给i，再将i依次转换为字符串，最后就是要以倒序排列一个字符</span></span><br><span class="line"><span class="comment"># 串，如12 11 ... 1。tail = " ".join([str(i) for i in range(n,0,-1)])不用中括号也可以，如</span></span><br><span class="line"><span class="comment"># tail = " ".join(str(i) for i in range(n,0,-1))。这里必须用字符串，如果用int形式是不行的</span></span><br><span class="line">    width = len(tail)</span><br><span class="line"><span class="comment"># 计算tail的长度</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,n):  </span><br><span class="line"><span class="comment"># 因为第一行只有一个1，所有这里range()从1到n打印，因为这里到第n行，所以最后还要再打印一次tail行的值</span></span><br><span class="line">        print(<span class="string">"&#123;:&gt;&#123;&#125;&#125;"</span>.format(<span class="string">" "</span>.join([str(j) <span class="keyword">for</span> j <span class="keyword">in</span> range(i,<span class="number">0</span>,<span class="number">-1</span>)]),width))</span><br><span class="line"><span class="comment"># &#123;:&gt;&#123;&#125;&#125;中&gt;表示右对齐，里面的&#123;&#125;表示这一行的宽度，format()里，逗号前面的部分就是要打印的部分，width表</span></span><br><span class="line"><span class="comment"># 示这一行的宽度，宽度是不会变的。只是打印都向右对齐就可以了</span></span><br><span class="line">    print(tail)</span><br><span class="line">show(<span class="number">12</span>)</span><br><span class="line">输出：</span><br><span class="line">                         <span class="number">1</span></span><br><span class="line">                       <span class="number">2</span> <span class="number">1</span></span><br><span class="line">                     <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">                   <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">                 <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">               <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">             <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">           <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">         <span class="number">9</span> <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">      <span class="number">10</span> <span class="number">9</span> <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">   <span class="number">11</span> <span class="number">10</span> <span class="number">9</span> <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">12</span> <span class="number">11</span> <span class="number">10</span> <span class="number">9</span> <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 下三角</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showtail</span><span class="params">(n)</span>:</span></span><br><span class="line">    tail = <span class="string">" "</span>.join([str(i) <span class="keyword">for</span> i <span class="keyword">in</span> range(n,<span class="number">0</span>,<span class="number">-1</span>)])   </span><br><span class="line"><span class="comment"># 计算出第一行的值，这里利用了字符串的特点，把所有值包括空格都算成一个个元素</span></span><br><span class="line">    print(tail)   <span class="comment"># 把第一行的值打印出来</span></span><br><span class="line">    <span class="comment"># 无需再次生成列表</span></span><br><span class="line"><span class="comment">#     print(len(tail))   # 查看tail一共有多少个元素</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(tail)):    </span><br><span class="line"><span class="comment"># 这里计算出第一行的长度，之后以此为基础。第一行的长度是23，这表示空格也算为一个元素。</span></span><br><span class="line"><span class="comment">#         print(i)   # 加入此行可以更明显地看出i的值执行到哪就满足了下面的条件</span></span><br><span class="line">        <span class="keyword">if</span> tail[i] == <span class="string">' '</span>:   </span><br><span class="line"><span class="comment"># 从11开始算，第一个1的索引是0，第二个1的索引是1，第三个空格的索引是2，这时满足条件，元素是空格</span></span><br><span class="line">            print(<span class="string">' '</span>*i,tail[i+<span class="number">1</span>:])</span><br><span class="line"><span class="comment"># 当上面满足时，这里用空格乘在上面的i，这样就形成了从第二行开始，每行前面要打印的空格，再加上tail中i+1</span></span><br><span class="line"><span class="comment"># 索引处到最后的值。这样就凑出了一行的值。另外，tail[i+1:]是一个列表切片操作，这是一个copy方法，所以对</span></span><br><span class="line"><span class="comment"># 性能有一些影响，如果打印10000的话可能会引起垃圾回收</span></span><br><span class="line">showtail(<span class="number">11</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">11</span> <span class="number">10</span> <span class="number">9</span> <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line">   <span class="number">10</span> <span class="number">9</span> <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">      <span class="number">9</span> <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">6</span></span><br><span class="line"><span class="number">7</span></span><br><span class="line">        <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">8</span></span><br><span class="line"><span class="number">9</span></span><br><span class="line">          <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">11</span></span><br><span class="line">            <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">12</span></span><br><span class="line"><span class="number">13</span></span><br><span class="line">              <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">14</span></span><br><span class="line"><span class="number">15</span></span><br><span class="line">                <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">16</span></span><br><span class="line"><span class="number">17</span></span><br><span class="line">                  <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">18</span></span><br><span class="line"><span class="number">19</span></span><br><span class="line">                    <span class="number">2</span> <span class="number">1</span></span><br><span class="line"><span class="number">20</span></span><br><span class="line"><span class="number">21</span></span><br><span class="line">                      <span class="number">1</span></span><br><span class="line"><span class="number">22</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 把正三角打印稍微改一下就会变成下三角</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(n)</span>:</span></span><br><span class="line">    tail = <span class="string">" "</span>.join(str(i) <span class="keyword">for</span> i <span class="keyword">in</span> range(n,<span class="number">0</span>,<span class="number">-1</span>)) <span class="comment"># 这行还有用，下面要用tail计算元素个数</span></span><br><span class="line">    width = len(tail)</span><br><span class="line"><span class="comment"># 这里也可以写为width = len(" ".join(str(i) for i in range(n,0,-1)))，这样就不用上面tail一行了</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(n,<span class="number">0</span>,<span class="number">-1</span>):   <span class="comment"># 改这里就可以</span></span><br><span class="line">        print(<span class="string">"&#123;:&gt;&#123;&#125;&#125;"</span>.format(<span class="string">" "</span>.join(str(j) <span class="keyword">for</span> j <span class="keyword">in</span> range(i,<span class="number">0</span>,<span class="number">-1</span>)),width))</span><br><span class="line">    </span><br><span class="line">show(<span class="number">11</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">11</span> <span class="number">10</span> <span class="number">9</span> <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">   <span class="number">10</span> <span class="number">9</span> <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">      <span class="number">9</span> <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">        <span class="number">8</span> <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">          <span class="number">7</span> <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">            <span class="number">6</span> <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">              <span class="number">5</span> <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">                <span class="number">4</span> <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">                  <span class="number">3</span> <span class="number">2</span> <span class="number">1</span></span><br><span class="line">                    <span class="number">2</span> <span class="number">1</span></span><br><span class="line">                      <span class="number">1</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/07/python基础学习-函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/07/python基础学习-函数/" itemprop="url">
                  python基础学习-函数
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-11-07 16:22:38" itemprop="dateCreated datePublished" datetime="2019-11-07T16:22:38+08:00">2019-11-07</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新於</span>
                
                <time title="修改時間：2019-11-15 15:17:47" itemprop="dateModified" datetime="2019-11-15T15:17:47+08:00">2019-11-15</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><ul>
<li>数学定义：y=f(x)，y是x的函数，x是自变量。y=f(x0,x1,…,xn)</li>
<li>Python函数<ul>
<li>由若干语句组成的语句块、函数名称、参数列表构成，它是组织代码的最小单元</li>
<li>完成一定的功能</li>
</ul>
</li>
<li>函数的作用<ul>
<li>函数是为了完成某几种功能</li>
<li>函数的作用就是简单封装，不会做非常复杂的封装</li>
<li>结构化编程对代码的最基本的封装，一般按照功能组织一段代码</li>
<li>封装的目的是为了复用，减少冗余代码</li>
<li>函数本身也是方法，叫函数或方法都可以。</li>
<li>代码更加简洁美观、可读易懂</li>
</ul>
</li>
<li>函数的分类<ul>
<li>内建函数，如max()、reversed()等</li>
<li>库函数，如math.ceil()等</li>
</ul>
</li>
</ul>
<h3 id="函数定义、调用"><a href="#函数定义、调用" class="headerlink" title="函数定义、调用"></a>函数定义、调用</h3><ul>
<li>def语句定义函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> 函数名<span class="params">(参数列表)</span>:</span></span><br><span class="line">    函数体(代码块)</span><br><span class="line">    [<span class="keyword">return</span> 返回值]</span><br><span class="line"><span class="comment"># 函数名就是标识符，命名要求一样</span></span><br><span class="line"><span class="comment"># 语句块必须缩进，约定4个空格</span></span><br><span class="line"><span class="comment"># Python的函数如果没有return语句，隐式会返回一个None值</span></span><br><span class="line"><span class="comment"># 定义中的参数列表称为形式参数，只是一种符号表达，简称形参</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>调用</p>
<ul>
<li>函数定义，只是声明了一个函数，它不会被执行，需要调用</li>
<li>调用的方式，就是函数名加上小括号，括号内写上参数</li>
<li>调用时写的参数是实际参数，是实实在在传入的值，简称实参</li>
</ul>
</li>
<li><p>函数举例</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x,y)</span>:</span></span><br><span class="line">    result = x + y</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">out = add(<span class="number">4</span>,<span class="number">5</span>)</span><br><span class="line">print(out)</span><br><span class="line"><span class="comment"># 上面只是一个函数的定义，有一个函数叫做add，接收2个参数</span></span><br><span class="line"><span class="comment"># 计算的结果，通过return返回值返回</span></span><br><span class="line"><span class="comment"># 调用通过函数名add加2个参数，返回值可使用变量接收</span></span><br><span class="line"><span class="comment"># 定义需要在调用前，也就是说调用时，已经被定义过了，否则抛NameError异常</span></span><br><span class="line"><span class="comment"># 函数是可调用的对象，callable()</span></span><br></pre></td></tr></table></figure>
<h3 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h3><ul>
<li>参数调用时传入的参数要和定义的个数相匹配（可变参数例外）</li>
<li>位置参数<ul>
<li><code>def f(x,y,z)</code>调用使用<code>f(1,3,5)</code></li>
<li>按照参数定义顺序传入实参</li>
</ul>
</li>
<li>关键字参数<ul>
<li><code>def f(x,y,z)</code>调用使用<code>f(x=1,y=3,z=5)</code></li>
<li>使用形参的名字来输入实参的方式，如果使用了形参名字，那么传参顺序就可和定义顺序不同</li>
</ul>
</li>
<li>传参<ul>
<li><code>f(z=None,y=10,x=[1])</code></li>
<li><code>f((1,),z=6,y=4.1)</code></li>
<li><code>f(y=5,z=6,2)</code> # 这会报错</li>
<li>要求位置参数在关键字参数之前传入，位置参数是按位置对应的</li>
<li>位置参数与关键字参数只是传参的方法不一样而已，定义函数时的方法是一样的</li>
</ul>
</li>
</ul>
<h3 id="函数参数默认值"><a href="#函数参数默认值" class="headerlink" title="函数参数默认值"></a>函数参数默认值</h3><ul>
<li>参数默认值(缺省值)<ul>
<li>定义时，在后跟上一个值</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x=<span class="number">4</span>,y=<span class="number">5</span>)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line"><span class="comment"># 测试调用 add(6,10)、add(6,y=7)、add(x=5)、add()、add(y=7)、add(x=5,6)、add(y=8,4)、add(x=5,y=6)、add(y=5,x=6)</span></span><br><span class="line"><span class="comment"># 测试定义后面这样的函数 def add(x=4,y)</span></span><br></pre></td></tr></table></figure>
<ul>
<li>作用<ul>
<li>参数的默认值可以在未传入足够的实参的时候，对没有给定的参数赋值为默认值</li>
<li>参数非常多的时候，并不需要用户每次都输入所有的参数，简化函数调用</li>
</ul>
</li>
<li>举例</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义一个函数login，参数名称为host、port、username、password</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(host=<span class="string">'127.0.0.1'</span>,port=<span class="string">'8080'</span>,username=<span class="string">'wayne'</span>,password=<span class="string">'magedu'</span>)</span>:</span></span><br><span class="line">    print(<span class="string">'&#123;&#125;:&#123;&#125;@&#123;&#125;/&#123;&#125;'</span>.format(host,port,username,password))</span><br><span class="line">login()  <span class="comment"># 可以这样调用，使用默认值。在测试时很有用，但在实际使用中作用不大</span></span><br><span class="line">输出：<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8080</span>@wayne/magedu</span><br><span class="line">login(<span class="string">'127.0.0.1'</span>,<span class="number">80</span>,<span class="string">'tom'</span>,<span class="string">'tom'</span>)</span><br><span class="line">输出：<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">80</span>@tom/tom</span><br><span class="line">login(<span class="string">'127.0.0.1'</span>,username=<span class="string">'root'</span>)</span><br><span class="line">输出：<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">8080</span>@root/magedu</span><br><span class="line">login(<span class="string">'localhost'</span>,port=<span class="number">80</span>,password=<span class="string">'com'</span>)</span><br><span class="line">输出：localhost:<span class="number">80</span>@wayne/com</span><br><span class="line">login(port=<span class="number">90</span>,password=<span class="string">'magedu'</span>,host=<span class="string">'www'</span>)</span><br><span class="line">输出：www:<span class="number">90</span>@wayne/magedu</span><br></pre></td></tr></table></figure>
<h3 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h3><ul>
<li>问题</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 有多个数，需要累加求和</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(nums)</span>:</span></span><br><span class="line">    sum = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> nums:</span><br><span class="line">        sum += x</span><br><span class="line">    <span class="keyword">return</span> sum</span><br><span class="line">add([<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>])</span><br><span class="line">标准输出：Out: <span class="number">9</span></span><br><span class="line">add((<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>))</span><br><span class="line">标准输出：Out: <span class="number">12</span></span><br><span class="line"><span class="comment"># 可以只传入一个参数，这个参数是一个可迭代对象。定义时只有一个形参，调用时的实参是一个可迭代对象</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>可变参数</p>
<ul>
<li>一个形参可以匹配任意个参数</li>
</ul>
</li>
<li><p>位置参数的可变参数</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 有多个数，需要累加求和</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(*nums)</span>:</span></span><br><span class="line">    sum = <span class="number">0</span></span><br><span class="line">    print(type(nums))</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> nums:</span><br><span class="line">        sum += x</span><br><span class="line">    print(sum)</span><br><span class="line">add(<span class="number">3</span>,<span class="number">6</span>,<span class="number">9</span>)</span><br><span class="line"><span class="comment"># 在形参前使用*表示该形参是可变参数，可以接收多个实参</span></span><br><span class="line"><span class="comment"># 收集多个实参为一个tuple</span></span><br><span class="line"></span><br><span class="line">例：</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(*nums)</span>:</span>  </span><br><span class="line"><span class="comment"># 加星号表示可以接收任意多个实参，包括0个。不加星号时只能接收一个实参。但这样定义后，不能接收关键字参数，如nums=3。</span></span><br><span class="line">    sum = <span class="number">0</span></span><br><span class="line">    print(type(nums))</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> nums:    <span class="comment"># 上面用*nums来接收，这里要用nums，不能加星号</span></span><br><span class="line">        sum += x</span><br><span class="line">    print(sum)    <span class="comment"># 这个打印是给控制台的，不是给我们使用的</span></span><br><span class="line"><span class="comment">#   return sum</span></span><br><span class="line"><span class="comment"># return返回值是给我们自己使用的，我们可以把这个返回值赋值给一个标识符，之前在说列表解析时特别用了一下print()，返回的都是None</span></span><br><span class="line"></span><br><span class="line">val = add(<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>)</span><br><span class="line"><span class="comment"># 结果显示nums是一个tuple类型，用这个类型来接收。在传完实参，真正要调用这个函数体时，解释器已经知道有几</span></span><br><span class="line"><span class="comment"># 个参数了，把这几个参数直接给tuple，相当于构建一个tuple。我们是一次全送进来的。它已经知道了当前参数有</span></span><br><span class="line"><span class="comment"># 几个，就可以构建出一个不可变对象来，因为在内部是不能再改变这个nums的，我们只能迭代读取nums。所以用这</span></span><br><span class="line"><span class="comment"># 种方式传进去的参数是不可变类型的。15是通过print打印出来的，这是给控制台的，我们是拿不到的。我们要通过</span></span><br><span class="line"><span class="comment"># return来拿。如果我们注释掉return一行，那么下面打印的会是None。</span></span><br><span class="line">print(val)</span><br><span class="line">输出：</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">tuple</span>'&gt;</span></span><br><span class="line"><span class="class">15</span></span><br><span class="line"><span class="class"><span class="title">None</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>关键字参数的可变参数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置信息打印</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showconfig</span><span class="params">(**kwargs)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> k,v <span class="keyword">in</span> kwargs.items():</span><br><span class="line">        print(<span class="string">'&#123;&#125; = &#123;&#125;'</span>.format(k,v))</span><br><span class="line">        </span><br><span class="line">showconfig(host=<span class="string">'127.0.0.1'</span>,port=<span class="string">'8080'</span>,username=<span class="string">'wayne'</span>,password=<span class="string">'magedu'</span>)</span><br><span class="line">输出：</span><br><span class="line">host = <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">port = <span class="number">8080</span></span><br><span class="line">username = wayne</span><br><span class="line">password = magedu</span><br><span class="line"><span class="comment"># 形参前使用**符号，表示可以接收多个关键字参数</span></span><br><span class="line"><span class="comment"># 收集的实参名称和值组成一个字典</span></span><br></pre></td></tr></table></figure>
<ul>
<li>可变参数混合使用</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 配置信息打印</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showconfig</span><span class="params">(username,password,**kwargs)</span></span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">showconfig</span><span class="params">(username,*args,**kwargs)</span></span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">showconfig</span><span class="params">(username,password,**kwargs,*args)</span></span></span><br><span class="line"><span class="function"></span></span><br><span class="line"><span class="function">例：</span></span><br><span class="line">- 可变参数。用两个星号，构建的是字典item形式。因为要用到关键字参数，如nums=2，这和字典的nums:2是一样的。所以构建的是字典。</span><br><span class="line">- 混合使用，一个星号就是接收任意多个实参的，两个星号就是接收关键字参数的。</span><br><span class="line">- 注意，在定义时，一个星号要放在两个星号前，如<span class="function"><span class="keyword">def</span> <span class="title">showconfig</span><span class="params">(username,passwd,**kwargs,*args)</span>，这样就不行。</span></span><br><span class="line"><span class="function">- 给实参时，会尽量先满足不可变参数，再满足可变参数</span></span><br><span class="line"><span class="function"><span class="title">def</span> <span class="title">add</span><span class="params">(*args,x)</span>:</span>   </span><br><span class="line"><span class="comment"># 这样定义的话，x就变成了关键字参数，调用时必须给出x的值，或者在定义时就要定义默认值，不然会报错</span></span><br><span class="line">    print(x)</span><br><span class="line">    print(args)</span><br><span class="line"></span><br><span class="line">add(<span class="number">4</span>,<span class="number">3</span>,x=<span class="number">0</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">0</span></span><br><span class="line">(<span class="number">4</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span><span class="params">(**kwargs,x)</span>:</span></span><br><span class="line">    print(x)</span><br><span class="line">    print(kwargs)</span><br><span class="line"><span class="comment"># 这里报错的原因是**kwargs和x都是关键字参数，都是keyword。所以会报错</span></span><br><span class="line">输出：</span><br><span class="line">  File <span class="string">"&lt;ipython-input-14-7e57b033edae&gt;"</span>, line <span class="number">1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span><span class="params">(**kwargs,x)</span>:</span></span><br><span class="line">       ^</span><br><span class="line">SyntaxError: invalid syntax</span><br></pre></td></tr></table></figure>
<ul>
<li><p>总结</p>
<ul>
<li>有位置可变参数和关键字可变参数</li>
<li>位置可变参数在形参前使用一个星号*</li>
<li>关键字可变参数在形参前使用两个星号**</li>
<li>位置可变参数和关键字可变参数都可以收集若干个实参，位置可变参数收集形成一个tuple，关键字可变参数收集形成一个dict</li>
<li>混合使用参数的时候，可变参数要放到参数列表的最后，普通参数需要放到参数列表前面，位置可变参数需要在关键字可变参数之前</li>
</ul>
</li>
<li><p>举例</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(x,y,*args,**kwargs)</span>:</span></span><br><span class="line">    print(x)</span><br><span class="line">    print(y)</span><br><span class="line">    print(args)</span><br><span class="line">    print(kwargs)</span><br><span class="line">    </span><br><span class="line">fn(<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">10</span>,a=<span class="number">1</span>,b=<span class="string">'python'</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">(<span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>)</span><br><span class="line">&#123;<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="string">'python'</span>&#125;</span><br><span class="line"></span><br><span class="line">fn(<span class="number">3</span>,<span class="number">5</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">()</span><br><span class="line">&#123;&#125;</span><br><span class="line"></span><br><span class="line">fn(<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">(<span class="number">7</span>,)</span><br><span class="line">&#123;&#125;</span><br><span class="line"></span><br><span class="line">fn(<span class="number">3</span>,<span class="number">5</span>,a=<span class="number">1</span>,b=<span class="string">'python'</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">()</span><br><span class="line">&#123;<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="string">'python'</span>&#125;</span><br><span class="line"></span><br><span class="line">fn(<span class="number">7</span>,<span class="number">9</span>,y=<span class="number">5</span>,x=<span class="number">3</span>,a=<span class="number">1</span>,b=<span class="string">'python'</span>)</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-51</span>-ff279493d0b6&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">9</span> <span class="comment"># fn(3,5,7)</span></span><br><span class="line">     <span class="number">10</span> <span class="comment"># fn(3,5,a=1,b='python')</span></span><br><span class="line">---&gt; 11 fn(7,9,y=5,x=3,a=1,b='python')</span><br><span class="line"></span><br><span class="line">TypeError: fn() got multiple values <span class="keyword">for</span> argument <span class="string">'y'</span></span><br><span class="line"><span class="comment"># 错误，7和9分别赋给了x，y，之后又给了y=5，x=3，重复了</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(*args,x,y,**kwargs)</span>:</span></span><br><span class="line">    print(x)</span><br><span class="line">    print(y)</span><br><span class="line">    print(args)</span><br><span class="line">    print(kwargs)</span><br><span class="line">    </span><br><span class="line">fn(<span class="number">3</span>,<span class="number">5</span>)</span><br><span class="line">fn(<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>)</span><br><span class="line">fn(<span class="number">3</span>,<span class="number">5</span>,a=<span class="number">1</span>,b=<span class="string">'python'</span>)</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-56</span><span class="number">-2097</span>f13d817a&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">5</span>     print(kwargs)</span><br><span class="line">      <span class="number">6</span> </span><br><span class="line">----&gt; 7 fn(7,9)</span><br><span class="line"></span><br><span class="line">TypeError: fn() missing <span class="number">2</span> required keyword-only arguments: <span class="string">'x'</span> <span class="keyword">and</span> <span class="string">'y'</span></span><br><span class="line"><span class="comment"># 按上面定义的方法，这三种调用的方法都会报错，要求将x和y这两个关键字参数的值明确给出</span></span><br><span class="line"></span><br><span class="line">fn(<span class="number">7</span>,<span class="number">9</span>,y=<span class="number">5</span>,x=<span class="number">3</span>,a=<span class="number">1</span>,b=<span class="string">'python'</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">(<span class="number">7</span>, <span class="number">9</span>)</span><br><span class="line">&#123;<span class="string">'a'</span>: <span class="number">1</span>, <span class="string">'b'</span>: <span class="string">'python'</span>&#125;</span><br><span class="line"><span class="comment"># 按上面方法定义时，只要这样调用才可以。</span></span><br></pre></td></tr></table></figure>
<h3 id="keyword-only参数"><a href="#keyword-only参数" class="headerlink" title="keyword-only参数"></a>keyword-only参数</h3><ul>
<li>keyword-only参数(Python3加入)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果在一个星号参数后，或者一个位置可变参数后，出现的普通参数，实际上已经不是普通的参数了，而是keyword-only参数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(*args,x)</span>:</span></span><br><span class="line">    print(x)</span><br><span class="line">    print(args)</span><br><span class="line">    </span><br><span class="line">fn(<span class="number">3</span>,<span class="number">5</span>)      </span><br><span class="line">fn(<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>)</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-58</span>-a561a8c35f3d&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">3</span>     print(args)</span><br><span class="line">      <span class="number">4</span> </span><br><span class="line">----&gt; 5 fn(3,5)</span><br><span class="line"></span><br><span class="line">TypeError: fn() missing <span class="number">1</span> required keyword-only argument: <span class="string">'x'</span></span><br><span class="line">        </span><br><span class="line">fn(<span class="number">3</span>,<span class="number">5</span>,x=<span class="number">7</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">7</span></span><br><span class="line">(<span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line"><span class="comment"># args可以看做已经截获了所有的位置参数，x不使用关键字参数就不可能拿到实参</span></span><br><span class="line"><span class="comment"># 思考:def fn(**kwargs, x) 可以吗？</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(**kwargs,x)</span>:</span></span><br><span class="line">    print(x)</span><br><span class="line">    print(kwargs)</span><br><span class="line">输出：</span><br><span class="line"> File <span class="string">"&lt;ipython-input-62-33c9a294d8b7&gt;"</span>, line <span class="number">1</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(**kwargs,x)</span>:</span></span><br><span class="line">                    ^</span><br><span class="line">SyntaxError: invalid syntax</span><br><span class="line"><span class="comment"># 直接报语法错误</span></span><br><span class="line"><span class="comment"># 可以理解为kwargs会截获所有的关键字参数，就算你写了x=5，x也永远得不到这个值，所以语法错误</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># keyword-only参数另一种形式</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(*,x,y)</span>:</span>   <span class="comment"># 星号或*args后如果有x,y，那么x，y都会变成关键字参数</span></span><br><span class="line">    print(x,y)</span><br><span class="line">fn(x=<span class="number">5</span>,y=<span class="number">6</span>)</span><br><span class="line"><span class="comment"># *号之后，普通形参都变成了必须给出的keyword-only参数。星号表示只接受两个参数x和y，且两个参数都要是关键字参数 </span></span><br><span class="line">- 定义时，一个星号后一般都用args，表示多个参数，如果是两个星号，用*kwargs，表示keywordargs</span><br></pre></td></tr></table></figure>
<h3 id="可变参数和参数默认值"><a href="#可变参数和参数默认值" class="headerlink" title="可变参数和参数默认值"></a>可变参数和参数默认值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(*args,x=<span class="number">5</span>)</span>:</span></span><br><span class="line">    print(x)</span><br><span class="line">    print(args)</span><br><span class="line">fn()</span><br><span class="line">输出：</span><br><span class="line"><span class="number">5</span></span><br><span class="line">()</span><br><span class="line"><span class="comment"># 等价于fn(x=5)</span></span><br><span class="line"></span><br><span class="line">fn(<span class="number">5</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">5</span></span><br><span class="line">(<span class="number">5</span>,)</span><br><span class="line"></span><br><span class="line">fn(x=<span class="number">6</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">6</span></span><br><span class="line">()</span><br><span class="line"></span><br><span class="line">fn(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,x=<span class="number">10</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">10</span></span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(y,*args,x=<span class="number">5</span>)</span>:</span></span><br><span class="line">    print(<span class="string">'x=&#123;&#125;,y=&#123;&#125;'</span>.format(x,y))</span><br><span class="line">    print(args)</span><br><span class="line"></span><br><span class="line">fn()</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-67</span>-d1577c4645e1&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">3</span>     print(args)</span><br><span class="line">      <span class="number">4</span> </span><br><span class="line">----&gt; 5 fn()</span><br><span class="line"></span><br><span class="line">TypeError: fn() missing <span class="number">1</span> required positional argument: <span class="string">'y'</span></span><br><span class="line">        </span><br><span class="line">fn(<span class="number">5</span>)</span><br><span class="line">输出：</span><br><span class="line">x=<span class="number">5</span>,y=<span class="number">5</span></span><br><span class="line">()</span><br><span class="line"></span><br><span class="line">fn(x=<span class="number">6</span>)</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-69</span><span class="number">-0</span>a11163cdc28&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">3</span>     print(args)</span><br><span class="line">      <span class="number">4</span> </span><br><span class="line">----&gt; 5 fn(x=6)</span><br><span class="line"></span><br><span class="line">TypeError: fn() missing <span class="number">1</span> required positional argument: <span class="string">'y'</span></span><br><span class="line">        </span><br><span class="line">fn(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,x=<span class="number">10</span>)</span><br><span class="line">输出：</span><br><span class="line">x=<span class="number">10</span>,y=<span class="number">1</span></span><br><span class="line">(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">fn(y=<span class="number">17</span>,<span class="number">2</span>,<span class="number">3</span>,x=<span class="number">10</span>)</span><br><span class="line">输出：</span><br><span class="line">  File <span class="string">"&lt;ipython-input-71-f33d57e490fb&gt;"</span>, line <span class="number">5</span></span><br><span class="line">    fn(y=<span class="number">17</span>,<span class="number">2</span>,<span class="number">3</span>,x=<span class="number">10</span>)</span><br><span class="line">           ^</span><br><span class="line">SyntaxError: positional argument follows keyword argument</span><br><span class="line">    </span><br><span class="line">fn(<span class="number">1</span>,<span class="number">2</span>,y=<span class="number">3</span>,x=<span class="number">10</span>)</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-72</span><span class="number">-526</span>c5ac03606&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">3</span>     print(args)</span><br><span class="line">      <span class="number">4</span> </span><br><span class="line">----&gt; 5 fn(1,2,y=3,x=10)</span><br><span class="line"></span><br><span class="line">TypeError: fn() got multiple values <span class="keyword">for</span> argument <span class="string">'y'</span></span><br><span class="line"><span class="comment"># x是keyword-only参数</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(x=<span class="number">5</span>,**kwargs)</span>:</span></span><br><span class="line">    print(<span class="string">'x=&#123;&#125;'</span>.format(x))</span><br><span class="line">    print(kwargs)</span><br><span class="line">    </span><br><span class="line">fn()</span><br><span class="line">输出：</span><br><span class="line">x=<span class="number">5</span></span><br><span class="line">&#123;&#125;</span><br><span class="line"></span><br><span class="line">fn(<span class="number">5</span>)</span><br><span class="line">输出：</span><br><span class="line">x=<span class="number">5</span></span><br><span class="line">&#123;&#125;</span><br><span class="line"></span><br><span class="line">fn(x=<span class="number">6</span>)</span><br><span class="line">输出：</span><br><span class="line">x=<span class="number">6</span></span><br><span class="line">&#123;&#125;</span><br><span class="line"></span><br><span class="line">fn(y=<span class="number">3</span>,x=<span class="number">10</span>)</span><br><span class="line">输出：</span><br><span class="line">x=<span class="number">10</span></span><br><span class="line">&#123;<span class="string">'y'</span>: <span class="number">3</span>&#125;</span><br><span class="line"></span><br><span class="line">fn(<span class="number">3</span>,y=<span class="number">10</span>)</span><br><span class="line">输出：</span><br><span class="line">x=<span class="number">3</span></span><br><span class="line">&#123;<span class="string">'y'</span>: <span class="number">10</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="函数参数规则"><a href="#函数参数规则" class="headerlink" title="函数参数规则"></a>函数参数规则</h3><ul>
<li><strong><em>参数列表参数一般顺序是，普通参数、缺省参数、可变位置参数、keyword-only参数(可带缺省值)、可变关键字参数</em></strong></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(x,y,z=<span class="number">3</span>,*arg,m=<span class="number">4</span>,n,**kwargs)</span>:</span></span><br><span class="line">    print(x,y,z,m,n)</span><br><span class="line">    print(args)</span><br><span class="line">    print(kwargs)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>注意</p>
<ul>
<li>代码应该易读易懂，而不是为难别人</li>
<li>请按照书写习惯定义函数参数</li>
</ul>
</li>
<li><p>参数规则举例</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">connect</span><span class="params">(host=<span class="string">'localhost'</span>, port=<span class="string">'3306'</span>, user=<span class="string">'admin'</span>, password=<span class="string">'admin'</span>, **kwargs)</span>:</span></span><br><span class="line">	print(host, port)</span><br><span class="line">	print(user, password)</span><br><span class="line">	print(kwargs)</span><br><span class="line">    </span><br><span class="line">connect(db=<span class="string">'cmdb'</span>)</span><br><span class="line">输出：</span><br><span class="line">localhost <span class="number">3306</span></span><br><span class="line">admin admin</span><br><span class="line">&#123;<span class="string">'db'</span>: <span class="string">'cmdb'</span>&#125;</span><br><span class="line"></span><br><span class="line">connect(host=<span class="string">'192.168.1.123'</span>, db=<span class="string">'cmdb'</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">192.168</span><span class="number">.1</span><span class="number">.123</span> <span class="number">3306</span></span><br><span class="line">admin admin</span><br><span class="line">&#123;<span class="string">'db'</span>: <span class="string">'cmdb'</span>&#125;</span><br><span class="line"></span><br><span class="line">connect(host=<span class="string">'192.168.1.123'</span>, db=<span class="string">'cmdb'</span>, password=<span class="string">'mysql'</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">192.168</span><span class="number">.1</span><span class="number">.123</span> <span class="number">3306</span></span><br><span class="line">admin mysql</span><br><span class="line">&#123;<span class="string">'db'</span>: <span class="string">'cmdb'</span>&#125;</span><br></pre></td></tr></table></figure>
<h3 id="参数解构"><a href="#参数解构" class="headerlink" title="参数解构"></a>参数解构</h3><ul>
<li>举例</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加法函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x, y)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> x+y</span><br><span class="line"></span><br><span class="line">add(<span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">输出： Out:<span class="number">9</span></span><br><span class="line">    </span><br><span class="line">add((<span class="number">4</span>,<span class="number">5</span>))</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-82</span>-aca89f37f922&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">2</span>         <span class="keyword">return</span> x+y</span><br><span class="line">      <span class="number">3</span> </span><br><span class="line">----&gt; 4 add((4, 5))</span><br><span class="line"></span><br><span class="line">TypeError: add() missing <span class="number">1</span> required positional argument: <span class="string">'y'</span></span><br><span class="line">        </span><br><span class="line">t = (<span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">add(t[<span class="number">0</span>], t[<span class="number">1</span>])</span><br><span class="line">输出：Out:<span class="number">9</span></span><br><span class="line">    </span><br><span class="line">add(*t)</span><br><span class="line">输出：Out:<span class="number">9</span></span><br><span class="line">    </span><br><span class="line">add(*(<span class="number">4</span>,<span class="number">5</span>))</span><br><span class="line">输出：Out:<span class="number">9</span></span><br><span class="line">    </span><br><span class="line">add(*range(<span class="number">1</span>,<span class="number">3</span>))</span><br><span class="line">输出：Out:<span class="number">3</span></span><br><span class="line"><span class="comment"># range(1,3)的结果是1和2，所以相加是3</span></span><br><span class="line"></span><br><span class="line">add(*[<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line">输出：Out:<span class="number">9</span></span><br><span class="line">    </span><br><span class="line">add(*&#123;<span class="number">4</span>,<span class="number">6</span>&#125;)</span><br><span class="line">输出：Out:<span class="number">10</span></span><br></pre></td></tr></table></figure>
<ul>
<li>参数解构<ul>
<li>给函数提供实参的时候，可以在集合类型前使用*或者**，把集合类型的结构解开，提取出所有元素作为函数的实参</li>
<li>非字典类型使用*解构成位置参数</li>
<li>字典类型使用**解构成关键字参数</li>
<li>提取出来的元素数目要和参数的要求匹配，也要和参数的类型匹配</li>
<li>参数解构，有时候有，有时候没有。如果有，就把参数一个个解构出来，如果没有，就解构成一个整体，如列表或元组</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(x, y)</span>:</span></span><br><span class="line">	<span class="keyword">return</span> x+y</span><br><span class="line"></span><br><span class="line">add(*(<span class="number">4</span>,<span class="number">5</span>))</span><br><span class="line">输出：Out:<span class="number">9</span></span><br><span class="line"></span><br><span class="line">add(*[<span class="number">4</span>,<span class="number">5</span>])</span><br><span class="line">输出：Out:<span class="number">9</span></span><br><span class="line"></span><br><span class="line">add(*&#123;<span class="number">4</span>,<span class="number">6</span>&#125;)</span><br><span class="line">输出：Out:<span class="number">10</span></span><br><span class="line"></span><br><span class="line">d = &#123;<span class="string">'x'</span>: <span class="number">5</span>, <span class="string">'y'</span>: <span class="number">6</span>&#125;</span><br><span class="line">add(**d)</span><br><span class="line">输出：Out:<span class="number">11</span></span><br><span class="line"></span><br><span class="line">add(**&#123;<span class="string">'a'</span>: <span class="number">5</span>, <span class="string">'b'</span>: <span class="number">6</span>&#125;)</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-95</span><span class="number">-407</span>fdeb69ace&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">2</span>         <span class="keyword">return</span> x+y</span><br><span class="line">      <span class="number">3</span> </span><br><span class="line">----&gt; 4 add(**&#123;'a':5,'b':6&#125;)</span><br><span class="line"></span><br><span class="line">TypeError: add() got an unexpected keyword argument <span class="string">'a'</span></span><br><span class="line">    </span><br><span class="line">add(*&#123;<span class="string">'a'</span>: <span class="number">5</span>, <span class="string">'b'</span>: <span class="number">6</span>&#125;)</span><br><span class="line">输出：Out:<span class="string">'ab'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>参数解构和可变参数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 给函数提供实参的时候，可以在集合类型前使用*或者**，把集合类型的结构解开，提取出所有元素作为函数的实参</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(*iterable)</span>:</span></span><br><span class="line">	result = <span class="number">0</span></span><br><span class="line">	<span class="keyword">for</span> x <span class="keyword">in</span> iterable:</span><br><span class="line">		result += x</span><br><span class="line">	<span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">add(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line">输出：Out:<span class="number">6</span></span><br><span class="line">    </span><br><span class="line">add(*[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">输出：Out:<span class="number">6</span></span><br><span class="line"></span><br><span class="line">add(*range(<span class="number">10</span>))</span><br><span class="line">输出：Out:<span class="number">45</span></span><br><span class="line"></span><br><span class="line">- 可见范围，函数内定义的变量，在函数外是不可见的，不能调用。</span><br><span class="line">- 但在函数外定义一个变量，在函数内可以调用</span><br><span class="line">- 函数内的变量叫本地变量</span><br></pre></td></tr></table></figure>
<h3 id="函数的返回值"><a href="#函数的返回值" class="headerlink" title="函数的返回值"></a>函数的返回值</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showplus</span><span class="params">(x)</span>:</span></span><br><span class="line">    print(x)</span><br><span class="line">    <span class="keyword">return</span> x + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">showplus(<span class="number">5</span>)</span><br><span class="line">输出：</span><br><span class="line"><span class="number">5</span></span><br><span class="line">Out:<span class="number">6</span></span><br></pre></td></tr></table></figure>
<ul>
<li>多条return语句</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">guess</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"&gt;3"</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"&lt;=3"</span></span><br><span class="line">print(guess(<span class="number">10</span>))</span><br><span class="line">输出：</span><br><span class="line">&gt;<span class="number">3</span></span><br><span class="line"><span class="comment"># return可以执行多次吗？</span></span><br></pre></td></tr></table></figure>
<ul>
<li>举例</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(x):</span><br><span class="line">        <span class="keyword">if</span> i &gt; <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">return</span> i</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">"&#123;&#125; is not greater than 3"</span>.format(i))</span><br><span class="line">            </span><br><span class="line"><span class="comment"># print(fn(5)) 打印什么？</span></span><br><span class="line"><span class="number">0</span> <span class="keyword">is</span> <span class="keyword">not</span> greater than <span class="number">3</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">is</span> <span class="keyword">not</span> greater than <span class="number">3</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">is</span> <span class="keyword">not</span> greater than <span class="number">3</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">is</span> <span class="keyword">not</span> greater than <span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(fn(3)) 打印什么？</span></span><br><span class="line"><span class="number">0</span> <span class="keyword">is</span> <span class="keyword">not</span> greater than <span class="number">3</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">is</span> <span class="keyword">not</span> greater than <span class="number">3</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">is</span> <span class="keyword">not</span> greater than <span class="number">3</span></span><br><span class="line"><span class="keyword">None</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>总结</p>
<ul>
<li>Python函数使用return语句返回“返回值”</li>
<li>所有函数都有返回值，如果没有使用return语句，隐式调用return None</li>
<li>return语句并不一定是函数的语句块的最后一条语句</li>
<li>一个函数可以存在多个return语句，但是只有一条可以被执行。如果没有一条return语句被执行到，隐式调用return None</li>
<li>如果有必要，可以显示调用return None，可以简写为return</li>
<li>如果函数执行了return语句，函数就会返回，当前被执行的return语句之后的其它语句就不会被执行了</li>
<li>作用：结束函数调用、返回值</li>
</ul>
</li>
<li><p>返回多个值</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showlist</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>]</span><br><span class="line"><span class="comment"># showlist函数是返回了多个值吗？</span></span><br><span class="line">输出： Out:[<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>]</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showlist</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span></span><br><span class="line"><span class="comment"># 这次showlist函数是否返回了多个值？</span></span><br><span class="line">输出：Out:(<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>)</span><br><span class="line">    </span><br><span class="line">- 函数不能同时返回多个值</span><br><span class="line">- <span class="keyword">return</span> [<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>]是指明返回一个列表，是一个列表对象</span><br><span class="line">- <span class="keyword">return</span> <span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span> 看似返回多个值，隐式的被python封装成了一个元组</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">showlist</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span></span><br><span class="line"></span><br><span class="line">x,y,z = showlist()</span><br><span class="line"><span class="comment"># 使用解构提取更为方便</span></span><br></pre></td></tr></table></figure>
<h3 id="函数嵌套"><a href="#函数嵌套" class="headerlink" title="函数嵌套"></a>函数嵌套</h3><ul>
<li>在一个函数中定义了另外一个函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span><span class="params">()</span>:</span></span><br><span class="line">        print(<span class="string">"inner"</span>)</span><br><span class="line">    print(<span class="string">"outer"</span>)</span><br><span class="line">    inner()</span><br><span class="line">outer()</span><br><span class="line">inner()</span><br><span class="line"></span><br><span class="line">- 函数有可见范围，这就是作用域的概念</span><br><span class="line">- 内部函数不能在外部直接使用，会抛NameError异常，因为它不可见</span><br></pre></td></tr></table></figure>
<h3 id="作用域"><a href="#作用域" class="headerlink" title="作用域***"></a>作用域***</h3><ul>
<li>一个标识符的可见范围，这就是标识符的作用域。一般常说的是变量的作用域</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- 举例，对比下面两个函数，x到底是否可见？</span><br><span class="line">x = <span class="number">5</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">    print(x)</span><br><span class="line">    </span><br><span class="line">foo()</span><br><span class="line"></span><br><span class="line">x = <span class="number">5</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">    x += <span class="number">1</span></span><br><span class="line">    print(x)</span><br><span class="line">    </span><br><span class="line">foo()</span><br></pre></td></tr></table></figure>
<ul>
<li>全局作用域<ul>
<li>在整个程序运行环境中都可见</li>
</ul>
</li>
<li>局部作用域<ul>
<li>在函数、类等内部可见</li>
<li>局部变量使用范围不能超过其所在的局部作用域</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn1</span><span class="params">()</span>:</span></span><br><span class="line">    x = <span class="number">1</span></span><br><span class="line"><span class="comment"># 局部作用域，在fn1内</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fn2</span><span class="params">()</span>:</span></span><br><span class="line">    print(x)</span><br><span class="line"><span class="comment"># x 可见吗</span></span><br><span class="line">print(x)</span><br><span class="line"><span class="comment"># x 可见吗</span></span><br><span class="line"></span><br><span class="line">* 嵌套结构</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer1</span><span class="params">()</span>:</span></span><br><span class="line">    o = <span class="number">65</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span><span class="params">()</span>:</span></span><br><span class="line">        print(<span class="string">"inner &#123;&#125;"</span>.format(o))</span><br><span class="line">        print(chr(o))</span><br><span class="line">    print(<span class="string">"outer &#123;&#125;"</span>.format(o))</span><br><span class="line">    inner()</span><br><span class="line">    </span><br><span class="line">outer1()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">outer2</span><span class="params">()</span>:</span></span><br><span class="line">    o = <span class="number">65</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span><span class="params">()</span>:</span></span><br><span class="line">        o = <span class="number">97</span></span><br><span class="line">        print(<span class="string">"inner &#123;&#125;"</span>.format(o))</span><br><span class="line">        print(chr(o))</span><br><span class="line">    print(<span class="string">"outer &#123;&#125;"</span>.format(o))</span><br><span class="line">    </span><br><span class="line">outer2()</span><br><span class="line"><span class="comment"># 上面两个函数中变量o的差别</span></span><br><span class="line">- 从嵌套结构例子看出</span><br><span class="line">	- 外层变量作用域在内层作用域可见</span><br><span class="line">    - 内层作用域inner中，如果定义了o=<span class="number">97</span>，相当于当前作用域中重新定义了一个新的变量o，但是这个o并没有覆</span><br><span class="line">    盖外层作用域outer2中的o</span><br><span class="line">    </span><br><span class="line">x = <span class="number">5</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">    y = x + <span class="number">1</span>   <span class="comment"># 会报错吗？</span></span><br><span class="line">    x += <span class="number">1</span>  <span class="comment"># 报错，报什么错？为什么？换成x=1还有错吗？</span></span><br><span class="line"><span class="comment"># 这里报错的原因是，左边的x就相当于要定义一个x，那么系统会认为要在本地重新定义这个x。而右边的x+1表示要</span></span><br><span class="line"><span class="comment"># 调用本地x的值，但x在本地还没有定义所以会报错。而上面的y = x + 1表示调用外部的x的值，所以不会报错。调</span></span><br><span class="line"><span class="comment"># 用函数时系统会先扫描语句块内部是否有x =，如果有，表示定义了一个本地x，所以不能再引用x</span></span><br><span class="line">    print(x)   <span class="comment"># 为什么它不报错</span></span><br><span class="line">    </span><br><span class="line">foo()</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">UnboundLocalError                         Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-1</span><span class="number">-8</span>bced725b7fd&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">7</span> <span class="comment"># 引用x</span></span><br><span class="line">      <span class="number">8</span>     print(x)</span><br><span class="line">----&gt; 9 foo()</span><br><span class="line"></span><br><span class="line">&lt;ipython-input<span class="number">-1</span><span class="number">-8</span>bced725b7fd&gt; <span class="keyword">in</span> foo()</span><br><span class="line">      <span class="number">1</span> x = <span class="number">5</span></span><br><span class="line">      <span class="number">2</span> <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">----&gt; 3     y = x + 1</span><br><span class="line">      <span class="number">4</span>     x = x + <span class="number">1</span></span><br><span class="line"></span><br><span class="line">UnboundLocalError: local variable <span class="string">'x'</span> referenced before assignment</span><br><span class="line"></span><br><span class="line">- x += <span class="number">1</span> 其实是x = x + <span class="number">1</span></span><br><span class="line">- 相当于在foo内部定义一个局部变量x，那么foo内部所有x都是这个局部变量x了</span><br><span class="line">- 但是这个x还没有完成赋值，就被右边拿来做加<span class="number">1</span>操作了</span><br><span class="line">- 如何解决这个问题？</span><br></pre></td></tr></table></figure>
<ul>
<li>全局变量global</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> x</span><br><span class="line">    x = <span class="number">10</span></span><br><span class="line">    x += <span class="number">1</span>   <span class="comment"># 报错吗？</span></span><br><span class="line">    print(x)   <span class="comment"># 打印什么？</span></span><br><span class="line">print(x)   <span class="comment"># 打印什么？</span></span><br><span class="line"><span class="comment"># 做这些实验建议不要使用ipython、jupyter，因为它会使用上下文中x的定义，也就是之前的x的定义，可能测试</span></span><br><span class="line"><span class="comment"># 不出来效果。如果要用这些工具，要在函数前用del x先删除变量</span></span><br><span class="line"></span><br><span class="line">- 使用<span class="keyword">global</span>关键字的变量，将foo内的x声明为使用外部的全局作用域中定义的x</span><br><span class="line">- 但是，x = <span class="number">10</span>赋值即定义，这是在内部作用域为一个外部作用域的变量x赋值，而不是在内部作用域定义一个新变</span><br><span class="line">  量，所以x += <span class="number">1</span>不会报错。注意，这里x的作用域还是全局的。</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> z</span><br><span class="line">    z = <span class="number">20</span></span><br><span class="line">    z += <span class="number">2</span></span><br><span class="line">    print(z)</span><br><span class="line">foo()</span><br><span class="line">print(z)</span><br><span class="line"><span class="comment"># 这个z是一个全局的变量，而不是本地的变量。因为在最后的print()函数打印的z是不能调用函数内的变量的，只能</span></span><br><span class="line"><span class="comment"># 由函数内调用函数外的变量因为在函数中使用了global，所以已经定义了作用域在外部，即使在内部又定义了一个</span></span><br><span class="line"><span class="comment"># 本地变量也没用。在内部的z = 20等于是在外部定义了一个变量</span></span><br></pre></td></tr></table></figure>
<ul>
<li>global总结<ul>
<li>x+=1这种是特殊形式产生的错误的原因？先引用后赋值，而python动态语言是赋值才算定义，才能被引用。解决办法是在这条语句前增加x=0之类的赋值语句，或者使用global告诉内部作用域，去全局作用域查找变量定义</li>
<li><strong><em>内部作用域使用x=5之类的赋值语句会重新定义局部作用域使用的变量x，但是，一旦这个作用域中使用global声明x为全局的，那么x=5相当于在为全局作用域的变量x赋值</em></strong></li>
<li>global使用原则<ul>
<li>外部作用域变量会在内部作用域可见，但也不要在这个内部的局部作用域中直接使用，因为函数的目的就是为了封装，尽量与外界隔离</li>
<li>如果函数需要使用外部全局变量，请使用函数的形参传参解决</li>
<li>一句话：不用global。学习它就是为了深入理解变量作用域</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="闭包"><a href="#闭包" class="headerlink" title="闭包*"></a>闭包*</h3><ul>
<li>自由变量：未在本地作用域中定义的变量。例如定义在内存函数外的外层函数的作用域中的变量</li>
<li>闭包：就是一个概念，出现在嵌套函数中，指的是内层函数引用到了外层函数的自由变量，就形成了闭包。这实际是一个函数嵌套，内层的函数引用到了上一层函数的问题。如果引用的是全局作用域中的函数就不是闭包。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><span class="line">- c[<span class="number">0</span>] += <span class="number">1</span>这行会报错吗？</span><br><span class="line">- print(foo(),foo())会打印什么结果？</span><br><span class="line">- print(foo())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">()</span>:</span></span><br><span class="line">    c = [<span class="number">0</span>]  <span class="comment"># 定义变量并赋值</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span><span class="params">()</span>:</span></span><br><span class="line">        c[<span class="number">0</span>] += <span class="number">1</span>   </span><br><span class="line"><span class="comment"># 这里是修改c变量，而不是赋值，修改不是重新定义。而且这是对c变量的内部元素在修改，对变量本身没有修改。这</span></span><br><span class="line"><span class="comment"># 里没有用global，而用一个引用类型来实现，这样就避开了c += 1会报错的情况。所以这行不会报错</span></span><br><span class="line">        <span class="keyword">return</span> c[<span class="number">0</span>]   <span class="comment"># 这里返回c[0]的值，也就是返回了c第一个元素的值</span></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"><span class="comment"># 这里不是函数调用，因为没有括号。这里返回的是一个标识符/函数名，这个标识符对应一个对象。标识符用来定义</span></span><br><span class="line"><span class="comment"># 一个对象，这个对象叫函数，所以返回的是函数对象。它返回的不是函数调用的返回值。加括号表示调用函数。这行</span></span><br><span class="line"><span class="comment"># 返回的不是函数调用的结果，这里的返回值就是inner，inner是一个可调用对象callable，也是一个function对象</span></span><br><span class="line"></span><br><span class="line">foo = counter()  </span><br><span class="line"><span class="comment"># 这里的counter()函数调用返回的是return inner，也就是函数对象的引用。这里的foo的类型也变成了一个</span></span><br><span class="line"><span class="comment"># callable，可调用对象。这时foo就等于inner了，foo()与inner()是一样的，像是一个别名。但在外面不能使</span></span><br><span class="line"><span class="comment"># 用inner() 这种方法，因为它是函数中的函数，所以在外面是不可见的。从里面可以使用外面的变量，用global。</span></span><br><span class="line"><span class="comment"># 但从外面不能引用函数中的定义</span></span><br><span class="line">print(type(foo))   <span class="comment"># 这就可以看出foo是一个function了</span></span><br><span class="line">print(callable(foo))   <span class="comment"># 这里返回True</span></span><br><span class="line">print(type(foo()))</span><br><span class="line">print(foo(),foo())</span><br><span class="line"><span class="comment"># 这里要调用两次foo函数，调用第一个foo()的时候就会进到函数中的def inner():里面，执行c[0] += 1和</span></span><br><span class="line"><span class="comment"># return c[0]，因为c的索引0的值在def counter():中定义了是0，再加1后，c就是1了，之后用return返回。</span></span><br><span class="line"><span class="comment"># 第二次调用foo()时，c已经是1了，这时c再加1就变成2了，之后返回。这说明c的值被保留下来了。一般按道理执</span></span><br><span class="line"><span class="comment"># 行过foo()之后，它的局部变量就没了，也就是c = [0]这个值就应该随counter函数消亡了，每次调用foo()时，</span></span><br><span class="line"><span class="comment"># c = [0]这个值应该不存在或重新赋值。但这里foo = counter()一步拿到了一个内部函数的引用，然后赋值给了</span></span><br><span class="line"><span class="comment"># 一个变量，之后加1，这时c[0]的值一定不是0。对象计数引用加1。被引用后inner()这个对象不应该被消亡，所以</span></span><br><span class="line"><span class="comment"># 打印时，foo是function对象，而且一定是callable的，也可以把一个callable对象用callable()检查，如果</span></span><br><span class="line"><span class="comment"># 是可调用对象，会返回True。counter()中定义的c = [0]没有消亡，而且可以被inner()函数引用，那么</span></span><br><span class="line"><span class="comment"># inner()函数就使用了一个外层函数的变量，这个c就叫自由变量。内部使用了外层函数的变量，外层函数的变量就</span></span><br><span class="line"><span class="comment"># 叫自由变量，使用了自由变量就产生了闭包，因为有闭包，所以c变量就一直存在，所以第一次调用后，c[0]就变</span></span><br><span class="line"><span class="comment"># 成了1，第二次调用时，以c[0]的值是1为基础，调用后就变成了2</span></span><br><span class="line">c = <span class="number">200</span>  <span class="comment"># 覆盖c，这里定义的是一个全局变量，但与上面的函数定义中的c没有关系</span></span><br><span class="line">print(foo())  </span><br><span class="line"><span class="comment"># 再调用foo函数，因为上面调用过两次了，所以这时c[0]的值已经是2了，所以这里再调用时，c[0]的值就变成了3</span></span><br><span class="line"><span class="comment"># 如果要改变外部变量的元素的值，在python2中只能用这种方法，在python3中可以使用nonlocal</span></span><br><span class="line">输出：</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">function</span>'&gt;</span></span><br><span class="line"><span class="class"><span class="title">True</span></span></span><br><span class="line"><span class="class">&lt;<span class="title">class</span> '<span class="title">int</span>'&gt;</span></span><br><span class="line"><span class="class">1 2</span></span><br><span class="line"><span class="class">3</span></span><br><span class="line">=======================================================================================</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">counter1</span><span class="params">()</span>:</span></span><br><span class="line">    c = <span class="number">5</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner1</span><span class="params">()</span>:</span></span><br><span class="line"><span class="comment">#        c += 1</span></span><br><span class="line">         <span class="keyword">return</span> c     </span><br><span class="line"><span class="comment"># 这也是一个闭包，因为这也是对外部变量的引用。引用时只要改变外部变量就不是闭包了。如在这里加上c = 4，这</span></span><br><span class="line"><span class="comment"># 里的c与外部的c就是两个变量了。闭包就是为了使用外层函数的变量，如果加入c += 1，就会出问题了。因为这时</span></span><br><span class="line"><span class="comment"># 没有定义c，就要改变c的值。上面只是改变c的元素的值。所以在定义时c就不能被定义成一个数字，应该定义为列</span></span><br><span class="line"><span class="comment"># 表，set等。如果要用c += 1这种方式，要用glocal</span></span><br><span class="line">    <span class="keyword">return</span> inner1</span><br><span class="line"></span><br><span class="line">foo1 = counter1()</span><br><span class="line">print(callable(foo1))</span><br><span class="line">print(foo1(),foo1())</span><br><span class="line">c = <span class="number">200</span></span><br><span class="line">print(foo1())</span><br><span class="line">输出：</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">UnboundLocalError                         Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-11</span>-d6047de65f5a&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">     <span class="number">11</span> foo1 = counter1()</span><br><span class="line">     <span class="number">12</span> print(callable(foo1))</span><br><span class="line">---&gt; 13 print(foo1(),foo1())</span><br><span class="line">     <span class="number">14</span> c = <span class="number">200</span></span><br><span class="line">     <span class="number">15</span> print(foo1())</span><br><span class="line"></span><br><span class="line">&lt;ipython-input<span class="number">-11</span>-d6047de65f5a&gt; <span class="keyword">in</span> inner1()</span><br><span class="line">      <span class="number">2</span>     c = <span class="number">5</span></span><br><span class="line">      <span class="number">3</span>     <span class="function"><span class="keyword">def</span> <span class="title">inner1</span><span class="params">()</span>:</span></span><br><span class="line">----&gt; 4         c += 1</span><br><span class="line">      <span class="number">5</span> <span class="comment">#         return c</span></span><br><span class="line">      <span class="number">6</span> <span class="comment"># 这也是一个闭包，因为这也是对外部变量的引用。引用时只要改变外部变量就不是闭包了。如在这里加上c = 4，这里的c与外部的c就是两个变量了</span></span><br><span class="line"></span><br><span class="line">UnboundLocalError: local variable <span class="string">'c'</span> referenced before assignment</span><br><span class="line"><span class="comment"># 使用global可以解决上面的报错，但这样使用的是全局变量，而不是闭包</span></span><br><span class="line"><span class="comment"># 如果要用对普通变量的闭包，python3中可以使用nonlocal</span></span><br><span class="line">=======================================================================================</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">counter1</span><span class="params">()</span>:</span></span><br><span class="line">    c = [<span class="number">4</span>]</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner1</span><span class="params">()</span>:</span></span><br><span class="line">        c.append(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> c     </span><br><span class="line">    <span class="keyword">return</span> inner1</span><br><span class="line"></span><br><span class="line">foo1 = counter1()</span><br><span class="line">print(callable(foo1))</span><br><span class="line">print(foo1(),foo1())</span><br><span class="line">c = <span class="number">200</span></span><br><span class="line">print(foo1())</span><br><span class="line">输出：</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line">[<span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>] [<span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">[<span class="number">4</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">=======================================================================================</span><br><span class="line"><span class="comment"># del c</span></span><br><span class="line">c = <span class="number">9</span>   <span class="comment"># 加上这句就不会报错了</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">count</span><span class="params">()</span>:</span></span><br><span class="line">    c = <span class="number">1</span></span><br><span class="line">    a = <span class="number">10</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">global</span> c   </span><br><span class="line">  <span class="comment"># 报错的原因是在函数的外部没有定义过c，函数中定义的都算本地环境。解析器才是global环境</span></span><br><span class="line"><span class="comment"># global的作用域在全局和使用global声明的函数中有效。以这个函数来说，只在全局和inner()函数中有效。</span></span><br><span class="line">        c += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line">foo = count()</span><br><span class="line">print(foo())   <span class="comment"># 执行错误，提示c没有定义</span></span><br><span class="line">print(foo())</span><br><span class="line">输出：</span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">11</span></span><br></pre></td></tr></table></figure>
<h3 id="nonlocal关键字"><a href="#nonlocal关键字" class="headerlink" title="nonlocal关键字"></a>nonlocal关键字</h3><ul>
<li>使用了nonlocal关键字，将变量标记为不在本地作用域定义，而在<em>上级的某一级</em>局部作用域中定义，但<em>不能是全局作用域中</em>定义</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">()</span>:</span></span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inc</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">nonlocal</span> count</span><br><span class="line"><span class="comment"># 表示不是本地作用域定义的，是上一级的局部作用域而且不是全局作用域的作用域定义的。这样count += 1就不会报错了</span></span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">    <span class="keyword">return</span> inc</span><br><span class="line"></span><br><span class="line">foo = counter()</span><br><span class="line">foo()</span><br><span class="line">foo()</span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line">- count是外层函数的局部变量，被内部函数引用</span><br><span class="line">- 内部函数使用<span class="keyword">nonlocal</span>关键字声明count变量在上级作用域而非本地作用域中定义</span><br><span class="line">- 上面代码可以正常使用，且形成闭包</span><br><span class="line">=======================================================================================</span><br><span class="line">a = <span class="number">50</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">counter</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">nonlocal</span> a</span><br><span class="line">    a += <span class="number">1</span></span><br><span class="line">    print(a)</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inc</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">nonlocal</span> count</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">    <span class="keyword">return</span> inc</span><br><span class="line"></span><br><span class="line">foo = counter()</span><br><span class="line">foo()</span><br><span class="line">foo()</span><br><span class="line">- 这段代码不能正常运行，变量a不能在全局作用域中</span><br></pre></td></tr></table></figure>
<h3 id="默认值作用域"><a href="#默认值作用域" class="headerlink" title="默认值作用域"></a>默认值作用域</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(xyz=<span class="number">2</span>)</span>:</span></span><br><span class="line">    print(xyz)</span><br><span class="line"></span><br><span class="line">foo()</span><br><span class="line"><span class="comment"># 无论调用几次都会打印2，返回None</span></span><br><span class="line"></span><br><span class="line">print(xyz)</span><br><span class="line"><span class="comment"># xyz虽然是形参，但也是一个局部变量，所以会报错。因为它只能在函数内使用</span></span><br><span class="line">输出：</span><br><span class="line"><span class="number">2</span></span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">NameError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-2</span><span class="number">-9</span>faea3c8b99f&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">5</span> <span class="comment"># 这会打印2，返回None</span></span><br><span class="line">      <span class="number">6</span> </span><br><span class="line">----&gt; 7 print(xyz)</span><br><span class="line">      <span class="number">8</span> <span class="comment"># xyz虽然是形参，但也是一个局部变量，所以会报错。因为它只能在函数内使用</span></span><br><span class="line"></span><br><span class="line">NameError: name <span class="string">'xyz'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br><span class="line">    </span><br><span class="line">=======================================================================================</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(xyz=[])</span>:</span></span><br><span class="line">    xyz.append(<span class="number">100</span>)</span><br><span class="line">    print(xyz)</span><br><span class="line"></span><br><span class="line">foo()</span><br><span class="line">输出：</span><br><span class="line">[<span class="number">100</span>]</span><br><span class="line">foo()</span><br><span class="line">输出：</span><br><span class="line">[<span class="number">100</span>, <span class="number">100</span>]</span><br><span class="line"><span class="comment"># 引用类型要小心。这不是xyz导致的，而是缺省值/默认值导致的。xyz用完或调用完就消亡了</span></span><br><span class="line"><span class="comment"># 第二次打印[100,100]是因为在当前作用域，也就是全局作用域内，ipython这个运行环境在当前作用域内还没有</span></span><br><span class="line"><span class="comment"># 结束。foo是一个函数对象，这个对象没有消亡，它还存在，它把xyz的默认值放在了一个函数对象的特殊属</span></span><br><span class="line"><span class="comment"># 性上了，这个属性叫foo.__defaults__。这个对象没有消亡，所以这个属性一直存在，这个属性是一个值，就是</span></span><br><span class="line"><span class="comment"># 把xyz = []放到了这个属性中，xyz的值是一个列表，列表元素可以改变。这就是每次调用foo函数都会变化的原</span></span><br><span class="line"><span class="comment"># 因。并不是因为xyz还存在，xyz会随函数调用而消亡。__defaults__是为函数对象提供的特殊属性</span></span><br><span class="line">- 为什么第二次调用foo函数打印的是[<span class="number">100</span>,<span class="number">100</span>]</span><br><span class="line">- 因为函数也是对象，python把函数的默认值放在了属性中，这个属性就伴随着这个函数对象的整个生命周期</span><br><span class="line">- 查看foo.__defaults__属性</span><br><span class="line">=======================================================================================</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(xyz=[],m=<span class="number">5</span>,n=<span class="number">6</span>)</span>:</span></span><br><span class="line">    xyz.append(<span class="number">100</span>)</span><br><span class="line">    print(xyz)</span><br><span class="line">    </span><br><span class="line">print(<span class="number">1</span>,foo.__defaults__)</span><br><span class="line"><span class="comment"># 在调用前打印一次，所以是默认值：([], 5, 6)</span></span><br><span class="line">print(foo(),id(foo))</span><br><span class="line"><span class="comment"># 查看一个foo函数对象的内存地址。执行时会先执行foo()调用，所以会执行函数内的print(xzy)，打印出[100]</span></span><br><span class="line">print(<span class="number">2</span>, foo.__defaults__)</span><br><span class="line"><span class="comment"># __defaults__是一个属性，属性就不用加括号了。加括号就成调用了</span></span><br><span class="line">print(foo(),id(foo))</span><br><span class="line"><span class="comment"># 第二次调用，并查看foo的地址是否改变。如果没变，说明在当前作用域内，就是那一个对象，是同一个对象</span></span><br><span class="line"><span class="comment"># 地址可以用is来判断，内容是否相同可以用==来判断</span></span><br><span class="line">print(<span class="number">3</span>,foo.__defaults__)</span><br><span class="line"><span class="comment"># 查看函数默认值是否改变</span></span><br><span class="line"><span class="comment"># 可以看到执行结果是一个元组：([100], 5, 6)，但元组中还有列表，所以可以变化</span></span><br><span class="line"><span class="comment"># 在当前的这个运行环境中，内存地址都不会改变。因为它指向的是同一个函数对象。对cPython来说，id()取的是</span></span><br><span class="line"><span class="comment"># 这个对象的地址，第二次相当于对默认值做了改变，所以第二次，第三次的值都不一样。但如果设置了默认值，如</span></span><br><span class="line"><span class="comment"># m=5，那么这是不可替换的，并且在元组中，更是不能改变的</span></span><br><span class="line">输出：</span><br><span class="line"><span class="number">1</span> ([], <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">[<span class="number">100</span>]</span><br><span class="line"><span class="keyword">None</span> <span class="number">140460738254232</span></span><br><span class="line"><span class="number">2</span> ([<span class="number">100</span>], <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">[<span class="number">100</span>, <span class="number">100</span>]</span><br><span class="line"><span class="keyword">None</span> <span class="number">140460738254232</span></span><br><span class="line"><span class="number">3</span> ([<span class="number">100</span>, <span class="number">100</span>], <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">- 函数地址并没有变，调用它，它的属性__defaults__中使用元组保存默认值</span><br><span class="line">- xyz默认值是引用类型，引用类型的元素变动，并不是元组的变化</span><br><span class="line">=======================================================================================</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(w,u=<span class="string">'abc'</span>,*,z=<span class="number">123</span>,zz=[<span class="number">456</span>])</span>:</span></span><br><span class="line">    u = <span class="string">'xyz'</span></span><br><span class="line">    z = <span class="number">789</span></span><br><span class="line">    zz.append(<span class="number">1</span>)</span><br><span class="line">    print(w,u,z,zz)</span><br><span class="line">print(foo.__defaults__)</span><br><span class="line">foo(<span class="string">'magedu'</span>)</span><br><span class="line">print(foo.__kwdefaults__)</span><br><span class="line">输出：</span><br><span class="line">(<span class="string">'abc'</span>,)</span><br><span class="line">magedu xyz <span class="number">789</span> [<span class="number">456</span>, <span class="number">1</span>]</span><br><span class="line">&#123;<span class="string">'z'</span>: <span class="number">123</span>, <span class="string">'zz'</span>: [<span class="number">456</span>, <span class="number">1</span>]&#125;</span><br><span class="line"></span><br><span class="line">- 属性__defaults__中使用元组保存所有位置参数默认值，这里说的位置参数包括关键字参数或默认参数</span><br><span class="line">- 属性__kwdefaults__中使用字典保存所有keyword-only参数的默认值</span><br><span class="line">- 这里涉及之前的概念不可混淆。位置参数与关键字参数是传参的方法不一样，但定义函数时是一样的，都是</span><br><span class="line">- <span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(a,b,c)</span>，位置参数传参时可以直接使用<span class="title">f</span><span class="params">(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span>，只要参数个数与定义时一样就可以，它会按定义时的顺</span></span><br><span class="line"><span class="function">- 序给参数赋值。而关键字参数传参时用，<span class="title">f</span><span class="params">(b=<span class="number">2</span>,c=<span class="number">0</span>,a=<span class="number">3</span>)</span>，这样传参更灵活，不用计较定义时的顺序。默认参数是</span></span><br><span class="line"><span class="function">- 在定义时就给了参数一个默认值，<span class="title">f</span><span class="params">(a=<span class="number">8</span>)</span>，调用时如果不给参数，就用默认值；<span class="title">keyword</span>-<span class="title">only</span>是在定义时在星号</span></span><br><span class="line"><span class="function">- 或可变参数后定义的普通参数，如<span class="title">f</span><span class="params">(a,*,r)</span>、<span class="title">f</span><span class="params">(*args,e)</span>，这里的<span class="title">r</span>和<span class="title">e</span>都是<span class="title">keyword</span>-<span class="title">only</span>，调用函数时必须给</span></span><br><span class="line"><span class="function">- <span class="title">keyword</span>-<span class="title">only</span>类型的参数指定明确的值，如<span class="title">f</span><span class="params">(<span class="number">1</span>,r=<span class="number">8</span>)</span>；可变参数可以用一个参数匹配多个参数，如</span></span><br><span class="line"><span class="function">- <span class="title">f</span><span class="params">(*args,a)</span>，调用时可以用<span class="title">f</span><span class="params">(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,a=<span class="number">0</span>)</span>；可变关键字参数在定义时要放在最后，它可以截取所有关键字参数，</span></span><br><span class="line"><span class="function">- 以字典方式保存，定义如<span class="title">f</span><span class="params">(**kwargs)</span>，调用时用<span class="title">f</span><span class="params">(a=<span class="number">8</span>,b=<span class="number">9</span>)</span></span></span><br></pre></td></tr></table></figure>
<ul>
<li>使用可变类型作为默认值，就可能修改这个默认值</li>
<li>有时候这个特性是好的，有的时候这种特性是不好的，有副作用</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如何做到按需改变？如下面两例：</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(xyz=[],u=<span class="string">'abc'</span>,z=<span class="number">123</span>)</span>:</span></span><br><span class="line">    xyz = xyz[:]   <span class="comment"># 浅拷贝，这里的xyz与默认值的xyz没有关系</span></span><br><span class="line">    xyz.append(<span class="number">1</span>)</span><br><span class="line">    print(xyz)</span><br><span class="line">    </span><br><span class="line">foo()</span><br><span class="line">print(<span class="number">1</span>,foo.__defaults__)</span><br><span class="line">foo()</span><br><span class="line">print(<span class="number">2</span>,foo.__defaults__)</span><br><span class="line">foo([<span class="number">10</span>])</span><br><span class="line"><span class="comment"># 这里给了foo()函数一个值，那就不使用默认值了，之后再向xyz中追加1，所以下面浅拷贝后再打印出来的是[10,1]</span></span><br><span class="line">print(<span class="number">3</span>,foo.__defaults__)</span><br><span class="line">foo([<span class="number">10</span>,<span class="number">5</span>])</span><br><span class="line"><span class="comment"># 因为上面没有修改默认值，所以打印出来的是[10,5,1]</span></span><br><span class="line">print(<span class="number">4</span>,foo.__defaults__)</span><br><span class="line"><span class="comment"># 如果不在函数内部改变默认值的值，使用浅拷贝是不会改变默认值的 </span></span><br><span class="line">输出：</span><br><span class="line">[<span class="number">1</span>]</span><br><span class="line"><span class="number">1</span> ([], <span class="string">'abc'</span>, <span class="number">123</span>)</span><br><span class="line">[<span class="number">1</span>]</span><br><span class="line"><span class="number">2</span> ([], <span class="string">'abc'</span>, <span class="number">123</span>)</span><br><span class="line">[<span class="number">10</span>, <span class="number">1</span>]</span><br><span class="line"><span class="number">3</span> ([], <span class="string">'abc'</span>, <span class="number">123</span>)</span><br><span class="line">[<span class="number">10</span>, <span class="number">5</span>, <span class="number">1</span>]</span><br><span class="line"><span class="number">4</span> ([], <span class="string">'abc'</span>, <span class="number">123</span>)</span><br><span class="line">- 函数体内，不改变默认值</span><br><span class="line">- xyz都是传入参数或者默认参数的副本，如果就想修改原参数，无能为力</span><br><span class="line">=======================================================================================</span><br><span class="line"><span class="comment"># 比较常用的方法</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(xyz=None,u=<span class="string">'abc'</span>,z=<span class="number">123</span>)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> xyz <span class="keyword">is</span> <span class="keyword">None</span>:</span><br><span class="line">        xyz = []</span><br><span class="line">    xyz.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> xyz</span><br><span class="line"></span><br><span class="line">lst = foo()   </span><br><span class="line"><span class="comment"># 因为没有给foo()函数值，所以使用默认值，当xyz是None时，把xyz改为空列表并追加一个[1]。lst的值就是[1]</span></span><br><span class="line">a = foo(lst)</span><br><span class="line"><span class="comment"># 用a来接收foo(lst)函数返回的值，一般都会这样使用。</span></span><br><span class="line">print(a)</span><br><span class="line"><span class="comment"># 再打印a时，因为foo()已经是[1]了，并赋值给了lst，所以再次调用foo(lst)时，会直接向[1]中追加[1]，所</span></span><br><span class="line"><span class="comment"># 以结果是[1,1]。这是使用不可变类型作为默认值，一般都用None，不会用123这样的值的。这种方式比较常用 </span></span><br><span class="line">输出：</span><br><span class="line">[<span class="number">1</span>, <span class="number">1</span>]</span><br><span class="line">- 使用不可变类型默认值</span><br><span class="line">- 如果使用缺省值<span class="keyword">None</span>就创建一个列表</span><br><span class="line">- 如果传入一个列表，就修改这个列表</span><br></pre></td></tr></table></figure>
<ul>
<li>方法一：<ul>
<li>使用影子拷贝创建一个新的对象，永远不能改变传入的参数</li>
</ul>
</li>
<li>方法二：<ul>
<li>通过值的判断就可以灵活的选择创建或者修改传入对象</li>
<li>这种方式灵活，应用广泛</li>
<li>很多函数的定义，都可以看到使用None这个不可变的值作为默认参数，可以说这是一种惯用方法</li>
</ul>
</li>
</ul>
<h3 id="变量名解析原则LEGB"><a href="#变量名解析原则LEGB" class="headerlink" title="变量名解析原则LEGB"></a>变量名解析原则LEGB</h3><ul>
<li>Local，本地作用域、局部作用域的local命名空间。函数调用时创建，调用结束消亡</li>
<li>Enclosing，Python2.2时引入了嵌套函数，实现了闭包，这个就是嵌套函数的外部函数的命名空间</li>
<li>Global，全局作用域，即一个模块的命名空间。模块被import时创建，解释器退出时消亡</li>
<li>Build-in，内置模块的命名空间，生命周期从python解释器启动时创建到解释器退出时消亡。例如print(open)，print和open都是内置的变量</li>
<li>所以一个名词的查找顺序就是LEGB</li>
</ul>
<p><img src="/images/python函数/变量名解析原则1.png" alt=""></p>
<h3 id="函数的销毁"><a href="#函数的销毁" class="headerlink" title="函数的销毁"></a>函数的销毁</h3><ul>
<li>全局函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(xyz=[],u=<span class="string">'abc'</span>,z=<span class="number">123</span>)</span>:</span></span><br><span class="line">    xyz.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> xyz</span><br><span class="line">print(foo(),id(foo),foo.__defaults__)</span><br><span class="line">输出：</span><br><span class="line">[<span class="number">1</span>] <span class="number">139660910996064</span> ([<span class="number">1</span>], <span class="string">'abc'</span>, <span class="number">123</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(xyz=[],u=<span class="string">'abc'</span>,z=<span class="number">123</span>)</span>:</span></span><br><span class="line">    xyz.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> xyz</span><br><span class="line">print(foo(),id(foo),foo.__defaults__)</span><br><span class="line"><span class="keyword">del</span> foo</span><br><span class="line">print(foo(),id(foo),foo.__defaults__)</span><br><span class="line">输出：</span><br><span class="line">[<span class="number">1</span>] <span class="number">139660910996608</span> ([<span class="number">1</span>], <span class="string">'abc'</span>, <span class="number">123</span>)</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">NameError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-152</span><span class="number">-21</span>d255639bdf&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">4</span> print(foo(),id(foo),foo.__defaults__)</span><br><span class="line">      <span class="number">5</span> <span class="keyword">del</span> foo</span><br><span class="line">----&gt; 6 print(foo(),id(foo),foo.__defaults__)</span><br><span class="line"></span><br><span class="line">NameError: name <span class="string">'foo'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br></pre></td></tr></table></figure>
<ul>
<li>全局函数销毁<ul>
<li>重新定义同名函数</li>
<li>del语句删除函数对象</li>
<li>程序结束时</li>
</ul>
</li>
</ul>
<ul>
<li>局部函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(xyz=[],u=<span class="string">'abc'</span>,z=<span class="number">123</span>)</span>:</span></span><br><span class="line">    xyz.append(<span class="number">1</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span><span class="params">(a=<span class="number">10</span>)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    print(inner)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">inner</span><span class="params">(a=<span class="number">100</span>)</span>:</span></span><br><span class="line">        print(xyz)</span><br><span class="line">    print(inner)</span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line">bar = foo()</span><br><span class="line">print(id(foo),id(bar),foo.__defaults__,bar.__defaults__)</span><br><span class="line">输出：</span><br><span class="line">&lt;function foo.&lt;locals&gt;.inner at <span class="number">0x7f0556fd2730</span>&gt;</span><br><span class="line">&lt;function foo.&lt;locals&gt;.inner at <span class="number">0x7f0556fd2b70</span>&gt;</span><br><span class="line"><span class="number">139660910996200</span> <span class="number">139660910996336</span> ([<span class="number">1</span>], <span class="string">'abc'</span>, <span class="number">123</span>) (<span class="number">100</span>,)</span><br><span class="line"></span><br><span class="line"><span class="keyword">del</span> bar</span><br><span class="line">print(id(foo),id(bar),foo.__defaults__,bar.__defaults__)</span><br><span class="line">输出：</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">NameError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-154</span>-da23e1c7a787&gt; <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">      <span class="number">1</span> <span class="keyword">del</span> bar</span><br><span class="line">----&gt; 2 print(id(foo),id(bar),foo.__defaults__,bar.__defaults__)</span><br><span class="line"></span><br><span class="line">NameError: name <span class="string">'bar'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br></pre></td></tr></table></figure>
<ul>
<li>局部函数销毁<ul>
<li>重新在上级作用域定义同名函数</li>
<li>del语句删除函数名称，函数对象的引用计数减1</li>
<li>上级作用域销毁时</li>
</ul>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/01/利用ssh密钥对的私钥访问服务器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ruopu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ruopu's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/11/01/利用ssh密钥对的私钥访问服务器/" itemprop="url">
                  利用ssh密钥对的私钥访问服务器
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">發表於</span>
              

              
                
              

              <time title="創建時間：2019-11-01 14:34:38 / 修改時間：16:55:55" itemprop="dateCreated datePublished" datetime="2019-11-01T14:34:38+08:00">2019-11-01</time>
            

            
              

              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分類於</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/基础/" itemprop="url" rel="index"><span itemprop="name">基础</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">------------</span><br><span class="line">   Server</span><br><span class="line">------------  </span><br><span class="line">1. 创建密钥对</span><br><span class="line">ssh-keygen -t rsa -P &apos;&apos;</span><br><span class="line">2. 将私钥改为.pem格式</span><br><span class="line">openssl rsa -in .ssh/id_rsa -outform pem &gt; dsjali.pem</span><br><span class="line">3. 修改权限，不然连接时会报错</span><br><span class="line">chmod 400 dsjali.pem</span><br><span class="line">4. 从私钥中产生公钥</span><br><span class="line">ssh-keygen -y -f dsjali.pem </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC+5xBrPVEJ3mRo/yVFtSQSv1/J09oYHkbTD+l/4or04YqUCHJ7iR+A/LMeff0c9xKCbT9h</span><br><span class="line">sb/MvJGmCZGxuE375Fwu8XZGS8SfjYSxeh0uASOcZazOiBu4Ooegj9A3Ov4C9odPqISWbTdUx286WJqdzW7RZ0ZwkFOipr</span><br><span class="line">oFrszAPnvg5xmlnMSa0afYgWhRXimmn2oyLt7PFfZIXX8PJnMs7x9B0+lwLLIVJRKrpU8if+gD80viC9wUJu3/jC1VF8Jg4Bq2aS7KiMX++L</span><br><span class="line">Y1SKoOUUc0sHa/SFZEzuouaRGgrmU9XkM3DvzlfcrGN+/14WczAZG4st</span><br><span class="line">5. 将上面的公钥写入认证文件</span><br><span class="line">vim .ssh/authorized_keys</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC+5xBrPVEJ3mRo/yVFtSQSv1/J09oYHkbTD+l/4or04YqUCHJ7iR+A/LMeff0c9xKCbT9h</span><br><span class="line">sb/MvJGmCZGxuE375Fwu8XZGS8SfjYSxeh0uASOcZazOiBu4Ooegj9A3Ov4C9odPqISWbTdUx286WJqdzW7RZ0ZwkFOipr</span><br><span class="line">oFrszAPnvg5xmlnMSa0afYgWhRXimmn2oyLt7PFfZIXX8PJnMs7x9B0+lwLLIVJRKrpU8if+gD80viC9wUJu3/jC1VF8Jg4Bq2aS7KiMX++L</span><br><span class="line">Y1SKoOUUc0sHa/SFZEzuouaRGgrmU9XkM3DvzlfcrGN+/14WczAZG4st</span><br><span class="line"></span><br><span class="line">------------</span><br><span class="line">   Client</span><br><span class="line">------------</span><br><span class="line">1. 下载服务器上的.pem文件</span><br><span class="line">2. 连接</span><br><span class="line">ssh -i &quot;dsjali.pem&quot; root@39.106.93.138</span><br><span class="line"># .pem文件的权限为400，如果不是，可能报错。</span><br></pre></td></tr></table></figure>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一頁"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一頁"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">ruopu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">201</span>
                    <span class="site-state-item-name">文章</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">29</span>
                    <span class="site-state-item-name">分類</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">152</span>
                    <span class="site-state-item-name">標籤</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ruopu</span>

  

  

  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>
  <span class="post-meta-divider">|</span>
  <span id="busuanzi_container_site_pv">
    本站总访问量: <span id="busuanzi_value_site_pv"></span>次
  </span>
</div>




  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 強力驅動 v3.7.1</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主題 – <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Gemini</a> v6.4.0</div>





        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="訪客總數">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="總瀏覽次數">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.4.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.4.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.4.0"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.0"></script>



  



  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
